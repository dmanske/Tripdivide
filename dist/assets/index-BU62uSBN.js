(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const m of u.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function l(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=l(c);fetch(c.href,u)}})();function uf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Yc={exports:{}},zn={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C0;function rp(){if(C0)return zn;C0=1;var r=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function l(o,c,u){var m=null;if(u!==void 0&&(m=""+u),c.key!==void 0&&(m=""+c.key),"key"in c){u={};for(var g in c)g!=="key"&&(u[g]=c[g])}else u=c;return c=u.ref,{$$typeof:r,type:o,key:m,ref:c!==void 0?c:null,props:u}}return zn.Fragment=s,zn.jsx=l,zn.jsxs=l,zn}var T0;function np(){return T0||(T0=1,Yc.exports=rp()),Yc.exports}var e=np(),Qc={exports:{}},Te={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k0;function lp(){if(k0)return Te;k0=1;var r=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),m=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),k=Symbol.iterator;function S(A){return A===null||typeof A!="object"?null:(A=k&&A[k]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,j={};function U(A,M,b){this.props=A,this.context=M,this.refs=j,this.updater=b||w}U.prototype.isReactComponent={},U.prototype.setState=function(A,M){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,M,"setState")},U.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function q(){}q.prototype=U.prototype;function Q(A,M,b){this.props=A,this.context=M,this.refs=j,this.updater=b||w}var C=Q.prototype=new q;C.constructor=Q,v(C,U.prototype),C.isPureReactComponent=!0;var N=Array.isArray;function O(){}var R={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function H(A,M,b){var B=b.ref;return{$$typeof:r,type:A,key:M,ref:B!==void 0?B:null,props:b}}function K(A,M){return H(A.type,M,A.props)}function ie(A){return typeof A=="object"&&A!==null&&A.$$typeof===r}function de(A){var M={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(b){return M[b]})}var xe=/\/+/g;function F(A,M){return typeof A=="object"&&A!==null&&A.key!=null?de(""+A.key):M.toString(36)}function Y(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(O,O):(A.status="pending",A.then(function(M){A.status==="pending"&&(A.status="fulfilled",A.value=M)},function(M){A.status==="pending"&&(A.status="rejected",A.reason=M)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function P(A,M,b,B,z){var oe=typeof A;(oe==="undefined"||oe==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(oe){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case r:case s:fe=!0;break;case y:return fe=A._init,P(fe(A._payload),M,b,B,z)}}if(fe)return z=z(A),fe=B===""?"."+F(A,0):B,N(z)?(b="",fe!=null&&(b=fe.replace(xe,"$&/")+"/"),P(z,M,b,"",function(Pe){return Pe})):z!=null&&(ie(z)&&(z=K(z,b+(z.key==null||A&&A.key===z.key?"":(""+z.key).replace(xe,"$&/")+"/")+fe)),M.push(z)),1;fe=0;var Ce=B===""?".":B+":";if(N(A))for(var Ne=0;Ne<A.length;Ne++)B=A[Ne],oe=Ce+F(B,Ne),fe+=P(B,M,b,oe,z);else if(Ne=S(A),typeof Ne=="function")for(A=Ne.call(A),Ne=0;!(B=A.next()).done;)B=B.value,oe=Ce+F(B,Ne++),fe+=P(B,M,b,oe,z);else if(oe==="object"){if(typeof A.then=="function")return P(Y(A),M,b,B,z);throw M=String(A),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.")}return fe}function ae(A,M,b){if(A==null)return A;var B=[],z=0;return P(A,B,"","",function(oe){return M.call(b,oe,z++)}),B}function ue(A){if(A._status===-1){var M=A._result;M=M(),M.then(function(b){(A._status===0||A._status===-1)&&(A._status=1,A._result=b)},function(b){(A._status===0||A._status===-1)&&(A._status=2,A._result=b)}),A._status===-1&&(A._status=0,A._result=M)}if(A._status===1)return A._result.default;throw A._result}var L=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var M=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(M))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},X={map:ae,forEach:function(A,M,b){ae(A,function(){M.apply(this,arguments)},b)},count:function(A){var M=0;return ae(A,function(){M++}),M},toArray:function(A){return ae(A,function(M){return M})||[]},only:function(A){if(!ie(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Te.Activity=_,Te.Children=X,Te.Component=U,Te.Fragment=l,Te.Profiler=c,Te.PureComponent=Q,Te.StrictMode=o,Te.Suspense=f,Te.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Te.__COMPILER_RUNTIME={__proto__:null,c:function(A){return R.H.useMemoCache(A)}},Te.cache=function(A){return function(){return A.apply(null,arguments)}},Te.cacheSignal=function(){return null},Te.cloneElement=function(A,M,b){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var B=v({},A.props),z=A.key;if(M!=null)for(oe in M.key!==void 0&&(z=""+M.key),M)!E.call(M,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&M.ref===void 0||(B[oe]=M[oe]);var oe=arguments.length-2;if(oe===1)B.children=b;else if(1<oe){for(var fe=Array(oe),Ce=0;Ce<oe;Ce++)fe[Ce]=arguments[Ce+2];B.children=fe}return H(A.type,z,B)},Te.createContext=function(A){return A={$$typeof:m,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:u,_context:A},A},Te.createElement=function(A,M,b){var B,z={},oe=null;if(M!=null)for(B in M.key!==void 0&&(oe=""+M.key),M)E.call(M,B)&&B!=="key"&&B!=="__self"&&B!=="__source"&&(z[B]=M[B]);var fe=arguments.length-2;if(fe===1)z.children=b;else if(1<fe){for(var Ce=Array(fe),Ne=0;Ne<fe;Ne++)Ce[Ne]=arguments[Ne+2];z.children=Ce}if(A&&A.defaultProps)for(B in fe=A.defaultProps,fe)z[B]===void 0&&(z[B]=fe[B]);return H(A,oe,z)},Te.createRef=function(){return{current:null}},Te.forwardRef=function(A){return{$$typeof:g,render:A}},Te.isValidElement=ie,Te.lazy=function(A){return{$$typeof:y,_payload:{_status:-1,_result:A},_init:ue}},Te.memo=function(A,M){return{$$typeof:x,type:A,compare:M===void 0?null:M}},Te.startTransition=function(A){var M=R.T,b={};R.T=b;try{var B=A(),z=R.S;z!==null&&z(b,B),typeof B=="object"&&B!==null&&typeof B.then=="function"&&B.then(O,L)}catch(oe){L(oe)}finally{M!==null&&b.types!==null&&(M.types=b.types),R.T=M}},Te.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Te.use=function(A){return R.H.use(A)},Te.useActionState=function(A,M,b){return R.H.useActionState(A,M,b)},Te.useCallback=function(A,M){return R.H.useCallback(A,M)},Te.useContext=function(A){return R.H.useContext(A)},Te.useDebugValue=function(){},Te.useDeferredValue=function(A,M){return R.H.useDeferredValue(A,M)},Te.useEffect=function(A,M){return R.H.useEffect(A,M)},Te.useEffectEvent=function(A){return R.H.useEffectEvent(A)},Te.useId=function(){return R.H.useId()},Te.useImperativeHandle=function(A,M,b){return R.H.useImperativeHandle(A,M,b)},Te.useInsertionEffect=function(A,M){return R.H.useInsertionEffect(A,M)},Te.useLayoutEffect=function(A,M){return R.H.useLayoutEffect(A,M)},Te.useMemo=function(A,M){return R.H.useMemo(A,M)},Te.useOptimistic=function(A,M){return R.H.useOptimistic(A,M)},Te.useReducer=function(A,M,b){return R.H.useReducer(A,M,b)},Te.useRef=function(A){return R.H.useRef(A)},Te.useState=function(A){return R.H.useState(A)},Te.useSyncExternalStore=function(A,M,b){return R.H.useSyncExternalStore(A,M,b)},Te.useTransition=function(){return R.H.useTransition()},Te.version="19.2.3",Te}var E0;function bd(){return E0||(E0=1,Qc.exports=lp()),Qc.exports}var D=bd();const ip=uf(D);var Jc={exports:{}},Bn={},Kc={exports:{}},Fc={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D0;function op(){return D0||(D0=1,(function(r){function s(P,ae){var ue=P.length;P.push(ae);e:for(;0<ue;){var L=ue-1>>>1,X=P[L];if(0<c(X,ae))P[L]=ae,P[ue]=X,ue=L;else break e}}function l(P){return P.length===0?null:P[0]}function o(P){if(P.length===0)return null;var ae=P[0],ue=P.pop();if(ue!==ae){P[0]=ue;e:for(var L=0,X=P.length,A=X>>>1;L<A;){var M=2*(L+1)-1,b=P[M],B=M+1,z=P[B];if(0>c(b,ue))B<X&&0>c(z,b)?(P[L]=z,P[B]=ue,L=B):(P[L]=b,P[M]=ue,L=M);else if(B<X&&0>c(z,ue))P[L]=z,P[B]=ue,L=B;else break e}}return ae}function c(P,ae){var ue=P.sortIndex-ae.sortIndex;return ue!==0?ue:P.id-ae.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;r.unstable_now=function(){return u.now()}}else{var m=Date,g=m.now();r.unstable_now=function(){return m.now()-g}}var f=[],x=[],y=1,_=null,k=3,S=!1,w=!1,v=!1,j=!1,U=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function C(P){for(var ae=l(x);ae!==null;){if(ae.callback===null)o(x);else if(ae.startTime<=P)o(x),ae.sortIndex=ae.expirationTime,s(f,ae);else break;ae=l(x)}}function N(P){if(v=!1,C(P),!w)if(l(f)!==null)w=!0,O||(O=!0,de());else{var ae=l(x);ae!==null&&Y(N,ae.startTime-P)}}var O=!1,R=-1,E=5,H=-1;function K(){return j?!0:!(r.unstable_now()-H<E)}function ie(){if(j=!1,O){var P=r.unstable_now();H=P;var ae=!0;try{e:{w=!1,v&&(v=!1,q(R),R=-1),S=!0;var ue=k;try{t:{for(C(P),_=l(f);_!==null&&!(_.expirationTime>P&&K());){var L=_.callback;if(typeof L=="function"){_.callback=null,k=_.priorityLevel;var X=L(_.expirationTime<=P);if(P=r.unstable_now(),typeof X=="function"){_.callback=X,C(P),ae=!0;break t}_===l(f)&&o(f),C(P)}else o(f);_=l(f)}if(_!==null)ae=!0;else{var A=l(x);A!==null&&Y(N,A.startTime-P),ae=!1}}break e}finally{_=null,k=ue,S=!1}ae=void 0}}finally{ae?de():O=!1}}}var de;if(typeof Q=="function")de=function(){Q(ie)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,F=xe.port2;xe.port1.onmessage=ie,de=function(){F.postMessage(null)}}else de=function(){U(ie,0)};function Y(P,ae){R=U(function(){P(r.unstable_now())},ae)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(P){P.callback=null},r.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<P?Math.floor(1e3/P):5},r.unstable_getCurrentPriorityLevel=function(){return k},r.unstable_next=function(P){switch(k){case 1:case 2:case 3:var ae=3;break;default:ae=k}var ue=k;k=ae;try{return P()}finally{k=ue}},r.unstable_requestPaint=function(){j=!0},r.unstable_runWithPriority=function(P,ae){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var ue=k;k=P;try{return ae()}finally{k=ue}},r.unstable_scheduleCallback=function(P,ae,ue){var L=r.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?L+ue:L):ue=L,P){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=ue+X,P={id:y++,callback:ae,priorityLevel:P,startTime:ue,expirationTime:X,sortIndex:-1},ue>L?(P.sortIndex=ue,s(x,P),l(f)===null&&P===l(x)&&(v?(q(R),R=-1):v=!0,Y(N,ue-L))):(P.sortIndex=X,s(f,P),w||S||(w=!0,O||(O=!0,de()))),P},r.unstable_shouldYield=K,r.unstable_wrapCallback=function(P){var ae=k;return function(){var ue=k;k=ae;try{return P.apply(this,arguments)}finally{k=ue}}}})(Fc)),Fc}var A0;function cp(){return A0||(A0=1,Kc.exports=op()),Kc.exports}var Xc={exports:{}},Ct={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O0;function dp(){if(O0)return Ct;O0=1;var r=bd();function s(f){var x="https://react.dev/errors/"+f;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)x+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+f+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var o={d:{f:l,r:function(){throw Error(s(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},c=Symbol.for("react.portal");function u(f,x,y){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:_==null?null:""+_,children:f,containerInfo:x,implementation:y}}var m=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(f,x){if(f==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Ct.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,Ct.createPortal=function(f,x){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(s(299));return u(f,x,null,y)},Ct.flushSync=function(f){var x=m.T,y=o.p;try{if(m.T=null,o.p=2,f)return f()}finally{m.T=x,o.p=y,o.d.f()}},Ct.preconnect=function(f,x){typeof f=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,o.d.C(f,x))},Ct.prefetchDNS=function(f){typeof f=="string"&&o.d.D(f)},Ct.preinit=function(f,x){if(typeof f=="string"&&x&&typeof x.as=="string"){var y=x.as,_=g(y,x.crossOrigin),k=typeof x.integrity=="string"?x.integrity:void 0,S=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;y==="style"?o.d.S(f,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:_,integrity:k,fetchPriority:S}):y==="script"&&o.d.X(f,{crossOrigin:_,integrity:k,fetchPriority:S,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Ct.preinitModule=function(f,x){if(typeof f=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var y=g(x.as,x.crossOrigin);o.d.M(f,{crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&o.d.M(f)},Ct.preload=function(f,x){if(typeof f=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var y=x.as,_=g(y,x.crossOrigin);o.d.L(f,y,{crossOrigin:_,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Ct.preloadModule=function(f,x){if(typeof f=="string")if(x){var y=g(x.as,x.crossOrigin);o.d.m(f,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:y,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else o.d.m(f)},Ct.requestFormReset=function(f){o.d.r(f)},Ct.unstable_batchedUpdates=function(f,x){return f(x)},Ct.useFormState=function(f,x,y){return m.H.useFormState(f,x,y)},Ct.useFormStatus=function(){return m.H.useHostTransitionStatus()},Ct.version="19.2.3",Ct}var R0;function up(){if(R0)return Xc.exports;R0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(s){console.error(s)}}return r(),Xc.exports=dp(),Xc.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L0;function hp(){if(L0)return Bn;L0=1;var r=cp(),s=bd(),l=up();function o(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)a+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var a=t,n=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(n=a.return),t=a.return;while(t)}return a.tag===3?n:null}function m(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function g(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function f(t){if(u(t)!==t)throw Error(o(188))}function x(t){var a=t.alternate;if(!a){if(a=u(t),a===null)throw Error(o(188));return a!==t?null:t}for(var n=t,i=a;;){var d=n.return;if(d===null)break;var h=d.alternate;if(h===null){if(i=d.return,i!==null){n=i;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===n)return f(d),t;if(h===i)return f(d),a;h=h.sibling}throw Error(o(188))}if(n.return!==i.return)n=d,i=h;else{for(var p=!1,T=d.child;T;){if(T===n){p=!0,n=d,i=h;break}if(T===i){p=!0,i=d,n=h;break}T=T.sibling}if(!p){for(T=h.child;T;){if(T===n){p=!0,n=h,i=d;break}if(T===i){p=!0,i=h,n=d;break}T=T.sibling}if(!p)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(n.tag!==3)throw Error(o(188));return n.stateNode.current===n?t:a}function y(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=y(t),a!==null)return a;t=t.sibling}return null}var _=Object.assign,k=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),ie=Symbol.iterator;function de(t){return t===null||typeof t!="object"?null:(t=ie&&t[ie]||t["@@iterator"],typeof t=="function"?t:null)}var xe=Symbol.for("react.client.reference");function F(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===xe?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case v:return"Fragment";case U:return"Profiler";case j:return"StrictMode";case N:return"Suspense";case O:return"SuspenseList";case H:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case w:return"Portal";case Q:return t.displayName||"Context";case q:return(t._context.displayName||"Context")+".Consumer";case C:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case R:return a=t.displayName||null,a!==null?a:F(t.type)||"Memo";case E:a=t._payload,t=t._init;try{return F(t(a))}catch{}}return null}var Y=Array.isArray,P=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},L=[],X=-1;function A(t){return{current:t}}function M(t){0>X||(t.current=L[X],L[X]=null,X--)}function b(t,a){X++,L[X]=t.current,t.current=a}var B=A(null),z=A(null),oe=A(null),fe=A(null);function Ce(t,a){switch(b(oe,a),b(z,t),b(B,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?Km(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=Km(a),t=Fm(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}M(B),b(B,t)}function Ne(){M(B),M(z),M(oe)}function Pe(t){t.memoizedState!==null&&b(fe,t);var a=B.current,n=Fm(a,t.type);a!==n&&(b(z,t),b(B,n))}function Tt(t){z.current===t&&(M(B),M(z)),fe.current===t&&(M(fe),Rn._currentValue=ue)}var Gs,Hr;function xa(t){if(Gs===void 0)try{throw Error()}catch(n){var a=n.stack.trim().match(/\n( *(at )?)/);Gs=a&&a[1]||"",Hr=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gs+t+Hr}var $=!1;function Ee(t,a){if(!t||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(a){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(se){var te=se}Reflect.construct(t,[],ce)}else{try{ce.call()}catch(se){te=se}t.call(ce.prototype)}}else{try{throw Error()}catch(se){te=se}(ce=t())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(se){if(se&&te&&typeof se.stack=="string")return[se.stack,te.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=i.DetermineComponentFrameRoot(),p=h[0],T=h[1];if(p&&T){var I=p.split(`
`),W=T.split(`
`);for(d=i=0;i<I.length&&!I[i].includes("DetermineComponentFrameRoot");)i++;for(;d<W.length&&!W[d].includes("DetermineComponentFrameRoot");)d++;if(i===I.length||d===W.length)for(i=I.length-1,d=W.length-1;1<=i&&0<=d&&I[i]!==W[d];)d--;for(;1<=i&&0<=d;i--,d--)if(I[i]!==W[d]){if(i!==1||d!==1)do if(i--,d--,0>d||I[i]!==W[d]){var ne=`
`+I[i].replace(" at new "," at ");return t.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",t.displayName)),ne}while(1<=i&&0<=d);break}}}finally{$=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?xa(n):""}function it(t,a){switch(t.tag){case 26:case 27:case 5:return xa(t.type);case 16:return xa("Lazy");case 13:return t.child!==a&&a!==null?xa("Suspense Fallback"):xa("Suspense");case 19:return xa("SuspenseList");case 0:case 15:return Ee(t.type,!1);case 11:return Ee(t.type.render,!1);case 1:return Ee(t.type,!0);case 31:return xa("Activity");default:return""}}function Ha(t){try{var a="",n=null;do a+=it(t,n),n=t,t=t.return;while(t);return a}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var ps=Object.prototype.hasOwnProperty,kt=r.unstable_scheduleCallback,ys=r.unstable_cancelCallback,Mf=r.unstable_shouldYield,zf=r.unstable_requestPaint,It=r.unstable_now,Bf=r.unstable_getCurrentPriorityLevel,Td=r.unstable_ImmediatePriority,kd=r.unstable_UserBlockingPriority,Kn=r.unstable_NormalPriority,If=r.unstable_LowPriority,Ed=r.unstable_IdlePriority,Vf=r.log,$f=r.unstable_setDisableYieldValue,Gr=null,Vt=null;function Ga(t){if(typeof Vf=="function"&&$f(t),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(Gr,t)}catch{}}var $t=Math.clz32?Math.clz32:Gf,Pf=Math.log,Hf=Math.LN2;function Gf(t){return t>>>=0,t===0?32:31-(Pf(t)/Hf|0)|0}var Fn=256,Xn=262144,Zn=4194304;function vs(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Wn(t,a,n){var i=t.pendingLanes;if(i===0)return 0;var d=0,h=t.suspendedLanes,p=t.pingedLanes;t=t.warmLanes;var T=i&134217727;return T!==0?(i=T&~h,i!==0?d=vs(i):(p&=T,p!==0?d=vs(p):n||(n=T&~t,n!==0&&(d=vs(n))))):(T=i&~h,T!==0?d=vs(T):p!==0?d=vs(p):n||(n=i&~t,n!==0&&(d=vs(n)))),d===0?0:a!==0&&a!==d&&(a&h)===0&&(h=d&-d,n=a&-a,h>=n||h===32&&(n&4194048)!==0)?a:d}function qr(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function qf(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dd(){var t=Zn;return Zn<<=1,(Zn&62914560)===0&&(Zn=4194304),t}function Ri(t){for(var a=[],n=0;31>n;n++)a.push(t);return a}function Yr(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Yf(t,a,n,i,d,h){var p=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var T=t.entanglements,I=t.expirationTimes,W=t.hiddenUpdates;for(n=p&~n;0<n;){var ne=31-$t(n),ce=1<<ne;T[ne]=0,I[ne]=-1;var te=W[ne];if(te!==null)for(W[ne]=null,ne=0;ne<te.length;ne++){var se=te[ne];se!==null&&(se.lane&=-536870913)}n&=~ce}i!==0&&Ad(t,i,0),h!==0&&d===0&&t.tag!==0&&(t.suspendedLanes|=h&~(p&~a))}function Ad(t,a,n){t.pendingLanes|=a,t.suspendedLanes&=~a;var i=31-$t(a);t.entangledLanes|=a,t.entanglements[i]=t.entanglements[i]|1073741824|n&261930}function Od(t,a){var n=t.entangledLanes|=a;for(t=t.entanglements;n;){var i=31-$t(n),d=1<<i;d&a|t[i]&a&&(t[i]|=a),n&=~d}}function Rd(t,a){var n=a&-a;return n=(n&42)!==0?1:Li(n),(n&(t.suspendedLanes|a))!==0?0:n}function Li(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Ui(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Ld(){var t=ae.p;return t!==0?t:(t=window.event,t===void 0?32:v0(t.type))}function Ud(t,a){var n=ae.p;try{return ae.p=t,a()}finally{ae.p=n}}var qa=Math.random().toString(36).slice(2),yt="__reactFiber$"+qa,At="__reactProps$"+qa,qs="__reactContainer$"+qa,Mi="__reactEvents$"+qa,Qf="__reactListeners$"+qa,Jf="__reactHandles$"+qa,Md="__reactResources$"+qa,Qr="__reactMarker$"+qa;function zi(t){delete t[yt],delete t[At],delete t[Mi],delete t[Qf],delete t[Jf]}function Ys(t){var a=t[yt];if(a)return a;for(var n=t.parentNode;n;){if(a=n[qs]||n[yt]){if(n=a.alternate,a.child!==null||n!==null&&n.child!==null)for(t=s0(t);t!==null;){if(n=t[yt])return n;t=s0(t)}return a}t=n,n=t.parentNode}return null}function Qs(t){if(t=t[yt]||t[qs]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function Jr(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(o(33))}function Js(t){var a=t[Md];return a||(a=t[Md]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function xt(t){t[Qr]=!0}var zd=new Set,Bd={};function bs(t,a){Ks(t,a),Ks(t+"Capture",a)}function Ks(t,a){for(Bd[t]=a,t=0;t<a.length;t++)zd.add(a[t])}var Kf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Id={},Vd={};function Ff(t){return ps.call(Vd,t)?!0:ps.call(Id,t)?!1:Kf.test(t)?Vd[t]=!0:(Id[t]=!0,!1)}function el(t,a,n){if(Ff(a))if(n===null)t.removeAttribute(a);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var i=a.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+n)}}function tl(t,a,n){if(n===null)t.removeAttribute(a);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+n)}}function wa(t,a,n,i){if(i===null)t.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(a,n,""+i)}}function Wt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function $d(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Xf(t,a,n){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var d=i.get,h=i.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return d.call(this)},set:function(p){n=""+p,h.call(this,p)}}),Object.defineProperty(t,a,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(p){n=""+p},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function Bi(t){if(!t._valueTracker){var a=$d(t)?"checked":"value";t._valueTracker=Xf(t,a,""+t[a])}}function Pd(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var n=a.getValue(),i="";return t&&(i=$d(t)?t.checked?"true":"false":t.value),t=i,t!==n?(a.setValue(t),!0):!1}function al(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Zf=/[\n"\\]/g;function ea(t){return t.replace(Zf,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Ii(t,a,n,i,d,h,p,T){t.name="",p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"?t.type=p:t.removeAttribute("type"),a!=null?p==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+Wt(a)):t.value!==""+Wt(a)&&(t.value=""+Wt(a)):p!=="submit"&&p!=="reset"||t.removeAttribute("value"),a!=null?Vi(t,p,Wt(a)):n!=null?Vi(t,p,Wt(n)):i!=null&&t.removeAttribute("value"),d==null&&h!=null&&(t.defaultChecked=!!h),d!=null&&(t.checked=d&&typeof d!="function"&&typeof d!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?t.name=""+Wt(T):t.removeAttribute("name")}function Hd(t,a,n,i,d,h,p,T){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(t.type=h),a!=null||n!=null){if(!(h!=="submit"&&h!=="reset"||a!=null)){Bi(t);return}n=n!=null?""+Wt(n):"",a=a!=null?""+Wt(a):n,T||a===t.value||(t.value=a),t.defaultValue=a}i=i??d,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=T?t.checked:!!i,t.defaultChecked=!!i,p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.name=p),Bi(t)}function Vi(t,a,n){a==="number"&&al(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function Fs(t,a,n,i){if(t=t.options,a){a={};for(var d=0;d<n.length;d++)a["$"+n[d]]=!0;for(n=0;n<t.length;n++)d=a.hasOwnProperty("$"+t[n].value),t[n].selected!==d&&(t[n].selected=d),d&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Wt(n),a=null,d=0;d<t.length;d++){if(t[d].value===n){t[d].selected=!0,i&&(t[d].defaultSelected=!0);return}a!==null||t[d].disabled||(a=t[d])}a!==null&&(a.selected=!0)}}function Gd(t,a,n){if(a!=null&&(a=""+Wt(a),a!==t.value&&(t.value=a),n==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=n!=null?""+Wt(n):""}function qd(t,a,n,i){if(a==null){if(i!=null){if(n!=null)throw Error(o(92));if(Y(i)){if(1<i.length)throw Error(o(93));i=i[0]}n=i}n==null&&(n=""),a=n}n=Wt(a),t.defaultValue=n,i=t.textContent,i===n&&i!==""&&i!==null&&(t.value=i),Bi(t)}function Xs(t,a){if(a){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=a;return}}t.textContent=a}var Wf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Yd(t,a,n){var i=a.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":i?t.setProperty(a,n):typeof n!="number"||n===0||Wf.has(a)?a==="float"?t.cssFloat=n:t[a]=(""+n).trim():t[a]=n+"px"}function Qd(t,a,n){if(a!=null&&typeof a!="object")throw Error(o(62));if(t=t.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||a!=null&&a.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var d in a)i=a[d],a.hasOwnProperty(d)&&n[d]!==i&&Yd(t,d,i)}else for(var h in a)a.hasOwnProperty(h)&&Yd(t,h,a[h])}function $i(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function sl(t){return tg.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function _a(){}var Pi=null;function Hi(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zs=null,Ws=null;function Jd(t){var a=Qs(t);if(a&&(t=a.stateNode)){var n=t[At]||null;e:switch(t=a.stateNode,a.type){case"input":if(Ii(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),a=n.name,n.type==="radio"&&a!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+ea(""+a)+'"][type="radio"]'),a=0;a<n.length;a++){var i=n[a];if(i!==t&&i.form===t.form){var d=i[At]||null;if(!d)throw Error(o(90));Ii(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(a=0;a<n.length;a++)i=n[a],i.form===t.form&&Pd(i)}break e;case"textarea":Gd(t,n.value,n.defaultValue);break e;case"select":a=n.value,a!=null&&Fs(t,!!n.multiple,a,!1)}}}var Gi=!1;function Kd(t,a,n){if(Gi)return t(a,n);Gi=!0;try{var i=t(a);return i}finally{if(Gi=!1,(Zs!==null||Ws!==null)&&(Gl(),Zs&&(a=Zs,t=Ws,Ws=Zs=null,Jd(a),t)))for(a=0;a<t.length;a++)Jd(t[a])}}function Kr(t,a){var n=t.stateNode;if(n===null)return null;var i=n[At]||null;if(i===null)return null;n=i[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(o(231,a,typeof n));return n}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qi=!1;if(Sa)try{var Fr={};Object.defineProperty(Fr,"passive",{get:function(){qi=!0}}),window.addEventListener("test",Fr,Fr),window.removeEventListener("test",Fr,Fr)}catch{qi=!1}var Ya=null,Yi=null,rl=null;function Fd(){if(rl)return rl;var t,a=Yi,n=a.length,i,d="value"in Ya?Ya.value:Ya.textContent,h=d.length;for(t=0;t<n&&a[t]===d[t];t++);var p=n-t;for(i=1;i<=p&&a[n-i]===d[h-i];i++);return rl=d.slice(t,1<i?1-i:void 0)}function nl(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function ll(){return!0}function Xd(){return!1}function Ot(t){function a(n,i,d,h,p){this._reactName=n,this._targetInst=d,this.type=i,this.nativeEvent=h,this.target=p,this.currentTarget=null;for(var T in t)t.hasOwnProperty(T)&&(n=t[T],this[T]=n?n(h):h[T]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?ll:Xd,this.isPropagationStopped=Xd,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ll)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ll)},persist:function(){},isPersistent:ll}),a}var js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},il=Ot(js),Xr=_({},js,{view:0,detail:0}),ag=Ot(Xr),Qi,Ji,Zr,ol=_({},Xr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fi,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zr&&(Zr&&t.type==="mousemove"?(Qi=t.screenX-Zr.screenX,Ji=t.screenY-Zr.screenY):Ji=Qi=0,Zr=t),Qi)},movementY:function(t){return"movementY"in t?t.movementY:Ji}}),Zd=Ot(ol),sg=_({},ol,{dataTransfer:0}),rg=Ot(sg),ng=_({},Xr,{relatedTarget:0}),Ki=Ot(ng),lg=_({},js,{animationName:0,elapsedTime:0,pseudoElement:0}),ig=Ot(lg),og=_({},js,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cg=Ot(og),dg=_({},js,{data:0}),Wd=Ot(dg),ug={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fg(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=mg[t])?!!a[t]:!1}function Fi(){return fg}var gg=_({},Xr,{key:function(t){if(t.key){var a=ug[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=nl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hg[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fi,charCode:function(t){return t.type==="keypress"?nl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xg=Ot(gg),pg=_({},ol,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eu=Ot(pg),yg=_({},Xr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fi}),vg=Ot(yg),bg=_({},js,{propertyName:0,elapsedTime:0,pseudoElement:0}),jg=Ot(bg),Ng=_({},ol,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wg=Ot(Ng),_g=_({},js,{newState:0,oldState:0}),Sg=Ot(_g),Cg=[9,13,27,32],Xi=Sa&&"CompositionEvent"in window,Wr=null;Sa&&"documentMode"in document&&(Wr=document.documentMode);var Tg=Sa&&"TextEvent"in window&&!Wr,tu=Sa&&(!Xi||Wr&&8<Wr&&11>=Wr),au=" ",su=!1;function ru(t,a){switch(t){case"keyup":return Cg.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nu(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var er=!1;function kg(t,a){switch(t){case"compositionend":return nu(a);case"keypress":return a.which!==32?null:(su=!0,au);case"textInput":return t=a.data,t===au&&su?null:t;default:return null}}function Eg(t,a){if(er)return t==="compositionend"||!Xi&&ru(t,a)?(t=Fd(),rl=Yi=Ya=null,er=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return tu&&a.locale!=="ko"?null:a.data;default:return null}}var Dg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lu(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!Dg[t.type]:a==="textarea"}function iu(t,a,n,i){Zs?Ws?Ws.push(i):Ws=[i]:Zs=i,a=Xl(a,"onChange"),0<a.length&&(n=new il("onChange","change",null,n,i),t.push({event:n,listeners:a}))}var en=null,tn=null;function Ag(t){Hm(t,0)}function cl(t){var a=Jr(t);if(Pd(a))return t}function ou(t,a){if(t==="change")return a}var cu=!1;if(Sa){var Zi;if(Sa){var Wi="oninput"in document;if(!Wi){var du=document.createElement("div");du.setAttribute("oninput","return;"),Wi=typeof du.oninput=="function"}Zi=Wi}else Zi=!1;cu=Zi&&(!document.documentMode||9<document.documentMode)}function uu(){en&&(en.detachEvent("onpropertychange",hu),tn=en=null)}function hu(t){if(t.propertyName==="value"&&cl(tn)){var a=[];iu(a,tn,t,Hi(t)),Kd(Ag,a)}}function Og(t,a,n){t==="focusin"?(uu(),en=a,tn=n,en.attachEvent("onpropertychange",hu)):t==="focusout"&&uu()}function Rg(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cl(tn)}function Lg(t,a){if(t==="click")return cl(a)}function Ug(t,a){if(t==="input"||t==="change")return cl(a)}function Mg(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var Pt=typeof Object.is=="function"?Object.is:Mg;function an(t,a){if(Pt(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var n=Object.keys(t),i=Object.keys(a);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var d=n[i];if(!ps.call(a,d)||!Pt(t[d],a[d]))return!1}return!0}function mu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fu(t,a){var n=mu(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=a&&i>=a)return{node:n,offset:a-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mu(n)}}function gu(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?gu(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function xu(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=al(t.document);a instanceof t.HTMLIFrameElement;){try{var n=typeof a.contentWindow.location.href=="string"}catch{n=!1}if(n)t=a.contentWindow;else break;a=al(t.document)}return a}function eo(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var zg=Sa&&"documentMode"in document&&11>=document.documentMode,tr=null,to=null,sn=null,ao=!1;function pu(t,a,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ao||tr==null||tr!==al(i)||(i=tr,"selectionStart"in i&&eo(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),sn&&an(sn,i)||(sn=i,i=Xl(to,"onSelect"),0<i.length&&(a=new il("onSelect","select",null,a,n),t.push({event:a,listeners:i}),a.target=tr)))}function Ns(t,a){var n={};return n[t.toLowerCase()]=a.toLowerCase(),n["Webkit"+t]="webkit"+a,n["Moz"+t]="moz"+a,n}var ar={animationend:Ns("Animation","AnimationEnd"),animationiteration:Ns("Animation","AnimationIteration"),animationstart:Ns("Animation","AnimationStart"),transitionrun:Ns("Transition","TransitionRun"),transitionstart:Ns("Transition","TransitionStart"),transitioncancel:Ns("Transition","TransitionCancel"),transitionend:Ns("Transition","TransitionEnd")},so={},yu={};Sa&&(yu=document.createElement("div").style,"AnimationEvent"in window||(delete ar.animationend.animation,delete ar.animationiteration.animation,delete ar.animationstart.animation),"TransitionEvent"in window||delete ar.transitionend.transition);function ws(t){if(so[t])return so[t];if(!ar[t])return t;var a=ar[t],n;for(n in a)if(a.hasOwnProperty(n)&&n in yu)return so[t]=a[n];return t}var vu=ws("animationend"),bu=ws("animationiteration"),ju=ws("animationstart"),Bg=ws("transitionrun"),Ig=ws("transitionstart"),Vg=ws("transitioncancel"),Nu=ws("transitionend"),wu=new Map,ro="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ro.push("scrollEnd");function da(t,a){wu.set(t,a),bs(a,[t])}var dl=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ta=[],sr=0,no=0;function ul(){for(var t=sr,a=no=sr=0;a<t;){var n=ta[a];ta[a++]=null;var i=ta[a];ta[a++]=null;var d=ta[a];ta[a++]=null;var h=ta[a];if(ta[a++]=null,i!==null&&d!==null){var p=i.pending;p===null?d.next=d:(d.next=p.next,p.next=d),i.pending=d}h!==0&&_u(n,d,h)}}function hl(t,a,n,i){ta[sr++]=t,ta[sr++]=a,ta[sr++]=n,ta[sr++]=i,no|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function lo(t,a,n,i){return hl(t,a,n,i),ml(t)}function _s(t,a){return hl(t,null,null,a),ml(t)}function _u(t,a,n){t.lanes|=n;var i=t.alternate;i!==null&&(i.lanes|=n);for(var d=!1,h=t.return;h!==null;)h.childLanes|=n,i=h.alternate,i!==null&&(i.childLanes|=n),h.tag===22&&(t=h.stateNode,t===null||t._visibility&1||(d=!0)),t=h,h=h.return;return t.tag===3?(h=t.stateNode,d&&a!==null&&(d=31-$t(n),t=h.hiddenUpdates,i=t[d],i===null?t[d]=[a]:i.push(a),a.lane=n|536870912),h):null}function ml(t){if(50<Cn)throw Cn=0,xc=null,Error(o(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var rr={};function $g(t,a,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ht(t,a,n,i){return new $g(t,a,n,i)}function io(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ca(t,a){var n=t.alternate;return n===null?(n=Ht(t.tag,a,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=a,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,a=t.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function Su(t,a){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,a=n.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function fl(t,a,n,i,d,h){var p=0;if(i=t,typeof t=="function")io(t)&&(p=1);else if(typeof t=="string")p=Yx(t,n,B.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case H:return t=Ht(31,n,a,d),t.elementType=H,t.lanes=h,t;case v:return Ss(n.children,d,h,a);case j:p=8,d|=24;break;case U:return t=Ht(12,n,a,d|2),t.elementType=U,t.lanes=h,t;case N:return t=Ht(13,n,a,d),t.elementType=N,t.lanes=h,t;case O:return t=Ht(19,n,a,d),t.elementType=O,t.lanes=h,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Q:p=10;break e;case q:p=9;break e;case C:p=11;break e;case R:p=14;break e;case E:p=16,i=null;break e}p=29,n=Error(o(130,t===null?"null":typeof t,"")),i=null}return a=Ht(p,n,a,d),a.elementType=t,a.type=i,a.lanes=h,a}function Ss(t,a,n,i){return t=Ht(7,t,i,a),t.lanes=n,t}function oo(t,a,n){return t=Ht(6,t,null,a),t.lanes=n,t}function Cu(t){var a=Ht(18,null,null,0);return a.stateNode=t,a}function co(t,a,n){return a=Ht(4,t.children!==null?t.children:[],t.key,a),a.lanes=n,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var Tu=new WeakMap;function aa(t,a){if(typeof t=="object"&&t!==null){var n=Tu.get(t);return n!==void 0?n:(a={value:t,source:a,stack:Ha(a)},Tu.set(t,a),a)}return{value:t,source:a,stack:Ha(a)}}var nr=[],lr=0,gl=null,rn=0,sa=[],ra=0,Qa=null,pa=1,ya="";function Ta(t,a){nr[lr++]=rn,nr[lr++]=gl,gl=t,rn=a}function ku(t,a,n){sa[ra++]=pa,sa[ra++]=ya,sa[ra++]=Qa,Qa=t;var i=pa;t=ya;var d=32-$t(i)-1;i&=~(1<<d),n+=1;var h=32-$t(a)+d;if(30<h){var p=d-d%5;h=(i&(1<<p)-1).toString(32),i>>=p,d-=p,pa=1<<32-$t(a)+d|n<<d|i,ya=h+t}else pa=1<<h|n<<d|i,ya=t}function uo(t){t.return!==null&&(Ta(t,1),ku(t,1,0))}function ho(t){for(;t===gl;)gl=nr[--lr],nr[lr]=null,rn=nr[--lr],nr[lr]=null;for(;t===Qa;)Qa=sa[--ra],sa[ra]=null,ya=sa[--ra],sa[ra]=null,pa=sa[--ra],sa[ra]=null}function Eu(t,a){sa[ra++]=pa,sa[ra++]=ya,sa[ra++]=Qa,pa=a.id,ya=a.overflow,Qa=t}var vt=null,Xe=null,Be=!1,Ja=null,na=!1,mo=Error(o(519));function Ka(t){var a=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nn(aa(a,t)),mo}function Du(t){var a=t.stateNode,n=t.type,i=t.memoizedProps;switch(a[yt]=t,a[At]=i,n){case"dialog":Ue("cancel",a),Ue("close",a);break;case"iframe":case"object":case"embed":Ue("load",a);break;case"video":case"audio":for(n=0;n<kn.length;n++)Ue(kn[n],a);break;case"source":Ue("error",a);break;case"img":case"image":case"link":Ue("error",a),Ue("load",a);break;case"details":Ue("toggle",a);break;case"input":Ue("invalid",a),Hd(a,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Ue("invalid",a);break;case"textarea":Ue("invalid",a),qd(a,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||a.textContent===""+n||i.suppressHydrationWarning===!0||Qm(a.textContent,n)?(i.popover!=null&&(Ue("beforetoggle",a),Ue("toggle",a)),i.onScroll!=null&&Ue("scroll",a),i.onScrollEnd!=null&&Ue("scrollend",a),i.onClick!=null&&(a.onclick=_a),a=!0):a=!1,a||Ka(t,!0)}function Au(t){for(vt=t.return;vt;)switch(vt.tag){case 5:case 31:case 13:na=!1;return;case 27:case 3:na=!0;return;default:vt=vt.return}}function ir(t){if(t!==vt)return!1;if(!Be)return Au(t),Be=!0,!1;var a=t.tag,n;if((n=a!==3&&a!==27)&&((n=a===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||Ac(t.type,t.memoizedProps)),n=!n),n&&Xe&&Ka(t),Au(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Xe=a0(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Xe=a0(t)}else a===27?(a=Xe,cs(t.type)?(t=Mc,Mc=null,Xe=t):Xe=a):Xe=vt?ia(t.stateNode.nextSibling):null;return!0}function Cs(){Xe=vt=null,Be=!1}function fo(){var t=Ja;return t!==null&&(Mt===null?Mt=t:Mt.push.apply(Mt,t),Ja=null),t}function nn(t){Ja===null?Ja=[t]:Ja.push(t)}var go=A(null),Ts=null,ka=null;function Fa(t,a,n){b(go,a._currentValue),a._currentValue=n}function Ea(t){t._currentValue=go.current,M(go)}function xo(t,a,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,i!==null&&(i.childLanes|=a)):i!==null&&(i.childLanes&a)!==a&&(i.childLanes|=a),t===n)break;t=t.return}}function po(t,a,n,i){var d=t.child;for(d!==null&&(d.return=t);d!==null;){var h=d.dependencies;if(h!==null){var p=d.child;h=h.firstContext;e:for(;h!==null;){var T=h;h=d;for(var I=0;I<a.length;I++)if(T.context===a[I]){h.lanes|=n,T=h.alternate,T!==null&&(T.lanes|=n),xo(h.return,n,t),i||(p=null);break e}h=T.next}}else if(d.tag===18){if(p=d.return,p===null)throw Error(o(341));p.lanes|=n,h=p.alternate,h!==null&&(h.lanes|=n),xo(p,n,t),p=null}else p=d.child;if(p!==null)p.return=d;else for(p=d;p!==null;){if(p===t){p=null;break}if(d=p.sibling,d!==null){d.return=p.return,p=d;break}p=p.return}d=p}}function or(t,a,n,i){t=null;for(var d=a,h=!1;d!==null;){if(!h){if((d.flags&524288)!==0)h=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var p=d.alternate;if(p===null)throw Error(o(387));if(p=p.memoizedProps,p!==null){var T=d.type;Pt(d.pendingProps.value,p.value)||(t!==null?t.push(T):t=[T])}}else if(d===fe.current){if(p=d.alternate,p===null)throw Error(o(387));p.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(t!==null?t.push(Rn):t=[Rn])}d=d.return}t!==null&&po(a,t,n,i),a.flags|=262144}function xl(t){for(t=t.firstContext;t!==null;){if(!Pt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ks(t){Ts=t,ka=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function bt(t){return Ou(Ts,t)}function pl(t,a){return Ts===null&&ks(t),Ou(t,a)}function Ou(t,a){var n=a._currentValue;if(a={context:a,memoizedValue:n,next:null},ka===null){if(t===null)throw Error(o(308));ka=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else ka=ka.next=a;return n}var Pg=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(n,i){t.push(i)}};this.abort=function(){a.aborted=!0,t.forEach(function(n){return n()})}},Hg=r.unstable_scheduleCallback,Gg=r.unstable_NormalPriority,ot={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yo(){return{controller:new Pg,data:new Map,refCount:0}}function ln(t){t.refCount--,t.refCount===0&&Hg(Gg,function(){t.controller.abort()})}var on=null,vo=0,cr=0,dr=null;function qg(t,a){if(on===null){var n=on=[];vo=0,cr=Nc(),dr={status:"pending",value:void 0,then:function(i){n.push(i)}}}return vo++,a.then(Ru,Ru),a}function Ru(){if(--vo===0&&on!==null){dr!==null&&(dr.status="fulfilled");var t=on;on=null,cr=0,dr=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function Yg(t,a){var n=[],i={status:"pending",value:null,reason:null,then:function(d){n.push(d)}};return t.then(function(){i.status="fulfilled",i.value=a;for(var d=0;d<n.length;d++)(0,n[d])(a)},function(d){for(i.status="rejected",i.reason=d,d=0;d<n.length;d++)(0,n[d])(void 0)}),i}var Lu=P.S;P.S=function(t,a){pm=It(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&qg(t,a),Lu!==null&&Lu(t,a)};var Es=A(null);function bo(){var t=Es.current;return t!==null?t:Je.pooledCache}function yl(t,a){a===null?b(Es,Es.current):b(Es,a.pool)}function Uu(){var t=bo();return t===null?null:{parent:ot._currentValue,pool:t}}var ur=Error(o(460)),jo=Error(o(474)),vl=Error(o(542)),bl={then:function(){}};function Mu(t){return t=t.status,t==="fulfilled"||t==="rejected"}function zu(t,a,n){switch(n=t[n],n===void 0?t.push(a):n!==a&&(a.then(_a,_a),a=n),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Iu(t),t;default:if(typeof a.status=="string")a.then(_a,_a);else{if(t=Je,t!==null&&100<t.shellSuspendCounter)throw Error(o(482));t=a,t.status="pending",t.then(function(i){if(a.status==="pending"){var d=a;d.status="fulfilled",d.value=i}},function(i){if(a.status==="pending"){var d=a;d.status="rejected",d.reason=i}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Iu(t),t}throw As=a,ur}}function Ds(t){try{var a=t._init;return a(t._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(As=n,ur):n}}var As=null;function Bu(){if(As===null)throw Error(o(459));var t=As;return As=null,t}function Iu(t){if(t===ur||t===vl)throw Error(o(483))}var hr=null,cn=0;function jl(t){var a=cn;return cn+=1,hr===null&&(hr=[]),zu(hr,t,a)}function dn(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Nl(t,a){throw a.$$typeof===k?Error(o(525)):(t=Object.prototype.toString.call(a),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function Vu(t){function a(J,G){if(t){var Z=J.deletions;Z===null?(J.deletions=[G],J.flags|=16):Z.push(G)}}function n(J,G){if(!t)return null;for(;G!==null;)a(J,G),G=G.sibling;return null}function i(J){for(var G=new Map;J!==null;)J.key!==null?G.set(J.key,J):G.set(J.index,J),J=J.sibling;return G}function d(J,G){return J=Ca(J,G),J.index=0,J.sibling=null,J}function h(J,G,Z){return J.index=Z,t?(Z=J.alternate,Z!==null?(Z=Z.index,Z<G?(J.flags|=67108866,G):Z):(J.flags|=67108866,G)):(J.flags|=1048576,G)}function p(J){return t&&J.alternate===null&&(J.flags|=67108866),J}function T(J,G,Z,le){return G===null||G.tag!==6?(G=oo(Z,J.mode,le),G.return=J,G):(G=d(G,Z),G.return=J,G)}function I(J,G,Z,le){var je=Z.type;return je===v?ne(J,G,Z.props.children,le,Z.key):G!==null&&(G.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===E&&Ds(je)===G.type)?(G=d(G,Z.props),dn(G,Z),G.return=J,G):(G=fl(Z.type,Z.key,Z.props,null,J.mode,le),dn(G,Z),G.return=J,G)}function W(J,G,Z,le){return G===null||G.tag!==4||G.stateNode.containerInfo!==Z.containerInfo||G.stateNode.implementation!==Z.implementation?(G=co(Z,J.mode,le),G.return=J,G):(G=d(G,Z.children||[]),G.return=J,G)}function ne(J,G,Z,le,je){return G===null||G.tag!==7?(G=Ss(Z,J.mode,le,je),G.return=J,G):(G=d(G,Z),G.return=J,G)}function ce(J,G,Z){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=oo(""+G,J.mode,Z),G.return=J,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case S:return Z=fl(G.type,G.key,G.props,null,J.mode,Z),dn(Z,G),Z.return=J,Z;case w:return G=co(G,J.mode,Z),G.return=J,G;case E:return G=Ds(G),ce(J,G,Z)}if(Y(G)||de(G))return G=Ss(G,J.mode,Z,null),G.return=J,G;if(typeof G.then=="function")return ce(J,jl(G),Z);if(G.$$typeof===Q)return ce(J,pl(J,G),Z);Nl(J,G)}return null}function te(J,G,Z,le){var je=G!==null?G.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return je!==null?null:T(J,G,""+Z,le);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case S:return Z.key===je?I(J,G,Z,le):null;case w:return Z.key===je?W(J,G,Z,le):null;case E:return Z=Ds(Z),te(J,G,Z,le)}if(Y(Z)||de(Z))return je!==null?null:ne(J,G,Z,le,null);if(typeof Z.then=="function")return te(J,G,jl(Z),le);if(Z.$$typeof===Q)return te(J,G,pl(J,Z),le);Nl(J,Z)}return null}function se(J,G,Z,le,je){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return J=J.get(Z)||null,T(G,J,""+le,je);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case S:return J=J.get(le.key===null?Z:le.key)||null,I(G,J,le,je);case w:return J=J.get(le.key===null?Z:le.key)||null,W(G,J,le,je);case E:return le=Ds(le),se(J,G,Z,le,je)}if(Y(le)||de(le))return J=J.get(Z)||null,ne(G,J,le,je,null);if(typeof le.then=="function")return se(J,G,Z,jl(le),je);if(le.$$typeof===Q)return se(J,G,Z,pl(G,le),je);Nl(G,le)}return null}function ye(J,G,Z,le){for(var je=null,Ie=null,ve=G,De=G=0,ze=null;ve!==null&&De<Z.length;De++){ve.index>De?(ze=ve,ve=null):ze=ve.sibling;var Ve=te(J,ve,Z[De],le);if(Ve===null){ve===null&&(ve=ze);break}t&&ve&&Ve.alternate===null&&a(J,ve),G=h(Ve,G,De),Ie===null?je=Ve:Ie.sibling=Ve,Ie=Ve,ve=ze}if(De===Z.length)return n(J,ve),Be&&Ta(J,De),je;if(ve===null){for(;De<Z.length;De++)ve=ce(J,Z[De],le),ve!==null&&(G=h(ve,G,De),Ie===null?je=ve:Ie.sibling=ve,Ie=ve);return Be&&Ta(J,De),je}for(ve=i(ve);De<Z.length;De++)ze=se(ve,J,De,Z[De],le),ze!==null&&(t&&ze.alternate!==null&&ve.delete(ze.key===null?De:ze.key),G=h(ze,G,De),Ie===null?je=ze:Ie.sibling=ze,Ie=ze);return t&&ve.forEach(function(fs){return a(J,fs)}),Be&&Ta(J,De),je}function we(J,G,Z,le){if(Z==null)throw Error(o(151));for(var je=null,Ie=null,ve=G,De=G=0,ze=null,Ve=Z.next();ve!==null&&!Ve.done;De++,Ve=Z.next()){ve.index>De?(ze=ve,ve=null):ze=ve.sibling;var fs=te(J,ve,Ve.value,le);if(fs===null){ve===null&&(ve=ze);break}t&&ve&&fs.alternate===null&&a(J,ve),G=h(fs,G,De),Ie===null?je=fs:Ie.sibling=fs,Ie=fs,ve=ze}if(Ve.done)return n(J,ve),Be&&Ta(J,De),je;if(ve===null){for(;!Ve.done;De++,Ve=Z.next())Ve=ce(J,Ve.value,le),Ve!==null&&(G=h(Ve,G,De),Ie===null?je=Ve:Ie.sibling=Ve,Ie=Ve);return Be&&Ta(J,De),je}for(ve=i(ve);!Ve.done;De++,Ve=Z.next())Ve=se(ve,J,De,Ve.value,le),Ve!==null&&(t&&Ve.alternate!==null&&ve.delete(Ve.key===null?De:Ve.key),G=h(Ve,G,De),Ie===null?je=Ve:Ie.sibling=Ve,Ie=Ve);return t&&ve.forEach(function(sp){return a(J,sp)}),Be&&Ta(J,De),je}function Qe(J,G,Z,le){if(typeof Z=="object"&&Z!==null&&Z.type===v&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case S:e:{for(var je=Z.key;G!==null;){if(G.key===je){if(je=Z.type,je===v){if(G.tag===7){n(J,G.sibling),le=d(G,Z.props.children),le.return=J,J=le;break e}}else if(G.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===E&&Ds(je)===G.type){n(J,G.sibling),le=d(G,Z.props),dn(le,Z),le.return=J,J=le;break e}n(J,G);break}else a(J,G);G=G.sibling}Z.type===v?(le=Ss(Z.props.children,J.mode,le,Z.key),le.return=J,J=le):(le=fl(Z.type,Z.key,Z.props,null,J.mode,le),dn(le,Z),le.return=J,J=le)}return p(J);case w:e:{for(je=Z.key;G!==null;){if(G.key===je)if(G.tag===4&&G.stateNode.containerInfo===Z.containerInfo&&G.stateNode.implementation===Z.implementation){n(J,G.sibling),le=d(G,Z.children||[]),le.return=J,J=le;break e}else{n(J,G);break}else a(J,G);G=G.sibling}le=co(Z,J.mode,le),le.return=J,J=le}return p(J);case E:return Z=Ds(Z),Qe(J,G,Z,le)}if(Y(Z))return ye(J,G,Z,le);if(de(Z)){if(je=de(Z),typeof je!="function")throw Error(o(150));return Z=je.call(Z),we(J,G,Z,le)}if(typeof Z.then=="function")return Qe(J,G,jl(Z),le);if(Z.$$typeof===Q)return Qe(J,G,pl(J,Z),le);Nl(J,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,G!==null&&G.tag===6?(n(J,G.sibling),le=d(G,Z),le.return=J,J=le):(n(J,G),le=oo(Z,J.mode,le),le.return=J,J=le),p(J)):n(J,G)}return function(J,G,Z,le){try{cn=0;var je=Qe(J,G,Z,le);return hr=null,je}catch(ve){if(ve===ur||ve===vl)throw ve;var Ie=Ht(29,ve,null,J.mode);return Ie.lanes=le,Ie.return=J,Ie}finally{}}}var Os=Vu(!0),$u=Vu(!1),Xa=!1;function No(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wo(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Za(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Wa(t,a,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,($e&2)!==0){var d=i.pending;return d===null?a.next=a:(a.next=d.next,d.next=a),i.pending=a,a=ml(t),_u(t,null,n),a}return hl(t,i,a,n),ml(t)}function un(t,a,n){if(a=a.updateQueue,a!==null&&(a=a.shared,(n&4194048)!==0)){var i=a.lanes;i&=t.pendingLanes,n|=i,a.lanes=n,Od(t,n)}}function _o(t,a){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var d=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var p={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};h===null?d=h=p:h=h.next=p,n=n.next}while(n!==null);h===null?d=h=a:h=h.next=a}else d=h=a;n={baseState:i.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:i.shared,callbacks:i.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=a:t.next=a,n.lastBaseUpdate=a}var So=!1;function hn(){if(So){var t=dr;if(t!==null)throw t}}function mn(t,a,n,i){So=!1;var d=t.updateQueue;Xa=!1;var h=d.firstBaseUpdate,p=d.lastBaseUpdate,T=d.shared.pending;if(T!==null){d.shared.pending=null;var I=T,W=I.next;I.next=null,p===null?h=W:p.next=W,p=I;var ne=t.alternate;ne!==null&&(ne=ne.updateQueue,T=ne.lastBaseUpdate,T!==p&&(T===null?ne.firstBaseUpdate=W:T.next=W,ne.lastBaseUpdate=I))}if(h!==null){var ce=d.baseState;p=0,ne=W=I=null,T=h;do{var te=T.lane&-536870913,se=te!==T.lane;if(se?(Me&te)===te:(i&te)===te){te!==0&&te===cr&&(So=!0),ne!==null&&(ne=ne.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var ye=t,we=T;te=a;var Qe=n;switch(we.tag){case 1:if(ye=we.payload,typeof ye=="function"){ce=ye.call(Qe,ce,te);break e}ce=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=we.payload,te=typeof ye=="function"?ye.call(Qe,ce,te):ye,te==null)break e;ce=_({},ce,te);break e;case 2:Xa=!0}}te=T.callback,te!==null&&(t.flags|=64,se&&(t.flags|=8192),se=d.callbacks,se===null?d.callbacks=[te]:se.push(te))}else se={lane:te,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ne===null?(W=ne=se,I=ce):ne=ne.next=se,p|=te;if(T=T.next,T===null){if(T=d.shared.pending,T===null)break;se=T,T=se.next,se.next=null,d.lastBaseUpdate=se,d.shared.pending=null}}while(!0);ne===null&&(I=ce),d.baseState=I,d.firstBaseUpdate=W,d.lastBaseUpdate=ne,h===null&&(d.shared.lanes=0),rs|=p,t.lanes=p,t.memoizedState=ce}}function Pu(t,a){if(typeof t!="function")throw Error(o(191,t));t.call(a)}function Hu(t,a){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)Pu(n[t],a)}var mr=A(null),wl=A(0);function Gu(t,a){t=Ba,b(wl,t),b(mr,a),Ba=t|a.baseLanes}function Co(){b(wl,Ba),b(mr,mr.current)}function To(){Ba=wl.current,M(mr),M(wl)}var Gt=A(null),la=null;function es(t){var a=t.alternate;b(nt,nt.current&1),b(Gt,t),la===null&&(a===null||mr.current!==null||a.memoizedState!==null)&&(la=t)}function ko(t){b(nt,nt.current),b(Gt,t),la===null&&(la=t)}function qu(t){t.tag===22?(b(nt,nt.current),b(Gt,t),la===null&&(la=t)):ts()}function ts(){b(nt,nt.current),b(Gt,Gt.current)}function qt(t){M(Gt),la===t&&(la=null),M(nt)}var nt=A(0);function _l(t){for(var a=t;a!==null;){if(a.tag===13){var n=a.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Lc(n)||Uc(n)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Da=0,ke=null,qe=null,ct=null,Sl=!1,fr=!1,Rs=!1,Cl=0,fn=0,gr=null,Qg=0;function at(){throw Error(o(321))}function Eo(t,a){if(a===null)return!1;for(var n=0;n<a.length&&n<t.length;n++)if(!Pt(t[n],a[n]))return!1;return!0}function Do(t,a,n,i,d,h){return Da=h,ke=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,P.H=t===null||t.memoizedState===null?kh:qo,Rs=!1,h=n(i,d),Rs=!1,fr&&(h=Qu(a,n,i,d)),Yu(t),h}function Yu(t){P.H=pn;var a=qe!==null&&qe.next!==null;if(Da=0,ct=qe=ke=null,Sl=!1,fn=0,gr=null,a)throw Error(o(300));t===null||dt||(t=t.dependencies,t!==null&&xl(t)&&(dt=!0))}function Qu(t,a,n,i){ke=t;var d=0;do{if(fr&&(gr=null),fn=0,fr=!1,25<=d)throw Error(o(301));if(d+=1,ct=qe=null,t.updateQueue!=null){var h=t.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}P.H=Eh,h=a(n,i)}while(fr);return h}function Jg(){var t=P.H,a=t.useState()[0];return a=typeof a.then=="function"?gn(a):a,t=t.useState()[0],(qe!==null?qe.memoizedState:null)!==t&&(ke.flags|=1024),a}function Ao(){var t=Cl!==0;return Cl=0,t}function Oo(t,a,n){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~n}function Ro(t){if(Sl){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Sl=!1}Da=0,ct=qe=ke=null,fr=!1,fn=Cl=0,gr=null}function Et(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?ke.memoizedState=ct=t:ct=ct.next=t,ct}function lt(){if(qe===null){var t=ke.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var a=ct===null?ke.memoizedState:ct.next;if(a!==null)ct=a,qe=t;else{if(t===null)throw ke.alternate===null?Error(o(467)):Error(o(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},ct===null?ke.memoizedState=ct=t:ct=ct.next=t}return ct}function Tl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gn(t){var a=fn;return fn+=1,gr===null&&(gr=[]),t=zu(gr,t,a),a=ke,(ct===null?a.memoizedState:ct.next)===null&&(a=a.alternate,P.H=a===null||a.memoizedState===null?kh:qo),t}function kl(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return gn(t);if(t.$$typeof===Q)return bt(t)}throw Error(o(438,String(t)))}function Lo(t){var a=null,n=ke.updateQueue;if(n!==null&&(a=n.memoCache),a==null){var i=ke.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(a={data:i.data.map(function(d){return d.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),n===null&&(n=Tl(),ke.updateQueue=n),n.memoCache=a,n=a.data[a.index],n===void 0)for(n=a.data[a.index]=Array(t),i=0;i<t;i++)n[i]=K;return a.index++,n}function Aa(t,a){return typeof a=="function"?a(t):a}function El(t){var a=lt();return Uo(a,qe,t)}function Uo(t,a,n){var i=t.queue;if(i===null)throw Error(o(311));i.lastRenderedReducer=n;var d=t.baseQueue,h=i.pending;if(h!==null){if(d!==null){var p=d.next;d.next=h.next,h.next=p}a.baseQueue=d=h,i.pending=null}if(h=t.baseState,d===null)t.memoizedState=h;else{a=d.next;var T=p=null,I=null,W=a,ne=!1;do{var ce=W.lane&-536870913;if(ce!==W.lane?(Me&ce)===ce:(Da&ce)===ce){var te=W.revertLane;if(te===0)I!==null&&(I=I.next={lane:0,revertLane:0,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),ce===cr&&(ne=!0);else if((Da&te)===te){W=W.next,te===cr&&(ne=!0);continue}else ce={lane:0,revertLane:W.revertLane,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},I===null?(T=I=ce,p=h):I=I.next=ce,ke.lanes|=te,rs|=te;ce=W.action,Rs&&n(h,ce),h=W.hasEagerState?W.eagerState:n(h,ce)}else te={lane:ce,revertLane:W.revertLane,gesture:W.gesture,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},I===null?(T=I=te,p=h):I=I.next=te,ke.lanes|=ce,rs|=ce;W=W.next}while(W!==null&&W!==a);if(I===null?p=h:I.next=T,!Pt(h,t.memoizedState)&&(dt=!0,ne&&(n=dr,n!==null)))throw n;t.memoizedState=h,t.baseState=p,t.baseQueue=I,i.lastRenderedState=h}return d===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function Mo(t){var a=lt(),n=a.queue;if(n===null)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,d=n.pending,h=a.memoizedState;if(d!==null){n.pending=null;var p=d=d.next;do h=t(h,p.action),p=p.next;while(p!==d);Pt(h,a.memoizedState)||(dt=!0),a.memoizedState=h,a.baseQueue===null&&(a.baseState=h),n.lastRenderedState=h}return[h,i]}function Ju(t,a,n){var i=ke,d=lt(),h=Be;if(h){if(n===void 0)throw Error(o(407));n=n()}else n=a();var p=!Pt((qe||d).memoizedState,n);if(p&&(d.memoizedState=n,dt=!0),d=d.queue,Io(Xu.bind(null,i,d,t),[t]),d.getSnapshot!==a||p||ct!==null&&ct.memoizedState.tag&1){if(i.flags|=2048,xr(9,{destroy:void 0},Fu.bind(null,i,d,n,a),null),Je===null)throw Error(o(349));h||(Da&127)!==0||Ku(i,a,n)}return n}function Ku(t,a,n){t.flags|=16384,t={getSnapshot:a,value:n},a=ke.updateQueue,a===null?(a=Tl(),ke.updateQueue=a,a.stores=[t]):(n=a.stores,n===null?a.stores=[t]:n.push(t))}function Fu(t,a,n,i){a.value=n,a.getSnapshot=i,Zu(a)&&Wu(t)}function Xu(t,a,n){return n(function(){Zu(a)&&Wu(t)})}function Zu(t){var a=t.getSnapshot;t=t.value;try{var n=a();return!Pt(t,n)}catch{return!0}}function Wu(t){var a=_s(t,2);a!==null&&zt(a,t,2)}function zo(t){var a=Et();if(typeof t=="function"){var n=t;if(t=n(),Rs){Ga(!0);try{n()}finally{Ga(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:t},a}function eh(t,a,n,i){return t.baseState=n,Uo(t,qe,typeof i=="function"?i:Aa)}function Kg(t,a,n,i,d){if(Ol(t))throw Error(o(485));if(t=a.action,t!==null){var h={payload:d,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(p){h.listeners.push(p)}};P.T!==null?n(!0):h.isTransition=!1,i(h),n=a.pending,n===null?(h.next=a.pending=h,th(a,h)):(h.next=n.next,a.pending=n.next=h)}}function th(t,a){var n=a.action,i=a.payload,d=t.state;if(a.isTransition){var h=P.T,p={};P.T=p;try{var T=n(d,i),I=P.S;I!==null&&I(p,T),ah(t,a,T)}catch(W){Bo(t,a,W)}finally{h!==null&&p.types!==null&&(h.types=p.types),P.T=h}}else try{h=n(d,i),ah(t,a,h)}catch(W){Bo(t,a,W)}}function ah(t,a,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){sh(t,a,i)},function(i){return Bo(t,a,i)}):sh(t,a,n)}function sh(t,a,n){a.status="fulfilled",a.value=n,rh(a),t.state=n,a=t.pending,a!==null&&(n=a.next,n===a?t.pending=null:(n=n.next,a.next=n,th(t,n)))}function Bo(t,a,n){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do a.status="rejected",a.reason=n,rh(a),a=a.next;while(a!==i)}t.action=null}function rh(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function nh(t,a){return a}function lh(t,a){if(Be){var n=Je.formState;if(n!==null){e:{var i=ke;if(Be){if(Xe){t:{for(var d=Xe,h=na;d.nodeType!==8;){if(!h){d=null;break t}if(d=ia(d.nextSibling),d===null){d=null;break t}}h=d.data,d=h==="F!"||h==="F"?d:null}if(d){Xe=ia(d.nextSibling),i=d.data==="F!";break e}}Ka(i)}i=!1}i&&(a=n[0])}}return n=Et(),n.memoizedState=n.baseState=a,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:a},n.queue=i,n=Sh.bind(null,ke,i),i.dispatch=n,i=zo(!1),h=Go.bind(null,ke,!1,i.queue),i=Et(),d={state:a,dispatch:null,action:t,pending:null},i.queue=d,n=Kg.bind(null,ke,d,h,n),d.dispatch=n,i.memoizedState=t,[a,n,!1]}function ih(t){var a=lt();return oh(a,qe,t)}function oh(t,a,n){if(a=Uo(t,a,nh)[0],t=El(Aa)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var i=gn(a)}catch(p){throw p===ur?vl:p}else i=a;a=lt();var d=a.queue,h=d.dispatch;return n!==a.memoizedState&&(ke.flags|=2048,xr(9,{destroy:void 0},Fg.bind(null,d,n),null)),[i,h,t]}function Fg(t,a){t.action=a}function ch(t){var a=lt(),n=qe;if(n!==null)return oh(a,n,t);lt(),a=a.memoizedState,n=lt();var i=n.queue.dispatch;return n.memoizedState=t,[a,i,!1]}function xr(t,a,n,i){return t={tag:t,create:n,deps:i,inst:a,next:null},a=ke.updateQueue,a===null&&(a=Tl(),ke.updateQueue=a),n=a.lastEffect,n===null?a.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,a.lastEffect=t),t}function dh(){return lt().memoizedState}function Dl(t,a,n,i){var d=Et();ke.flags|=t,d.memoizedState=xr(1|a,{destroy:void 0},n,i===void 0?null:i)}function Al(t,a,n,i){var d=lt();i=i===void 0?null:i;var h=d.memoizedState.inst;qe!==null&&i!==null&&Eo(i,qe.memoizedState.deps)?d.memoizedState=xr(a,h,n,i):(ke.flags|=t,d.memoizedState=xr(1|a,h,n,i))}function uh(t,a){Dl(8390656,8,t,a)}function Io(t,a){Al(2048,8,t,a)}function Xg(t){ke.flags|=4;var a=ke.updateQueue;if(a===null)a=Tl(),ke.updateQueue=a,a.events=[t];else{var n=a.events;n===null?a.events=[t]:n.push(t)}}function hh(t){var a=lt().memoizedState;return Xg({ref:a,nextImpl:t}),function(){if(($e&2)!==0)throw Error(o(440));return a.impl.apply(void 0,arguments)}}function mh(t,a){return Al(4,2,t,a)}function fh(t,a){return Al(4,4,t,a)}function gh(t,a){if(typeof a=="function"){t=t();var n=a(t);return function(){typeof n=="function"?n():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function xh(t,a,n){n=n!=null?n.concat([t]):null,Al(4,4,gh.bind(null,a,t),n)}function Vo(){}function ph(t,a){var n=lt();a=a===void 0?null:a;var i=n.memoizedState;return a!==null&&Eo(a,i[1])?i[0]:(n.memoizedState=[t,a],t)}function yh(t,a){var n=lt();a=a===void 0?null:a;var i=n.memoizedState;if(a!==null&&Eo(a,i[1]))return i[0];if(i=t(),Rs){Ga(!0);try{t()}finally{Ga(!1)}}return n.memoizedState=[i,a],i}function $o(t,a,n){return n===void 0||(Da&1073741824)!==0&&(Me&261930)===0?t.memoizedState=a:(t.memoizedState=n,t=vm(),ke.lanes|=t,rs|=t,n)}function vh(t,a,n,i){return Pt(n,a)?n:mr.current!==null?(t=$o(t,n,i),Pt(t,a)||(dt=!0),t):(Da&42)===0||(Da&1073741824)!==0&&(Me&261930)===0?(dt=!0,t.memoizedState=n):(t=vm(),ke.lanes|=t,rs|=t,a)}function bh(t,a,n,i,d){var h=ae.p;ae.p=h!==0&&8>h?h:8;var p=P.T,T={};P.T=T,Go(t,!1,a,n);try{var I=d(),W=P.S;if(W!==null&&W(T,I),I!==null&&typeof I=="object"&&typeof I.then=="function"){var ne=Yg(I,i);xn(t,a,ne,Jt(t))}else xn(t,a,i,Jt(t))}catch(ce){xn(t,a,{then:function(){},status:"rejected",reason:ce},Jt())}finally{ae.p=h,p!==null&&T.types!==null&&(p.types=T.types),P.T=p}}function Zg(){}function Po(t,a,n,i){if(t.tag!==5)throw Error(o(476));var d=jh(t).queue;bh(t,d,a,ue,n===null?Zg:function(){return Nh(t),n(i)})}function jh(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:ue},next:null};var n={};return a.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:n},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function Nh(t){var a=jh(t);a.next===null&&(a=t.alternate.memoizedState),xn(t,a.next.queue,{},Jt())}function Ho(){return bt(Rn)}function wh(){return lt().memoizedState}function _h(){return lt().memoizedState}function Wg(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var n=Jt();t=Za(n);var i=Wa(a,t,n);i!==null&&(zt(i,a,n),un(i,a,n)),a={cache:yo()},t.payload=a;return}a=a.return}}function ex(t,a,n){var i=Jt();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Ol(t)?Ch(a,n):(n=lo(t,a,n,i),n!==null&&(zt(n,t,i),Th(n,a,i)))}function Sh(t,a,n){var i=Jt();xn(t,a,n,i)}function xn(t,a,n,i){var d={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ol(t))Ch(a,d);else{var h=t.alternate;if(t.lanes===0&&(h===null||h.lanes===0)&&(h=a.lastRenderedReducer,h!==null))try{var p=a.lastRenderedState,T=h(p,n);if(d.hasEagerState=!0,d.eagerState=T,Pt(T,p))return hl(t,a,d,0),Je===null&&ul(),!1}catch{}finally{}if(n=lo(t,a,d,i),n!==null)return zt(n,t,i),Th(n,a,i),!0}return!1}function Go(t,a,n,i){if(i={lane:2,revertLane:Nc(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Ol(t)){if(a)throw Error(o(479))}else a=lo(t,n,i,2),a!==null&&zt(a,t,2)}function Ol(t){var a=t.alternate;return t===ke||a!==null&&a===ke}function Ch(t,a){fr=Sl=!0;var n=t.pending;n===null?a.next=a:(a.next=n.next,n.next=a),t.pending=a}function Th(t,a,n){if((n&4194048)!==0){var i=a.lanes;i&=t.pendingLanes,n|=i,a.lanes=n,Od(t,n)}}var pn={readContext:bt,use:kl,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useLayoutEffect:at,useInsertionEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useSyncExternalStore:at,useId:at,useHostTransitionStatus:at,useFormState:at,useActionState:at,useOptimistic:at,useMemoCache:at,useCacheRefresh:at};pn.useEffectEvent=at;var kh={readContext:bt,use:kl,useCallback:function(t,a){return Et().memoizedState=[t,a===void 0?null:a],t},useContext:bt,useEffect:uh,useImperativeHandle:function(t,a,n){n=n!=null?n.concat([t]):null,Dl(4194308,4,gh.bind(null,a,t),n)},useLayoutEffect:function(t,a){return Dl(4194308,4,t,a)},useInsertionEffect:function(t,a){Dl(4,2,t,a)},useMemo:function(t,a){var n=Et();a=a===void 0?null:a;var i=t();if(Rs){Ga(!0);try{t()}finally{Ga(!1)}}return n.memoizedState=[i,a],i},useReducer:function(t,a,n){var i=Et();if(n!==void 0){var d=n(a);if(Rs){Ga(!0);try{n(a)}finally{Ga(!1)}}}else d=a;return i.memoizedState=i.baseState=d,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:d},i.queue=t,t=t.dispatch=ex.bind(null,ke,t),[i.memoizedState,t]},useRef:function(t){var a=Et();return t={current:t},a.memoizedState=t},useState:function(t){t=zo(t);var a=t.queue,n=Sh.bind(null,ke,a);return a.dispatch=n,[t.memoizedState,n]},useDebugValue:Vo,useDeferredValue:function(t,a){var n=Et();return $o(n,t,a)},useTransition:function(){var t=zo(!1);return t=bh.bind(null,ke,t.queue,!0,!1),Et().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,n){var i=ke,d=Et();if(Be){if(n===void 0)throw Error(o(407));n=n()}else{if(n=a(),Je===null)throw Error(o(349));(Me&127)!==0||Ku(i,a,n)}d.memoizedState=n;var h={value:n,getSnapshot:a};return d.queue=h,uh(Xu.bind(null,i,h,t),[t]),i.flags|=2048,xr(9,{destroy:void 0},Fu.bind(null,i,h,n,a),null),n},useId:function(){var t=Et(),a=Je.identifierPrefix;if(Be){var n=ya,i=pa;n=(i&~(1<<32-$t(i)-1)).toString(32)+n,a="_"+a+"R_"+n,n=Cl++,0<n&&(a+="H"+n.toString(32)),a+="_"}else n=Qg++,a="_"+a+"r_"+n.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:Ho,useFormState:lh,useActionState:lh,useOptimistic:function(t){var a=Et();a.memoizedState=a.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=n,a=Go.bind(null,ke,!0,n),n.dispatch=a,[t,a]},useMemoCache:Lo,useCacheRefresh:function(){return Et().memoizedState=Wg.bind(null,ke)},useEffectEvent:function(t){var a=Et(),n={impl:t};return a.memoizedState=n,function(){if(($e&2)!==0)throw Error(o(440));return n.impl.apply(void 0,arguments)}}},qo={readContext:bt,use:kl,useCallback:ph,useContext:bt,useEffect:Io,useImperativeHandle:xh,useInsertionEffect:mh,useLayoutEffect:fh,useMemo:yh,useReducer:El,useRef:dh,useState:function(){return El(Aa)},useDebugValue:Vo,useDeferredValue:function(t,a){var n=lt();return vh(n,qe.memoizedState,t,a)},useTransition:function(){var t=El(Aa)[0],a=lt().memoizedState;return[typeof t=="boolean"?t:gn(t),a]},useSyncExternalStore:Ju,useId:wh,useHostTransitionStatus:Ho,useFormState:ih,useActionState:ih,useOptimistic:function(t,a){var n=lt();return eh(n,qe,t,a)},useMemoCache:Lo,useCacheRefresh:_h};qo.useEffectEvent=hh;var Eh={readContext:bt,use:kl,useCallback:ph,useContext:bt,useEffect:Io,useImperativeHandle:xh,useInsertionEffect:mh,useLayoutEffect:fh,useMemo:yh,useReducer:Mo,useRef:dh,useState:function(){return Mo(Aa)},useDebugValue:Vo,useDeferredValue:function(t,a){var n=lt();return qe===null?$o(n,t,a):vh(n,qe.memoizedState,t,a)},useTransition:function(){var t=Mo(Aa)[0],a=lt().memoizedState;return[typeof t=="boolean"?t:gn(t),a]},useSyncExternalStore:Ju,useId:wh,useHostTransitionStatus:Ho,useFormState:ch,useActionState:ch,useOptimistic:function(t,a){var n=lt();return qe!==null?eh(n,qe,t,a):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:Lo,useCacheRefresh:_h};Eh.useEffectEvent=hh;function Yo(t,a,n,i){a=t.memoizedState,n=n(i,a),n=n==null?a:_({},a,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qo={enqueueSetState:function(t,a,n){t=t._reactInternals;var i=Jt(),d=Za(i);d.payload=a,n!=null&&(d.callback=n),a=Wa(t,d,i),a!==null&&(zt(a,t,i),un(a,t,i))},enqueueReplaceState:function(t,a,n){t=t._reactInternals;var i=Jt(),d=Za(i);d.tag=1,d.payload=a,n!=null&&(d.callback=n),a=Wa(t,d,i),a!==null&&(zt(a,t,i),un(a,t,i))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var n=Jt(),i=Za(n);i.tag=2,a!=null&&(i.callback=a),a=Wa(t,i,n),a!==null&&(zt(a,t,n),un(a,t,n))}};function Dh(t,a,n,i,d,h,p){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,h,p):a.prototype&&a.prototype.isPureReactComponent?!an(n,i)||!an(d,h):!0}function Ah(t,a,n,i){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(n,i),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(n,i),a.state!==t&&Qo.enqueueReplaceState(a,a.state,null)}function Ls(t,a){var n=a;if("ref"in a){n={};for(var i in a)i!=="ref"&&(n[i]=a[i])}if(t=t.defaultProps){n===a&&(n=_({},n));for(var d in t)n[d]===void 0&&(n[d]=t[d])}return n}function Oh(t){dl(t)}function Rh(t){console.error(t)}function Lh(t){dl(t)}function Rl(t,a){try{var n=t.onUncaughtError;n(a.value,{componentStack:a.stack})}catch(i){setTimeout(function(){throw i})}}function Uh(t,a,n){try{var i=t.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Jo(t,a,n){return n=Za(n),n.tag=3,n.payload={element:null},n.callback=function(){Rl(t,a)},n}function Mh(t){return t=Za(t),t.tag=3,t}function zh(t,a,n,i){var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var h=i.value;t.payload=function(){return d(h)},t.callback=function(){Uh(a,n,i)}}var p=n.stateNode;p!==null&&typeof p.componentDidCatch=="function"&&(t.callback=function(){Uh(a,n,i),typeof d!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var T=i.stack;this.componentDidCatch(i.value,{componentStack:T!==null?T:""})})}function tx(t,a,n,i,d){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(a=n.alternate,a!==null&&or(a,n,d,!0),n=Gt.current,n!==null){switch(n.tag){case 31:case 13:return la===null?ql():n.alternate===null&&st===0&&(st=3),n.flags&=-257,n.flags|=65536,n.lanes=d,i===bl?n.flags|=16384:(a=n.updateQueue,a===null?n.updateQueue=new Set([i]):a.add(i),vc(t,i,d)),!1;case 22:return n.flags|=65536,i===bl?n.flags|=16384:(a=n.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=a):(n=a.retryQueue,n===null?a.retryQueue=new Set([i]):n.add(i)),vc(t,i,d)),!1}throw Error(o(435,n.tag))}return vc(t,i,d),ql(),!1}if(Be)return a=Gt.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=d,i!==mo&&(t=Error(o(422),{cause:i}),nn(aa(t,n)))):(i!==mo&&(a=Error(o(423),{cause:i}),nn(aa(a,n))),t=t.current.alternate,t.flags|=65536,d&=-d,t.lanes|=d,i=aa(i,n),d=Jo(t.stateNode,i,d),_o(t,d),st!==4&&(st=2)),!1;var h=Error(o(520),{cause:i});if(h=aa(h,n),Sn===null?Sn=[h]:Sn.push(h),st!==4&&(st=2),a===null)return!0;i=aa(i,n),n=a;do{switch(n.tag){case 3:return n.flags|=65536,t=d&-d,n.lanes|=t,t=Jo(n.stateNode,i,t),_o(n,t),!1;case 1:if(a=n.type,h=n.stateNode,(n.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(ns===null||!ns.has(h))))return n.flags|=65536,d&=-d,n.lanes|=d,d=Mh(d),zh(d,t,n,i),_o(n,d),!1}n=n.return}while(n!==null);return!1}var Ko=Error(o(461)),dt=!1;function jt(t,a,n,i){a.child=t===null?$u(a,null,n,i):Os(a,t.child,n,i)}function Bh(t,a,n,i,d){n=n.render;var h=a.ref;if("ref"in i){var p={};for(var T in i)T!=="ref"&&(p[T]=i[T])}else p=i;return ks(a),i=Do(t,a,n,p,h,d),T=Ao(),t!==null&&!dt?(Oo(t,a,d),Oa(t,a,d)):(Be&&T&&uo(a),a.flags|=1,jt(t,a,i,d),a.child)}function Ih(t,a,n,i,d){if(t===null){var h=n.type;return typeof h=="function"&&!io(h)&&h.defaultProps===void 0&&n.compare===null?(a.tag=15,a.type=h,Vh(t,a,h,i,d)):(t=fl(n.type,null,i,a,a.mode,d),t.ref=a.ref,t.return=a,a.child=t)}if(h=t.child,!sc(t,d)){var p=h.memoizedProps;if(n=n.compare,n=n!==null?n:an,n(p,i)&&t.ref===a.ref)return Oa(t,a,d)}return a.flags|=1,t=Ca(h,i),t.ref=a.ref,t.return=a,a.child=t}function Vh(t,a,n,i,d){if(t!==null){var h=t.memoizedProps;if(an(h,i)&&t.ref===a.ref)if(dt=!1,a.pendingProps=i=h,sc(t,d))(t.flags&131072)!==0&&(dt=!0);else return a.lanes=t.lanes,Oa(t,a,d)}return Fo(t,a,n,i,d)}function $h(t,a,n,i){var d=i.children,h=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((a.flags&128)!==0){if(h=h!==null?h.baseLanes|n:n,t!==null){for(i=a.child=t.child,d=0;i!==null;)d=d|i.lanes|i.childLanes,i=i.sibling;i=d&~h}else i=0,a.child=null;return Ph(t,a,h,n,i)}if((n&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&yl(a,h!==null?h.cachePool:null),h!==null?Gu(a,h):Co(),qu(a);else return i=a.lanes=536870912,Ph(t,a,h!==null?h.baseLanes|n:n,n,i)}else h!==null?(yl(a,h.cachePool),Gu(a,h),ts(),a.memoizedState=null):(t!==null&&yl(a,null),Co(),ts());return jt(t,a,d,n),a.child}function yn(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Ph(t,a,n,i,d){var h=bo();return h=h===null?null:{parent:ot._currentValue,pool:h},a.memoizedState={baseLanes:n,cachePool:h},t!==null&&yl(a,null),Co(),qu(a),t!==null&&or(t,a,i,!0),a.childLanes=d,null}function Ll(t,a){return a=Ml({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function Hh(t,a,n){return Os(a,t.child,null,n),t=Ll(a,a.pendingProps),t.flags|=2,qt(a),a.memoizedState=null,t}function ax(t,a,n){var i=a.pendingProps,d=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(Be){if(i.mode==="hidden")return t=Ll(a,i),a.lanes=536870912,yn(null,t);if(ko(a),(t=Xe)?(t=t0(t,na),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Qa!==null?{id:pa,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},n=Cu(t),n.return=a,a.child=n,vt=a,Xe=null)):t=null,t===null)throw Ka(a);return a.lanes=536870912,null}return Ll(a,i)}var h=t.memoizedState;if(h!==null){var p=h.dehydrated;if(ko(a),d)if(a.flags&256)a.flags&=-257,a=Hh(t,a,n);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(o(558));else if(dt||or(t,a,n,!1),d=(n&t.childLanes)!==0,dt||d){if(i=Je,i!==null&&(p=Rd(i,n),p!==0&&p!==h.retryLane))throw h.retryLane=p,_s(t,p),zt(i,t,p),Ko;ql(),a=Hh(t,a,n)}else t=h.treeContext,Xe=ia(p.nextSibling),vt=a,Be=!0,Ja=null,na=!1,t!==null&&Eu(a,t),a=Ll(a,i),a.flags|=4096;return a}return t=Ca(t.child,{mode:i.mode,children:i.children}),t.ref=a.ref,a.child=t,t.return=a,t}function Ul(t,a){var n=a.ref;if(n===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(o(284));(t===null||t.ref!==n)&&(a.flags|=4194816)}}function Fo(t,a,n,i,d){return ks(a),n=Do(t,a,n,i,void 0,d),i=Ao(),t!==null&&!dt?(Oo(t,a,d),Oa(t,a,d)):(Be&&i&&uo(a),a.flags|=1,jt(t,a,n,d),a.child)}function Gh(t,a,n,i,d,h){return ks(a),a.updateQueue=null,n=Qu(a,i,n,d),Yu(t),i=Ao(),t!==null&&!dt?(Oo(t,a,h),Oa(t,a,h)):(Be&&i&&uo(a),a.flags|=1,jt(t,a,n,h),a.child)}function qh(t,a,n,i,d){if(ks(a),a.stateNode===null){var h=rr,p=n.contextType;typeof p=="object"&&p!==null&&(h=bt(p)),h=new n(i,h),a.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Qo,a.stateNode=h,h._reactInternals=a,h=a.stateNode,h.props=i,h.state=a.memoizedState,h.refs={},No(a),p=n.contextType,h.context=typeof p=="object"&&p!==null?bt(p):rr,h.state=a.memoizedState,p=n.getDerivedStateFromProps,typeof p=="function"&&(Yo(a,n,p,i),h.state=a.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(p=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),p!==h.state&&Qo.enqueueReplaceState(h,h.state,null),mn(a,i,h,d),hn(),h.state=a.memoizedState),typeof h.componentDidMount=="function"&&(a.flags|=4194308),i=!0}else if(t===null){h=a.stateNode;var T=a.memoizedProps,I=Ls(n,T);h.props=I;var W=h.context,ne=n.contextType;p=rr,typeof ne=="object"&&ne!==null&&(p=bt(ne));var ce=n.getDerivedStateFromProps;ne=typeof ce=="function"||typeof h.getSnapshotBeforeUpdate=="function",T=a.pendingProps!==T,ne||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(T||W!==p)&&Ah(a,h,i,p),Xa=!1;var te=a.memoizedState;h.state=te,mn(a,i,h,d),hn(),W=a.memoizedState,T||te!==W||Xa?(typeof ce=="function"&&(Yo(a,n,ce,i),W=a.memoizedState),(I=Xa||Dh(a,n,I,i,te,W,p))?(ne||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(a.flags|=4194308)):(typeof h.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=i,a.memoizedState=W),h.props=i,h.state=W,h.context=p,i=I):(typeof h.componentDidMount=="function"&&(a.flags|=4194308),i=!1)}else{h=a.stateNode,wo(t,a),p=a.memoizedProps,ne=Ls(n,p),h.props=ne,ce=a.pendingProps,te=h.context,W=n.contextType,I=rr,typeof W=="object"&&W!==null&&(I=bt(W)),T=n.getDerivedStateFromProps,(W=typeof T=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(p!==ce||te!==I)&&Ah(a,h,i,I),Xa=!1,te=a.memoizedState,h.state=te,mn(a,i,h,d),hn();var se=a.memoizedState;p!==ce||te!==se||Xa||t!==null&&t.dependencies!==null&&xl(t.dependencies)?(typeof T=="function"&&(Yo(a,n,T,i),se=a.memoizedState),(ne=Xa||Dh(a,n,ne,i,te,se,I)||t!==null&&t.dependencies!==null&&xl(t.dependencies))?(W||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,se,I),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,se,I)),typeof h.componentDidUpdate=="function"&&(a.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof h.componentDidUpdate!="function"||p===t.memoizedProps&&te===t.memoizedState||(a.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||p===t.memoizedProps&&te===t.memoizedState||(a.flags|=1024),a.memoizedProps=i,a.memoizedState=se),h.props=i,h.state=se,h.context=I,i=ne):(typeof h.componentDidUpdate!="function"||p===t.memoizedProps&&te===t.memoizedState||(a.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||p===t.memoizedProps&&te===t.memoizedState||(a.flags|=1024),i=!1)}return h=i,Ul(t,a),i=(a.flags&128)!==0,h||i?(h=a.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:h.render(),a.flags|=1,t!==null&&i?(a.child=Os(a,t.child,null,d),a.child=Os(a,null,n,d)):jt(t,a,n,d),a.memoizedState=h.state,t=a.child):t=Oa(t,a,d),t}function Yh(t,a,n,i){return Cs(),a.flags|=256,jt(t,a,n,i),a.child}var Xo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zo(t){return{baseLanes:t,cachePool:Uu()}}function Wo(t,a,n){return t=t!==null?t.childLanes&~n:0,a&&(t|=Qt),t}function Qh(t,a,n){var i=a.pendingProps,d=!1,h=(a.flags&128)!==0,p;if((p=h)||(p=t!==null&&t.memoizedState===null?!1:(nt.current&2)!==0),p&&(d=!0,a.flags&=-129),p=(a.flags&32)!==0,a.flags&=-33,t===null){if(Be){if(d?es(a):ts(),(t=Xe)?(t=t0(t,na),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Qa!==null?{id:pa,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},n=Cu(t),n.return=a,a.child=n,vt=a,Xe=null)):t=null,t===null)throw Ka(a);return Uc(t)?a.lanes=32:a.lanes=536870912,null}var T=i.children;return i=i.fallback,d?(ts(),d=a.mode,T=Ml({mode:"hidden",children:T},d),i=Ss(i,d,n,null),T.return=a,i.return=a,T.sibling=i,a.child=T,i=a.child,i.memoizedState=Zo(n),i.childLanes=Wo(t,p,n),a.memoizedState=Xo,yn(null,i)):(es(a),ec(a,T))}var I=t.memoizedState;if(I!==null&&(T=I.dehydrated,T!==null)){if(h)a.flags&256?(es(a),a.flags&=-257,a=tc(t,a,n)):a.memoizedState!==null?(ts(),a.child=t.child,a.flags|=128,a=null):(ts(),T=i.fallback,d=a.mode,i=Ml({mode:"visible",children:i.children},d),T=Ss(T,d,n,null),T.flags|=2,i.return=a,T.return=a,i.sibling=T,a.child=i,Os(a,t.child,null,n),i=a.child,i.memoizedState=Zo(n),i.childLanes=Wo(t,p,n),a.memoizedState=Xo,a=yn(null,i));else if(es(a),Uc(T)){if(p=T.nextSibling&&T.nextSibling.dataset,p)var W=p.dgst;p=W,i=Error(o(419)),i.stack="",i.digest=p,nn({value:i,source:null,stack:null}),a=tc(t,a,n)}else if(dt||or(t,a,n,!1),p=(n&t.childLanes)!==0,dt||p){if(p=Je,p!==null&&(i=Rd(p,n),i!==0&&i!==I.retryLane))throw I.retryLane=i,_s(t,i),zt(p,t,i),Ko;Lc(T)||ql(),a=tc(t,a,n)}else Lc(T)?(a.flags|=192,a.child=t.child,a=null):(t=I.treeContext,Xe=ia(T.nextSibling),vt=a,Be=!0,Ja=null,na=!1,t!==null&&Eu(a,t),a=ec(a,i.children),a.flags|=4096);return a}return d?(ts(),T=i.fallback,d=a.mode,I=t.child,W=I.sibling,i=Ca(I,{mode:"hidden",children:i.children}),i.subtreeFlags=I.subtreeFlags&65011712,W!==null?T=Ca(W,T):(T=Ss(T,d,n,null),T.flags|=2),T.return=a,i.return=a,i.sibling=T,a.child=i,yn(null,i),i=a.child,T=t.child.memoizedState,T===null?T=Zo(n):(d=T.cachePool,d!==null?(I=ot._currentValue,d=d.parent!==I?{parent:I,pool:I}:d):d=Uu(),T={baseLanes:T.baseLanes|n,cachePool:d}),i.memoizedState=T,i.childLanes=Wo(t,p,n),a.memoizedState=Xo,yn(t.child,i)):(es(a),n=t.child,t=n.sibling,n=Ca(n,{mode:"visible",children:i.children}),n.return=a,n.sibling=null,t!==null&&(p=a.deletions,p===null?(a.deletions=[t],a.flags|=16):p.push(t)),a.child=n,a.memoizedState=null,n)}function ec(t,a){return a=Ml({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function Ml(t,a){return t=Ht(22,t,null,a),t.lanes=0,t}function tc(t,a,n){return Os(a,t.child,null,n),t=ec(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Jh(t,a,n){t.lanes|=a;var i=t.alternate;i!==null&&(i.lanes|=a),xo(t.return,a,n)}function ac(t,a,n,i,d,h){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:d,treeForkCount:h}:(p.isBackwards=a,p.rendering=null,p.renderingStartTime=0,p.last=i,p.tail=n,p.tailMode=d,p.treeForkCount=h)}function Kh(t,a,n){var i=a.pendingProps,d=i.revealOrder,h=i.tail;i=i.children;var p=nt.current,T=(p&2)!==0;if(T?(p=p&1|2,a.flags|=128):p&=1,b(nt,p),jt(t,a,i,n),i=Be?rn:0,!T&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Jh(t,n,a);else if(t.tag===19)Jh(t,n,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(d){case"forwards":for(n=a.child,d=null;n!==null;)t=n.alternate,t!==null&&_l(t)===null&&(d=n),n=n.sibling;n=d,n===null?(d=a.child,a.child=null):(d=n.sibling,n.sibling=null),ac(a,!1,d,n,h,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,d=a.child,a.child=null;d!==null;){if(t=d.alternate,t!==null&&_l(t)===null){a.child=d;break}t=d.sibling,d.sibling=n,n=d,d=t}ac(a,!0,n,null,h,i);break;case"together":ac(a,!1,null,null,void 0,i);break;default:a.memoizedState=null}return a.child}function Oa(t,a,n){if(t!==null&&(a.dependencies=t.dependencies),rs|=a.lanes,(n&a.childLanes)===0)if(t!==null){if(or(t,a,n,!1),(n&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(o(153));if(a.child!==null){for(t=a.child,n=Ca(t,t.pendingProps),a.child=n,n.return=a;t.sibling!==null;)t=t.sibling,n=n.sibling=Ca(t,t.pendingProps),n.return=a;n.sibling=null}return a.child}function sc(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&xl(t)))}function sx(t,a,n){switch(a.tag){case 3:Ce(a,a.stateNode.containerInfo),Fa(a,ot,t.memoizedState.cache),Cs();break;case 27:case 5:Pe(a);break;case 4:Ce(a,a.stateNode.containerInfo);break;case 10:Fa(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,ko(a),null;break;case 13:var i=a.memoizedState;if(i!==null)return i.dehydrated!==null?(es(a),a.flags|=128,null):(n&a.child.childLanes)!==0?Qh(t,a,n):(es(a),t=Oa(t,a,n),t!==null?t.sibling:null);es(a);break;case 19:var d=(t.flags&128)!==0;if(i=(n&a.childLanes)!==0,i||(or(t,a,n,!1),i=(n&a.childLanes)!==0),d){if(i)return Kh(t,a,n);a.flags|=128}if(d=a.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),b(nt,nt.current),i)break;return null;case 22:return a.lanes=0,$h(t,a,n,a.pendingProps);case 24:Fa(a,ot,t.memoizedState.cache)}return Oa(t,a,n)}function Fh(t,a,n){if(t!==null)if(t.memoizedProps!==a.pendingProps)dt=!0;else{if(!sc(t,n)&&(a.flags&128)===0)return dt=!1,sx(t,a,n);dt=(t.flags&131072)!==0}else dt=!1,Be&&(a.flags&1048576)!==0&&ku(a,rn,a.index);switch(a.lanes=0,a.tag){case 16:e:{var i=a.pendingProps;if(t=Ds(a.elementType),a.type=t,typeof t=="function")io(t)?(i=Ls(t,i),a.tag=1,a=qh(null,a,t,i,n)):(a.tag=0,a=Fo(null,a,t,i,n));else{if(t!=null){var d=t.$$typeof;if(d===C){a.tag=11,a=Bh(null,a,t,i,n);break e}else if(d===R){a.tag=14,a=Ih(null,a,t,i,n);break e}}throw a=F(t)||t,Error(o(306,a,""))}}return a;case 0:return Fo(t,a,a.type,a.pendingProps,n);case 1:return i=a.type,d=Ls(i,a.pendingProps),qh(t,a,i,d,n);case 3:e:{if(Ce(a,a.stateNode.containerInfo),t===null)throw Error(o(387));i=a.pendingProps;var h=a.memoizedState;d=h.element,wo(t,a),mn(a,i,null,n);var p=a.memoizedState;if(i=p.cache,Fa(a,ot,i),i!==h.cache&&po(a,[ot],n,!0),hn(),i=p.element,h.isDehydrated)if(h={element:i,isDehydrated:!1,cache:p.cache},a.updateQueue.baseState=h,a.memoizedState=h,a.flags&256){a=Yh(t,a,i,n);break e}else if(i!==d){d=aa(Error(o(424)),a),nn(d),a=Yh(t,a,i,n);break e}else{switch(t=a.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Xe=ia(t.firstChild),vt=a,Be=!0,Ja=null,na=!0,n=$u(a,null,i,n),a.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Cs(),i===d){a=Oa(t,a,n);break e}jt(t,a,i,n)}a=a.child}return a;case 26:return Ul(t,a),t===null?(n=i0(a.type,null,a.pendingProps,null))?a.memoizedState=n:Be||(n=a.type,t=a.pendingProps,i=Zl(oe.current).createElement(n),i[yt]=a,i[At]=t,Nt(i,n,t),xt(i),a.stateNode=i):a.memoizedState=i0(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return Pe(a),t===null&&Be&&(i=a.stateNode=r0(a.type,a.pendingProps,oe.current),vt=a,na=!0,d=Xe,cs(a.type)?(Mc=d,Xe=ia(i.firstChild)):Xe=d),jt(t,a,a.pendingProps.children,n),Ul(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&Be&&((d=i=Xe)&&(i=Rx(i,a.type,a.pendingProps,na),i!==null?(a.stateNode=i,vt=a,Xe=ia(i.firstChild),na=!1,d=!0):d=!1),d||Ka(a)),Pe(a),d=a.type,h=a.pendingProps,p=t!==null?t.memoizedProps:null,i=h.children,Ac(d,h)?i=null:p!==null&&Ac(d,p)&&(a.flags|=32),a.memoizedState!==null&&(d=Do(t,a,Jg,null,null,n),Rn._currentValue=d),Ul(t,a),jt(t,a,i,n),a.child;case 6:return t===null&&Be&&((t=n=Xe)&&(n=Lx(n,a.pendingProps,na),n!==null?(a.stateNode=n,vt=a,Xe=null,t=!0):t=!1),t||Ka(a)),null;case 13:return Qh(t,a,n);case 4:return Ce(a,a.stateNode.containerInfo),i=a.pendingProps,t===null?a.child=Os(a,null,i,n):jt(t,a,i,n),a.child;case 11:return Bh(t,a,a.type,a.pendingProps,n);case 7:return jt(t,a,a.pendingProps,n),a.child;case 8:return jt(t,a,a.pendingProps.children,n),a.child;case 12:return jt(t,a,a.pendingProps.children,n),a.child;case 10:return i=a.pendingProps,Fa(a,a.type,i.value),jt(t,a,i.children,n),a.child;case 9:return d=a.type._context,i=a.pendingProps.children,ks(a),d=bt(d),i=i(d),a.flags|=1,jt(t,a,i,n),a.child;case 14:return Ih(t,a,a.type,a.pendingProps,n);case 15:return Vh(t,a,a.type,a.pendingProps,n);case 19:return Kh(t,a,n);case 31:return ax(t,a,n);case 22:return $h(t,a,n,a.pendingProps);case 24:return ks(a),i=bt(ot),t===null?(d=bo(),d===null&&(d=Je,h=yo(),d.pooledCache=h,h.refCount++,h!==null&&(d.pooledCacheLanes|=n),d=h),a.memoizedState={parent:i,cache:d},No(a),Fa(a,ot,d)):((t.lanes&n)!==0&&(wo(t,a),mn(a,null,null,n),hn()),d=t.memoizedState,h=a.memoizedState,d.parent!==i?(d={parent:i,cache:i},a.memoizedState=d,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=d),Fa(a,ot,i)):(i=h.cache,Fa(a,ot,i),i!==d.cache&&po(a,[ot],n,!0))),jt(t,a,a.pendingProps.children,n),a.child;case 29:throw a.pendingProps}throw Error(o(156,a.tag))}function Ra(t){t.flags|=4}function rc(t,a,n,i,d){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(d&335544128)===d)if(t.stateNode.complete)t.flags|=8192;else if(wm())t.flags|=8192;else throw As=bl,jo}else t.flags&=-16777217}function Xh(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!h0(a))if(wm())t.flags|=8192;else throw As=bl,jo}function zl(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?Dd():536870912,t.lanes|=a,br|=a)}function vn(t,a){if(!Be)switch(t.tailMode){case"hidden":a=t.tail;for(var n=null;a!==null;)a.alternate!==null&&(n=a),a=a.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ze(t){var a=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(a)for(var d=t.child;d!==null;)n|=d.lanes|d.childLanes,i|=d.subtreeFlags&65011712,i|=d.flags&65011712,d.return=t,d=d.sibling;else for(d=t.child;d!==null;)n|=d.lanes|d.childLanes,i|=d.subtreeFlags,i|=d.flags,d.return=t,d=d.sibling;return t.subtreeFlags|=i,t.childLanes=n,a}function rx(t,a,n){var i=a.pendingProps;switch(ho(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(a),null;case 1:return Ze(a),null;case 3:return n=a.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),Ea(ot),Ne(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(ir(a)?Ra(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,fo())),Ze(a),null;case 26:var d=a.type,h=a.memoizedState;return t===null?(Ra(a),h!==null?(Ze(a),Xh(a,h)):(Ze(a),rc(a,d,null,i,n))):h?h!==t.memoizedState?(Ra(a),Ze(a),Xh(a,h)):(Ze(a),a.flags&=-16777217):(t=t.memoizedProps,t!==i&&Ra(a),Ze(a),rc(a,d,t,i,n)),null;case 27:if(Tt(a),n=oe.current,d=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==i&&Ra(a);else{if(!i){if(a.stateNode===null)throw Error(o(166));return Ze(a),null}t=B.current,ir(a)?Du(a):(t=r0(d,i,n),a.stateNode=t,Ra(a))}return Ze(a),null;case 5:if(Tt(a),d=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==i&&Ra(a);else{if(!i){if(a.stateNode===null)throw Error(o(166));return Ze(a),null}if(h=B.current,ir(a))Du(a);else{var p=Zl(oe.current);switch(h){case 1:h=p.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:h=p.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":h=p.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":h=p.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":h=p.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof i.is=="string"?p.createElement("select",{is:i.is}):p.createElement("select"),i.multiple?h.multiple=!0:i.size&&(h.size=i.size);break;default:h=typeof i.is=="string"?p.createElement(d,{is:i.is}):p.createElement(d)}}h[yt]=a,h[At]=i;e:for(p=a.child;p!==null;){if(p.tag===5||p.tag===6)h.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===a)break e;for(;p.sibling===null;){if(p.return===null||p.return===a)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}a.stateNode=h;e:switch(Nt(h,d,i),d){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ra(a)}}return Ze(a),rc(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,n),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==i&&Ra(a);else{if(typeof i!="string"&&a.stateNode===null)throw Error(o(166));if(t=oe.current,ir(a)){if(t=a.stateNode,n=a.memoizedProps,i=null,d=vt,d!==null)switch(d.tag){case 27:case 5:i=d.memoizedProps}t[yt]=a,t=!!(t.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Qm(t.nodeValue,n)),t||Ka(a,!0)}else t=Zl(t).createTextNode(i),t[yt]=a,a.stateNode=t}return Ze(a),null;case 31:if(n=a.memoizedState,t===null||t.memoizedState!==null){if(i=ir(a),n!==null){if(t===null){if(!i)throw Error(o(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(557));t[yt]=a}else Cs(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ze(a),t=!1}else n=fo(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),t=!0;if(!t)return a.flags&256?(qt(a),a):(qt(a),null);if((a.flags&128)!==0)throw Error(o(558))}return Ze(a),null;case 13:if(i=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(d=ir(a),i!==null&&i.dehydrated!==null){if(t===null){if(!d)throw Error(o(318));if(d=a.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(o(317));d[yt]=a}else Cs(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ze(a),d=!1}else d=fo(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=d),d=!0;if(!d)return a.flags&256?(qt(a),a):(qt(a),null)}return qt(a),(a.flags&128)!==0?(a.lanes=n,a):(n=i!==null,t=t!==null&&t.memoizedState!==null,n&&(i=a.child,d=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(d=i.alternate.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==d&&(i.flags|=2048)),n!==t&&n&&(a.child.flags|=8192),zl(a,a.updateQueue),Ze(a),null);case 4:return Ne(),t===null&&Cc(a.stateNode.containerInfo),Ze(a),null;case 10:return Ea(a.type),Ze(a),null;case 19:if(M(nt),i=a.memoizedState,i===null)return Ze(a),null;if(d=(a.flags&128)!==0,h=i.rendering,h===null)if(d)vn(i,!1);else{if(st!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(h=_l(t),h!==null){for(a.flags|=128,vn(i,!1),t=h.updateQueue,a.updateQueue=t,zl(a,t),a.subtreeFlags=0,t=n,n=a.child;n!==null;)Su(n,t),n=n.sibling;return b(nt,nt.current&1|2),Be&&Ta(a,i.treeForkCount),a.child}t=t.sibling}i.tail!==null&&It()>Pl&&(a.flags|=128,d=!0,vn(i,!1),a.lanes=4194304)}else{if(!d)if(t=_l(h),t!==null){if(a.flags|=128,d=!0,t=t.updateQueue,a.updateQueue=t,zl(a,t),vn(i,!0),i.tail===null&&i.tailMode==="hidden"&&!h.alternate&&!Be)return Ze(a),null}else 2*It()-i.renderingStartTime>Pl&&n!==536870912&&(a.flags|=128,d=!0,vn(i,!1),a.lanes=4194304);i.isBackwards?(h.sibling=a.child,a.child=h):(t=i.last,t!==null?t.sibling=h:a.child=h,i.last=h)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=It(),t.sibling=null,n=nt.current,b(nt,d?n&1|2:n&1),Be&&Ta(a,i.treeForkCount),t):(Ze(a),null);case 22:case 23:return qt(a),To(),i=a.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(a.flags|=8192):i&&(a.flags|=8192),i?(n&536870912)!==0&&(a.flags&128)===0&&(Ze(a),a.subtreeFlags&6&&(a.flags|=8192)):Ze(a),n=a.updateQueue,n!==null&&zl(a,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==n&&(a.flags|=2048),t!==null&&M(Es),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),a.memoizedState.cache!==n&&(a.flags|=2048),Ea(ot),Ze(a),null;case 25:return null;case 30:return null}throw Error(o(156,a.tag))}function nx(t,a){switch(ho(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Ea(ot),Ne(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return Tt(a),null;case 31:if(a.memoizedState!==null){if(qt(a),a.alternate===null)throw Error(o(340));Cs()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(qt(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(o(340));Cs()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return M(nt),null;case 4:return Ne(),null;case 10:return Ea(a.type),null;case 22:case 23:return qt(a),To(),t!==null&&M(Es),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Ea(ot),null;case 25:return null;default:return null}}function Zh(t,a){switch(ho(a),a.tag){case 3:Ea(ot),Ne();break;case 26:case 27:case 5:Tt(a);break;case 4:Ne();break;case 31:a.memoizedState!==null&&qt(a);break;case 13:qt(a);break;case 19:M(nt);break;case 10:Ea(a.type);break;case 22:case 23:qt(a),To(),t!==null&&M(Es);break;case 24:Ea(ot)}}function bn(t,a){try{var n=a.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var d=i.next;n=d;do{if((n.tag&t)===t){i=void 0;var h=n.create,p=n.inst;i=h(),p.destroy=i}n=n.next}while(n!==d)}}catch(T){Ge(a,a.return,T)}}function as(t,a,n){try{var i=a.updateQueue,d=i!==null?i.lastEffect:null;if(d!==null){var h=d.next;i=h;do{if((i.tag&t)===t){var p=i.inst,T=p.destroy;if(T!==void 0){p.destroy=void 0,d=a;var I=n,W=T;try{W()}catch(ne){Ge(d,I,ne)}}}i=i.next}while(i!==h)}}catch(ne){Ge(a,a.return,ne)}}function Wh(t){var a=t.updateQueue;if(a!==null){var n=t.stateNode;try{Hu(a,n)}catch(i){Ge(t,t.return,i)}}}function em(t,a,n){n.props=Ls(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(i){Ge(t,a,i)}}function jn(t,a){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof n=="function"?t.refCleanup=n(i):n.current=i}}catch(d){Ge(t,a,d)}}function va(t,a){var n=t.ref,i=t.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(d){Ge(t,a,d)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(d){Ge(t,a,d)}else n.current=null}function tm(t){var a=t.type,n=t.memoizedProps,i=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(d){Ge(t,t.return,d)}}function nc(t,a,n){try{var i=t.stateNode;Tx(i,t.type,n,a),i[At]=a}catch(d){Ge(t,t.return,d)}}function am(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&cs(t.type)||t.tag===4}function lc(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||am(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&cs(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ic(t,a,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,a?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,a):(a=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,a.appendChild(t),n=n._reactRootContainer,n!=null||a.onclick!==null||(a.onclick=_a));else if(i!==4&&(i===27&&cs(t.type)&&(n=t.stateNode,a=null),t=t.child,t!==null))for(ic(t,a,n),t=t.sibling;t!==null;)ic(t,a,n),t=t.sibling}function Bl(t,a,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,a?n.insertBefore(t,a):n.appendChild(t);else if(i!==4&&(i===27&&cs(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(Bl(t,a,n),t=t.sibling;t!==null;)Bl(t,a,n),t=t.sibling}function sm(t){var a=t.stateNode,n=t.memoizedProps;try{for(var i=t.type,d=a.attributes;d.length;)a.removeAttributeNode(d[0]);Nt(a,i,n),a[yt]=t,a[At]=n}catch(h){Ge(t,t.return,h)}}var La=!1,ut=!1,oc=!1,rm=typeof WeakSet=="function"?WeakSet:Set,pt=null;function lx(t,a){if(t=t.containerInfo,Ec=ni,t=xu(t),eo(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var d=i.anchorOffset,h=i.focusNode;i=i.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var p=0,T=-1,I=-1,W=0,ne=0,ce=t,te=null;t:for(;;){for(var se;ce!==n||d!==0&&ce.nodeType!==3||(T=p+d),ce!==h||i!==0&&ce.nodeType!==3||(I=p+i),ce.nodeType===3&&(p+=ce.nodeValue.length),(se=ce.firstChild)!==null;)te=ce,ce=se;for(;;){if(ce===t)break t;if(te===n&&++W===d&&(T=p),te===h&&++ne===i&&(I=p),(se=ce.nextSibling)!==null)break;ce=te,te=ce.parentNode}ce=se}n=T===-1||I===-1?null:{start:T,end:I}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dc={focusedElem:t,selectionRange:n},ni=!1,pt=a;pt!==null;)if(a=pt,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,pt=t;else for(;pt!==null;){switch(a=pt,h=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(n=0;n<t.length;n++)d=t[n],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&h!==null){t=void 0,n=a,d=h.memoizedProps,h=h.memoizedState,i=n.stateNode;try{var ye=Ls(n.type,d);t=i.getSnapshotBeforeUpdate(ye,h),i.__reactInternalSnapshotBeforeUpdate=t}catch(we){Ge(n,n.return,we)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,n=t.nodeType,n===9)Rc(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Rc(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(o(163))}if(t=a.sibling,t!==null){t.return=a.return,pt=t;break}pt=a.return}}function nm(t,a,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Ma(t,n),i&4&&bn(5,n);break;case 1:if(Ma(t,n),i&4)if(t=n.stateNode,a===null)try{t.componentDidMount()}catch(p){Ge(n,n.return,p)}else{var d=Ls(n.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(d,a,t.__reactInternalSnapshotBeforeUpdate)}catch(p){Ge(n,n.return,p)}}i&64&&Wh(n),i&512&&jn(n,n.return);break;case 3:if(Ma(t,n),i&64&&(t=n.updateQueue,t!==null)){if(a=null,n.child!==null)switch(n.child.tag){case 27:case 5:a=n.child.stateNode;break;case 1:a=n.child.stateNode}try{Hu(t,a)}catch(p){Ge(n,n.return,p)}}break;case 27:a===null&&i&4&&sm(n);case 26:case 5:Ma(t,n),a===null&&i&4&&tm(n),i&512&&jn(n,n.return);break;case 12:Ma(t,n);break;case 31:Ma(t,n),i&4&&om(t,n);break;case 13:Ma(t,n),i&4&&cm(t,n),i&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=gx.bind(null,n),Ux(t,n))));break;case 22:if(i=n.memoizedState!==null||La,!i){a=a!==null&&a.memoizedState!==null||ut,d=La;var h=ut;La=i,(ut=a)&&!h?za(t,n,(n.subtreeFlags&8772)!==0):Ma(t,n),La=d,ut=h}break;case 30:break;default:Ma(t,n)}}function lm(t){var a=t.alternate;a!==null&&(t.alternate=null,lm(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&zi(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var We=null,Rt=!1;function Ua(t,a,n){for(n=n.child;n!==null;)im(t,a,n),n=n.sibling}function im(t,a,n){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(Gr,n)}catch{}switch(n.tag){case 26:ut||va(n,a),Ua(t,a,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:ut||va(n,a);var i=We,d=Rt;cs(n.type)&&(We=n.stateNode,Rt=!1),Ua(t,a,n),Dn(n.stateNode),We=i,Rt=d;break;case 5:ut||va(n,a);case 6:if(i=We,d=Rt,We=null,Ua(t,a,n),We=i,Rt=d,We!==null)if(Rt)try{(We.nodeType===9?We.body:We.nodeName==="HTML"?We.ownerDocument.body:We).removeChild(n.stateNode)}catch(h){Ge(n,a,h)}else try{We.removeChild(n.stateNode)}catch(h){Ge(n,a,h)}break;case 18:We!==null&&(Rt?(t=We,Wm(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),kr(t)):Wm(We,n.stateNode));break;case 4:i=We,d=Rt,We=n.stateNode.containerInfo,Rt=!0,Ua(t,a,n),We=i,Rt=d;break;case 0:case 11:case 14:case 15:as(2,n,a),ut||as(4,n,a),Ua(t,a,n);break;case 1:ut||(va(n,a),i=n.stateNode,typeof i.componentWillUnmount=="function"&&em(n,a,i)),Ua(t,a,n);break;case 21:Ua(t,a,n);break;case 22:ut=(i=ut)||n.memoizedState!==null,Ua(t,a,n),ut=i;break;default:Ua(t,a,n)}}function om(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{kr(t)}catch(n){Ge(a,a.return,n)}}}function cm(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{kr(t)}catch(n){Ge(a,a.return,n)}}function ix(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new rm),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new rm),a;default:throw Error(o(435,t.tag))}}function Il(t,a){var n=ix(t);a.forEach(function(i){if(!n.has(i)){n.add(i);var d=xx.bind(null,t,i);i.then(d,d)}})}function Lt(t,a){var n=a.deletions;if(n!==null)for(var i=0;i<n.length;i++){var d=n[i],h=t,p=a,T=p;e:for(;T!==null;){switch(T.tag){case 27:if(cs(T.type)){We=T.stateNode,Rt=!1;break e}break;case 5:We=T.stateNode,Rt=!1;break e;case 3:case 4:We=T.stateNode.containerInfo,Rt=!0;break e}T=T.return}if(We===null)throw Error(o(160));im(h,p,d),We=null,Rt=!1,h=d.alternate,h!==null&&(h.return=null),d.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)dm(a,t),a=a.sibling}var ua=null;function dm(t,a){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Lt(a,t),Ut(t),i&4&&(as(3,t,t.return),bn(3,t),as(5,t,t.return));break;case 1:Lt(a,t),Ut(t),i&512&&(ut||n===null||va(n,n.return)),i&64&&La&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var d=ua;if(Lt(a,t),Ut(t),i&512&&(ut||n===null||va(n,n.return)),i&4){var h=n!==null?n.memoizedState:null;if(i=t.memoizedState,n===null)if(i===null)if(t.stateNode===null){e:{i=t.type,n=t.memoizedProps,d=d.ownerDocument||d;t:switch(i){case"title":h=d.getElementsByTagName("title")[0],(!h||h[Qr]||h[yt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=d.createElement(i),d.head.insertBefore(h,d.querySelector("head > title"))),Nt(h,i,n),h[yt]=t,xt(h),i=h;break e;case"link":var p=d0("link","href",d).get(i+(n.href||""));if(p){for(var T=0;T<p.length;T++)if(h=p[T],h.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&h.getAttribute("rel")===(n.rel==null?null:n.rel)&&h.getAttribute("title")===(n.title==null?null:n.title)&&h.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){p.splice(T,1);break t}}h=d.createElement(i),Nt(h,i,n),d.head.appendChild(h);break;case"meta":if(p=d0("meta","content",d).get(i+(n.content||""))){for(T=0;T<p.length;T++)if(h=p[T],h.getAttribute("content")===(n.content==null?null:""+n.content)&&h.getAttribute("name")===(n.name==null?null:n.name)&&h.getAttribute("property")===(n.property==null?null:n.property)&&h.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&h.getAttribute("charset")===(n.charSet==null?null:n.charSet)){p.splice(T,1);break t}}h=d.createElement(i),Nt(h,i,n),d.head.appendChild(h);break;default:throw Error(o(468,i))}h[yt]=t,xt(h),i=h}t.stateNode=i}else u0(d,t.type,t.stateNode);else t.stateNode=c0(d,i,t.memoizedProps);else h!==i?(h===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):h.count--,i===null?u0(d,t.type,t.stateNode):c0(d,i,t.memoizedProps)):i===null&&t.stateNode!==null&&nc(t,t.memoizedProps,n.memoizedProps)}break;case 27:Lt(a,t),Ut(t),i&512&&(ut||n===null||va(n,n.return)),n!==null&&i&4&&nc(t,t.memoizedProps,n.memoizedProps);break;case 5:if(Lt(a,t),Ut(t),i&512&&(ut||n===null||va(n,n.return)),t.flags&32){d=t.stateNode;try{Xs(d,"")}catch(ye){Ge(t,t.return,ye)}}i&4&&t.stateNode!=null&&(d=t.memoizedProps,nc(t,d,n!==null?n.memoizedProps:d)),i&1024&&(oc=!0);break;case 6:if(Lt(a,t),Ut(t),i&4){if(t.stateNode===null)throw Error(o(162));i=t.memoizedProps,n=t.stateNode;try{n.nodeValue=i}catch(ye){Ge(t,t.return,ye)}}break;case 3:if(ti=null,d=ua,ua=Wl(a.containerInfo),Lt(a,t),ua=d,Ut(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{kr(a.containerInfo)}catch(ye){Ge(t,t.return,ye)}oc&&(oc=!1,um(t));break;case 4:i=ua,ua=Wl(t.stateNode.containerInfo),Lt(a,t),Ut(t),ua=i;break;case 12:Lt(a,t),Ut(t);break;case 31:Lt(a,t),Ut(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Il(t,i)));break;case 13:Lt(a,t),Ut(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&($l=It()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Il(t,i)));break;case 22:d=t.memoizedState!==null;var I=n!==null&&n.memoizedState!==null,W=La,ne=ut;if(La=W||d,ut=ne||I,Lt(a,t),ut=ne,La=W,Ut(t),i&8192)e:for(a=t.stateNode,a._visibility=d?a._visibility&-2:a._visibility|1,d&&(n===null||I||La||ut||Us(t)),n=null,a=t;;){if(a.tag===5||a.tag===26){if(n===null){I=n=a;try{if(h=I.stateNode,d)p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{T=I.stateNode;var ce=I.memoizedProps.style,te=ce!=null&&ce.hasOwnProperty("display")?ce.display:null;T.style.display=te==null||typeof te=="boolean"?"":(""+te).trim()}}catch(ye){Ge(I,I.return,ye)}}}else if(a.tag===6){if(n===null){I=a;try{I.stateNode.nodeValue=d?"":I.memoizedProps}catch(ye){Ge(I,I.return,ye)}}}else if(a.tag===18){if(n===null){I=a;try{var se=I.stateNode;d?e0(se,!0):e0(I.stateNode,!1)}catch(ye){Ge(I,I.return,ye)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;n===a&&(n=null),a=a.return}n===a&&(n=null),a.sibling.return=a.return,a=a.sibling}i&4&&(i=t.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Il(t,n))));break;case 19:Lt(a,t),Ut(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,Il(t,i)));break;case 30:break;case 21:break;default:Lt(a,t),Ut(t)}}function Ut(t){var a=t.flags;if(a&2){try{for(var n,i=t.return;i!==null;){if(am(i)){n=i;break}i=i.return}if(n==null)throw Error(o(160));switch(n.tag){case 27:var d=n.stateNode,h=lc(t);Bl(t,h,d);break;case 5:var p=n.stateNode;n.flags&32&&(Xs(p,""),n.flags&=-33);var T=lc(t);Bl(t,T,p);break;case 3:case 4:var I=n.stateNode.containerInfo,W=lc(t);ic(t,W,I);break;default:throw Error(o(161))}}catch(ne){Ge(t,t.return,ne)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function um(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;um(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function Ma(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)nm(t,a.alternate,a),a=a.sibling}function Us(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:as(4,a,a.return),Us(a);break;case 1:va(a,a.return);var n=a.stateNode;typeof n.componentWillUnmount=="function"&&em(a,a.return,n),Us(a);break;case 27:Dn(a.stateNode);case 26:case 5:va(a,a.return),Us(a);break;case 22:a.memoizedState===null&&Us(a);break;case 30:Us(a);break;default:Us(a)}t=t.sibling}}function za(t,a,n){for(n=n&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var i=a.alternate,d=t,h=a,p=h.flags;switch(h.tag){case 0:case 11:case 15:za(d,h,n),bn(4,h);break;case 1:if(za(d,h,n),i=h,d=i.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(W){Ge(i,i.return,W)}if(i=h,d=i.updateQueue,d!==null){var T=i.stateNode;try{var I=d.shared.hiddenCallbacks;if(I!==null)for(d.shared.hiddenCallbacks=null,d=0;d<I.length;d++)Pu(I[d],T)}catch(W){Ge(i,i.return,W)}}n&&p&64&&Wh(h),jn(h,h.return);break;case 27:sm(h);case 26:case 5:za(d,h,n),n&&i===null&&p&4&&tm(h),jn(h,h.return);break;case 12:za(d,h,n);break;case 31:za(d,h,n),n&&p&4&&om(d,h);break;case 13:za(d,h,n),n&&p&4&&cm(d,h);break;case 22:h.memoizedState===null&&za(d,h,n),jn(h,h.return);break;case 30:break;default:za(d,h,n)}a=a.sibling}}function cc(t,a){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&ln(n))}function dc(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&ln(t))}function ha(t,a,n,i){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)hm(t,a,n,i),a=a.sibling}function hm(t,a,n,i){var d=a.flags;switch(a.tag){case 0:case 11:case 15:ha(t,a,n,i),d&2048&&bn(9,a);break;case 1:ha(t,a,n,i);break;case 3:ha(t,a,n,i),d&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&ln(t)));break;case 12:if(d&2048){ha(t,a,n,i),t=a.stateNode;try{var h=a.memoizedProps,p=h.id,T=h.onPostCommit;typeof T=="function"&&T(p,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(I){Ge(a,a.return,I)}}else ha(t,a,n,i);break;case 31:ha(t,a,n,i);break;case 13:ha(t,a,n,i);break;case 23:break;case 22:h=a.stateNode,p=a.alternate,a.memoizedState!==null?h._visibility&2?ha(t,a,n,i):Nn(t,a):h._visibility&2?ha(t,a,n,i):(h._visibility|=2,pr(t,a,n,i,(a.subtreeFlags&10256)!==0||!1)),d&2048&&cc(p,a);break;case 24:ha(t,a,n,i),d&2048&&dc(a.alternate,a);break;default:ha(t,a,n,i)}}function pr(t,a,n,i,d){for(d=d&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var h=t,p=a,T=n,I=i,W=p.flags;switch(p.tag){case 0:case 11:case 15:pr(h,p,T,I,d),bn(8,p);break;case 23:break;case 22:var ne=p.stateNode;p.memoizedState!==null?ne._visibility&2?pr(h,p,T,I,d):Nn(h,p):(ne._visibility|=2,pr(h,p,T,I,d)),d&&W&2048&&cc(p.alternate,p);break;case 24:pr(h,p,T,I,d),d&&W&2048&&dc(p.alternate,p);break;default:pr(h,p,T,I,d)}a=a.sibling}}function Nn(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var n=t,i=a,d=i.flags;switch(i.tag){case 22:Nn(n,i),d&2048&&cc(i.alternate,i);break;case 24:Nn(n,i),d&2048&&dc(i.alternate,i);break;default:Nn(n,i)}a=a.sibling}}var wn=8192;function yr(t,a,n){if(t.subtreeFlags&wn)for(t=t.child;t!==null;)mm(t,a,n),t=t.sibling}function mm(t,a,n){switch(t.tag){case 26:yr(t,a,n),t.flags&wn&&t.memoizedState!==null&&Qx(n,ua,t.memoizedState,t.memoizedProps);break;case 5:yr(t,a,n);break;case 3:case 4:var i=ua;ua=Wl(t.stateNode.containerInfo),yr(t,a,n),ua=i;break;case 22:t.memoizedState===null&&(i=t.alternate,i!==null&&i.memoizedState!==null?(i=wn,wn=16777216,yr(t,a,n),wn=i):yr(t,a,n));break;default:yr(t,a,n)}}function fm(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function _n(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var n=0;n<a.length;n++){var i=a[n];pt=i,xm(i,t)}fm(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)gm(t),t=t.sibling}function gm(t){switch(t.tag){case 0:case 11:case 15:_n(t),t.flags&2048&&as(9,t,t.return);break;case 3:_n(t);break;case 12:_n(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,Vl(t)):_n(t);break;default:_n(t)}}function Vl(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var n=0;n<a.length;n++){var i=a[n];pt=i,xm(i,t)}fm(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:as(8,a,a.return),Vl(a);break;case 22:n=a.stateNode,n._visibility&2&&(n._visibility&=-3,Vl(a));break;default:Vl(a)}t=t.sibling}}function xm(t,a){for(;pt!==null;){var n=pt;switch(n.tag){case 0:case 11:case 15:as(8,n,a);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:ln(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,pt=i;else e:for(n=t;pt!==null;){i=pt;var d=i.sibling,h=i.return;if(lm(i),i===n){pt=null;break e}if(d!==null){d.return=h,pt=d;break e}pt=h}}}var ox={getCacheForType:function(t){var a=bt(ot),n=a.data.get(t);return n===void 0&&(n=t(),a.data.set(t,n)),n},cacheSignal:function(){return bt(ot).controller.signal}},cx=typeof WeakMap=="function"?WeakMap:Map,$e=0,Je=null,Le=null,Me=0,He=0,Yt=null,ss=!1,vr=!1,uc=!1,Ba=0,st=0,rs=0,Ms=0,hc=0,Qt=0,br=0,Sn=null,Mt=null,mc=!1,$l=0,pm=0,Pl=1/0,Hl=null,ns=null,ft=0,ls=null,jr=null,Ia=0,fc=0,gc=null,ym=null,Cn=0,xc=null;function Jt(){return($e&2)!==0&&Me!==0?Me&-Me:P.T!==null?Nc():Ld()}function vm(){if(Qt===0)if((Me&536870912)===0||Be){var t=Xn;Xn<<=1,(Xn&3932160)===0&&(Xn=262144),Qt=t}else Qt=536870912;return t=Gt.current,t!==null&&(t.flags|=32),Qt}function zt(t,a,n){(t===Je&&(He===2||He===9)||t.cancelPendingCommit!==null)&&(Nr(t,0),is(t,Me,Qt,!1)),Yr(t,n),(($e&2)===0||t!==Je)&&(t===Je&&(($e&2)===0&&(Ms|=n),st===4&&is(t,Me,Qt,!1)),ba(t))}function bm(t,a,n){if(($e&6)!==0)throw Error(o(327));var i=!n&&(a&127)===0&&(a&t.expiredLanes)===0||qr(t,a),d=i?hx(t,a):yc(t,a,!0),h=i;do{if(d===0){vr&&!i&&is(t,a,0,!1);break}else{if(n=t.current.alternate,h&&!dx(n)){d=yc(t,a,!1),h=!1;continue}if(d===2){if(h=a,t.errorRecoveryDisabledLanes&h)var p=0;else p=t.pendingLanes&-536870913,p=p!==0?p:p&536870912?536870912:0;if(p!==0){a=p;e:{var T=t;d=Sn;var I=T.current.memoizedState.isDehydrated;if(I&&(Nr(T,p).flags|=256),p=yc(T,p,!1),p!==2){if(uc&&!I){T.errorRecoveryDisabledLanes|=h,Ms|=h,d=4;break e}h=Mt,Mt=d,h!==null&&(Mt===null?Mt=h:Mt.push.apply(Mt,h))}d=p}if(h=!1,d!==2)continue}}if(d===1){Nr(t,0),is(t,a,0,!0);break}e:{switch(i=t,h=d,h){case 0:case 1:throw Error(o(345));case 4:if((a&4194048)!==a)break;case 6:is(i,a,Qt,!ss);break e;case 2:Mt=null;break;case 3:case 5:break;default:throw Error(o(329))}if((a&62914560)===a&&(d=$l+300-It(),10<d)){if(is(i,a,Qt,!ss),Wn(i,0,!0)!==0)break e;Ia=a,i.timeoutHandle=Xm(jm.bind(null,i,n,Mt,Hl,mc,a,Qt,Ms,br,ss,h,"Throttled",-0,0),d);break e}jm(i,n,Mt,Hl,mc,a,Qt,Ms,br,ss,h,null,-0,0)}}break}while(!0);ba(t)}function jm(t,a,n,i,d,h,p,T,I,W,ne,ce,te,se){if(t.timeoutHandle=-1,ce=a.subtreeFlags,ce&8192||(ce&16785408)===16785408){ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_a},mm(a,h,ce);var ye=(h&62914560)===h?$l-It():(h&4194048)===h?pm-It():0;if(ye=Jx(ce,ye),ye!==null){Ia=h,t.cancelPendingCommit=ye(Em.bind(null,t,a,h,n,i,d,p,T,I,ne,ce,null,te,se)),is(t,h,p,!W);return}}Em(t,a,h,n,i,d,p,T,I)}function dx(t){for(var a=t;;){var n=a.tag;if((n===0||n===11||n===15)&&a.flags&16384&&(n=a.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var d=n[i],h=d.getSnapshot;d=d.value;try{if(!Pt(h(),d))return!1}catch{return!1}}if(n=a.child,a.subtreeFlags&16384&&n!==null)n.return=a,a=n;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function is(t,a,n,i){a&=~hc,a&=~Ms,t.suspendedLanes|=a,t.pingedLanes&=~a,i&&(t.warmLanes|=a),i=t.expirationTimes;for(var d=a;0<d;){var h=31-$t(d),p=1<<h;i[h]=-1,d&=~p}n!==0&&Ad(t,n,a)}function Gl(){return($e&6)===0?(Tn(0),!1):!0}function pc(){if(Le!==null){if(He===0)var t=Le.return;else t=Le,ka=Ts=null,Ro(t),hr=null,cn=0,t=Le;for(;t!==null;)Zh(t.alternate,t),t=t.return;Le=null}}function Nr(t,a){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,Dx(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),Ia=0,pc(),Je=t,Le=n=Ca(t.current,null),Me=a,He=0,Yt=null,ss=!1,vr=qr(t,a),uc=!1,br=Qt=hc=Ms=rs=st=0,Mt=Sn=null,mc=!1,(a&8)!==0&&(a|=a&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=a;0<i;){var d=31-$t(i),h=1<<d;a|=t[d],i&=~h}return Ba=a,ul(),n}function Nm(t,a){ke=null,P.H=pn,a===ur||a===vl?(a=Bu(),He=3):a===jo?(a=Bu(),He=4):He=a===Ko?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Yt=a,Le===null&&(st=1,Rl(t,aa(a,t.current)))}function wm(){var t=Gt.current;return t===null?!0:(Me&4194048)===Me?la===null:(Me&62914560)===Me||(Me&536870912)!==0?t===la:!1}function _m(){var t=P.H;return P.H=pn,t===null?pn:t}function Sm(){var t=P.A;return P.A=ox,t}function ql(){st=4,ss||(Me&4194048)!==Me&&Gt.current!==null||(vr=!0),(rs&134217727)===0&&(Ms&134217727)===0||Je===null||is(Je,Me,Qt,!1)}function yc(t,a,n){var i=$e;$e|=2;var d=_m(),h=Sm();(Je!==t||Me!==a)&&(Hl=null,Nr(t,a)),a=!1;var p=st;e:do try{if(He!==0&&Le!==null){var T=Le,I=Yt;switch(He){case 8:pc(),p=6;break e;case 3:case 2:case 9:case 6:Gt.current===null&&(a=!0);var W=He;if(He=0,Yt=null,wr(t,T,I,W),n&&vr){p=0;break e}break;default:W=He,He=0,Yt=null,wr(t,T,I,W)}}ux(),p=st;break}catch(ne){Nm(t,ne)}while(!0);return a&&t.shellSuspendCounter++,ka=Ts=null,$e=i,P.H=d,P.A=h,Le===null&&(Je=null,Me=0,ul()),p}function ux(){for(;Le!==null;)Cm(Le)}function hx(t,a){var n=$e;$e|=2;var i=_m(),d=Sm();Je!==t||Me!==a?(Hl=null,Pl=It()+500,Nr(t,a)):vr=qr(t,a);e:do try{if(He!==0&&Le!==null){a=Le;var h=Yt;t:switch(He){case 1:He=0,Yt=null,wr(t,a,h,1);break;case 2:case 9:if(Mu(h)){He=0,Yt=null,Tm(a);break}a=function(){He!==2&&He!==9||Je!==t||(He=7),ba(t)},h.then(a,a);break e;case 3:He=7;break e;case 4:He=5;break e;case 7:Mu(h)?(He=0,Yt=null,Tm(a)):(He=0,Yt=null,wr(t,a,h,7));break;case 5:var p=null;switch(Le.tag){case 26:p=Le.memoizedState;case 5:case 27:var T=Le;if(p?h0(p):T.stateNode.complete){He=0,Yt=null;var I=T.sibling;if(I!==null)Le=I;else{var W=T.return;W!==null?(Le=W,Yl(W)):Le=null}break t}}He=0,Yt=null,wr(t,a,h,5);break;case 6:He=0,Yt=null,wr(t,a,h,6);break;case 8:pc(),st=6;break e;default:throw Error(o(462))}}mx();break}catch(ne){Nm(t,ne)}while(!0);return ka=Ts=null,P.H=i,P.A=d,$e=n,Le!==null?0:(Je=null,Me=0,ul(),st)}function mx(){for(;Le!==null&&!Mf();)Cm(Le)}function Cm(t){var a=Fh(t.alternate,t,Ba);t.memoizedProps=t.pendingProps,a===null?Yl(t):Le=a}function Tm(t){var a=t,n=a.alternate;switch(a.tag){case 15:case 0:a=Gh(n,a,a.pendingProps,a.type,void 0,Me);break;case 11:a=Gh(n,a,a.pendingProps,a.type.render,a.ref,Me);break;case 5:Ro(a);default:Zh(n,a),a=Le=Su(a,Ba),a=Fh(n,a,Ba)}t.memoizedProps=t.pendingProps,a===null?Yl(t):Le=a}function wr(t,a,n,i){ka=Ts=null,Ro(a),hr=null,cn=0;var d=a.return;try{if(tx(t,d,a,n,Me)){st=1,Rl(t,aa(n,t.current)),Le=null;return}}catch(h){if(d!==null)throw Le=d,h;st=1,Rl(t,aa(n,t.current)),Le=null;return}a.flags&32768?(Be||i===1?t=!0:vr||(Me&536870912)!==0?t=!1:(ss=t=!0,(i===2||i===9||i===3||i===6)&&(i=Gt.current,i!==null&&i.tag===13&&(i.flags|=16384))),km(a,t)):Yl(a)}function Yl(t){var a=t;do{if((a.flags&32768)!==0){km(a,ss);return}t=a.return;var n=rx(a.alternate,a,Ba);if(n!==null){Le=n;return}if(a=a.sibling,a!==null){Le=a;return}Le=a=t}while(a!==null);st===0&&(st=5)}function km(t,a){do{var n=nx(t.alternate,t);if(n!==null){n.flags&=32767,Le=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!a&&(t=t.sibling,t!==null)){Le=t;return}Le=t=n}while(t!==null);st=6,Le=null}function Em(t,a,n,i,d,h,p,T,I){t.cancelPendingCommit=null;do Ql();while(ft!==0);if(($e&6)!==0)throw Error(o(327));if(a!==null){if(a===t.current)throw Error(o(177));if(h=a.lanes|a.childLanes,h|=no,Yf(t,n,h,p,T,I),t===Je&&(Le=Je=null,Me=0),jr=a,ls=t,Ia=n,fc=h,gc=d,ym=i,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,px(Kn,function(){return Lm(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||i){i=P.T,P.T=null,d=ae.p,ae.p=2,p=$e,$e|=4;try{lx(t,a,n)}finally{$e=p,ae.p=d,P.T=i}}ft=1,Dm(),Am(),Om()}}function Dm(){if(ft===1){ft=0;var t=ls,a=jr,n=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||n){n=P.T,P.T=null;var i=ae.p;ae.p=2;var d=$e;$e|=4;try{dm(a,t);var h=Dc,p=xu(t.containerInfo),T=h.focusedElem,I=h.selectionRange;if(p!==T&&T&&T.ownerDocument&&gu(T.ownerDocument.documentElement,T)){if(I!==null&&eo(T)){var W=I.start,ne=I.end;if(ne===void 0&&(ne=W),"selectionStart"in T)T.selectionStart=W,T.selectionEnd=Math.min(ne,T.value.length);else{var ce=T.ownerDocument||document,te=ce&&ce.defaultView||window;if(te.getSelection){var se=te.getSelection(),ye=T.textContent.length,we=Math.min(I.start,ye),Qe=I.end===void 0?we:Math.min(I.end,ye);!se.extend&&we>Qe&&(p=Qe,Qe=we,we=p);var J=fu(T,we),G=fu(T,Qe);if(J&&G&&(se.rangeCount!==1||se.anchorNode!==J.node||se.anchorOffset!==J.offset||se.focusNode!==G.node||se.focusOffset!==G.offset)){var Z=ce.createRange();Z.setStart(J.node,J.offset),se.removeAllRanges(),we>Qe?(se.addRange(Z),se.extend(G.node,G.offset)):(Z.setEnd(G.node,G.offset),se.addRange(Z))}}}}for(ce=[],se=T;se=se.parentNode;)se.nodeType===1&&ce.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ce.length;T++){var le=ce[T];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}ni=!!Ec,Dc=Ec=null}finally{$e=d,ae.p=i,P.T=n}}t.current=a,ft=2}}function Am(){if(ft===2){ft=0;var t=ls,a=jr,n=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||n){n=P.T,P.T=null;var i=ae.p;ae.p=2;var d=$e;$e|=4;try{nm(t,a.alternate,a)}finally{$e=d,ae.p=i,P.T=n}}ft=3}}function Om(){if(ft===4||ft===3){ft=0,zf();var t=ls,a=jr,n=Ia,i=ym;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ft=5:(ft=0,jr=ls=null,Rm(t,t.pendingLanes));var d=t.pendingLanes;if(d===0&&(ns=null),Ui(n),a=a.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(Gr,a,void 0,(a.current.flags&128)===128)}catch{}if(i!==null){a=P.T,d=ae.p,ae.p=2,P.T=null;try{for(var h=t.onRecoverableError,p=0;p<i.length;p++){var T=i[p];h(T.value,{componentStack:T.stack})}}finally{P.T=a,ae.p=d}}(Ia&3)!==0&&Ql(),ba(t),d=t.pendingLanes,(n&261930)!==0&&(d&42)!==0?t===xc?Cn++:(Cn=0,xc=t):Cn=0,Tn(0)}}function Rm(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,ln(a)))}function Ql(){return Dm(),Am(),Om(),Lm()}function Lm(){if(ft!==5)return!1;var t=ls,a=fc;fc=0;var n=Ui(Ia),i=P.T,d=ae.p;try{ae.p=32>n?32:n,P.T=null,n=gc,gc=null;var h=ls,p=Ia;if(ft=0,jr=ls=null,Ia=0,($e&6)!==0)throw Error(o(331));var T=$e;if($e|=4,gm(h.current),hm(h,h.current,p,n),$e=T,Tn(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(Gr,h)}catch{}return!0}finally{ae.p=d,P.T=i,Rm(t,a)}}function Um(t,a,n){a=aa(n,a),a=Jo(t.stateNode,a,2),t=Wa(t,a,2),t!==null&&(Yr(t,2),ba(t))}function Ge(t,a,n){if(t.tag===3)Um(t,t,n);else for(;a!==null;){if(a.tag===3){Um(a,t,n);break}else if(a.tag===1){var i=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ns===null||!ns.has(i))){t=aa(n,t),n=Mh(2),i=Wa(a,n,2),i!==null&&(zh(n,i,a,t),Yr(i,2),ba(i));break}}a=a.return}}function vc(t,a,n){var i=t.pingCache;if(i===null){i=t.pingCache=new cx;var d=new Set;i.set(a,d)}else d=i.get(a),d===void 0&&(d=new Set,i.set(a,d));d.has(n)||(uc=!0,d.add(n),t=fx.bind(null,t,a,n),a.then(t,t))}function fx(t,a,n){var i=t.pingCache;i!==null&&i.delete(a),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,Je===t&&(Me&n)===n&&(st===4||st===3&&(Me&62914560)===Me&&300>It()-$l?($e&2)===0&&Nr(t,0):hc|=n,br===Me&&(br=0)),ba(t)}function Mm(t,a){a===0&&(a=Dd()),t=_s(t,a),t!==null&&(Yr(t,a),ba(t))}function gx(t){var a=t.memoizedState,n=0;a!==null&&(n=a.retryLane),Mm(t,n)}function xx(t,a){var n=0;switch(t.tag){case 31:case 13:var i=t.stateNode,d=t.memoizedState;d!==null&&(n=d.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(o(314))}i!==null&&i.delete(a),Mm(t,n)}function px(t,a){return kt(t,a)}var Jl=null,_r=null,bc=!1,Kl=!1,jc=!1,os=0;function ba(t){t!==_r&&t.next===null&&(_r===null?Jl=_r=t:_r=_r.next=t),Kl=!0,bc||(bc=!0,vx())}function Tn(t,a){if(!jc&&Kl){jc=!0;do for(var n=!1,i=Jl;i!==null;){if(t!==0){var d=i.pendingLanes;if(d===0)var h=0;else{var p=i.suspendedLanes,T=i.pingedLanes;h=(1<<31-$t(42|t)+1)-1,h&=d&~(p&~T),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(n=!0,Vm(i,h))}else h=Me,h=Wn(i,i===Je?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(h&3)===0||qr(i,h)||(n=!0,Vm(i,h));i=i.next}while(n);jc=!1}}function yx(){zm()}function zm(){Kl=bc=!1;var t=0;os!==0&&Ex()&&(t=os);for(var a=It(),n=null,i=Jl;i!==null;){var d=i.next,h=Bm(i,a);h===0?(i.next=null,n===null?Jl=d:n.next=d,d===null&&(_r=n)):(n=i,(t!==0||(h&3)!==0)&&(Kl=!0)),i=d}ft!==0&&ft!==5||Tn(t),os!==0&&(os=0)}function Bm(t,a){for(var n=t.suspendedLanes,i=t.pingedLanes,d=t.expirationTimes,h=t.pendingLanes&-62914561;0<h;){var p=31-$t(h),T=1<<p,I=d[p];I===-1?((T&n)===0||(T&i)!==0)&&(d[p]=qf(T,a)):I<=a&&(t.expiredLanes|=T),h&=~T}if(a=Je,n=Me,n=Wn(t,t===a?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,n===0||t===a&&(He===2||He===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&ys(i),t.callbackNode=null,t.callbackPriority=0;if((n&3)===0||qr(t,n)){if(a=n&-n,a===t.callbackPriority)return a;switch(i!==null&&ys(i),Ui(n)){case 2:case 8:n=kd;break;case 32:n=Kn;break;case 268435456:n=Ed;break;default:n=Kn}return i=Im.bind(null,t),n=kt(n,i),t.callbackPriority=a,t.callbackNode=n,a}return i!==null&&i!==null&&ys(i),t.callbackPriority=2,t.callbackNode=null,2}function Im(t,a){if(ft!==0&&ft!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(Ql()&&t.callbackNode!==n)return null;var i=Me;return i=Wn(t,t===Je?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(bm(t,i,a),Bm(t,It()),t.callbackNode!=null&&t.callbackNode===n?Im.bind(null,t):null)}function Vm(t,a){if(Ql())return null;bm(t,a,!0)}function vx(){Ax(function(){($e&6)!==0?kt(Td,yx):zm()})}function Nc(){if(os===0){var t=cr;t===0&&(t=Fn,Fn<<=1,(Fn&261888)===0&&(Fn=256)),os=t}return os}function $m(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:sl(""+t)}function Pm(t,a){var n=a.ownerDocument.createElement("input");return n.name=a.name,n.value=a.value,t.id&&n.setAttribute("form",t.id),a.parentNode.insertBefore(n,a),t=new FormData(t),n.parentNode.removeChild(n),t}function bx(t,a,n,i,d){if(a==="submit"&&n&&n.stateNode===d){var h=$m((d[At]||null).action),p=i.submitter;p&&(a=(a=p[At]||null)?$m(a.formAction):p.getAttribute("formAction"),a!==null&&(h=a,p=null));var T=new il("action","action",null,i,d);t.push({event:T,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(os!==0){var I=p?Pm(d,p):new FormData(d);Po(n,{pending:!0,data:I,method:d.method,action:h},null,I)}}else typeof h=="function"&&(T.preventDefault(),I=p?Pm(d,p):new FormData(d),Po(n,{pending:!0,data:I,method:d.method,action:h},h,I))},currentTarget:d}]})}}for(var wc=0;wc<ro.length;wc++){var _c=ro[wc],jx=_c.toLowerCase(),Nx=_c[0].toUpperCase()+_c.slice(1);da(jx,"on"+Nx)}da(vu,"onAnimationEnd"),da(bu,"onAnimationIteration"),da(ju,"onAnimationStart"),da("dblclick","onDoubleClick"),da("focusin","onFocus"),da("focusout","onBlur"),da(Bg,"onTransitionRun"),da(Ig,"onTransitionStart"),da(Vg,"onTransitionCancel"),da(Nu,"onTransitionEnd"),Ks("onMouseEnter",["mouseout","mouseover"]),Ks("onMouseLeave",["mouseout","mouseover"]),Ks("onPointerEnter",["pointerout","pointerover"]),Ks("onPointerLeave",["pointerout","pointerover"]),bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bs("onBeforeInput",["compositionend","keypress","textInput","paste"]),bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kn));function Hm(t,a){a=(a&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],d=i.event;i=i.listeners;e:{var h=void 0;if(a)for(var p=i.length-1;0<=p;p--){var T=i[p],I=T.instance,W=T.currentTarget;if(T=T.listener,I!==h&&d.isPropagationStopped())break e;h=T,d.currentTarget=W;try{h(d)}catch(ne){dl(ne)}d.currentTarget=null,h=I}else for(p=0;p<i.length;p++){if(T=i[p],I=T.instance,W=T.currentTarget,T=T.listener,I!==h&&d.isPropagationStopped())break e;h=T,d.currentTarget=W;try{h(d)}catch(ne){dl(ne)}d.currentTarget=null,h=I}}}}function Ue(t,a){var n=a[Mi];n===void 0&&(n=a[Mi]=new Set);var i=t+"__bubble";n.has(i)||(Gm(a,t,2,!1),n.add(i))}function Sc(t,a,n){var i=0;a&&(i|=4),Gm(n,t,i,a)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function Cc(t){if(!t[Fl]){t[Fl]=!0,zd.forEach(function(n){n!=="selectionchange"&&(wx.has(n)||Sc(n,!1,t),Sc(n,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[Fl]||(a[Fl]=!0,Sc("selectionchange",!1,a))}}function Gm(t,a,n,i){switch(v0(a)){case 2:var d=Xx;break;case 8:d=Zx;break;default:d=$c}n=d.bind(null,a,n,t),d=void 0,!qi||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(d=!0),i?d!==void 0?t.addEventListener(a,n,{capture:!0,passive:d}):t.addEventListener(a,n,!0):d!==void 0?t.addEventListener(a,n,{passive:d}):t.addEventListener(a,n,!1)}function Tc(t,a,n,i,d){var h=i;if((a&1)===0&&(a&2)===0&&i!==null)e:for(;;){if(i===null)return;var p=i.tag;if(p===3||p===4){var T=i.stateNode.containerInfo;if(T===d)break;if(p===4)for(p=i.return;p!==null;){var I=p.tag;if((I===3||I===4)&&p.stateNode.containerInfo===d)return;p=p.return}for(;T!==null;){if(p=Ys(T),p===null)return;if(I=p.tag,I===5||I===6||I===26||I===27){i=h=p;continue e}T=T.parentNode}}i=i.return}Kd(function(){var W=h,ne=Hi(n),ce=[];e:{var te=wu.get(t);if(te!==void 0){var se=il,ye=t;switch(t){case"keypress":if(nl(n)===0)break e;case"keydown":case"keyup":se=xg;break;case"focusin":ye="focus",se=Ki;break;case"focusout":ye="blur",se=Ki;break;case"beforeblur":case"afterblur":se=Ki;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=Zd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=rg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=vg;break;case vu:case bu:case ju:se=ig;break;case Nu:se=jg;break;case"scroll":case"scrollend":se=ag;break;case"wheel":se=wg;break;case"copy":case"cut":case"paste":se=cg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=eu;break;case"toggle":case"beforetoggle":se=Sg}var we=(a&4)!==0,Qe=!we&&(t==="scroll"||t==="scrollend"),J=we?te!==null?te+"Capture":null:te;we=[];for(var G=W,Z;G!==null;){var le=G;if(Z=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||Z===null||J===null||(le=Kr(G,J),le!=null&&we.push(En(G,le,Z))),Qe)break;G=G.return}0<we.length&&(te=new se(te,ye,null,n,ne),ce.push({event:te,listeners:we}))}}if((a&7)===0){e:{if(te=t==="mouseover"||t==="pointerover",se=t==="mouseout"||t==="pointerout",te&&n!==Pi&&(ye=n.relatedTarget||n.fromElement)&&(Ys(ye)||ye[qs]))break e;if((se||te)&&(te=ne.window===ne?ne:(te=ne.ownerDocument)?te.defaultView||te.parentWindow:window,se?(ye=n.relatedTarget||n.toElement,se=W,ye=ye?Ys(ye):null,ye!==null&&(Qe=u(ye),we=ye.tag,ye!==Qe||we!==5&&we!==27&&we!==6)&&(ye=null)):(se=null,ye=W),se!==ye)){if(we=Zd,le="onMouseLeave",J="onMouseEnter",G="mouse",(t==="pointerout"||t==="pointerover")&&(we=eu,le="onPointerLeave",J="onPointerEnter",G="pointer"),Qe=se==null?te:Jr(se),Z=ye==null?te:Jr(ye),te=new we(le,G+"leave",se,n,ne),te.target=Qe,te.relatedTarget=Z,le=null,Ys(ne)===W&&(we=new we(J,G+"enter",ye,n,ne),we.target=Z,we.relatedTarget=Qe,le=we),Qe=le,se&&ye)t:{for(we=_x,J=se,G=ye,Z=0,le=J;le;le=we(le))Z++;le=0;for(var je=G;je;je=we(je))le++;for(;0<Z-le;)J=we(J),Z--;for(;0<le-Z;)G=we(G),le--;for(;Z--;){if(J===G||G!==null&&J===G.alternate){we=J;break t}J=we(J),G=we(G)}we=null}else we=null;se!==null&&qm(ce,te,se,we,!1),ye!==null&&Qe!==null&&qm(ce,Qe,ye,we,!0)}}e:{if(te=W?Jr(W):window,se=te.nodeName&&te.nodeName.toLowerCase(),se==="select"||se==="input"&&te.type==="file")var Ie=ou;else if(lu(te))if(cu)Ie=Ug;else{Ie=Rg;var ve=Og}else se=te.nodeName,!se||se.toLowerCase()!=="input"||te.type!=="checkbox"&&te.type!=="radio"?W&&$i(W.elementType)&&(Ie=ou):Ie=Lg;if(Ie&&(Ie=Ie(t,W))){iu(ce,Ie,n,ne);break e}ve&&ve(t,te,W),t==="focusout"&&W&&te.type==="number"&&W.memoizedProps.value!=null&&Vi(te,"number",te.value)}switch(ve=W?Jr(W):window,t){case"focusin":(lu(ve)||ve.contentEditable==="true")&&(tr=ve,to=W,sn=null);break;case"focusout":sn=to=tr=null;break;case"mousedown":ao=!0;break;case"contextmenu":case"mouseup":case"dragend":ao=!1,pu(ce,n,ne);break;case"selectionchange":if(zg)break;case"keydown":case"keyup":pu(ce,n,ne)}var De;if(Xi)e:{switch(t){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else er?ru(t,n)&&(ze="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ze="onCompositionStart");ze&&(tu&&n.locale!=="ko"&&(er||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&er&&(De=Fd()):(Ya=ne,Yi="value"in Ya?Ya.value:Ya.textContent,er=!0)),ve=Xl(W,ze),0<ve.length&&(ze=new Wd(ze,t,null,n,ne),ce.push({event:ze,listeners:ve}),De?ze.data=De:(De=nu(n),De!==null&&(ze.data=De)))),(De=Tg?kg(t,n):Eg(t,n))&&(ze=Xl(W,"onBeforeInput"),0<ze.length&&(ve=new Wd("onBeforeInput","beforeinput",null,n,ne),ce.push({event:ve,listeners:ze}),ve.data=De)),bx(ce,t,W,n,ne)}Hm(ce,a)})}function En(t,a,n){return{instance:t,listener:a,currentTarget:n}}function Xl(t,a){for(var n=a+"Capture",i=[];t!==null;){var d=t,h=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||h===null||(d=Kr(t,n),d!=null&&i.unshift(En(t,d,h)),d=Kr(t,a),d!=null&&i.push(En(t,d,h))),t.tag===3)return i;t=t.return}return[]}function _x(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function qm(t,a,n,i,d){for(var h=a._reactName,p=[];n!==null&&n!==i;){var T=n,I=T.alternate,W=T.stateNode;if(T=T.tag,I!==null&&I===i)break;T!==5&&T!==26&&T!==27||W===null||(I=W,d?(W=Kr(n,h),W!=null&&p.unshift(En(n,W,I))):d||(W=Kr(n,h),W!=null&&p.push(En(n,W,I)))),n=n.return}p.length!==0&&t.push({event:a,listeners:p})}var Sx=/\r\n?/g,Cx=/\u0000|\uFFFD/g;function Ym(t){return(typeof t=="string"?t:""+t).replace(Sx,`
`).replace(Cx,"")}function Qm(t,a){return a=Ym(a),Ym(t)===a}function Ye(t,a,n,i,d,h){switch(n){case"children":typeof i=="string"?a==="body"||a==="textarea"&&i===""||Xs(t,i):(typeof i=="number"||typeof i=="bigint")&&a!=="body"&&Xs(t,""+i);break;case"className":tl(t,"class",i);break;case"tabIndex":tl(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":tl(t,n,i);break;case"style":Qd(t,i,h);break;case"data":if(a!=="object"){tl(t,"data",i);break}case"src":case"href":if(i===""&&(a!=="a"||n!=="href")){t.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=sl(""+i),t.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(n==="formAction"?(a!=="input"&&Ye(t,a,"name",d.name,d,null),Ye(t,a,"formEncType",d.formEncType,d,null),Ye(t,a,"formMethod",d.formMethod,d,null),Ye(t,a,"formTarget",d.formTarget,d,null)):(Ye(t,a,"encType",d.encType,d,null),Ye(t,a,"method",d.method,d,null),Ye(t,a,"target",d.target,d,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=sl(""+i),t.setAttribute(n,i);break;case"onClick":i!=null&&(t.onclick=_a);break;case"onScroll":i!=null&&Ue("scroll",t);break;case"onScrollEnd":i!=null&&Ue("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(n=i.__html,n!=null){if(d.children!=null)throw Error(o(60));t.innerHTML=n}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}n=sl(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""+i):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":i===!0?t.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,i):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(n,i):t.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(n):t.setAttribute(n,i);break;case"popover":Ue("beforetoggle",t),Ue("toggle",t),el(t,"popover",i);break;case"xlinkActuate":wa(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":wa(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":wa(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":wa(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":wa(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":wa(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":wa(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":wa(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":wa(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":el(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=eg.get(n)||n,el(t,n,i))}}function kc(t,a,n,i,d,h){switch(n){case"style":Qd(t,i,h);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(o(61));if(n=i.__html,n!=null){if(d.children!=null)throw Error(o(60));t.innerHTML=n}}break;case"children":typeof i=="string"?Xs(t,i):(typeof i=="number"||typeof i=="bigint")&&Xs(t,""+i);break;case"onScroll":i!=null&&Ue("scroll",t);break;case"onScrollEnd":i!=null&&Ue("scrollend",t);break;case"onClick":i!=null&&(t.onclick=_a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bd.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(d=n.endsWith("Capture"),a=n.slice(2,d?n.length-7:void 0),h=t[At]||null,h=h!=null?h[n]:null,typeof h=="function"&&t.removeEventListener(a,h,d),typeof i=="function")){typeof h!="function"&&h!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(a,i,d);break e}n in t?t[n]=i:i===!0?t.setAttribute(n,""):el(t,n,i)}}}function Nt(t,a,n){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ue("error",t),Ue("load",t);var i=!1,d=!1,h;for(h in n)if(n.hasOwnProperty(h)){var p=n[h];if(p!=null)switch(h){case"src":i=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,a));default:Ye(t,a,h,p,n,null)}}d&&Ye(t,a,"srcSet",n.srcSet,n,null),i&&Ye(t,a,"src",n.src,n,null);return;case"input":Ue("invalid",t);var T=h=p=d=null,I=null,W=null;for(i in n)if(n.hasOwnProperty(i)){var ne=n[i];if(ne!=null)switch(i){case"name":d=ne;break;case"type":p=ne;break;case"checked":I=ne;break;case"defaultChecked":W=ne;break;case"value":h=ne;break;case"defaultValue":T=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(o(137,a));break;default:Ye(t,a,i,ne,n,null)}}Hd(t,h,T,I,W,p,d,!1);return;case"select":Ue("invalid",t),i=p=h=null;for(d in n)if(n.hasOwnProperty(d)&&(T=n[d],T!=null))switch(d){case"value":h=T;break;case"defaultValue":p=T;break;case"multiple":i=T;default:Ye(t,a,d,T,n,null)}a=h,n=p,t.multiple=!!i,a!=null?Fs(t,!!i,a,!1):n!=null&&Fs(t,!!i,n,!0);return;case"textarea":Ue("invalid",t),h=d=i=null;for(p in n)if(n.hasOwnProperty(p)&&(T=n[p],T!=null))switch(p){case"value":i=T;break;case"defaultValue":d=T;break;case"children":h=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(o(91));break;default:Ye(t,a,p,T,n,null)}qd(t,i,d,h);return;case"option":for(I in n)if(n.hasOwnProperty(I)&&(i=n[I],i!=null))switch(I){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Ye(t,a,I,i,n,null)}return;case"dialog":Ue("beforetoggle",t),Ue("toggle",t),Ue("cancel",t),Ue("close",t);break;case"iframe":case"object":Ue("load",t);break;case"video":case"audio":for(i=0;i<kn.length;i++)Ue(kn[i],t);break;case"image":Ue("error",t),Ue("load",t);break;case"details":Ue("toggle",t);break;case"embed":case"source":case"link":Ue("error",t),Ue("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in n)if(n.hasOwnProperty(W)&&(i=n[W],i!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,a));default:Ye(t,a,W,i,n,null)}return;default:if($i(a)){for(ne in n)n.hasOwnProperty(ne)&&(i=n[ne],i!==void 0&&kc(t,a,ne,i,n,void 0));return}}for(T in n)n.hasOwnProperty(T)&&(i=n[T],i!=null&&Ye(t,a,T,i,n,null))}function Tx(t,a,n,i){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,h=null,p=null,T=null,I=null,W=null,ne=null;for(se in n){var ce=n[se];if(n.hasOwnProperty(se)&&ce!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":I=ce;default:i.hasOwnProperty(se)||Ye(t,a,se,null,i,ce)}}for(var te in i){var se=i[te];if(ce=n[te],i.hasOwnProperty(te)&&(se!=null||ce!=null))switch(te){case"type":h=se;break;case"name":d=se;break;case"checked":W=se;break;case"defaultChecked":ne=se;break;case"value":p=se;break;case"defaultValue":T=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(o(137,a));break;default:se!==ce&&Ye(t,a,te,se,i,ce)}}Ii(t,p,T,I,W,ne,h,d);return;case"select":se=p=T=te=null;for(h in n)if(I=n[h],n.hasOwnProperty(h)&&I!=null)switch(h){case"value":break;case"multiple":se=I;default:i.hasOwnProperty(h)||Ye(t,a,h,null,i,I)}for(d in i)if(h=i[d],I=n[d],i.hasOwnProperty(d)&&(h!=null||I!=null))switch(d){case"value":te=h;break;case"defaultValue":T=h;break;case"multiple":p=h;default:h!==I&&Ye(t,a,d,h,i,I)}a=T,n=p,i=se,te!=null?Fs(t,!!n,te,!1):!!i!=!!n&&(a!=null?Fs(t,!!n,a,!0):Fs(t,!!n,n?[]:"",!1));return;case"textarea":se=te=null;for(T in n)if(d=n[T],n.hasOwnProperty(T)&&d!=null&&!i.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Ye(t,a,T,null,i,d)}for(p in i)if(d=i[p],h=n[p],i.hasOwnProperty(p)&&(d!=null||h!=null))switch(p){case"value":te=d;break;case"defaultValue":se=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(o(91));break;default:d!==h&&Ye(t,a,p,d,i,h)}Gd(t,te,se);return;case"option":for(var ye in n)if(te=n[ye],n.hasOwnProperty(ye)&&te!=null&&!i.hasOwnProperty(ye))switch(ye){case"selected":t.selected=!1;break;default:Ye(t,a,ye,null,i,te)}for(I in i)if(te=i[I],se=n[I],i.hasOwnProperty(I)&&te!==se&&(te!=null||se!=null))switch(I){case"selected":t.selected=te&&typeof te!="function"&&typeof te!="symbol";break;default:Ye(t,a,I,te,i,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var we in n)te=n[we],n.hasOwnProperty(we)&&te!=null&&!i.hasOwnProperty(we)&&Ye(t,a,we,null,i,te);for(W in i)if(te=i[W],se=n[W],i.hasOwnProperty(W)&&te!==se&&(te!=null||se!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(o(137,a));break;default:Ye(t,a,W,te,i,se)}return;default:if($i(a)){for(var Qe in n)te=n[Qe],n.hasOwnProperty(Qe)&&te!==void 0&&!i.hasOwnProperty(Qe)&&kc(t,a,Qe,void 0,i,te);for(ne in i)te=i[ne],se=n[ne],!i.hasOwnProperty(ne)||te===se||te===void 0&&se===void 0||kc(t,a,ne,te,i,se);return}}for(var J in n)te=n[J],n.hasOwnProperty(J)&&te!=null&&!i.hasOwnProperty(J)&&Ye(t,a,J,null,i,te);for(ce in i)te=i[ce],se=n[ce],!i.hasOwnProperty(ce)||te===se||te==null&&se==null||Ye(t,a,ce,te,i,se)}function Jm(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function kx(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var d=n[i],h=d.transferSize,p=d.initiatorType,T=d.duration;if(h&&T&&Jm(p)){for(p=0,T=d.responseEnd,i+=1;i<n.length;i++){var I=n[i],W=I.startTime;if(W>T)break;var ne=I.transferSize,ce=I.initiatorType;ne&&Jm(ce)&&(I=I.responseEnd,p+=ne*(I<T?1:(T-W)/(I-W)))}if(--i,a+=8*(h+p)/(d.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Ec=null,Dc=null;function Zl(t){return t.nodeType===9?t:t.ownerDocument}function Km(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Fm(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function Ac(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Oc=null;function Ex(){var t=window.event;return t&&t.type==="popstate"?t===Oc?!1:(Oc=t,!0):(Oc=null,!1)}var Xm=typeof setTimeout=="function"?setTimeout:void 0,Dx=typeof clearTimeout=="function"?clearTimeout:void 0,Zm=typeof Promise=="function"?Promise:void 0,Ax=typeof queueMicrotask=="function"?queueMicrotask:typeof Zm<"u"?function(t){return Zm.resolve(null).then(t).catch(Ox)}:Xm;function Ox(t){setTimeout(function(){throw t})}function cs(t){return t==="head"}function Wm(t,a){var n=a,i=0;do{var d=n.nextSibling;if(t.removeChild(n),d&&d.nodeType===8)if(n=d.data,n==="/$"||n==="/&"){if(i===0){t.removeChild(d),kr(a);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")Dn(t.ownerDocument.documentElement);else if(n==="head"){n=t.ownerDocument.head,Dn(n);for(var h=n.firstChild;h;){var p=h.nextSibling,T=h.nodeName;h[Qr]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&h.rel.toLowerCase()==="stylesheet"||n.removeChild(h),h=p}}else n==="body"&&Dn(t.ownerDocument.body);n=d}while(n);kr(a)}function e0(t,a){var n=t;t=0;do{var i=n.nextSibling;if(n.nodeType===1?a?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(a?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(t===0)break;t--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||t++;n=i}while(n)}function Rc(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var n=a;switch(a=a.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Rc(n),zi(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function Rx(t,a,n,i){for(;t.nodeType===1;){var d=n;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[Qr])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(h=t.getAttribute("rel"),h==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(h!==d.rel||t.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||t.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||t.getAttribute("title")!==(d.title==null?null:d.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(h=t.getAttribute("src"),(h!==(d.src==null?null:d.src)||t.getAttribute("type")!==(d.type==null?null:d.type)||t.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&h&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var h=d.name==null?null:""+d.name;if(d.type==="hidden"&&t.getAttribute("name")===h)return t}else return t;if(t=ia(t.nextSibling),t===null)break}return null}function Lx(t,a,n){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=ia(t.nextSibling),t===null))return null;return t}function t0(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=ia(t.nextSibling),t===null))return null;return t}function Lc(t){return t.data==="$?"||t.data==="$~"}function Uc(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function Ux(t,a){var n=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||n.readyState!=="loading")a();else{var i=function(){a(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function ia(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var Mc=null;function a0(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"||n==="/&"){if(a===0)return ia(t.nextSibling);a--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||a++}t=t.nextSibling}return null}function s0(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(a===0)return t;a--}else n!=="/$"&&n!=="/&"||a++}t=t.previousSibling}return null}function r0(t,a,n){switch(a=Zl(n),t){case"html":if(t=a.documentElement,!t)throw Error(o(452));return t;case"head":if(t=a.head,!t)throw Error(o(453));return t;case"body":if(t=a.body,!t)throw Error(o(454));return t;default:throw Error(o(451))}}function Dn(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);zi(t)}var oa=new Map,n0=new Set;function Wl(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Va=ae.d;ae.d={f:Mx,r:zx,D:Bx,C:Ix,L:Vx,m:$x,X:Hx,S:Px,M:Gx};function Mx(){var t=Va.f(),a=Gl();return t||a}function zx(t){var a=Qs(t);a!==null&&a.tag===5&&a.type==="form"?Nh(a):Va.r(t)}var Sr=typeof document>"u"?null:document;function l0(t,a,n){var i=Sr;if(i&&typeof a=="string"&&a){var d=ea(a);d='link[rel="'+t+'"][href="'+d+'"]',typeof n=="string"&&(d+='[crossorigin="'+n+'"]'),n0.has(d)||(n0.add(d),t={rel:t,crossOrigin:n,href:a},i.querySelector(d)===null&&(a=i.createElement("link"),Nt(a,"link",t),xt(a),i.head.appendChild(a)))}}function Bx(t){Va.D(t),l0("dns-prefetch",t,null)}function Ix(t,a){Va.C(t,a),l0("preconnect",t,a)}function Vx(t,a,n){Va.L(t,a,n);var i=Sr;if(i&&t&&a){var d='link[rel="preload"][as="'+ea(a)+'"]';a==="image"&&n&&n.imageSrcSet?(d+='[imagesrcset="'+ea(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(d+='[imagesizes="'+ea(n.imageSizes)+'"]')):d+='[href="'+ea(t)+'"]';var h=d;switch(a){case"style":h=Cr(t);break;case"script":h=Tr(t)}oa.has(h)||(t=_({rel:"preload",href:a==="image"&&n&&n.imageSrcSet?void 0:t,as:a},n),oa.set(h,t),i.querySelector(d)!==null||a==="style"&&i.querySelector(An(h))||a==="script"&&i.querySelector(On(h))||(a=i.createElement("link"),Nt(a,"link",t),xt(a),i.head.appendChild(a)))}}function $x(t,a){Va.m(t,a);var n=Sr;if(n&&t){var i=a&&typeof a.as=="string"?a.as:"script",d='link[rel="modulepreload"][as="'+ea(i)+'"][href="'+ea(t)+'"]',h=d;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Tr(t)}if(!oa.has(h)&&(t=_({rel:"modulepreload",href:t},a),oa.set(h,t),n.querySelector(d)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(On(h)))return}i=n.createElement("link"),Nt(i,"link",t),xt(i),n.head.appendChild(i)}}}function Px(t,a,n){Va.S(t,a,n);var i=Sr;if(i&&t){var d=Js(i).hoistableStyles,h=Cr(t);a=a||"default";var p=d.get(h);if(!p){var T={loading:0,preload:null};if(p=i.querySelector(An(h)))T.loading=5;else{t=_({rel:"stylesheet",href:t,"data-precedence":a},n),(n=oa.get(h))&&zc(t,n);var I=p=i.createElement("link");xt(I),Nt(I,"link",t),I._p=new Promise(function(W,ne){I.onload=W,I.onerror=ne}),I.addEventListener("load",function(){T.loading|=1}),I.addEventListener("error",function(){T.loading|=2}),T.loading|=4,ei(p,a,i)}p={type:"stylesheet",instance:p,count:1,state:T},d.set(h,p)}}}function Hx(t,a){Va.X(t,a);var n=Sr;if(n&&t){var i=Js(n).hoistableScripts,d=Tr(t),h=i.get(d);h||(h=n.querySelector(On(d)),h||(t=_({src:t,async:!0},a),(a=oa.get(d))&&Bc(t,a),h=n.createElement("script"),xt(h),Nt(h,"link",t),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(d,h))}}function Gx(t,a){Va.M(t,a);var n=Sr;if(n&&t){var i=Js(n).hoistableScripts,d=Tr(t),h=i.get(d);h||(h=n.querySelector(On(d)),h||(t=_({src:t,async:!0,type:"module"},a),(a=oa.get(d))&&Bc(t,a),h=n.createElement("script"),xt(h),Nt(h,"link",t),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(d,h))}}function i0(t,a,n,i){var d=(d=oe.current)?Wl(d):null;if(!d)throw Error(o(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(a=Cr(n.href),n=Js(d).hoistableStyles,i=n.get(a),i||(i={type:"style",instance:null,count:0,state:null},n.set(a,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=Cr(n.href);var h=Js(d).hoistableStyles,p=h.get(t);if(p||(d=d.ownerDocument||d,p={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(t,p),(h=d.querySelector(An(t)))&&!h._p&&(p.instance=h,p.state.loading=5),oa.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},oa.set(t,n),h||qx(d,t,n,p.state))),a&&i===null)throw Error(o(528,""));return p}if(a&&i!==null)throw Error(o(529,""));return null;case"script":return a=n.async,n=n.src,typeof n=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Tr(n),n=Js(d).hoistableScripts,i=n.get(a),i||(i={type:"script",instance:null,count:0,state:null},n.set(a,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,t))}}function Cr(t){return'href="'+ea(t)+'"'}function An(t){return'link[rel="stylesheet"]['+t+"]"}function o0(t){return _({},t,{"data-precedence":t.precedence,precedence:null})}function qx(t,a,n,i){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?i.loading=1:(a=t.createElement("link"),i.preload=a,a.addEventListener("load",function(){return i.loading|=1}),a.addEventListener("error",function(){return i.loading|=2}),Nt(a,"link",n),xt(a),t.head.appendChild(a))}function Tr(t){return'[src="'+ea(t)+'"]'}function On(t){return"script[async]"+t}function c0(t,a,n){if(a.count++,a.instance===null)switch(a.type){case"style":var i=t.querySelector('style[data-href~="'+ea(n.href)+'"]');if(i)return a.instance=i,xt(i),i;var d=_({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),xt(i),Nt(i,"style",d),ei(i,n.precedence,t),a.instance=i;case"stylesheet":d=Cr(n.href);var h=t.querySelector(An(d));if(h)return a.state.loading|=4,a.instance=h,xt(h),h;i=o0(n),(d=oa.get(d))&&zc(i,d),h=(t.ownerDocument||t).createElement("link"),xt(h);var p=h;return p._p=new Promise(function(T,I){p.onload=T,p.onerror=I}),Nt(h,"link",i),a.state.loading|=4,ei(h,n.precedence,t),a.instance=h;case"script":return h=Tr(n.src),(d=t.querySelector(On(h)))?(a.instance=d,xt(d),d):(i=n,(d=oa.get(h))&&(i=_({},n),Bc(i,d)),t=t.ownerDocument||t,d=t.createElement("script"),xt(d),Nt(d,"link",i),t.head.appendChild(d),a.instance=d);case"void":return null;default:throw Error(o(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(i=a.instance,a.state.loading|=4,ei(i,n.precedence,t));return a.instance}function ei(t,a,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=i.length?i[i.length-1]:null,h=d,p=0;p<i.length;p++){var T=i[p];if(T.dataset.precedence===a)h=T;else if(h!==d)break}h?h.parentNode.insertBefore(t,h.nextSibling):(a=n.nodeType===9?n.head:n,a.insertBefore(t,a.firstChild))}function zc(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function Bc(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var ti=null;function d0(t,a,n){if(ti===null){var i=new Map,d=ti=new Map;d.set(n,i)}else d=ti,i=d.get(n),i||(i=new Map,d.set(n,i));if(i.has(t))return i;for(i.set(t,null),n=n.getElementsByTagName(t),d=0;d<n.length;d++){var h=n[d];if(!(h[Qr]||h[yt]||t==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var p=h.getAttribute(a)||"";p=t+p;var T=i.get(p);T?T.push(h):i.set(p,[h])}}return i}function u0(t,a,n){t=t.ownerDocument||t,t.head.insertBefore(n,a==="title"?t.querySelector("head > title"):null)}function Yx(t,a,n){if(n===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return t=a.disabled,typeof a.precedence=="string"&&t==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function h0(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Qx(t,a,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var d=Cr(i.href),h=a.querySelector(An(d));if(h){a=h._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=ai.bind(t),a.then(t,t)),n.state.loading|=4,n.instance=h,xt(h);return}h=a.ownerDocument||a,i=o0(i),(d=oa.get(d))&&zc(i,d),h=h.createElement("link"),xt(h);var p=h;p._p=new Promise(function(T,I){p.onload=T,p.onerror=I}),Nt(h,"link",i),n.instance=h}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(n,a),(a=n.state.preload)&&(n.state.loading&3)===0&&(t.count++,n=ai.bind(t),a.addEventListener("load",n),a.addEventListener("error",n))}}var Ic=0;function Jx(t,a){return t.stylesheets&&t.count===0&&ri(t,t.stylesheets),0<t.count||0<t.imgCount?function(n){var i=setTimeout(function(){if(t.stylesheets&&ri(t,t.stylesheets),t.unsuspend){var h=t.unsuspend;t.unsuspend=null,h()}},6e4+a);0<t.imgBytes&&Ic===0&&(Ic=62500*kx());var d=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&ri(t,t.stylesheets),t.unsuspend)){var h=t.unsuspend;t.unsuspend=null,h()}},(t.imgBytes>Ic?50:800)+a);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(i),clearTimeout(d)}}:null}function ai(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ri(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var si=null;function ri(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,si=new Map,a.forEach(Kx,t),si=null,ai.call(t))}function Kx(t,a){if(!(a.state.loading&4)){var n=si.get(t);if(n)var i=n.get(null);else{n=new Map,si.set(t,n);for(var d=t.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<d.length;h++){var p=d[h];(p.nodeName==="LINK"||p.getAttribute("media")!=="not all")&&(n.set(p.dataset.precedence,p),i=p)}i&&n.set(null,i)}d=a.instance,p=d.getAttribute("data-precedence"),h=n.get(p)||i,h===i&&n.set(null,d),n.set(p,d),this.count++,i=ai.bind(this),d.addEventListener("load",i),d.addEventListener("error",i),h?h.parentNode.insertBefore(d,h.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(d,t.firstChild)),a.state.loading|=4}}var Rn={$$typeof:Q,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function Fx(t,a,n,i,d,h,p,T,I){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ri(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ri(0),this.hiddenUpdates=Ri(null),this.identifierPrefix=i,this.onUncaughtError=d,this.onCaughtError=h,this.onRecoverableError=p,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function m0(t,a,n,i,d,h,p,T,I,W,ne,ce){return t=new Fx(t,a,n,p,I,W,ne,ce,T),a=1,h===!0&&(a|=24),h=Ht(3,null,null,a),t.current=h,h.stateNode=t,a=yo(),a.refCount++,t.pooledCache=a,a.refCount++,h.memoizedState={element:i,isDehydrated:n,cache:a},No(h),t}function f0(t){return t?(t=rr,t):rr}function g0(t,a,n,i,d,h){d=f0(d),i.context===null?i.context=d:i.pendingContext=d,i=Za(a),i.payload={element:n},h=h===void 0?null:h,h!==null&&(i.callback=h),n=Wa(t,i,a),n!==null&&(zt(n,t,a),un(n,t,a))}function x0(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<a?n:a}}function Vc(t,a){x0(t,a),(t=t.alternate)&&x0(t,a)}function p0(t){if(t.tag===13||t.tag===31){var a=_s(t,67108864);a!==null&&zt(a,t,67108864),Vc(t,67108864)}}function y0(t){if(t.tag===13||t.tag===31){var a=Jt();a=Li(a);var n=_s(t,a);n!==null&&zt(n,t,a),Vc(t,a)}}var ni=!0;function Xx(t,a,n,i){var d=P.T;P.T=null;var h=ae.p;try{ae.p=2,$c(t,a,n,i)}finally{ae.p=h,P.T=d}}function Zx(t,a,n,i){var d=P.T;P.T=null;var h=ae.p;try{ae.p=8,$c(t,a,n,i)}finally{ae.p=h,P.T=d}}function $c(t,a,n,i){if(ni){var d=Pc(i);if(d===null)Tc(t,a,i,li,n),b0(t,i);else if(ep(d,t,a,n,i))i.stopPropagation();else if(b0(t,i),a&4&&-1<Wx.indexOf(t)){for(;d!==null;){var h=Qs(d);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var p=vs(h.pendingLanes);if(p!==0){var T=h;for(T.pendingLanes|=2,T.entangledLanes|=2;p;){var I=1<<31-$t(p);T.entanglements[1]|=I,p&=~I}ba(h),($e&6)===0&&(Pl=It()+500,Tn(0))}}break;case 31:case 13:T=_s(h,2),T!==null&&zt(T,h,2),Gl(),Vc(h,2)}if(h=Pc(i),h===null&&Tc(t,a,i,li,n),h===d)break;d=h}d!==null&&i.stopPropagation()}else Tc(t,a,i,null,n)}}function Pc(t){return t=Hi(t),Hc(t)}var li=null;function Hc(t){if(li=null,t=Ys(t),t!==null){var a=u(t);if(a===null)t=null;else{var n=a.tag;if(n===13){if(t=m(a),t!==null)return t;t=null}else if(n===31){if(t=g(a),t!==null)return t;t=null}else if(n===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return li=t,null}function v0(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bf()){case Td:return 2;case kd:return 8;case Kn:case If:return 32;case Ed:return 268435456;default:return 32}default:return 32}}var Gc=!1,ds=null,us=null,hs=null,Ln=new Map,Un=new Map,ms=[],Wx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b0(t,a){switch(t){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":us=null;break;case"mouseover":case"mouseout":hs=null;break;case"pointerover":case"pointerout":Ln.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Un.delete(a.pointerId)}}function Mn(t,a,n,i,d,h){return t===null||t.nativeEvent!==h?(t={blockedOn:a,domEventName:n,eventSystemFlags:i,nativeEvent:h,targetContainers:[d]},a!==null&&(a=Qs(a),a!==null&&p0(a)),t):(t.eventSystemFlags|=i,a=t.targetContainers,d!==null&&a.indexOf(d)===-1&&a.push(d),t)}function ep(t,a,n,i,d){switch(a){case"focusin":return ds=Mn(ds,t,a,n,i,d),!0;case"dragenter":return us=Mn(us,t,a,n,i,d),!0;case"mouseover":return hs=Mn(hs,t,a,n,i,d),!0;case"pointerover":var h=d.pointerId;return Ln.set(h,Mn(Ln.get(h)||null,t,a,n,i,d)),!0;case"gotpointercapture":return h=d.pointerId,Un.set(h,Mn(Un.get(h)||null,t,a,n,i,d)),!0}return!1}function j0(t){var a=Ys(t.target);if(a!==null){var n=u(a);if(n!==null){if(a=n.tag,a===13){if(a=m(n),a!==null){t.blockedOn=a,Ud(t.priority,function(){y0(n)});return}}else if(a===31){if(a=g(n),a!==null){t.blockedOn=a,Ud(t.priority,function(){y0(n)});return}}else if(a===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ii(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var n=Pc(t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Pi=i,n.target.dispatchEvent(i),Pi=null}else return a=Qs(n),a!==null&&p0(a),t.blockedOn=n,!1;a.shift()}return!0}function N0(t,a,n){ii(t)&&n.delete(a)}function tp(){Gc=!1,ds!==null&&ii(ds)&&(ds=null),us!==null&&ii(us)&&(us=null),hs!==null&&ii(hs)&&(hs=null),Ln.forEach(N0),Un.forEach(N0)}function oi(t,a){t.blockedOn===a&&(t.blockedOn=null,Gc||(Gc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,tp)))}var ci=null;function w0(t){ci!==t&&(ci=t,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){ci===t&&(ci=null);for(var a=0;a<t.length;a+=3){var n=t[a],i=t[a+1],d=t[a+2];if(typeof i!="function"){if(Hc(i||n)===null)continue;break}var h=Qs(n);h!==null&&(t.splice(a,3),a-=3,Po(h,{pending:!0,data:d,method:n.method,action:i},i,d))}}))}function kr(t){function a(I){return oi(I,t)}ds!==null&&oi(ds,t),us!==null&&oi(us,t),hs!==null&&oi(hs,t),Ln.forEach(a),Un.forEach(a);for(var n=0;n<ms.length;n++){var i=ms[n];i.blockedOn===t&&(i.blockedOn=null)}for(;0<ms.length&&(n=ms[0],n.blockedOn===null);)j0(n),n.blockedOn===null&&ms.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var d=n[i],h=n[i+1],p=d[At]||null;if(typeof h=="function")p||w0(n);else if(p){var T=null;if(h&&h.hasAttribute("formAction")){if(d=h,p=h[At]||null)T=p.formAction;else if(Hc(d)!==null)continue}else T=p.action;typeof T=="function"?n[i+1]=T:(n.splice(i,3),i-=3),w0(n)}}}function _0(){function t(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(p){return d=p})},focusReset:"manual",scroll:"manual"})}function a(){d!==null&&(d(),d=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,d=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),d!==null&&(d(),d=null)}}}function qc(t){this._internalRoot=t}di.prototype.render=qc.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(o(409));var n=a.current,i=Jt();g0(n,i,t,a,null,null)},di.prototype.unmount=qc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;g0(t.current,2,null,t,null,null),Gl(),a[qs]=null}};function di(t){this._internalRoot=t}di.prototype.unstable_scheduleHydration=function(t){if(t){var a=Ld();t={blockedOn:null,target:t,priority:a};for(var n=0;n<ms.length&&a!==0&&a<ms[n].priority;n++);ms.splice(n,0,t),n===0&&j0(t)}};var S0=s.version;if(S0!=="19.2.3")throw Error(o(527,S0,"19.2.3"));ae.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=x(a),t=t!==null?y(t):null,t=t===null?null:t.stateNode,t};var ap={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ui=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ui.isDisabled&&ui.supportsFiber)try{Gr=ui.inject(ap),Vt=ui}catch{}}return Bn.createRoot=function(t,a){if(!c(t))throw Error(o(299));var n=!1,i="",d=Oh,h=Rh,p=Lh;return a!=null&&(a.unstable_strictMode===!0&&(n=!0),a.identifierPrefix!==void 0&&(i=a.identifierPrefix),a.onUncaughtError!==void 0&&(d=a.onUncaughtError),a.onCaughtError!==void 0&&(h=a.onCaughtError),a.onRecoverableError!==void 0&&(p=a.onRecoverableError)),a=m0(t,1,!1,null,null,n,i,null,d,h,p,_0),t[qs]=a.current,Cc(t),new qc(a)},Bn.hydrateRoot=function(t,a,n){if(!c(t))throw Error(o(299));var i=!1,d="",h=Oh,p=Rh,T=Lh,I=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(T=n.onRecoverableError),n.formState!==void 0&&(I=n.formState)),a=m0(t,1,!0,a,n??null,i,d,I,h,p,T,_0),a.context=f0(null),n=a.current,i=Jt(),i=Li(i),d=Za(i),d.callback=null,Wa(n,d,i),n=i,a.current.lanes=n,Yr(a,n),ba(a),t[qs]=a.current,Cc(t),new di(a)},Bn.version="19.2.3",Bn}var U0;function mp(){if(U0)return Jc.exports;U0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(s){console.error(s)}}return r(),Jc.exports=hp(),Jc.exports}var fp=mp();const gp=uf(fp);function Ci(r,s){var l={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&s.indexOf(o)<0&&(l[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(r);c<o.length;c++)s.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(r,o[c])&&(l[o[c]]=r[o[c]]);return l}function xp(r,s,l,o){function c(u){return u instanceof l?u:new l(function(m){m(u)})}return new(l||(l=Promise))(function(u,m){function g(y){try{x(o.next(y))}catch(_){m(_)}}function f(y){try{x(o.throw(y))}catch(_){m(_)}}function x(y){y.done?u(y.value):c(y.value).then(g,f)}x((o=o.apply(r,s||[])).next())})}const pp=r=>r?(...s)=>r(...s):(...s)=>fetch(...s);class jd extends Error{constructor(s,l="FunctionsError",o){super(s),this.name=l,this.context=o}}class yp extends jd{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class M0 extends jd{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class z0 extends jd{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var od;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(od||(od={}));class vp{constructor(s,{headers:l={},customFetch:o,region:c=od.Any}={}){this.url=s,this.headers=l,this.region=c,this.fetch=pp(o)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s){return xp(this,arguments,void 0,function*(l,o={}){var c;let u,m;try{const{headers:g,method:f,body:x,signal:y,timeout:_}=o;let k={},{region:S}=o;S||(S=this.region);const w=new URL(`${this.url}/${l}`);S&&S!=="any"&&(k["x-region"]=S,w.searchParams.set("forceFunctionRegion",S));let v;x&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&x instanceof Blob||x instanceof ArrayBuffer?(k["Content-Type"]="application/octet-stream",v=x):typeof x=="string"?(k["Content-Type"]="text/plain",v=x):typeof FormData<"u"&&x instanceof FormData?v=x:(k["Content-Type"]="application/json",v=JSON.stringify(x)):x&&typeof x!="string"&&!(typeof Blob<"u"&&x instanceof Blob)&&!(x instanceof ArrayBuffer)&&!(typeof FormData<"u"&&x instanceof FormData)?v=JSON.stringify(x):v=x;let j=y;_&&(m=new AbortController,u=setTimeout(()=>m.abort(),_),y?(j=m.signal,y.addEventListener("abort",()=>m.abort())):j=m.signal);const U=yield this.fetch(w.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},k),this.headers),g),body:v,signal:j}).catch(N=>{throw new yp(N)}),q=U.headers.get("x-relay-error");if(q&&q==="true")throw new M0(U);if(!U.ok)throw new z0(U);let Q=((c=U.headers.get("Content-Type"))!==null&&c!==void 0?c:"text/plain").split(";")[0].trim(),C;return Q==="application/json"?C=yield U.json():Q==="application/octet-stream"||Q==="application/pdf"?C=yield U.blob():Q==="text/event-stream"?C=U:Q==="multipart/form-data"?C=yield U.formData():C=yield U.text(),{data:C,error:null,response:U}}catch(g){return{data:null,error:g,response:g instanceof z0||g instanceof M0?g.context:void 0}}finally{u&&clearTimeout(u)}})}}var bp=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}},jp=class{constructor(r){var s,l;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(s=r.shouldThrowOnError)!==null&&s!==void 0?s:!1,this.signal=r.signal,this.isMaybeSingle=(l=r.isMaybeSingle)!==null&&l!==void 0?l:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,s){return this.headers=new Headers(this.headers),this.headers.set(r,s),this}then(r,s){var l=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let c=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{let m=null,g=null,f=null,x=u.status,y=u.statusText;if(u.ok){var _,k;if(l.method!=="HEAD"){var S;const U=await u.text();U===""||(l.headers.get("Accept")==="text/csv"||l.headers.get("Accept")&&(!((S=l.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?g=U:g=JSON.parse(U))}const v=(_=l.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),j=(k=u.headers.get("content-range"))===null||k===void 0?void 0:k.split("/");v&&j&&j.length>1&&(f=parseInt(j[1])),l.isMaybeSingle&&l.method==="GET"&&Array.isArray(g)&&(g.length>1?(m={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,f=null,x=406,y="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{var w;const v=await u.text();try{m=JSON.parse(v),Array.isArray(m)&&u.status===404&&(g=[],m=null,x=200,y="OK")}catch{u.status===404&&v===""?(x=204,y="No Content"):m={message:v}}if(m&&l.isMaybeSingle&&(!(m==null||(w=m.details)===null||w===void 0)&&w.includes("0 rows"))&&(m=null,x=200,y="OK"),m&&l.shouldThrowOnError)throw new bp(m)}return{error:m,data:g,count:f,status:x,statusText:y}});return this.shouldThrowOnError||(c=c.catch(u=>{var m;let g="";const f=u==null?void 0:u.cause;if(f){var x,y,_,k;const w=(x=f==null?void 0:f.message)!==null&&x!==void 0?x:"",v=(y=f==null?void 0:f.code)!==null&&y!==void 0?y:"";g=`${(_=u==null?void 0:u.name)!==null&&_!==void 0?_:"FetchError"}: ${u==null?void 0:u.message}`,g+=`

Caused by: ${(k=f==null?void 0:f.name)!==null&&k!==void 0?k:"Error"}: ${w}`,v&&(g+=` (${v})`),f!=null&&f.stack&&(g+=`
${f.stack}`)}else{var S;g=(S=u==null?void 0:u.stack)!==null&&S!==void 0?S:""}return{error:{message:`${(m=u==null?void 0:u.name)!==null&&m!==void 0?m:"FetchError"}: ${u==null?void 0:u.message}`,details:g,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),c.then(r,s)}returns(){return this}overrideTypes(){return this}},Np=class extends jp{select(r){let s=!1;const l=(r??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:s=!0,nullsFirst:l,foreignTable:o,referencedTable:c=o}={}){const u=c?`${c}.order`:"order",m=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${m?`${m},`:""}${r}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:s,referencedTable:l=s}={}){const o=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(o,`${r}`),this}range(r,s,{foreignTable:l,referencedTable:o=l}={}){const c=typeof o>"u"?"offset":`${o}.offset`,u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${r}`),this.url.searchParams.set(u,`${s-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:s=!1,settings:l=!1,buffers:o=!1,wal:c=!1,format:u="text"}={}){var m;const g=[r?"analyze":null,s?"verbose":null,l?"settings":null,o?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${g};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}};const B0=new RegExp("[,()]");var Mr=class extends Np{eq(r,s){return this.url.searchParams.append(r,`eq.${s}`),this}neq(r,s){return this.url.searchParams.append(r,`neq.${s}`),this}gt(r,s){return this.url.searchParams.append(r,`gt.${s}`),this}gte(r,s){return this.url.searchParams.append(r,`gte.${s}`),this}lt(r,s){return this.url.searchParams.append(r,`lt.${s}`),this}lte(r,s){return this.url.searchParams.append(r,`lte.${s}`),this}like(r,s){return this.url.searchParams.append(r,`like.${s}`),this}likeAllOf(r,s){return this.url.searchParams.append(r,`like(all).{${s.join(",")}}`),this}likeAnyOf(r,s){return this.url.searchParams.append(r,`like(any).{${s.join(",")}}`),this}ilike(r,s){return this.url.searchParams.append(r,`ilike.${s}`),this}ilikeAllOf(r,s){return this.url.searchParams.append(r,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(r,s){return this.url.searchParams.append(r,`ilike(any).{${s.join(",")}}`),this}regexMatch(r,s){return this.url.searchParams.append(r,`match.${s}`),this}regexIMatch(r,s){return this.url.searchParams.append(r,`imatch.${s}`),this}is(r,s){return this.url.searchParams.append(r,`is.${s}`),this}isDistinct(r,s){return this.url.searchParams.append(r,`isdistinct.${s}`),this}in(r,s){const l=Array.from(new Set(s)).map(o=>typeof o=="string"&&B0.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`in.(${l})`),this}notIn(r,s){const l=Array.from(new Set(s)).map(o=>typeof o=="string"&&B0.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`not.in.(${l})`),this}contains(r,s){return typeof s=="string"?this.url.searchParams.append(r,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(r,`cs.{${s.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(s)}`),this}containedBy(r,s){return typeof s=="string"?this.url.searchParams.append(r,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(r,`cd.{${s.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(s)}`),this}rangeGt(r,s){return this.url.searchParams.append(r,`sr.${s}`),this}rangeGte(r,s){return this.url.searchParams.append(r,`nxl.${s}`),this}rangeLt(r,s){return this.url.searchParams.append(r,`sl.${s}`),this}rangeLte(r,s){return this.url.searchParams.append(r,`nxr.${s}`),this}rangeAdjacent(r,s){return this.url.searchParams.append(r,`adj.${s}`),this}overlaps(r,s){return typeof s=="string"?this.url.searchParams.append(r,`ov.${s}`):this.url.searchParams.append(r,`ov.{${s.join(",")}}`),this}textSearch(r,s,{config:l,type:o}={}){let c="";o==="plain"?c="pl":o==="phrase"?c="ph":o==="websearch"&&(c="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(r,`${c}fts${u}.${s}`),this}match(r){return Object.entries(r).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(r,s,l){return this.url.searchParams.append(r,`not.${s}.${l}`),this}or(r,{foreignTable:s,referencedTable:l=s}={}){const o=l?`${l}.or`:"or";return this.url.searchParams.append(o,`(${r})`),this}filter(r,s,l){return this.url.searchParams.append(r,`${s}.${l}`),this}},wp=class{constructor(r,{headers:s={},schema:l,fetch:o}){this.url=r,this.headers=new Headers(s),this.schema=l,this.fetch=o}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(r,s){const{head:l=!1,count:o}=s??{},c=l?"HEAD":"GET";let u=!1;const m=(r??"*").split("").map(x=>/\s/.test(x)&&!u?"":(x==='"'&&(u=!u),x)).join(""),{url:g,headers:f}=this.cloneRequestState();return g.searchParams.set("select",m),o&&f.append("Prefer",`count=${o}`),new Mr({method:c,url:g,headers:f,schema:this.schema,fetch:this.fetch})}insert(r,{count:s,defaultToNull:l=!0}={}){var o;const c="POST",{url:u,headers:m}=this.cloneRequestState();if(s&&m.append("Prefer",`count=${s}`),l||m.append("Prefer","missing=default"),Array.isArray(r)){const g=r.reduce((f,x)=>f.concat(Object.keys(x)),[]);if(g.length>0){const f=[...new Set(g)].map(x=>`"${x}"`);u.searchParams.set("columns",f.join(","))}}return new Mr({method:c,url:u,headers:m,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(r,{onConflict:s,ignoreDuplicates:l=!1,count:o,defaultToNull:c=!0}={}){var u;const m="POST",{url:g,headers:f}=this.cloneRequestState();if(f.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),s!==void 0&&g.searchParams.set("on_conflict",s),o&&f.append("Prefer",`count=${o}`),c||f.append("Prefer","missing=default"),Array.isArray(r)){const x=r.reduce((y,_)=>y.concat(Object.keys(_)),[]);if(x.length>0){const y=[...new Set(x)].map(_=>`"${_}"`);g.searchParams.set("columns",y.join(","))}}return new Mr({method:m,url:g,headers:f,schema:this.schema,body:r,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(r,{count:s}={}){var l;const o="PATCH",{url:c,headers:u}=this.cloneRequestState();return s&&u.append("Prefer",`count=${s}`),new Mr({method:o,url:c,headers:u,schema:this.schema,body:r,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:r}={}){var s;const l="DELETE",{url:o,headers:c}=this.cloneRequestState();return r&&c.append("Prefer",`count=${r}`),new Mr({method:l,url:o,headers:c,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}},_p=class hf{constructor(s,{headers:l={},schema:o,fetch:c}={}){this.url=s,this.headers=new Headers(l),this.schemaName=o,this.fetch=c}from(s){if(!s||typeof s!="string"||s.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new wp(new URL(`${this.url}/${s}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new hf(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,l={},{head:o=!1,get:c=!1,count:u}={}){var m;let g;const f=new URL(`${this.url}/rpc/${s}`);let x;const y=S=>S!==null&&typeof S=="object"&&(!Array.isArray(S)||S.some(y)),_=o&&Object.values(l).some(y);_?(g="POST",x=l):o||c?(g=o?"HEAD":"GET",Object.entries(l).filter(([S,w])=>w!==void 0).map(([S,w])=>[S,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([S,w])=>{f.searchParams.append(S,w)})):(g="POST",x=l);const k=new Headers(this.headers);return _?k.set("Prefer",u?`count=${u},return=minimal`:"return=minimal"):u&&k.set("Prefer",`count=${u}`),new Mr({method:g,url:f,headers:k,schema:this.schemaName,body:x,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}};class Sp{constructor(){}static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const l=globalThis.process;if(l){const o=l.versions;if(o&&o.node){const c=o.node,u=parseInt(c.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let l=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(l+=`

Suggested solution: ${s.workaround}`),new Error(l)}static createWebSocket(s,l){const o=this.getWebSocketConstructor();return new o(s,l)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const Cp="2.91.0",Tp=`realtime-js/${Cp}`,kp="1.0.0",mf="2.0.0",I0=mf,cd=1e4,Ep=1e3,Dp=100;var gs;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(gs||(gs={}));var gt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(gt||(gt={}));var ga;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(ga||(ga={}));var dd;(function(r){r.websocket="websocket"})(dd||(dd={}));var Vs;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Vs||(Vs={}));class Ap{constructor(s){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=s??[]}encode(s,l){if(s.event===this.BROADCAST_EVENT&&!(s.payload instanceof ArrayBuffer)&&typeof s.payload.event=="string")return l(this._binaryEncodeUserBroadcastPush(s));let o=[s.join_ref,s.ref,s.topic,s.event,s.payload];return l(JSON.stringify(o))}_binaryEncodeUserBroadcastPush(s){var l;return this._isArrayBuffer((l=s.payload)===null||l===void 0?void 0:l.payload)?this._encodeBinaryUserBroadcastPush(s):this._encodeJsonUserBroadcastPush(s)}_encodeBinaryUserBroadcastPush(s){var l,o;const c=(o=(l=s.payload)===null||l===void 0?void 0:l.payload)!==null&&o!==void 0?o:new ArrayBuffer(0);return this._encodeUserBroadcastPush(s,this.BINARY_ENCODING,c)}_encodeJsonUserBroadcastPush(s){var l,o;const c=(o=(l=s.payload)===null||l===void 0?void 0:l.payload)!==null&&o!==void 0?o:{},m=new TextEncoder().encode(JSON.stringify(c)).buffer;return this._encodeUserBroadcastPush(s,this.JSON_ENCODING,m)}_encodeUserBroadcastPush(s,l,o){var c,u;const m=s.topic,g=(c=s.ref)!==null&&c!==void 0?c:"",f=(u=s.join_ref)!==null&&u!==void 0?u:"",x=s.payload.event,y=this.allowedMetadataKeys?this._pick(s.payload,this.allowedMetadataKeys):{},_=Object.keys(y).length===0?"":JSON.stringify(y);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`ref length ${g.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`topic length ${m.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`userEvent length ${x.length} exceeds maximum of 255`);if(_.length>255)throw new Error(`metadata length ${_.length} exceeds maximum of 255`);const k=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+g.length+m.length+x.length+_.length,S=new ArrayBuffer(this.HEADER_LENGTH+k);let w=new DataView(S),v=0;w.setUint8(v++,this.KINDS.userBroadcastPush),w.setUint8(v++,f.length),w.setUint8(v++,g.length),w.setUint8(v++,m.length),w.setUint8(v++,x.length),w.setUint8(v++,_.length),w.setUint8(v++,l),Array.from(f,U=>w.setUint8(v++,U.charCodeAt(0))),Array.from(g,U=>w.setUint8(v++,U.charCodeAt(0))),Array.from(m,U=>w.setUint8(v++,U.charCodeAt(0))),Array.from(x,U=>w.setUint8(v++,U.charCodeAt(0))),Array.from(_,U=>w.setUint8(v++,U.charCodeAt(0)));var j=new Uint8Array(S.byteLength+o.byteLength);return j.set(new Uint8Array(S),0),j.set(new Uint8Array(o),S.byteLength),j.buffer}decode(s,l){if(this._isArrayBuffer(s)){let o=this._binaryDecode(s);return l(o)}if(typeof s=="string"){const o=JSON.parse(s),[c,u,m,g,f]=o;return l({join_ref:c,ref:u,topic:m,event:g,payload:f})}return l({})}_binaryDecode(s){const l=new DataView(s),o=l.getUint8(0),c=new TextDecoder;switch(o){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(s,l,c)}}_decodeUserBroadcast(s,l,o){const c=l.getUint8(1),u=l.getUint8(2),m=l.getUint8(3),g=l.getUint8(4);let f=this.HEADER_LENGTH+4;const x=o.decode(s.slice(f,f+c));f=f+c;const y=o.decode(s.slice(f,f+u));f=f+u;const _=o.decode(s.slice(f,f+m));f=f+m;const k=s.slice(f,s.byteLength),S=g===this.JSON_ENCODING?JSON.parse(o.decode(k)):k,w={type:this.BROADCAST_EVENT,event:y,payload:S};return m>0&&(w.meta=JSON.parse(_)),{join_ref:null,ref:null,topic:x,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(s){var l;return s instanceof ArrayBuffer||((l=s==null?void 0:s.constructor)===null||l===void 0?void 0:l.name)==="ArrayBuffer"}_pick(s,l){return!s||typeof s!="object"?{}:Object.fromEntries(Object.entries(s).filter(([o])=>l.includes(o)))}}class ff{constructor(s,l){this.callback=s,this.timerCalc=l,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=l}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ke;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Ke||(Ke={}));const V0=(r,s,l={})=>{var o;const c=(o=l.skipTypes)!==null&&o!==void 0?o:[];return s?Object.keys(s).reduce((u,m)=>(u[m]=Op(m,r,s,c),u),{}):{}},Op=(r,s,l,o)=>{const c=s.find(g=>g.name===r),u=c==null?void 0:c.type,m=l[r];return u&&!o.includes(u)?gf(u,m):ud(m)},gf=(r,s)=>{if(r.charAt(0)==="_"){const l=r.slice(1,r.length);return Mp(s,l)}switch(r){case Ke.bool:return Rp(s);case Ke.float4:case Ke.float8:case Ke.int2:case Ke.int4:case Ke.int8:case Ke.numeric:case Ke.oid:return Lp(s);case Ke.json:case Ke.jsonb:return Up(s);case Ke.timestamp:return zp(s);case Ke.abstime:case Ke.date:case Ke.daterange:case Ke.int4range:case Ke.int8range:case Ke.money:case Ke.reltime:case Ke.text:case Ke.time:case Ke.timestamptz:case Ke.timetz:case Ke.tsrange:case Ke.tstzrange:return ud(s);default:return ud(s)}},ud=r=>r,Rp=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Lp=r=>{if(typeof r=="string"){const s=parseFloat(r);if(!Number.isNaN(s))return s}return r},Up=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},Mp=(r,s)=>{if(typeof r!="string")return r;const l=r.length-1,o=r[l];if(r[0]==="{"&&o==="}"){let u;const m=r.slice(1,l);try{u=JSON.parse("["+m+"]")}catch{u=m?m.split(","):[]}return u.map(g=>gf(s,g))}return r},zp=r=>typeof r=="string"?r.replace(" ","T"):r,xf=r=>{const s=new URL(r);return s.protocol=s.protocol.replace(/^ws/i,"http"),s.pathname=s.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),s.pathname===""||s.pathname==="/"?s.pathname="/api/broadcast":s.pathname=s.pathname+"/api/broadcast",s.href};class Zc{constructor(s,l,o={},c=cd){this.channel=s,this.event=l,this.payload=o,this.timeout=c,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,l){var o;return this._hasReceived(s)&&l((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:s,callback:l}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=l=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=l,this._matchReceive(l)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,l){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:l})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:l}){this.recHooks.filter(o=>o.status===s).forEach(o=>o.callback(l))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var $0;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})($0||($0={}));class Vn{constructor(s,l){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=(l==null?void 0:l.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},c=>{const{onJoin:u,onLeave:m,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vn.syncState(this.state,c,u,m),this.pendingDiffs.forEach(f=>{this.state=Vn.syncDiff(this.state,f,u,m)}),this.pendingDiffs=[],g()}),this.channel._on(o.diff,{},c=>{const{onJoin:u,onLeave:m,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(c):(this.state=Vn.syncDiff(this.state,c,u,m),g())}),this.onJoin((c,u,m)=>{this.channel._trigger("presence",{event:"join",key:c,currentPresences:u,newPresences:m})}),this.onLeave((c,u,m)=>{this.channel._trigger("presence",{event:"leave",key:c,currentPresences:u,leftPresences:m})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,l,o,c){const u=this.cloneDeep(s),m=this.transformState(l),g={},f={};return this.map(u,(x,y)=>{m[x]||(f[x]=y)}),this.map(m,(x,y)=>{const _=u[x];if(_){const k=y.map(j=>j.presence_ref),S=_.map(j=>j.presence_ref),w=y.filter(j=>S.indexOf(j.presence_ref)<0),v=_.filter(j=>k.indexOf(j.presence_ref)<0);w.length>0&&(g[x]=w),v.length>0&&(f[x]=v)}else g[x]=y}),this.syncDiff(u,{joins:g,leaves:f},o,c)}static syncDiff(s,l,o,c){const{joins:u,leaves:m}={joins:this.transformState(l.joins),leaves:this.transformState(l.leaves)};return o||(o=()=>{}),c||(c=()=>{}),this.map(u,(g,f)=>{var x;const y=(x=s[g])!==null&&x!==void 0?x:[];if(s[g]=this.cloneDeep(f),y.length>0){const _=s[g].map(S=>S.presence_ref),k=y.filter(S=>_.indexOf(S.presence_ref)<0);s[g].unshift(...k)}o(g,y,f)}),this.map(m,(g,f)=>{let x=s[g];if(!x)return;const y=f.map(_=>_.presence_ref);x=x.filter(_=>y.indexOf(_.presence_ref)<0),s[g]=x,c(g,x,f),x.length===0&&delete s[g]}),s}static map(s,l){return Object.getOwnPropertyNames(s).map(o=>l(o,s[o]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((l,o)=>{const c=s[o];return"metas"in c?l[o]=c.metas.map(u=>(u.presence_ref=u.phx_ref,delete u.phx_ref,delete u.phx_ref_prev,u)):l[o]=c,l},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var P0;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(P0||(P0={}));var $n;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})($n||($n={}));var $a;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})($a||($a={}));class $r{constructor(s,l={config:{}},o){var c,u;if(this.topic=s,this.params=l,this.socket=o,this.bindings={},this.state=gt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},l.config),this.timeout=this.socket.timeout,this.joinPush=new Zc(this,ga.join,this.params,this.timeout),this.rejoinTimer=new ff(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=gt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(m=>m.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=gt.closed,this.socket._remove(this)}),this._onError(m=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,m),this.state=gt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=gt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",m=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,m),this.state=gt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ga.reply,{},(m,g)=>{this._trigger(this._replyEventName(g),m)}),this.presence=new Vn(this),this.broadcastEndpointURL=xf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((u=(c=this.params.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(s,l=this.timeout){var o,c,u;if(this.socket.isConnected()||this.socket.connect(),this.state==gt.closed){const{config:{broadcast:m,presence:g,private:f}}=this.params,x=(c=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(S=>S.filter))!==null&&c!==void 0?c:[],y=!!this.bindings[$n.PRESENCE]&&this.bindings[$n.PRESENCE].length>0||((u=this.params.config.presence)===null||u===void 0?void 0:u.enabled)===!0,_={},k={broadcast:m,presence:Object.assign(Object.assign({},g),{enabled:y}),postgres_changes:x,private:f};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(S=>s==null?void 0:s($a.CHANNEL_ERROR,S)),this._onClose(()=>s==null?void 0:s($a.CLOSED)),this.updateJoinPayload(Object.assign({config:k},_)),this.joinedOnce=!0,this._rejoin(l),this.joinPush.receive("ok",async({postgres_changes:S})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){s==null||s($a.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,j=(w=v==null?void 0:v.length)!==null&&w!==void 0?w:0,U=[];for(let q=0;q<j;q++){const Q=v[q],{filter:{event:C,schema:N,table:O,filter:R}}=Q,E=S&&S[q];if(E&&E.event===C&&$r.isFilterValueEqual(E.schema,N)&&$r.isFilterValueEqual(E.table,O)&&$r.isFilterValueEqual(E.filter,R))U.push(Object.assign(Object.assign({},Q),{id:E.id}));else{this.unsubscribe(),this.state=gt.errored,s==null||s($a.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=U,s&&s($a.SUBSCRIBED);return}}).receive("error",S=>{this.state=gt.errored,s==null||s($a.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{s==null||s($a.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,l={}){return await this.send({type:"presence",event:"track",payload:s},l.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,l,o){return this.state===gt.joined&&s===$n.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(s,l,o)}async httpSend(s,l,o={}){var c;if(l==null)return Promise.reject("Payload is required for httpSend()");const u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const m={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(c=o.timeout)!==null&&c!==void 0?c:this.timeout);if(g.status===202)return{success:!0};let f=g.statusText;try{const x=await g.json();f=x.error||x.message||f}catch{}return Promise.reject(new Error(f))}async send(s,l={}){var o,c;if(!this._canPush()&&s.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:u,payload:m}=s,g={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(g.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:g,body:JSON.stringify({messages:[{topic:this.subTopic,event:u,payload:m,private:this.private}]})};try{const x=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(o=l.timeout)!==null&&o!==void 0?o:this.timeout);return await((c=x.body)===null||c===void 0?void 0:c.cancel()),x.ok?"ok":"error"}catch(x){return x.name==="AbortError"?"timed out":"error"}}else return new Promise(u=>{var m,g,f;const x=this._push(s.type,s,l.timeout||this.timeout);s.type==="broadcast"&&!(!((f=(g=(m=this.params)===null||m===void 0?void 0:m.config)===null||g===void 0?void 0:g.broadcast)===null||f===void 0)&&f.ack)&&u("ok"),x.receive("ok",()=>u("ok")),x.receive("error",()=>u("error")),x.receive("timeout",()=>u("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=gt.leaving;const l=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ga.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(c=>{o=new Zc(this,ga.leave,{},s),o.receive("ok",()=>{l(),c("ok")}).receive("timeout",()=>{l(),c("timed out")}).receive("error",()=>{c("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o==null||o.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=gt.closed,this.bindings={}}async _fetchWithTimeout(s,l,o){const c=new AbortController,u=setTimeout(()=>c.abort(),o),m=await this.socket.fetch(s,Object.assign(Object.assign({},l),{signal:c.signal}));return clearTimeout(u),m}_push(s,l,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let c=new Zc(this,s,l,o);return this._canPush()?c.send():this._addToPushBuffer(c),c}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>Dp){const l=this.pushBuffer.shift();l&&(l.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${l.event}`,l.payload))}}_onMessage(s,l,o){return l}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,l,o){var c,u;const m=s.toLocaleLowerCase(),{close:g,error:f,leave:x,join:y}=ga;if(o&&[g,f,x,y].indexOf(m)>=0&&o!==this._joinRef())return;let k=this._onMessage(m,l,o);if(l&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(m)?(c=this.bindings.postgres_changes)===null||c===void 0||c.filter(S=>{var w,v,j;return((w=S.filter)===null||w===void 0?void 0:w.event)==="*"||((j=(v=S.filter)===null||v===void 0?void 0:v.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===m}).map(S=>S.callback(k,o)):(u=this.bindings[m])===null||u===void 0||u.filter(S=>{var w,v,j,U,q,Q,C,N;if(["broadcast","presence","postgres_changes"].includes(m))if("id"in S){const O=S.id,R=(w=S.filter)===null||w===void 0?void 0:w.event;return O&&((v=l.ids)===null||v===void 0?void 0:v.includes(O))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((j=l.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))&&(!(!((U=S.filter)===null||U===void 0)&&U.table)||S.filter.table===((q=l.data)===null||q===void 0?void 0:q.table))}else{const O=(C=(Q=S==null?void 0:S.filter)===null||Q===void 0?void 0:Q.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return O==="*"||O===((N=l==null?void 0:l.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===m}).map(S=>{if(typeof k=="object"&&"ids"in k){const w=k.data,{schema:v,table:j,commit_timestamp:U,type:q,errors:Q}=w;k=Object.assign(Object.assign({},{schema:v,table:j,commit_timestamp:U,eventType:q,new:{},old:{},errors:Q}),this._getPayloadRecords(w))}S.callback(k,o)})}_isClosed(){return this.state===gt.closed}_isJoined(){return this.state===gt.joined}_isJoining(){return this.state===gt.joining}_isLeaving(){return this.state===gt.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,l,o){const c=s.toLocaleLowerCase(),u={type:c,filter:l,callback:o};return this.bindings[c]?this.bindings[c].push(u):this.bindings[c]=[u],this}_off(s,l){const o=s.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(c=>{var u;return!(((u=c.type)===null||u===void 0?void 0:u.toLocaleLowerCase())===o&&$r.isEqual(c.filter,l))})),this}static isEqual(s,l){if(Object.keys(s).length!==Object.keys(l).length)return!1;for(const o in s)if(s[o]!==l[o])return!1;return!0}static isFilterValueEqual(s,l){return(s??void 0)===(l??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(ga.close,{},s)}_onError(s){this._on(ga.error,{},l=>s(l))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=gt.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const l={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(l.new=V0(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(l.old=V0(s.columns,s.old_record)),l}}const Wc=()=>{},hi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Bp=[1e3,2e3,5e3,1e4],Ip=1e4,Vp=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $p{constructor(s,l){var o;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cd,this.transport=null,this.heartbeatIntervalMs=hi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wc,this.ref=0,this.reconnectTimer=null,this.vsn=I0,this.logger=Wc,this.conn=null,this.sendBuffer=[],this.serializer=new Ap,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=c=>c?(...u)=>c(...u):(...u)=>fetch(...u),!(!((o=l==null?void 0:l.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=l.params.apikey,this.endPoint=`${s}/${dd.websocket}`,this.httpEndpoint=xf(s),this._initializeOptions(l),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(l==null?void 0:l.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Sp.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const l=s.message;throw l.includes("Node.js")?new Error(`${l}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${l}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(s,l){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(s?this.conn.close(s,l??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const l=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),l}async removeAllChannels(){const s=await Promise.all(this.channels.map(l=>l.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,l,o){this.logger(s,l,o)}connectionState(){switch(this.conn&&this.conn.readyState){case gs.connecting:return Vs.Connecting;case gs.open:return Vs.Open;case gs.closing:return Vs.Closing;default:return Vs.Closed}}isConnected(){return this.connectionState()===Vs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,l={config:{}}){const o=`realtime:${s}`,c=this.getChannels().find(u=>u.topic===o);if(c)return c;{const u=new $r(`realtime:${s}`,l,this);return this.channels.push(u),u}}push(s){const{topic:l,event:o,payload:c,ref:u}=s,m=()=>{this.encode(s,g=>{var f;(f=this.conn)===null||f===void 0||f.send(g)})};this.log("push",`${l} ${o} (${u})`,c),this.isConnected()?m():this.sendBuffer.push(m)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(l){this.log("error","error in heartbeat callback",l)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(l){this.log("error","error in heartbeat callback",l)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(Ep,"heartbeat timeout"),setTimeout(()=>{var l;this.isConnected()||(l=this.reconnectTimer)===null||l===void 0||l.scheduleTimeout()},hi.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(l){this.log("error","error in heartbeat callback",l)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let l=this.channels.find(o=>o.topic===s&&(o._isJoined()||o._isJoining()));l&&(this.log("transport",`leaving duplicate topic "${s}"`),l.unsubscribe())}_remove(s){this.channels=this.channels.filter(l=>l.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,l=>{if(l.topic==="phoenix"&&l.event==="phx_reply"&&l.ref&&l.ref===this.pendingHeartbeatRef){const x=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(l.payload.status==="ok"?"ok":"error",x)}catch(y){this.log("error","error in heartbeat callback",y)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:o,event:c,payload:u,ref:m}=l,g=m?`(${m})`:"",f=u.status||"";this.log("receive",`${f} ${o} ${c} ${g}`.trim(),u),this.channels.filter(x=>x._isMember(o)).forEach(x=>x._trigger(c,u,m)),this._triggerStateCallbacks("message",l)})}_clearTimer(s){var l;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((l=this.reconnectTimer)===null||l===void 0||l.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s),this.conn.readyState===gs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===gs.open||this.conn.readyState===gs.connecting)try{this.conn.close()}catch(s){this.log("error","Error closing connection",s)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(l=>{this.log("error","error waiting for auth on connect",l),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=l=>{this.log("worker","worker error",l.message),this._terminateWorker()},this.workerRef.onmessage=l=>{l.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(s){var l;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(l=this.reconnectTimer)===null||l===void 0||l.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(ga.error))}_appendParams(s,l){if(Object.keys(l).length===0)return s;const o=s.match(/\?/)?"&":"?",c=new URLSearchParams(l);return`${s}${o}${c}`}_workerObjectUrl(s){let l;if(s)l=s;else{const o=new Blob([Vp],{type:"application/javascript"});l=URL.createObjectURL(o)}return l}_setConnectionState(s,l=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=l)}async _performAuth(s=null){let l,o=!1;if(s)l=s,o=!0;else if(this.accessToken)try{l=await this.accessToken()}catch(c){this.log("error","Error fetching access token from callback",c),l=this.accessTokenValue}else l=this.accessTokenValue;o?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=l&&(this.accessTokenValue=l,this.channels.forEach(c=>{const u={access_token:l,version:Tp};l&&c.updateJoinPayload(u),c.joinedOnce&&c._isJoined()&&c._push(ga.access_token,{access_token:l})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this._isManualToken()||this.setAuth().catch(l=>{this.log("error",`Error setting auth in ${s}`,l)})}_triggerStateCallbacks(s,l){try{this.stateChangeCallbacks[s].forEach(o=>{try{o(l)}catch(c){this.log("error",`error in ${s} callback`,c)}})}catch(o){this.log("error",`error triggering ${s} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new ff(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},hi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var l,o,c,u,m,g,f,x,y,_,k,S;switch(this.transport=(l=s==null?void 0:s.transport)!==null&&l!==void 0?l:null,this.timeout=(o=s==null?void 0:s.timeout)!==null&&o!==void 0?o:cd,this.heartbeatIntervalMs=(c=s==null?void 0:s.heartbeatIntervalMs)!==null&&c!==void 0?c:hi.HEARTBEAT_INTERVAL,this.worker=(u=s==null?void 0:s.worker)!==null&&u!==void 0?u:!1,this.accessToken=(m=s==null?void 0:s.accessToken)!==null&&m!==void 0?m:null,this.heartbeatCallback=(g=s==null?void 0:s.heartbeatCallback)!==null&&g!==void 0?g:Wc,this.vsn=(f=s==null?void 0:s.vsn)!==null&&f!==void 0?f:I0,s!=null&&s.params&&(this.params=s.params),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(x=s==null?void 0:s.reconnectAfterMs)!==null&&x!==void 0?x:(w=>Bp[w-1]||Ip),this.vsn){case kp:this.encode=(y=s==null?void 0:s.encode)!==null&&y!==void 0?y:((w,v)=>v(JSON.stringify(w))),this.decode=(_=s==null?void 0:s.decode)!==null&&_!==void 0?_:((w,v)=>v(JSON.parse(w)));break;case mf:this.encode=(k=s==null?void 0:s.encode)!==null&&k!==void 0?k:this.serializer.encode.bind(this.serializer),this.decode=(S=s==null?void 0:s.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s==null?void 0:s.workerUrl}}}var Pn=class extends Error{constructor(r,s){var l;super(r),this.name="IcebergError",this.status=s.status,this.icebergType=s.icebergType,this.icebergCode=s.icebergCode,this.details=s.details,this.isCommitStateUnknown=s.icebergType==="CommitStateUnknownException"||[500,502,504].includes(s.status)&&((l=s.icebergType)==null?void 0:l.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Pp(r,s,l){const o=new URL(s,r);if(l)for(const[c,u]of Object.entries(l))u!==void 0&&o.searchParams.set(c,u);return o.toString()}async function Hp(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function Gp(r){const s=r.fetchImpl??globalThis.fetch;return{async request({method:l,path:o,query:c,body:u,headers:m}){const g=Pp(r.baseUrl,o,c),f=await Hp(r.auth),x=await s(g,{method:l,headers:{...u?{"Content-Type":"application/json"}:{},...f,...m},body:u?JSON.stringify(u):void 0}),y=await x.text(),_=(x.headers.get("content-type")||"").includes("application/json"),k=_&&y?JSON.parse(y):y;if(!x.ok){const S=_?k:void 0,w=S==null?void 0:S.error;throw new Pn((w==null?void 0:w.message)??`Request failed with status ${x.status}`,{status:x.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:S})}return{status:x.status,headers:x.headers,data:k}}}}function mi(r){return r.join("")}var qp=class{constructor(r,s=""){this.client=r,this.prefix=s}async listNamespaces(r){const s=r?{parent:mi(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:s})).data.namespaces.map(o=>({namespace:o}))}async createNamespace(r,s){const l={namespace:r.namespace,properties:s==null?void 0:s.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:l})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mi(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mi(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mi(r.namespace)}`}),!0}catch(s){if(s instanceof Pn&&s.status===404)return!1;throw s}}async createNamespaceIfNotExists(r,s){try{return await this.createNamespace(r,s)}catch(l){if(l instanceof Pn&&l.status===409)return;throw l}}};function Er(r){return r.join("")}var Yp=class{constructor(r,s="",l){this.client=r,this.prefix=s,this.accessDelegation=l}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Er(r.namespace)}/tables`})).data.identifiers}async createTable(r,s){const l={};return this.accessDelegation&&(l["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Er(r.namespace)}/tables`,body:s,headers:l})).data.metadata}async updateTable(r,s){const l=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Er(r.namespace)}/tables/${r.name}`,body:s});return{"metadata-location":l.data["metadata-location"],metadata:l.data.metadata}}async dropTable(r,s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Er(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String((s==null?void 0:s.purge)??!1)}})}async loadTable(r){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Er(r.namespace)}/tables/${r.name}`,headers:s})).data.metadata}async tableExists(r){const s={};this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Er(r.namespace)}/tables/${r.name}`,headers:s}),!0}catch(l){if(l instanceof Pn&&l.status===404)return!1;throw l}}async createTableIfNotExists(r,s){try{return await this.createTable(r,s)}catch(l){if(l instanceof Pn&&l.status===409)return await this.loadTable({namespace:r.namespace,name:s.name});throw l}}},Qp=class{constructor(r){var o;let s="v1";r.catalogName&&(s+=`/${r.catalogName}`);const l=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=Gp({baseUrl:l,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=(o=r.accessDelegation)==null?void 0:o.join(","),this.namespaceOps=new qp(this.client,s),this.tableOps=new Yp(this.client,s,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,s){return this.namespaceOps.createNamespace(r,s)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,s){return this.tableOps.createTable(r,s)}async updateTable(r,s){return this.tableOps.updateTable(r,s)}async dropTable(r,s){await this.tableOps.dropTable(r,s)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,s){return this.namespaceOps.createNamespaceIfNotExists(r,s)}async createTableIfNotExists(r,s){return this.tableOps.createTableIfNotExists(r,s)}},Ti=class extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}};function tt(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var Jp=class extends Ti{constructor(r,s,l){super(r),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},hd=class extends Ti{constructor(r,s){super(r),this.name="StorageUnknownError",this.originalError=s}};const Nd=r=>r?(...s)=>r(...s):(...s)=>fetch(...s),Kp=()=>Response,md=r=>{if(Array.isArray(r))return r.map(l=>md(l));if(typeof r=="function"||r!==Object(r))return r;const s={};return Object.entries(r).forEach(([l,o])=>{const c=l.replace(/([-_][a-z])/gi,u=>u.toUpperCase().replace(/[-_]/g,""));s[c]=md(o)}),s},Fp=r=>{if(typeof r!="object"||r===null)return!1;const s=Object.getPrototypeOf(r);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Xp=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r);function Hn(r){"@babel/helpers - typeof";return Hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Hn(r)}function Zp(r,s){if(Hn(r)!="object"||!r)return r;var l=r[Symbol.toPrimitive];if(l!==void 0){var o=l.call(r,s);if(Hn(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(r)}function Wp(r){var s=Zp(r,"string");return Hn(s)=="symbol"?s:s+""}function ey(r,s,l){return(s=Wp(s))in r?Object.defineProperty(r,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[s]=l,r}function H0(r,s){var l=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);s&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(r,c).enumerable})),l.push.apply(l,o)}return l}function Se(r){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?H0(Object(l),!0).forEach(function(o){ey(r,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(l)):H0(Object(l)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(l,o))})}return r}const ed=r=>{var s;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(s=r.error)===null||s===void 0?void 0:s.message)||JSON.stringify(r)},ty=async(r,s,l)=>{r instanceof await Kp()&&!(l!=null&&l.noResolveJson)?r.json().then(o=>{const c=r.status||500,u=(o==null?void 0:o.statusCode)||c+"";s(new Jp(ed(o),c,u))}).catch(o=>{s(new hd(ed(o),o))}):s(new hd(ed(r),r))},ay=(r,s,l,o)=>{const c={method:r,headers:(s==null?void 0:s.headers)||{}};return r==="GET"||!o?c:(Fp(o)?(c.headers=Se({"Content-Type":"application/json"},s==null?void 0:s.headers),c.body=JSON.stringify(o)):c.body=o,s!=null&&s.duplex&&(c.duplex=s.duplex),Se(Se({},c),l))};async function Jn(r,s,l,o,c,u){return new Promise((m,g)=>{r(l,ay(s,o,c,u)).then(f=>{if(!f.ok)throw f;return o!=null&&o.noResolveJson?f:f.json()}).then(f=>m(f)).catch(f=>ty(f,g,o))})}async function Gn(r,s,l,o){return Jn(r,"GET",s,l,o)}async function fa(r,s,l,o,c){return Jn(r,"POST",s,o,c,l)}async function fd(r,s,l,o,c){return Jn(r,"PUT",s,o,c,l)}async function sy(r,s,l,o){return Jn(r,"HEAD",s,Se(Se({},l),{},{noResolveJson:!0}),o)}async function wd(r,s,l,o,c){return Jn(r,"DELETE",s,o,c,l)}var ry=class{constructor(r,s){this.downloadFn=r,this.shouldThrowOnError=s}then(r,s){return this.execute().then(r,s)}async execute(){var r=this;try{return{data:(await r.downloadFn()).body,error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(tt(s))return{data:null,error:s};throw s}}};let pf;pf=Symbol.toStringTag;var ny=class{constructor(r,s){this.downloadFn=r,this.shouldThrowOnError=s,this[pf]="BlobDownloadBuilder",this.promise=null}asStream(){return new ry(this.downloadFn,this.shouldThrowOnError)}then(r,s){return this.getPromise().then(r,s)}catch(r){return this.getPromise().catch(r)}finally(r){return this.getPromise().finally(r)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var r=this;try{return{data:await(await r.downloadFn()).blob(),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(tt(s))return{data:null,error:s};throw s}}};const ly={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},G0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var iy=class{constructor(r,s={},l,o){this.shouldThrowOnError=!1,this.url=r,this.headers=s,this.bucketId=l,this.fetch=Nd(o)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(r,s,l,o){var c=this;try{let u;const m=Se(Se({},G0),o);let g=Se(Se({},c.headers),r==="POST"&&{"x-upsert":String(m.upsert)});const f=m.metadata;typeof Blob<"u"&&l instanceof Blob?(u=new FormData,u.append("cacheControl",m.cacheControl),f&&u.append("metadata",c.encodeMetadata(f)),u.append("",l)):typeof FormData<"u"&&l instanceof FormData?(u=l,u.has("cacheControl")||u.append("cacheControl",m.cacheControl),f&&!u.has("metadata")&&u.append("metadata",c.encodeMetadata(f))):(u=l,g["cache-control"]=`max-age=${m.cacheControl}`,g["content-type"]=m.contentType,f&&(g["x-metadata"]=c.toBase64(c.encodeMetadata(f))),(typeof ReadableStream<"u"&&u instanceof ReadableStream||u&&typeof u=="object"&&"pipe"in u&&typeof u.pipe=="function")&&!m.duplex&&(m.duplex="half")),o!=null&&o.headers&&(g=Se(Se({},g),o.headers));const x=c._removeEmptyFolders(s),y=c._getFinalPath(x),_=await(r=="PUT"?fd:fa)(c.fetch,`${c.url}/object/${y}`,u,Se({headers:g},m!=null&&m.duplex?{duplex:m.duplex}:{}));return{data:{path:x,id:_.Id,fullPath:_.Key},error:null}}catch(u){if(c.shouldThrowOnError)throw u;if(tt(u))return{data:null,error:u};throw u}}async upload(r,s,l){return this.uploadOrUpdate("POST",r,s,l)}async uploadToSignedUrl(r,s,l,o){var c=this;const u=c._removeEmptyFolders(r),m=c._getFinalPath(u),g=new URL(c.url+`/object/upload/sign/${m}`);g.searchParams.set("token",s);try{let f;const x=Se({upsert:G0.upsert},o),y=Se(Se({},c.headers),{"x-upsert":String(x.upsert)});return typeof Blob<"u"&&l instanceof Blob?(f=new FormData,f.append("cacheControl",x.cacheControl),f.append("",l)):typeof FormData<"u"&&l instanceof FormData?(f=l,f.append("cacheControl",x.cacheControl)):(f=l,y["cache-control"]=`max-age=${x.cacheControl}`,y["content-type"]=x.contentType),{data:{path:u,fullPath:(await fd(c.fetch,g.toString(),f,{headers:y})).Key},error:null}}catch(f){if(c.shouldThrowOnError)throw f;if(tt(f))return{data:null,error:f};throw f}}async createSignedUploadUrl(r,s){var l=this;try{let o=l._getFinalPath(r);const c=Se({},l.headers);s!=null&&s.upsert&&(c["x-upsert"]="true");const u=await fa(l.fetch,`${l.url}/object/upload/sign/${o}`,{},{headers:c}),m=new URL(l.url+u.url),g=m.searchParams.get("token");if(!g)throw new Ti("No token returned by API");return{data:{signedUrl:m.toString(),path:r,token:g},error:null}}catch(o){if(l.shouldThrowOnError)throw o;if(tt(o))return{data:null,error:o};throw o}}async update(r,s,l){return this.uploadOrUpdate("PUT",r,s,l)}async move(r,s,l){var o=this;try{return{data:await fa(o.fetch,`${o.url}/object/move`,{bucketId:o.bucketId,sourceKey:r,destinationKey:s,destinationBucket:l==null?void 0:l.destinationBucket},{headers:o.headers}),error:null}}catch(c){if(o.shouldThrowOnError)throw c;if(tt(c))return{data:null,error:c};throw c}}async copy(r,s,l){var o=this;try{return{data:{path:(await fa(o.fetch,`${o.url}/object/copy`,{bucketId:o.bucketId,sourceKey:r,destinationKey:s,destinationBucket:l==null?void 0:l.destinationBucket},{headers:o.headers})).Key},error:null}}catch(c){if(o.shouldThrowOnError)throw c;if(tt(c))return{data:null,error:c};throw c}}async createSignedUrl(r,s,l){var o=this;try{let c=o._getFinalPath(r),u=await fa(o.fetch,`${o.url}/object/sign/${c}`,Se({expiresIn:s},l!=null&&l.transform?{transform:l.transform}:{}),{headers:o.headers});const m=l!=null&&l.download?`&download=${l.download===!0?"":l.download}`:"";return u={signedUrl:encodeURI(`${o.url}${u.signedURL}${m}`)},{data:u,error:null}}catch(c){if(o.shouldThrowOnError)throw c;if(tt(c))return{data:null,error:c};throw c}}async createSignedUrls(r,s,l){var o=this;try{const c=await fa(o.fetch,`${o.url}/object/sign/${o.bucketId}`,{expiresIn:s,paths:r},{headers:o.headers}),u=l!=null&&l.download?`&download=${l.download===!0?"":l.download}`:"";return{data:c.map(m=>Se(Se({},m),{},{signedUrl:m.signedURL?encodeURI(`${o.url}${m.signedURL}${u}`):null})),error:null}}catch(c){if(o.shouldThrowOnError)throw c;if(tt(c))return{data:null,error:c};throw c}}download(r,s){const l=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),c=o?`?${o}`:"",u=this._getFinalPath(r),m=()=>Gn(this.fetch,`${this.url}/${l}/${u}${c}`,{headers:this.headers,noResolveJson:!0});return new ny(m,this.shouldThrowOnError)}async info(r){var s=this;const l=s._getFinalPath(r);try{return{data:md(await Gn(s.fetch,`${s.url}/object/info/${l}`,{headers:s.headers})),error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(tt(o))return{data:null,error:o};throw o}}async exists(r){var s=this;const l=s._getFinalPath(r);try{return await sy(s.fetch,`${s.url}/object/${l}`,{headers:s.headers}),{data:!0,error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(tt(o)&&o instanceof hd){const c=o.originalError;if([400,404].includes(c==null?void 0:c.status))return{data:!1,error:o}}throw o}}getPublicUrl(r,s){const l=this._getFinalPath(r),o=[],c=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";c!==""&&o.push(c);const u=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});m!==""&&o.push(m);let g=o.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${l}${g}`)}}}async remove(r){var s=this;try{return{data:await wd(s.fetch,`${s.url}/object/${s.bucketId}`,{prefixes:r},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}async list(r,s,l){var o=this;try{const c=Se(Se(Se({},ly),s),{},{prefix:r||""});return{data:await fa(o.fetch,`${o.url}/object/list/${o.bucketId}`,c,{headers:o.headers},l),error:null}}catch(c){if(o.shouldThrowOnError)throw c;if(tt(c))return{data:null,error:c};throw c}}async listV2(r,s){var l=this;try{const o=Se({},r);return{data:await fa(l.fetch,`${l.url}/object/list-v2/${l.bucketId}`,o,{headers:l.headers},s),error:null}}catch(o){if(l.shouldThrowOnError)throw o;if(tt(o))return{data:null,error:o};throw o}}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const s=[];return r.width&&s.push(`width=${r.width}`),r.height&&s.push(`height=${r.height}`),r.resize&&s.push(`resize=${r.resize}`),r.format&&s.push(`format=${r.format}`),r.quality&&s.push(`quality=${r.quality}`),s.join("&")}};const yf="2.91.0",vf={"X-Client-Info":`storage-js/${yf}`};var oy=class{constructor(r,s={},l,o){this.shouldThrowOnError=!1;const c=new URL(r);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href.replace(/\/$/,""),this.headers=Se(Se({},vf),s),this.fetch=Nd(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(r){var s=this;try{const l=s.listBucketOptionsToQueryString(r);return{data:await Gn(s.fetch,`${s.url}/bucket${l}`,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}async getBucket(r){var s=this;try{return{data:await Gn(s.fetch,`${s.url}/bucket/${r}`,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}async createBucket(r,s={public:!1}){var l=this;try{return{data:await fa(l.fetch,`${l.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:l.headers}),error:null}}catch(o){if(l.shouldThrowOnError)throw o;if(tt(o))return{data:null,error:o};throw o}}async updateBucket(r,s){var l=this;try{return{data:await fd(l.fetch,`${l.url}/bucket/${r}`,{id:r,name:r,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:l.headers}),error:null}}catch(o){if(l.shouldThrowOnError)throw o;if(tt(o))return{data:null,error:o};throw o}}async emptyBucket(r){var s=this;try{return{data:await fa(s.fetch,`${s.url}/bucket/${r}/empty`,{},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}async deleteBucket(r){var s=this;try{return{data:await wd(s.fetch,`${s.url}/bucket/${r}`,{},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}listBucketOptionsToQueryString(r){const s={};return r&&("limit"in r&&(s.limit=String(r.limit)),"offset"in r&&(s.offset=String(r.offset)),r.search&&(s.search=r.search),r.sortColumn&&(s.sortColumn=r.sortColumn),r.sortOrder&&(s.sortOrder=r.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}},cy=class{constructor(r,s={},l){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Se(Se({},vf),s),this.fetch=Nd(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(r){var s=this;try{return{data:await fa(s.fetch,`${s.url}/bucket`,{name:r},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}async listBuckets(r){var s=this;try{const l=new URLSearchParams;(r==null?void 0:r.limit)!==void 0&&l.set("limit",r.limit.toString()),(r==null?void 0:r.offset)!==void 0&&l.set("offset",r.offset.toString()),r!=null&&r.sortColumn&&l.set("sortColumn",r.sortColumn),r!=null&&r.sortOrder&&l.set("sortOrder",r.sortOrder),r!=null&&r.search&&l.set("search",r.search);const o=l.toString(),c=o?`${s.url}/bucket?${o}`:`${s.url}/bucket`;return{data:await Gn(s.fetch,c,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}async deleteBucket(r){var s=this;try{return{data:await wd(s.fetch,`${s.url}/bucket/${r}`,{},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(tt(l))return{data:null,error:l};throw l}}from(r){var s=this;if(!Xp(r))throw new Ti("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const l=new Qp({baseUrl:this.url,catalogName:r,auth:{type:"custom",getHeaders:async()=>s.headers},fetch:this.fetch}),o=this.shouldThrowOnError;return new Proxy(l,{get(c,u){const m=c[u];return typeof m!="function"?m:async(...g)=>{try{return{data:await m.apply(c,g),error:null}}catch(f){if(o)throw f;return{data:null,error:f}}}}})}};const _d={"X-Client-Info":`storage-js/${yf}`,"Content-Type":"application/json"};var bf=class extends Error{constructor(r){super(r),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Xt(r){return typeof r=="object"&&r!==null&&"__isStorageVectorsError"in r}var td=class extends bf{constructor(r,s,l){super(r),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},dy=class extends bf{constructor(r,s){super(r),this.name="StorageVectorsUnknownError",this.originalError=s}};const Sd=r=>r?(...s)=>r(...s):(...s)=>fetch(...s),uy=r=>{if(typeof r!="object"||r===null)return!1;const s=Object.getPrototypeOf(r);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},q0=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),hy=async(r,s,l)=>{if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!(l!=null&&l.noResolveJson)){const o=r.status||500,c=r;if(typeof c.json=="function")c.json().then(u=>{const m=(u==null?void 0:u.statusCode)||(u==null?void 0:u.code)||o+"";s(new td(q0(u),o,m))}).catch(()=>{const u=o+"";s(new td(c.statusText||`HTTP ${o} error`,o,u))});else{const u=o+"";s(new td(c.statusText||`HTTP ${o} error`,o,u))}}else s(new dy(q0(r),r))},my=(r,s,l,o)=>{const c={method:r,headers:(s==null?void 0:s.headers)||{}};return o?(uy(o)?(c.headers=Se({"Content-Type":"application/json"},s==null?void 0:s.headers),c.body=JSON.stringify(o)):c.body=o,Se(Se({},c),l)):c};async function fy(r,s,l,o,c,u){return new Promise((m,g)=>{r(l,my(s,o,c,u)).then(f=>{if(!f.ok)throw f;if(o!=null&&o.noResolveJson)return f;const x=f.headers.get("content-type");return!x||!x.includes("application/json")?{}:f.json()}).then(f=>m(f)).catch(f=>hy(f,g,o))})}async function Zt(r,s,l,o,c){return fy(r,"POST",s,o,c,l)}var gy=class{constructor(r,s={},l){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Se(Se({},_d),s),this.fetch=Sd(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/CreateIndex`,r,{headers:s.headers})||{},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async getIndex(r,s){var l=this;try{return{data:await Zt(l.fetch,`${l.url}/GetIndex`,{vectorBucketName:r,indexName:s},{headers:l.headers}),error:null}}catch(o){if(l.shouldThrowOnError)throw o;if(Xt(o))return{data:null,error:o};throw o}}async listIndexes(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/ListIndexes`,r,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async deleteIndex(r,s){var l=this;try{return{data:await Zt(l.fetch,`${l.url}/DeleteIndex`,{vectorBucketName:r,indexName:s},{headers:l.headers})||{},error:null}}catch(o){if(l.shouldThrowOnError)throw o;if(Xt(o))return{data:null,error:o};throw o}}},xy=class{constructor(r,s={},l){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Se(Se({},_d),s),this.fetch=Sd(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(r){var s=this;try{if(r.vectors.length<1||r.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Zt(s.fetch,`${s.url}/PutVectors`,r,{headers:s.headers})||{},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async getVectors(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/GetVectors`,r,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async listVectors(r){var s=this;try{if(r.segmentCount!==void 0){if(r.segmentCount<1||r.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(r.segmentIndex!==void 0&&(r.segmentIndex<0||r.segmentIndex>=r.segmentCount))throw new Error(`segmentIndex must be between 0 and ${r.segmentCount-1}`)}return{data:await Zt(s.fetch,`${s.url}/ListVectors`,r,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async queryVectors(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/QueryVectors`,r,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async deleteVectors(r){var s=this;try{if(r.keys.length<1||r.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Zt(s.fetch,`${s.url}/DeleteVectors`,r,{headers:s.headers})||{},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}},py=class{constructor(r,s={},l){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Se(Se({},_d),s),this.fetch=Sd(l)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/CreateVectorBucket`,{vectorBucketName:r},{headers:s.headers})||{},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async getBucket(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/GetVectorBucket`,{vectorBucketName:r},{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async listBuckets(r={}){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/ListVectorBuckets`,r,{headers:s.headers}),error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}async deleteBucket(r){var s=this;try{return{data:await Zt(s.fetch,`${s.url}/DeleteVectorBucket`,{vectorBucketName:r},{headers:s.headers})||{},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}}},yy=class extends py{constructor(r,s={}){super(r,s.headers||{},s.fetch)}from(r){return new vy(this.url,this.headers,r,this.fetch)}async createBucket(r){var s=()=>super.createBucket,l=this;return s().call(l,r)}async getBucket(r){var s=()=>super.getBucket,l=this;return s().call(l,r)}async listBuckets(r={}){var s=()=>super.listBuckets,l=this;return s().call(l,r)}async deleteBucket(r){var s=()=>super.deleteBucket,l=this;return s().call(l,r)}},vy=class extends gy{constructor(r,s,l,o){super(r,s,o),this.vectorBucketName=l}async createIndex(r){var s=()=>super.createIndex,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName}))}async listIndexes(r={}){var s=()=>super.listIndexes,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName}))}async getIndex(r){var s=()=>super.getIndex,l=this;return s().call(l,l.vectorBucketName,r)}async deleteIndex(r){var s=()=>super.deleteIndex,l=this;return s().call(l,l.vectorBucketName,r)}index(r){return new by(this.url,this.headers,this.vectorBucketName,r,this.fetch)}},by=class extends xy{constructor(r,s,l,o,c){super(r,s,c),this.vectorBucketName=l,this.indexName=o}async putVectors(r){var s=()=>super.putVectors,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName,indexName:l.indexName}))}async getVectors(r){var s=()=>super.getVectors,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName,indexName:l.indexName}))}async listVectors(r={}){var s=()=>super.listVectors,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName,indexName:l.indexName}))}async queryVectors(r){var s=()=>super.queryVectors,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName,indexName:l.indexName}))}async deleteVectors(r){var s=()=>super.deleteVectors,l=this;return s().call(l,Se(Se({},r),{},{vectorBucketName:l.vectorBucketName,indexName:l.indexName}))}},jy=class extends oy{constructor(r,s={},l,o){super(r,s,l,o)}from(r){return new iy(this.url,this.headers,r,this.fetch)}get vectors(){return new yy(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new cy(this.url+"/iceberg",this.headers,this.fetch)}};const jf="2.91.0",zr=30*1e3,gd=3,ad=gd*zr,Ny="http://localhost:9999",wy="supabase.auth.token",_y={"X-Client-Info":`gotrue-js/${jf}`},xd="X-Supabase-Api-Version",Nf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Sy=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Cy=600*1e3;class qn extends Error{constructor(s,l,o){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=l,this.code=o}}function be(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Ty extends qn{constructor(s,l,o){super(s,l,o),this.name="AuthApiError",this.status=l,this.code=o}}function ky(r){return be(r)&&r.name==="AuthApiError"}class $s extends qn{constructor(s,l){super(s),this.name="AuthUnknownError",this.originalError=l}}class Pa extends qn{constructor(s,l,o,c){super(s,o,c),this.name=l,this.status=o}}class Kt extends Pa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ey(r){return be(r)&&r.name==="AuthSessionMissingError"}class Dr extends Pa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fi extends Pa{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class gi extends Pa{constructor(s,l=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=l}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Dy(r){return be(r)&&r.name==="AuthImplicitGrantRedirectError"}class Y0 extends Pa{constructor(s,l=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=l}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ay extends Pa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class pd extends Pa{constructor(s,l){super(s,"AuthRetryableFetchError",l,void 0)}}function sd(r){return be(r)&&r.name==="AuthRetryableFetchError"}class Q0 extends Pa{constructor(s,l,o){super(s,"AuthWeakPasswordError",l,"weak_password"),this.reasons=o}}class yd extends Pa{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),J0=` 	
\r=`.split(""),Oy=(()=>{const r=new Array(128);for(let s=0;s<r.length;s+=1)r[s]=-1;for(let s=0;s<J0.length;s+=1)r[J0[s].charCodeAt(0)]=-2;for(let s=0;s<wi.length;s+=1)r[wi[s].charCodeAt(0)]=s;return r})();function K0(r,s,l){if(r!==null)for(s.queue=s.queue<<8|r,s.queuedBits+=8;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;l(wi[o]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;l(wi[o]),s.queuedBits-=6}}function wf(r,s,l){const o=Oy[r];if(o>-1)for(s.queue=s.queue<<6|o,s.queuedBits+=6;s.queuedBits>=8;)l(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function F0(r){const s=[],l=m=>{s.push(String.fromCodePoint(m))},o={utf8seq:0,codepoint:0},c={queue:0,queuedBits:0},u=m=>{Uy(m,o,l)};for(let m=0;m<r.length;m+=1)wf(r.charCodeAt(m),c,u);return s.join("")}function Ry(r,s){if(r<=127){s(r);return}else if(r<=2047){s(192|r>>6),s(128|r&63);return}else if(r<=65535){s(224|r>>12),s(128|r>>6&63),s(128|r&63);return}else if(r<=1114111){s(240|r>>18),s(128|r>>12&63),s(128|r>>6&63),s(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Ly(r,s){for(let l=0;l<r.length;l+=1){let o=r.charCodeAt(l);if(o>55295&&o<=56319){const c=(o-55296)*1024&65535;o=(r.charCodeAt(l+1)-56320&65535|c)+65536,l+=1}Ry(o,s)}}function Uy(r,s,l){if(s.utf8seq===0){if(r<=127){l(r);return}for(let o=1;o<6;o+=1)if((r>>7-o&1)===0){s.utf8seq=o;break}if(s.utf8seq===2)s.codepoint=r&31;else if(s.utf8seq===3)s.codepoint=r&15;else if(s.utf8seq===4)s.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|r&63,s.utf8seq-=1,s.utf8seq===0&&l(s.codepoint)}}function Pr(r){const s=[],l={queue:0,queuedBits:0},o=c=>{s.push(c)};for(let c=0;c<r.length;c+=1)wf(r.charCodeAt(c),l,o);return new Uint8Array(s)}function My(r){const s=[];return Ly(r,l=>s.push(l)),new Uint8Array(s)}function Ps(r){const s=[],l={queue:0,queuedBits:0},o=c=>{s.push(c)};return r.forEach(c=>K0(c,l,o)),K0(null,l,o),s.join("")}function zy(r){return Math.round(Date.now()/1e3)+r}function By(){return Symbol("auth-callback")}const _t=()=>typeof window<"u"&&typeof document<"u",zs={tested:!1,writable:!1},_f=()=>{if(!_t())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(zs.tested)return zs.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),zs.tested=!0,zs.writable=!0}catch{zs.tested=!0,zs.writable=!1}return zs.writable};function Iy(r){const s={},l=new URL(r);if(l.hash&&l.hash[0]==="#")try{new URLSearchParams(l.hash.substring(1)).forEach((c,u)=>{s[u]=c})}catch{}return l.searchParams.forEach((o,c)=>{s[c]=o}),s}const Sf=r=>r?(...s)=>r(...s):(...s)=>fetch(...s),Vy=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Br=async(r,s,l)=>{await r.setItem(s,JSON.stringify(l))},Bs=async(r,s)=>{const l=await r.getItem(s);if(!l)return null;try{return JSON.parse(l)}catch{return l}},wt=async(r,s)=>{await r.removeItem(s)};class ki{constructor(){this.promise=new ki.promiseConstructor((s,l)=>{this.resolve=s,this.reject=l})}}ki.promiseConstructor=Promise;function rd(r){const s=r.split(".");if(s.length!==3)throw new yd("Invalid JWT structure");for(let o=0;o<s.length;o++)if(!Sy.test(s[o]))throw new yd("JWT not in base64url format");return{header:JSON.parse(F0(s[0])),payload:JSON.parse(F0(s[1])),signature:Pr(s[2]),raw:{header:s[0],payload:s[1]}}}async function $y(r){return await new Promise(s=>{setTimeout(()=>s(null),r)})}function Py(r,s){return new Promise((o,c)=>{(async()=>{for(let u=0;u<1/0;u++)try{const m=await r(u);if(!s(u,null,m)){o(m);return}}catch(m){if(!s(u,m)){c(m);return}}})()})}function Hy(r){return("0"+r.toString(16)).substr(-2)}function Gy(){const s=new Uint32Array(56);if(typeof crypto>"u"){const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=l.length;let c="";for(let u=0;u<56;u++)c+=l.charAt(Math.floor(Math.random()*o));return c}return crypto.getRandomValues(s),Array.from(s,Hy).join("")}async function qy(r){const l=new TextEncoder().encode(r),o=await crypto.subtle.digest("SHA-256",l),c=new Uint8Array(o);return Array.from(c).map(u=>String.fromCharCode(u)).join("")}async function Yy(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const l=await qy(r);return btoa(l).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ar(r,s,l=!1){const o=Gy();let c=o;l&&(c+="/PASSWORD_RECOVERY"),await Br(r,`${s}-code-verifier`,c);const u=await Yy(o);return[u,o===u?"plain":"s256"]}const Qy=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Jy(r){const s=r.headers.get(xd);if(!s||!s.match(Qy))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function Ky(r){if(!r)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(r<=s)throw new Error("JWT has expired")}function Fy(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Xy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Or(r){if(!Xy.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function nd(){const r={};return new Proxy(r,{get:(s,l)=>{if(l==="__isUserNotAvailableProxy")return!0;if(typeof l=="symbol"){const o=l.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${l}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,l)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${l}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,l)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${l}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Zy(r,s){return new Proxy(r,{get:(l,o,c)=>{if(o==="__isInsecureUserWarningProxy")return!0;if(typeof o=="symbol"){const u=o.toString();if(u==="Symbol(Symbol.toPrimitive)"||u==="Symbol(Symbol.toStringTag)"||u==="Symbol(util.inspect.custom)"||u==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(l,o,c)}return!s.value&&typeof o=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s.value=!0),Reflect.get(l,o,c)}})}function X0(r){return JSON.parse(JSON.stringify(r))}const Is=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Wy=[502,503,504];async function Z0(r){var s;if(!Vy(r))throw new pd(Is(r),0);if(Wy.includes(r.status))throw new pd(Is(r),r.status);let l;try{l=await r.json()}catch(u){throw new $s(Is(u),u)}let o;const c=Jy(r);if(c&&c.getTime()>=Nf["2024-01-01"].timestamp&&typeof l=="object"&&l&&typeof l.code=="string"?o=l.code:typeof l=="object"&&l&&typeof l.error_code=="string"&&(o=l.error_code),o){if(o==="weak_password")throw new Q0(Is(l),r.status,((s=l.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(o==="session_not_found")throw new Kt}else if(typeof l=="object"&&l&&typeof l.weak_password=="object"&&l.weak_password&&Array.isArray(l.weak_password.reasons)&&l.weak_password.reasons.length&&l.weak_password.reasons.reduce((u,m)=>u&&typeof m=="string",!0))throw new Q0(Is(l),r.status,l.weak_password.reasons);throw new Ty(Is(l),r.status||500,o)}const ev=(r,s,l,o)=>{const c={method:r,headers:(s==null?void 0:s.headers)||{}};return r==="GET"?c:(c.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),c.body=JSON.stringify(o),Object.assign(Object.assign({},c),l))};async function _e(r,s,l,o){var c;const u=Object.assign({},o==null?void 0:o.headers);u[xd]||(u[xd]=Nf["2024-01-01"].name),o!=null&&o.jwt&&(u.Authorization=`Bearer ${o.jwt}`);const m=(c=o==null?void 0:o.query)!==null&&c!==void 0?c:{};o!=null&&o.redirectTo&&(m.redirect_to=o.redirectTo);const g=Object.keys(m).length?"?"+new URLSearchParams(m).toString():"",f=await tv(r,s,l+g,{headers:u,noResolveJson:o==null?void 0:o.noResolveJson},{},o==null?void 0:o.body);return o!=null&&o.xform?o==null?void 0:o.xform(f):{data:Object.assign({},f),error:null}}async function tv(r,s,l,o,c,u){const m=ev(s,o,c,u);let g;try{g=await r(l,Object.assign({},m))}catch(f){throw console.error(f),new pd(Is(f),0)}if(g.ok||await Z0(g),o!=null&&o.noResolveJson)return g;try{return await g.json()}catch(f){await Z0(f)}}function ma(r){var s;let l=null;rv(r)&&(l=Object.assign({},r),r.expires_at||(l.expires_at=zy(r.expires_in)));const o=(s=r.user)!==null&&s!==void 0?s:r;return{data:{session:l,user:o},error:null}}function W0(r){const s=ma(r);return!s.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((l,o)=>l&&typeof o=="string",!0)&&(s.data.weak_password=r.weak_password),s}function xs(r){var s;return{data:{user:(s=r.user)!==null&&s!==void 0?s:r},error:null}}function av(r){return{data:r,error:null}}function sv(r){const{action_link:s,email_otp:l,hashed_token:o,redirect_to:c,verification_type:u}=r,m=Ci(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:s,email_otp:l,hashed_token:o,redirect_to:c,verification_type:u},f=Object.assign({},m);return{data:{properties:g,user:f},error:null}}function ef(r){return r}function rv(r){return r.access_token&&r.refresh_token&&r.expires_in}const ld=["global","local","others"];class nv{constructor({url:s="",headers:l={},fetch:o}){this.url=s,this.headers=l,this.fetch=Sf(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(s,l=ld[0]){if(ld.indexOf(l)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ld.join(", ")}`);try{return await _e(this.fetch,"POST",`${this.url}/logout?scope=${l}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(o){if(be(o))return{data:null,error:o};throw o}}async inviteUserByEmail(s,l={}){try{return await _e(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:l.data},headers:this.headers,redirectTo:l.redirectTo,xform:xs})}catch(o){if(be(o))return{data:{user:null},error:o};throw o}}async generateLink(s){try{const{options:l}=s,o=Ci(s,["options"]),c=Object.assign(Object.assign({},o),l);return"newEmail"in o&&(c.new_email=o==null?void 0:o.newEmail,delete c.newEmail),await _e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:c,headers:this.headers,xform:sv,redirectTo:l==null?void 0:l.redirectTo})}catch(l){if(be(l))return{data:{properties:null,user:null},error:l};throw l}}async createUser(s){try{return await _e(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:xs})}catch(l){if(be(l))return{data:{user:null},error:l};throw l}}async listUsers(s){var l,o,c,u,m,g,f;try{const x={nextPage:null,lastPage:0,total:0},y=await _e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(l=s==null?void 0:s.page)===null||l===void 0?void 0:l.toString())!==null&&o!==void 0?o:"",per_page:(u=(c=s==null?void 0:s.perPage)===null||c===void 0?void 0:c.toString())!==null&&u!==void 0?u:""},xform:ef});if(y.error)throw y.error;const _=await y.json(),k=(m=y.headers.get("x-total-count"))!==null&&m!==void 0?m:0,S=(f=(g=y.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&f!==void 0?f:[];return S.length>0&&(S.forEach(w=>{const v=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(w.split(";")[1].split("=")[1]);x[`${j}Page`]=v}),x.total=parseInt(k)),{data:Object.assign(Object.assign({},_),x),error:null}}catch(x){if(be(x))return{data:{users:[]},error:x};throw x}}async getUserById(s){Or(s);try{return await _e(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:xs})}catch(l){if(be(l))return{data:{user:null},error:l};throw l}}async updateUserById(s,l){Or(s);try{return await _e(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:l,headers:this.headers,xform:xs})}catch(o){if(be(o))return{data:{user:null},error:o};throw o}}async deleteUser(s,l=!1){Or(s);try{return await _e(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:l},xform:xs})}catch(o){if(be(o))return{data:{user:null},error:o};throw o}}async _listFactors(s){Or(s.userId);try{const{data:l,error:o}=await _e(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:c=>({data:{factors:c},error:null})});return{data:l,error:o}}catch(l){if(be(l))return{data:null,error:l};throw l}}async _deleteFactor(s){Or(s.userId),Or(s.id);try{return{data:await _e(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(l){if(be(l))return{data:null,error:l};throw l}}async _listOAuthClients(s){var l,o,c,u,m,g,f;try{const x={nextPage:null,lastPage:0,total:0},y=await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(l=s==null?void 0:s.page)===null||l===void 0?void 0:l.toString())!==null&&o!==void 0?o:"",per_page:(u=(c=s==null?void 0:s.perPage)===null||c===void 0?void 0:c.toString())!==null&&u!==void 0?u:""},xform:ef});if(y.error)throw y.error;const _=await y.json(),k=(m=y.headers.get("x-total-count"))!==null&&m!==void 0?m:0,S=(f=(g=y.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&f!==void 0?f:[];return S.length>0&&(S.forEach(w=>{const v=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(w.split(";")[1].split("=")[1]);x[`${j}Page`]=v}),x.total=parseInt(k)),{data:Object.assign(Object.assign({},_),x),error:null}}catch(x){if(be(x))return{data:{clients:[]},error:x};throw x}}async _createOAuthClient(s){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(be(l))return{data:null,error:l};throw l}}async _getOAuthClient(s){try{return await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(be(l))return{data:null,error:l};throw l}}async _updateOAuthClient(s,l){try{return await _e(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${s}`,{body:l,headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(be(o))return{data:null,error:o};throw o}}async _deleteOAuthClient(s){try{return await _e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(l){if(be(l))return{data:null,error:l};throw l}}async _regenerateOAuthClientSecret(s){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${s}/regenerate_secret`,{headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(be(l))return{data:null,error:l};throw l}}}function tf(r={}){return{getItem:s=>r[s]||null,setItem:(s,l)=>{r[s]=l},removeItem:s=>{delete r[s]}}}const Rr={debug:!!(globalThis&&_f()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Cf extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class lv extends Cf{}async function iv(r,s,l){Rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,s);const o=new globalThis.AbortController;return s>0&&setTimeout(()=>{o.abort(),Rr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async c=>{if(c){Rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,c.name);try{return await l()}finally{Rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,c.name)}}else{if(s===0)throw Rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new lv(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Rr.debug)try{const u=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(u,null,"  "))}catch(u){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",u)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await l()}}))}function ov(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Tf(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function cv(r){return parseInt(r,16)}function dv(r){const s=new TextEncoder().encode(r);return"0x"+Array.from(s,o=>o.toString(16).padStart(2,"0")).join("")}function uv(r){var s;const{chainId:l,domain:o,expirationTime:c,issuedAt:u=new Date,nonce:m,notBefore:g,requestId:f,resources:x,scheme:y,uri:_,version:k}=r;{if(!Number.isInteger(l))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${l}`);if(!o)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(m&&m.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${m}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(k!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${k}`);if(!((s=r.statement)===null||s===void 0)&&s.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const S=Tf(r.address),w=y?`${y}://${o}`:o,v=r.statement?`${r.statement}
`:"",j=`${w} wants you to sign in with your Ethereum account:
${S}

${v}`;let U=`URI: ${_}
Version: ${k}
Chain ID: ${l}${m?`
Nonce: ${m}`:""}
Issued At: ${u.toISOString()}`;if(c&&(U+=`
Expiration Time: ${c.toISOString()}`),g&&(U+=`
Not Before: ${g.toISOString()}`),f&&(U+=`
Request ID: ${f}`),x){let q=`
Resources:`;for(const Q of x){if(!Q||typeof Q!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${Q}`);q+=`
- ${Q}`}U+=q}return`${j}
${U}`}class ht extends Error{constructor({message:s,code:l,cause:o,name:c}){var u;super(s,{cause:o}),this.__isWebAuthnError=!0,this.name=(u=c??(o instanceof Error?o.name:void 0))!==null&&u!==void 0?u:"Unknown Error",this.code=l}}class _i extends ht{constructor(s,l){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:l,message:s}),this.name="WebAuthnUnknownError",this.originalError=l}}function hv({error:r,options:s}){var l,o,c;const{publicKey:u}=s;if(!u)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(s.signal instanceof AbortSignal)return new ht({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((l=u.authenticatorSelection)===null||l===void 0?void 0:l.requireResidentKey)===!0)return new ht({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(s.mediation==="conditional"&&((o=u.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new ht({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((c=u.authenticatorSelection)===null||c===void 0?void 0:c.userVerification)==="required")return new ht({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new ht({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new ht({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return u.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new ht({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new ht({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const m=window.location.hostname;if(kf(m)){if(u.rp.id!==m)return new ht({message:`The RP ID "${u.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new ht({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(u.user.id.byteLength<1||u.user.id.byteLength>64)return new ht({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new ht({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new ht({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function mv({error:r,options:s}){const{publicKey:l}=s;if(!l)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(s.signal instanceof AbortSignal)return new ht({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new ht({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const o=window.location.hostname;if(kf(o)){if(l.rpId!==o)return new ht({message:`The RP ID "${l.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new ht({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new ht({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new ht({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class fv{createNewAbortSignal(){if(this.controller){const l=new Error("Cancelling existing WebAuthn API call for new one");l.name="AbortError",this.controller.abort(l)}const s=new AbortController;return this.controller=s,s.signal}cancelCeremony(){if(this.controller){const s=new Error("Manually cancelling existing WebAuthn API call");s.name="AbortError",this.controller.abort(s),this.controller=void 0}}}const gv=new fv;function xv(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:s,user:l,excludeCredentials:o}=r,c=Ci(r,["challenge","user","excludeCredentials"]),u=Pr(s).buffer,m=Object.assign(Object.assign({},l),{id:Pr(l.id).buffer}),g=Object.assign(Object.assign({},c),{challenge:u,user:m});if(o&&o.length>0){g.excludeCredentials=new Array(o.length);for(let f=0;f<o.length;f++){const x=o[f];g.excludeCredentials[f]=Object.assign(Object.assign({},x),{id:Pr(x.id).buffer,type:x.type||"public-key",transports:x.transports})}}return g}function pv(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:s,allowCredentials:l}=r,o=Ci(r,["challenge","allowCredentials"]),c=Pr(s).buffer,u=Object.assign(Object.assign({},o),{challenge:c});if(l&&l.length>0){u.allowCredentials=new Array(l.length);for(let m=0;m<l.length;m++){const g=l[m];u.allowCredentials[m]=Object.assign(Object.assign({},g),{id:Pr(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return u}function yv(r){var s;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const l=r;return{id:r.id,rawId:r.id,response:{attestationObject:Ps(new Uint8Array(r.response.attestationObject)),clientDataJSON:Ps(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(s=l.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function vv(r){var s;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const l=r,o=r.getClientExtensionResults(),c=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Ps(new Uint8Array(c.authenticatorData)),clientDataJSON:Ps(new Uint8Array(c.clientDataJSON)),signature:Ps(new Uint8Array(c.signature)),userHandle:c.userHandle?Ps(new Uint8Array(c.userHandle)):void 0},type:"public-key",clientExtensionResults:o,authenticatorAttachment:(s=l.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function kf(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function af(){var r,s;return!!(_t()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.get)=="function")}async function bv(r){try{const s=await navigator.credentials.create(r);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new _i("Browser returned unexpected credential type",s)}:{data:null,error:new _i("Empty credential response",s)}}catch(s){return{data:null,error:hv({error:s,options:r})}}}async function jv(r){try{const s=await navigator.credentials.get(r);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new _i("Browser returned unexpected credential type",s)}:{data:null,error:new _i("Empty credential response",s)}}catch(s){return{data:null,error:mv({error:s,options:r})}}}const Nv={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wv={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Si(...r){const s=c=>c!==null&&typeof c=="object"&&!Array.isArray(c),l=c=>c instanceof ArrayBuffer||ArrayBuffer.isView(c),o={};for(const c of r)if(c)for(const u in c){const m=c[u];if(m!==void 0)if(Array.isArray(m))o[u]=m;else if(l(m))o[u]=m;else if(s(m)){const g=o[u];s(g)?o[u]=Si(g,m):o[u]=Si(m)}else o[u]=m}return o}function _v(r,s){return Si(Nv,r,s||{})}function Sv(r,s){return Si(wv,r,s||{})}class Cv{constructor(s){this.client=s,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(s){return this.client.mfa.enroll(Object.assign(Object.assign({},s),{factorType:"webauthn"}))}async _challenge({factorId:s,webauthn:l,friendlyName:o,signal:c},u){try{const{data:m,error:g}=await this.client.mfa.challenge({factorId:s,webauthn:l});if(!m)return{data:null,error:g};const f=c??gv.createNewAbortSignal();if(m.webauthn.type==="create"){const{user:x}=m.webauthn.credential_options.publicKey;x.name||(x.name=`${x.id}:${o}`),x.displayName||(x.displayName=x.name)}switch(m.webauthn.type){case"create":{const x=_v(m.webauthn.credential_options.publicKey,u==null?void 0:u.create),{data:y,error:_}=await bv({publicKey:x,signal:f});return y?{data:{factorId:s,challengeId:m.id,webauthn:{type:m.webauthn.type,credential_response:y}},error:null}:{data:null,error:_}}case"request":{const x=Sv(m.webauthn.credential_options.publicKey,u==null?void 0:u.request),{data:y,error:_}=await jv(Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:x,signal:f}));return y?{data:{factorId:s,challengeId:m.id,webauthn:{type:m.webauthn.type,credential_response:y}},error:null}:{data:null,error:_}}}}catch(m){return be(m)?{data:null,error:m}:{data:null,error:new $s("Unexpected error in challenge",m)}}}async _verify({challengeId:s,factorId:l,webauthn:o}){return this.client.mfa.verify({factorId:l,challengeId:s,webauthn:o})}async _authenticate({factorId:s,webauthn:{rpId:l=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:c}={}},u){if(!l)return{data:null,error:new qn("rpId is required for WebAuthn authentication")};try{if(!af())return{data:null,error:new $s("Browser does not support WebAuthn",null)};const{data:m,error:g}=await this.challenge({factorId:s,webauthn:{rpId:l,rpOrigins:o},signal:c},{request:u});if(!m)return{data:null,error:g};const{webauthn:f}=m;return this._verify({factorId:s,challengeId:m.challengeId,webauthn:{type:f.type,rpId:l,rpOrigins:o,credential_response:f.credential_response}})}catch(m){return be(m)?{data:null,error:m}:{data:null,error:new $s("Unexpected error in authenticate",m)}}}async _register({friendlyName:s,webauthn:{rpId:l=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:c}={}},u){if(!l)return{data:null,error:new qn("rpId is required for WebAuthn registration")};try{if(!af())return{data:null,error:new $s("Browser does not support WebAuthn",null)};const{data:m,error:g}=await this._enroll({friendlyName:s});if(!m)return await this.client.mfa.listFactors().then(y=>{var _;return(_=y.data)===null||_===void 0?void 0:_.all.find(k=>k.factor_type==="webauthn"&&k.friendly_name===s&&k.status!=="unverified")}).then(y=>y?this.client.mfa.unenroll({factorId:y==null?void 0:y.id}):void 0),{data:null,error:g};const{data:f,error:x}=await this._challenge({factorId:m.id,friendlyName:m.friendly_name,webauthn:{rpId:l,rpOrigins:o},signal:c},{create:u});return f?this._verify({factorId:m.id,challengeId:f.challengeId,webauthn:{rpId:l,rpOrigins:o,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:x}}catch(m){return be(m)?{data:null,error:m}:{data:null,error:new $s("Unexpected error in register",m)}}}}ov();const Tv={url:Ny,storageKey:wy,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:_y,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function sf(r,s,l){return await l()}const Lr={};class Yn{get jwks(){var s,l;return(l=(s=Lr[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&l!==void 0?l:{keys:[]}}set jwks(s){Lr[this.storageKey]=Object.assign(Object.assign({},Lr[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,l;return(l=(s=Lr[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&l!==void 0?l:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){Lr[this.storageKey]=Object.assign(Object.assign({},Lr[this.storageKey]),{cachedAt:s})}constructor(s){var l,o,c;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const u=Object.assign(Object.assign({},Tv),s);if(this.storageKey=u.storageKey,this.instanceID=(l=Yn.nextInstanceID[this.storageKey])!==null&&l!==void 0?l:0,Yn.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!u.debug,typeof u.debug=="function"&&(this.logger=u.debug),this.instanceID>0&&_t()){const m=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(m),this.logDebugMessages&&console.trace(m)}if(this.persistSession=u.persistSession,this.autoRefreshToken=u.autoRefreshToken,this.admin=new nv({url:u.url,headers:u.headers,fetch:u.fetch}),this.url=u.url,this.headers=u.headers,this.fetch=Sf(u.fetch),this.lock=u.lock||sf,this.detectSessionInUrl=u.detectSessionInUrl,this.flowType=u.flowType,this.hasCustomAuthorizationHeader=u.hasCustomAuthorizationHeader,this.throwOnError=u.throwOnError,this.lockAcquireTimeout=u.lockAcquireTimeout,u.lock?this.lock=u.lock:this.persistSession&&_t()&&(!((o=globalThis==null?void 0:globalThis.navigator)===null||o===void 0)&&o.locks)?this.lock=iv:this.lock=sf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Cv(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(u.storage?this.storage=u.storage:_f()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tf(this.memoryStorage)),u.userStorage&&(this.userStorage=u.userStorage)):(this.memoryStorage={},this.storage=tf(this.memoryStorage)),_t()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(m){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",m)}(c=this.broadcastChannel)===null||c===void 0||c.addEventListener("message",async m=>{this._debug("received broadcast notification from other tab or client",m),await this._notifyAllSubscribers(m.data.event,m.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(s){if(this.throwOnError&&s&&s.error)throw s.error;return s}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${jf}) ${new Date().toISOString()}`}_debug(...s){return this.logDebugMessages&&this.logger(this._logPrefix(),...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{let l={},o="none";if(_t()&&(l=Iy(window.location.href),this._isImplicitGrantCallback(l)?o="implicit":await this._isPKCECallback(l)&&(o="pkce")),_t()&&this.detectSessionInUrl&&o!=="none"){const{data:c,error:u}=await this._getSessionFromURL(l,o);if(u){if(this._debug("#_initialize()","error detecting session from URL",u),Dy(u)){const f=(s=u.details)===null||s===void 0?void 0:s.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:u}}return{error:u}}const{session:m,redirectType:g}=c;return this._debug("#_initialize()","detected session in URL",m,"redirect type",g),await this._saveSession(m),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",m):await this._notifyAllSubscribers("SIGNED_IN",m)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(l){return be(l)?this._returnResult({error:l}):this._returnResult({error:new $s("Unexpected error during initialization",l)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var l,o,c;try{const u=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(l=s==null?void 0:s.options)===null||l===void 0?void 0:l.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(c=s==null?void 0:s.options)===null||c===void 0?void 0:c.captchaToken}},xform:ma}),{data:m,error:g}=u;if(g||!m)return this._returnResult({data:{user:null,session:null},error:g});const f=m.session,x=m.user;return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:x,session:f},error:null})}catch(u){if(be(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signUp(s){var l,o,c;try{let u;if("email"in s){const{email:y,password:_,options:k}=s;let S=null,w=null;this.flowType==="pkce"&&([S,w]=await Ar(this.storage,this.storageKey)),u=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:k==null?void 0:k.emailRedirectTo,body:{email:y,password:_,data:(l=k==null?void 0:k.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:k==null?void 0:k.captchaToken},code_challenge:S,code_challenge_method:w},xform:ma})}else if("phone"in s){const{phone:y,password:_,options:k}=s;u=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:_,data:(o=k==null?void 0:k.data)!==null&&o!==void 0?o:{},channel:(c=k==null?void 0:k.channel)!==null&&c!==void 0?c:"sms",gotrue_meta_security:{captcha_token:k==null?void 0:k.captchaToken}},xform:ma})}else throw new fi("You must provide either an email or phone number and a password");const{data:m,error:g}=u;if(g||!m)return await wt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:g});const f=m.session,x=m.user;return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:x,session:f},error:null})}catch(u){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithPassword(s){try{let l;if("email"in s){const{email:u,password:m,options:g}=s;l=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:m,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:W0})}else if("phone"in s){const{phone:u,password:m,options:g}=s;l=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:m,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:W0})}else throw new fi("You must provide either an email or phone number and a password");const{data:o,error:c}=l;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!o||!o.session||!o.user){const u=new Dr;return this._returnResult({data:{user:null,session:null},error:u})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:c})}catch(l){if(be(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithOAuth(s){var l,o,c,u;return await this._handleProviderSignIn(s.provider,{redirectTo:(l=s.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=s.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=s.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:(u=s.options)===null||u===void 0?void 0:u.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:l}=s;switch(l){case"ethereum":return await this.signInWithEthereum(s);case"solana":return await this.signInWithSolana(s);default:throw new Error(`@supabase/auth-js: Unsupported chain "${l}"`)}}async signInWithEthereum(s){var l,o,c,u,m,g,f,x,y,_,k;let S,w;if("message"in s)S=s.message,w=s.signature;else{const{chain:v,wallet:j,statement:U,options:q}=s;let Q;if(_t())if(typeof j=="object")Q=j;else{const H=window;if("ethereum"in H&&typeof H.ethereum=="object"&&"request"in H.ethereum&&typeof H.ethereum.request=="function")Q=H.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(q!=null&&q.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Q=j}const C=new URL((l=q==null?void 0:q.url)!==null&&l!==void 0?l:window.location.href),N=await Q.request({method:"eth_requestAccounts"}).then(H=>H).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!N||N.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=Tf(N[0]);let R=(o=q==null?void 0:q.signInWithEthereum)===null||o===void 0?void 0:o.chainId;if(!R){const H=await Q.request({method:"eth_chainId"});R=cv(H)}const E={domain:C.host,address:O,statement:U,uri:C.href,version:"1",chainId:R,nonce:(c=q==null?void 0:q.signInWithEthereum)===null||c===void 0?void 0:c.nonce,issuedAt:(m=(u=q==null?void 0:q.signInWithEthereum)===null||u===void 0?void 0:u.issuedAt)!==null&&m!==void 0?m:new Date,expirationTime:(g=q==null?void 0:q.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(f=q==null?void 0:q.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(x=q==null?void 0:q.signInWithEthereum)===null||x===void 0?void 0:x.requestId,resources:(y=q==null?void 0:q.signInWithEthereum)===null||y===void 0?void 0:y.resources};S=uv(E),w=await Q.request({method:"personal_sign",params:[dv(S),O]})}try{const{data:v,error:j}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:w},!((_=s.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(k=s.options)===null||k===void 0?void 0:k.captchaToken}}:null),xform:ma});if(j)throw j;if(!v||!v.session||!v.user){const U=new Dr;return this._returnResult({data:{user:null,session:null},error:U})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:j})}catch(v){if(be(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(s){var l,o,c,u,m,g,f,x,y,_,k,S;let w,v;if("message"in s)w=s.message,v=s.signature;else{const{chain:j,wallet:U,statement:q,options:Q}=s;let C;if(_t())if(typeof U=="object")C=U;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))C=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof U!="object"||!(Q!=null&&Q.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=U}const N=new URL((l=Q==null?void 0:Q.url)!==null&&l!==void 0?l:window.location.href);if("signIn"in C&&C.signIn){const O=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},Q==null?void 0:Q.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),q?{statement:q}:null));let R;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")R=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)R=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)w=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),v=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${N.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...q?["",q,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(c=(o=Q==null?void 0:Q.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&c!==void 0?c:new Date().toISOString()}`,...!((u=Q==null?void 0:Q.signInWithSolana)===null||u===void 0)&&u.notBefore?[`Not Before: ${Q.signInWithSolana.notBefore}`]:[],...!((m=Q==null?void 0:Q.signInWithSolana)===null||m===void 0)&&m.expirationTime?[`Expiration Time: ${Q.signInWithSolana.expirationTime}`]:[],...!((g=Q==null?void 0:Q.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${Q.signInWithSolana.chainId}`]:[],...!((f=Q==null?void 0:Q.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${Q.signInWithSolana.nonce}`]:[],...!((x=Q==null?void 0:Q.signInWithSolana)===null||x===void 0)&&x.requestId?[`Request ID: ${Q.signInWithSolana.requestId}`]:[],...!((_=(y=Q==null?void 0:Q.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||_===void 0)&&_.length?["Resources",...Q.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const O=await C.signMessage(new TextEncoder().encode(w),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=O}}try{const{data:j,error:U}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Ps(v)},!((k=s.options)===null||k===void 0)&&k.captchaToken?{gotrue_meta_security:{captcha_token:(S=s.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:ma});if(U)throw U;if(!j||!j.session||!j.user){const q=new Dr;return this._returnResult({data:{user:null,session:null},error:q})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:U})}catch(j){if(be(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(s){const l=await Bs(this.storage,`${this.storageKey}-code-verifier`),[o,c]=(l??"").split("/");try{if(!o&&this.flowType==="pkce")throw new Ay;const{data:u,error:m}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:o},xform:ma});if(await wt(this.storage,`${this.storageKey}-code-verifier`),m)throw m;if(!u||!u.session||!u.user){const g=new Dr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return u.session&&(await this._saveSession(u.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",u.session)},0)),this._returnResult({data:Object.assign(Object.assign({},u),{redirectType:c??null}),error:m})}catch(u){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(u))return this._returnResult({data:{user:null,session:null,redirectType:null},error:u});throw u}}async signInWithIdToken(s){try{const{options:l,provider:o,token:c,access_token:u,nonce:m}=s,g=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:c,access_token:u,nonce:m,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ma}),{data:f,error:x}=g;if(x)return this._returnResult({data:{user:null,session:null},error:x});if(!f||!f.session||!f.user){const y=new Dr;return this._returnResult({data:{user:null,session:null},error:y})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:x})}catch(l){if(be(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithOtp(s){var l,o,c,u,m;try{if("email"in s){const{email:g,options:f}=s;let x=null,y=null;this.flowType==="pkce"&&([x,y]=await Ar(this.storage,this.storageKey));const{error:_}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(l=f==null?void 0:f.data)!==null&&l!==void 0?l:{},create_user:(o=f==null?void 0:f.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:x,code_challenge_method:y},redirectTo:f==null?void 0:f.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:_})}if("phone"in s){const{phone:g,options:f}=s,{data:x,error:y}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(c=f==null?void 0:f.data)!==null&&c!==void 0?c:{},create_user:(u=f==null?void 0:f.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},channel:(m=f==null?void 0:f.channel)!==null&&m!==void 0?m:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:x==null?void 0:x.message_id},error:y})}throw new fi("You must provide either an email or phone number.")}catch(g){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(s){var l,o;try{let c,u;"options"in s&&(c=(l=s.options)===null||l===void 0?void 0:l.redirectTo,u=(o=s.options)===null||o===void 0?void 0:o.captchaToken);const{data:m,error:g}=await _e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:u}}),redirectTo:c,xform:ma});if(g)throw g;if(!m)throw new Error("An error occurred on token verification.");const f=m.session,x=m.user;return f!=null&&f.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:x,session:f},error:null})}catch(c){if(be(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signInWithSSO(s){var l,o,c,u,m;try{let g=null,f=null;this.flowType==="pkce"&&([g,f]=await Ar(this.storage,this.storageKey));const x=await _e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(o=(l=s.options)===null||l===void 0?void 0:l.redirectTo)!==null&&o!==void 0?o:void 0}),!((c=s==null?void 0:s.options)===null||c===void 0)&&c.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:f}),headers:this.headers,xform:av});return!((u=x.data)===null||u===void 0)&&u.url&&_t()&&!(!((m=s.options)===null||m===void 0)&&m.skipBrowserRedirect)&&window.location.assign(x.data.url),this._returnResult(x)}catch(g){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:l},error:o}=s;if(o)throw o;if(!l)throw new Kt;const{error:c}=await _e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:l.access_token});return this._returnResult({data:{user:null,session:null},error:c})})}catch(s){if(be(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async resend(s){try{const l=`${this.url}/resend`;if("email"in s){const{email:o,type:c,options:u}=s,{error:m}=await _e(this.fetch,"POST",l,{headers:this.headers,body:{email:o,type:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},redirectTo:u==null?void 0:u.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}else if("phone"in s){const{phone:o,type:c,options:u}=s,{data:m,error:g}=await _e(this.fetch,"POST",l,{headers:this.headers,body:{phone:o,type:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:g})}throw new fi("You must provide either an email or phone number and a type")}catch(l){if(be(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async l=>l))}async _acquireLock(s,l){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await o,await l()))();return this.pendingInLock.push((async()=>{try{await c}catch{}})()),c}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=l();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const c=[...this.pendingInLock];await Promise.all(c),this.pendingInLock.splice(0,c.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const l=await this.__loadSession();return await s(l)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const l=await Bs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",l),l!==null&&(this._isValidSession(l)?s=l:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const o=s.expires_at?s.expires_at*1e3-Date.now()<ad:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",s.expires_at),!o){if(this.userStorage){const m=await Bs(this.userStorage,this.storageKey+"-user");m!=null&&m.user?s.user=m.user:s.user=nd()}if(this.storage.isServer&&s.user&&!s.user.__isUserNotAvailableProxy){const m={value:this.suppressGetSessionWarning};s.user=Zy(s.user,m),m.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:s},error:null}}const{data:c,error:u}=await this._callRefreshToken(s.refresh_token);return u?this._returnResult({data:{session:null},error:u}):this._returnResult({data:{session:c},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(s){if(s)return await this._getUser(s);await this.initializePromise;const l=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return l.data.user&&(this.suppressGetSessionWarning=!0),l}async _getUser(s){try{return s?await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:xs}):await this._useSession(async l=>{var o,c,u;const{data:m,error:g}=l;if(g)throw g;return!(!((o=m.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Kt}:await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(u=(c=m.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0,xform:xs})})}catch(l){if(be(l))return Ey(l)&&(await this._removeSession(),await wt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:l});throw l}}async updateUser(s,l={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(s,l))}async _updateUser(s,l={}){try{return await this._useSession(async o=>{const{data:c,error:u}=o;if(u)throw u;if(!c.session)throw new Kt;const m=c.session;let g=null,f=null;this.flowType==="pkce"&&s.email!=null&&([g,f]=await Ar(this.storage,this.storageKey));const{data:x,error:y}=await _e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:l==null?void 0:l.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:g,code_challenge_method:f}),jwt:m.access_token,xform:xs});if(y)throw y;return m.user=x.user,await this._saveSession(m),await this._notifyAllSubscribers("USER_UPDATED",m),this._returnResult({data:{user:m.user},error:null})})}catch(o){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(o))return this._returnResult({data:{user:null},error:o});throw o}}async setSession(s){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new Kt;const l=Date.now()/1e3;let o=l,c=!0,u=null;const{payload:m}=rd(s.access_token);if(m.exp&&(o=m.exp,c=o<=l),c){const{data:g,error:f}=await this._callRefreshToken(s.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!g)return{data:{user:null,session:null},error:null};u=g}else{const{data:g,error:f}=await this._getUser(s.access_token);if(f)throw f;u={access_token:s.access_token,refresh_token:s.refresh_token,user:g.user,token_type:"bearer",expires_in:o-l,expires_at:o},await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)}return this._returnResult({data:{user:u.user,session:u},error:null})}catch(l){if(be(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async l=>{var o;if(!s){const{data:m,error:g}=l;if(g)throw g;s=(o=m.session)!==null&&o!==void 0?o:void 0}if(!(s!=null&&s.refresh_token))throw new Kt;const{data:c,error:u}=await this._callRefreshToken(s.refresh_token);return u?this._returnResult({data:{user:null,session:null},error:u}):c?this._returnResult({data:{user:c.user,session:c},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(l){if(be(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async _getSessionFromURL(s,l){try{if(!_t())throw new gi("No browser detected.");if(s.error||s.error_description||s.error_code)throw new gi(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(l){case"implicit":if(this.flowType==="pkce")throw new Y0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new gi("Not a valid implicit grant flow url.");break;default:}if(l==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new Y0("No code detected.");const{data:q,error:Q}=await this._exchangeCodeForSession(s.code);if(Q)throw Q;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:q.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:c,access_token:u,refresh_token:m,expires_in:g,expires_at:f,token_type:x}=s;if(!u||!g||!m||!x)throw new gi("No session defined in URL");const y=Math.round(Date.now()/1e3),_=parseInt(g);let k=y+_;f&&(k=parseInt(f));const S=k-y;S*1e3<=zr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${_}s`);const w=k-_;y-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,k,y):y-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,k,y);const{data:v,error:j}=await this._getUser(u);if(j)throw j;const U={provider_token:o,provider_refresh_token:c,access_token:u,expires_in:_,expires_at:k,refresh_token:m,token_type:x,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:U,redirectType:s.type},error:null})}catch(o){if(be(o))return this._returnResult({data:{session:null,redirectType:null},error:o});throw o}}_isImplicitGrantCallback(s){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),s):!!(s.access_token||s.error_description)}async _isPKCECallback(s){const l=await Bs(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&l)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async l=>{var o;const{data:c,error:u}=l;if(u)return this._returnResult({error:u});const m=(o=c.session)===null||o===void 0?void 0:o.access_token;if(m){const{error:g}=await this.admin.signOut(m,s);if(g&&!(ky(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return s!=="others"&&(await this._removeSession(),await wt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(s){const l=By(),o={id:l,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",l),this.stateChangeEmitters.delete(l)}};return this._debug("#onAuthStateChange()","registered callback with id",l),this.stateChangeEmitters.set(l,o),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(l)})))(),{data:{subscription:o}}}async _emitInitialSession(s){return await this._useSession(async l=>{var o,c;try{const{data:{session:u},error:m}=l;if(m)throw m;await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",u)),this._debug("INITIAL_SESSION","callback id",s,"session",u)}catch(u){await((c=this.stateChangeEmitters.get(s))===null||c===void 0?void 0:c.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",u),console.error(u)}})}async resetPasswordForEmail(s,l={}){let o=null,c=null;this.flowType==="pkce"&&([o,c]=await Ar(this.storage,this.storageKey,!0));try{return await _e(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:o,code_challenge_method:c,gotrue_meta_security:{captcha_token:l.captchaToken}},headers:this.headers,redirectTo:l.redirectTo})}catch(u){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(u))return this._returnResult({data:null,error:u});throw u}}async getUserIdentities(){var s;try{const{data:l,error:o}=await this.getUser();if(o)throw o;return this._returnResult({data:{identities:(s=l.user.identities)!==null&&s!==void 0?s:[]},error:null})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async linkIdentity(s){return"token"in s?this.linkIdentityIdToken(s):this.linkIdentityOAuth(s)}async linkIdentityOAuth(s){var l;try{const{data:o,error:c}=await this._useSession(async u=>{var m,g,f,x,y;const{data:_,error:k}=u;if(k)throw k;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(m=s.options)===null||m===void 0?void 0:m.redirectTo,scopes:(g=s.options)===null||g===void 0?void 0:g.scopes,queryParams:(f=s.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await _e(this.fetch,"GET",S,{headers:this.headers,jwt:(y=(x=_.session)===null||x===void 0?void 0:x.access_token)!==null&&y!==void 0?y:void 0})});if(c)throw c;return _t()&&!(!((l=s.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(o==null?void 0:o.url),this._returnResult({data:{provider:s.provider,url:o==null?void 0:o.url},error:null})}catch(o){if(be(o))return this._returnResult({data:{provider:s.provider,url:null},error:o});throw o}}async linkIdentityIdToken(s){return await this._useSession(async l=>{var o;try{const{error:c,data:{session:u}}=l;if(c)throw c;const{options:m,provider:g,token:f,access_token:x,nonce:y}=s,_=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(o=u==null?void 0:u.access_token)!==null&&o!==void 0?o:void 0,body:{provider:g,id_token:f,access_token:x,nonce:y,link_identity:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:ma}),{data:k,error:S}=_;return S?this._returnResult({data:{user:null,session:null},error:S}):!k||!k.session||!k.user?this._returnResult({data:{user:null,session:null},error:new Dr}):(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("USER_UPDATED",k.session)),this._returnResult({data:k,error:S}))}catch(c){if(await wt(this.storage,`${this.storageKey}-code-verifier`),be(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}})}async unlinkIdentity(s){try{return await this._useSession(async l=>{var o,c;const{data:u,error:m}=l;if(m)throw m;return await _e(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(c=(o=u.session)===null||o===void 0?void 0:o.access_token)!==null&&c!==void 0?c:void 0})})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async _refreshAccessToken(s){const l=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(l,"begin");try{const o=Date.now();return await Py(async c=>(c>0&&await $y(200*Math.pow(2,c-1)),this._debug(l,"refreshing attempt",c),await _e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:ma})),(c,u)=>{const m=200*Math.pow(2,c);return u&&sd(u)&&Date.now()+m-o<zr})}catch(o){if(this._debug(l,"error",o),be(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}finally{this._debug(l,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,l){const o=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:l.redirectTo,scopes:l.scopes,queryParams:l.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",l,"url",o),_t()&&!l.skipBrowserRedirect&&window.location.assign(o),{data:{provider:s,url:o},error:null}}async _recoverAndRefresh(){var s,l;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const c=await Bs(this.storage,this.storageKey);if(c&&this.userStorage){let m=await Bs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!m&&(m={user:c.user},await Br(this.userStorage,this.storageKey+"-user",m)),c.user=(s=m==null?void 0:m.user)!==null&&s!==void 0?s:nd()}else if(c&&!c.user&&!c.user){const m=await Bs(this.storage,this.storageKey+"-user");m&&(m!=null&&m.user)?(c.user=m.user,await wt(this.storage,this.storageKey+"-user"),await Br(this.storage,this.storageKey,c)):c.user=nd()}if(this._debug(o,"session from storage",c),!this._isValidSession(c)){this._debug(o,"session is not valid"),c!==null&&await this._removeSession();return}const u=((l=c.expires_at)!==null&&l!==void 0?l:1/0)*1e3-Date.now()<ad;if(this._debug(o,`session has${u?"":" not"} expired with margin of ${ad}s`),u){if(this.autoRefreshToken&&c.refresh_token){const{error:m}=await this._callRefreshToken(c.refresh_token);m&&(console.error(m),sd(m)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",m),await this._removeSession()))}}else if(c.user&&c.user.__isUserNotAvailableProxy===!0)try{const{data:m,error:g}=await this._getUser(c.access_token);!g&&(m!=null&&m.user)?(c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(m){console.error("Error getting user data:",m),this._debug(o,"error getting user data, skipping SIGNED_IN notification",m)}else await this._notifyAllSubscribers("SIGNED_IN",c)}catch(c){this._debug(o,"error",c),console.error(c);return}finally{this._debug(o,"end")}}async _callRefreshToken(s){var l,o;if(!s)throw new Kt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const c=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(c,"begin");try{this.refreshingDeferred=new ki;const{data:u,error:m}=await this._refreshAccessToken(s);if(m)throw m;if(!u.session)throw new Kt;await this._saveSession(u.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const g={data:u.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(u){if(this._debug(c,"error",u),be(u)){const m={data:null,error:u};return sd(u)||await this._removeSession(),(l=this.refreshingDeferred)===null||l===void 0||l.resolve(m),m}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(u),u}finally{this.refreshingDeferred=null,this._debug(c,"end")}}async _notifyAllSubscribers(s,l,o=!0){const c=`#_notifyAllSubscribers(${s})`;this._debug(c,"begin",l,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:s,session:l});const u=[],m=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(s,l)}catch(f){u.push(f)}});if(await Promise.all(m),u.length>0){for(let g=0;g<u.length;g+=1)console.error(u[g]);throw u[0]}}finally{this._debug(c,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0,await wt(this.storage,`${this.storageKey}-code-verifier`);const l=Object.assign({},s),o=l.user&&l.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&l.user&&await Br(this.userStorage,this.storageKey+"-user",{user:l.user});const c=Object.assign({},l);delete c.user;const u=X0(c);await Br(this.storage,this.storageKey,u)}else{const c=X0(l);await Br(this.storage,this.storageKey,c)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await wt(this.storage,this.storageKey),await wt(this.storage,this.storageKey+"-code-verifier"),await wt(this.storage,this.storageKey+"-user"),this.userStorage&&await wt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&_t()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(l){console.error("removing visibilitychange callback failed",l)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),zr);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s);const l=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=l,l&&typeof l=="object"&&typeof l.unref=="function"?l.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(l)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s);const l=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,l&&clearTimeout(l)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async l=>{const{data:{session:o}}=l;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const c=Math.floor((o.expires_at*1e3-s)/zr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${c} ticks, a tick lasts ${zr}ms, refresh threshold is ${gd} ticks`),c<=gd&&await this._callRefreshToken(o.refresh_token)})}catch(l){console.error("Auto refresh tick failed with error. This is likely a transient error.",l)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof Cf)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_t()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const l=`#_onVisibilityChanged(${s})`;this._debug(l,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(l,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,l,o){const c=[`provider=${encodeURIComponent(l)}`];if(o!=null&&o.redirectTo&&c.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o!=null&&o.scopes&&c.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[u,m]=await Ar(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(m)}`});c.push(g.toString())}if(o!=null&&o.queryParams){const u=new URLSearchParams(o.queryParams);c.push(u.toString())}return o!=null&&o.skipBrowserRedirect&&c.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${s}?${c.join("&")}`}async _unenroll(s){try{return await this._useSession(async l=>{var o;const{data:c,error:u}=l;return u?this._returnResult({data:null,error:u}):await _e(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(o=c==null?void 0:c.session)===null||o===void 0?void 0:o.access_token})})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async _enroll(s){try{return await this._useSession(async l=>{var o,c;const{data:u,error:m}=l;if(m)return this._returnResult({data:null,error:m});const g=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:s.factorType==="totp"?{issuer:s.issuer}:{}),{data:f,error:x}=await _e(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(o=u==null?void 0:u.session)===null||o===void 0?void 0:o.access_token});return x?this._returnResult({data:null,error:x}):(s.factorType==="totp"&&f.type==="totp"&&(!((c=f==null?void 0:f.totp)===null||c===void 0)&&c.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async _verify(s){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async l=>{var o;const{data:c,error:u}=l;if(u)return this._returnResult({data:null,error:u});const m=Object.assign({challenge_id:s.challengeId},"webauthn"in s?{webauthn:Object.assign(Object.assign({},s.webauthn),{credential_response:s.webauthn.type==="create"?yv(s.webauthn.credential_response):vv(s.webauthn.credential_response)})}:{code:s.code}),{data:g,error:f}=await _e(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:m,headers:this.headers,jwt:(o=c==null?void 0:c.session)===null||o===void 0?void 0:o.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:f}))})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}})}async _challenge(s){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async l=>{var o;const{data:c,error:u}=l;if(u)return this._returnResult({data:null,error:u});const m=await _e(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:s,headers:this.headers,jwt:(o=c==null?void 0:c.session)===null||o===void 0?void 0:o.access_token});if(m.error)return m;const{data:g}=m;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:xv(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:pv(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}})}async _challengeAndVerify(s){const{data:l,error:o}=await this._challenge({factorId:s.factorId});return o?this._returnResult({data:null,error:o}):await this._verify({factorId:s.factorId,challengeId:l.id,code:s.code})}async _listFactors(){var s;const{data:{user:l},error:o}=await this.getUser();if(o)return{data:null,error:o};const c={all:[],phone:[],totp:[],webauthn:[]};for(const u of(s=l==null?void 0:l.factors)!==null&&s!==void 0?s:[])c.all.push(u),u.status==="verified"&&c[u.factor_type].push(u);return{data:c,error:null}}async _getAuthenticatorAssuranceLevel(){var s,l;const{data:{session:o},error:c}=await this.getSession();if(c)return this._returnResult({data:null,error:c});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=rd(o.access_token);let m=null;u.aal&&(m=u.aal);let g=m;((l=(s=o.user.factors)===null||s===void 0?void 0:s.filter(y=>y.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(g="aal2");const x=u.amr||[];return{data:{currentLevel:m,nextLevel:g,currentAuthenticationMethods:x},error:null}}async _getAuthorizationDetails(s){try{return await this._useSession(async l=>{const{data:{session:o},error:c}=l;return c?this._returnResult({data:null,error:c}):o?await _e(this.fetch,"GET",`${this.url}/oauth/authorizations/${s}`,{headers:this.headers,jwt:o.access_token,xform:u=>({data:u,error:null})}):this._returnResult({data:null,error:new Kt})})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async _approveAuthorization(s,l){try{return await this._useSession(async o=>{const{data:{session:c},error:u}=o;if(u)return this._returnResult({data:null,error:u});if(!c)return this._returnResult({data:null,error:new Kt});const m=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${s}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return m.data&&m.data.redirect_url&&_t()&&!(l!=null&&l.skipBrowserRedirect)&&window.location.assign(m.data.redirect_url),m})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async _denyAuthorization(s,l){try{return await this._useSession(async o=>{const{data:{session:c},error:u}=o;if(u)return this._returnResult({data:null,error:u});if(!c)return this._returnResult({data:null,error:new Kt});const m=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${s}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return m.data&&m.data.redirect_url&&_t()&&!(l!=null&&l.skipBrowserRedirect)&&window.location.assign(m.data.redirect_url),m})}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}async _listOAuthGrants(){try{return await this._useSession(async s=>{const{data:{session:l},error:o}=s;return o?this._returnResult({data:null,error:o}):l?await _e(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,xform:c=>({data:c,error:null})}):this._returnResult({data:null,error:new Kt})})}catch(s){if(be(s))return this._returnResult({data:null,error:s});throw s}}async _revokeOAuthGrant(s){try{return await this._useSession(async l=>{const{data:{session:o},error:c}=l;return c?this._returnResult({data:null,error:c}):o?(await _e(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:o.access_token,query:{client_id:s.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Kt})})}catch(l){if(be(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(s,l={keys:[]}){let o=l.keys.find(g=>g.kid===s);if(o)return o;const c=Date.now();if(o=this.jwks.keys.find(g=>g.kid===s),o&&this.jwks_cached_at+Cy>c)return o;const{data:u,error:m}=await _e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(m)throw m;return!u.keys||u.keys.length===0||(this.jwks=u,this.jwks_cached_at=c,o=u.keys.find(g=>g.kid===s),!o)?null:o}async getClaims(s,l={}){try{let o=s;if(!o){const{data:S,error:w}=await this.getSession();if(w||!S.session)return this._returnResult({data:null,error:w});o=S.session.access_token}const{header:c,payload:u,signature:m,raw:{header:g,payload:f}}=rd(o);l!=null&&l.allowExpired||Ky(u.exp);const x=!c.alg||c.alg.startsWith("HS")||!c.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(c.kid,l!=null&&l.keys?{keys:l.keys}:l==null?void 0:l.jwks);if(!x){const{error:S}=await this.getUser(o);if(S)throw S;return{data:{claims:u,header:c,signature:m},error:null}}const y=Fy(c.alg),_=await crypto.subtle.importKey("jwk",x,y,!0,["verify"]);if(!await crypto.subtle.verify(y,_,m,My(`${g}.${f}`)))throw new yd("Invalid JWT signature");return{data:{claims:u,header:c,signature:m},error:null}}catch(o){if(be(o))return this._returnResult({data:null,error:o});throw o}}}Yn.nextInstanceID={};const kv=Yn,Ev="2.91.0";let In="";typeof Deno<"u"?In="deno":typeof document<"u"?In="web":typeof navigator<"u"&&navigator.product==="ReactNative"?In="react-native":In="node";const Dv={"X-Client-Info":`supabase-js-${In}/${Ev}`},Av={headers:Dv},Ov={schema:"public"},Rv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Lv={};function Qn(r){"@babel/helpers - typeof";return Qn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Qn(r)}function Uv(r,s){if(Qn(r)!="object"||!r)return r;var l=r[Symbol.toPrimitive];if(l!==void 0){var o=l.call(r,s);if(Qn(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(r)}function Mv(r){var s=Uv(r,"string");return Qn(s)=="symbol"?s:s+""}function zv(r,s,l){return(s=Mv(s))in r?Object.defineProperty(r,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[s]=l,r}function rf(r,s){var l=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);s&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(r,c).enumerable})),l.push.apply(l,o)}return l}function rt(r){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?rf(Object(l),!0).forEach(function(o){zv(r,o,l[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(l)):rf(Object(l)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(l,o))})}return r}const Bv=r=>r?(...s)=>r(...s):(...s)=>fetch(...s),Iv=()=>Headers,Vv=(r,s,l)=>{const o=Bv(l),c=Iv();return async(u,m)=>{var g;const f=(g=await s())!==null&&g!==void 0?g:r;let x=new c(m==null?void 0:m.headers);return x.has("apikey")||x.set("apikey",r),x.has("Authorization")||x.set("Authorization",`Bearer ${f}`),o(u,rt(rt({},m),{},{headers:x}))}};function $v(r){return r.endsWith("/")?r:r+"/"}function Pv(r,s){var l,o;const{db:c,auth:u,realtime:m,global:g}=r,{db:f,auth:x,realtime:y,global:_}=s,k={db:rt(rt({},f),c),auth:rt(rt({},x),u),realtime:rt(rt({},y),m),storage:{},global:rt(rt(rt({},_),g),{},{headers:rt(rt({},(l=_==null?void 0:_.headers)!==null&&l!==void 0?l:{}),(o=g==null?void 0:g.headers)!==null&&o!==void 0?o:{})}),accessToken:async()=>""};return r.accessToken?k.accessToken=r.accessToken:delete k.accessToken,k}function Hv(r){const s=r==null?void 0:r.trim();if(!s)throw new Error("supabaseUrl is required.");if(!s.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL($v(s))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Gv=class extends kv{constructor(r){super(r)}},qv=class{constructor(r,s,l){var o,c;this.supabaseUrl=r,this.supabaseKey=s;const u=Hv(r);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const m=`sb-${u.hostname.split(".")[0]}-auth-token`,g={db:Ov,realtime:Lv,auth:rt(rt({},Rv),{},{storageKey:m}),global:Av},f=Pv(l??{},g);if(this.storageKey=(o=f.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(c=f.global.headers)!==null&&c!==void 0?c:{},f.accessToken)this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(y,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}});else{var x;this.auth=this._initSupabaseAuthClient((x=f.auth)!==null&&x!==void 0?x:{},this.headers,f.global.fetch)}this.fetch=Vv(s,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(rt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(y=>this.realtime.setAuth(y)).catch(y=>console.warn("Failed to set initial Realtime auth token:",y)),this.rest=new _p(new URL("rest/v1",u).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new jy(this.storageUrl.href,this.headers,this.fetch,l==null?void 0:l.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new vp(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(r,s,l)}channel(r,s={config:{}}){return this.realtime.channel(r,s)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var r=this,s,l;if(r.accessToken)return await r.accessToken();const{data:o}=await r.auth.getSession();return(s=(l=o.session)===null||l===void 0?void 0:l.access_token)!==null&&s!==void 0?s:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:s,detectSessionInUrl:l,storage:o,userStorage:c,storageKey:u,flowType:m,lock:g,debug:f,throwOnError:x},y,_){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Gv({url:this.authUrl.href,headers:rt(rt({},k),y),storageKey:u,autoRefreshToken:r,persistSession:s,detectSessionInUrl:l,storage:o,userStorage:c,flowType:m,lock:g,debug:f,throwOnError:x,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new $p(this.realtimeUrl.href,rt(rt({},r),{},{params:rt(rt({},{apikey:this.supabaseKey}),r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(r,s,l){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):r==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Yv=(r,s,l)=>new qv(r,s,l);function Qv(){if(typeof window<"u")return!1;const r=globalThis.process;if(!r)return!1;const s=r.version;if(s==null)return!1;const l=s.match(/^v(\d+)\./);return l?parseInt(l[1],10)<=18:!1}Qv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ir="https://mateqvfogzwictdpaurj.supabase.co",Jv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1hdGVxdmZvZ3p3aWN0ZHBhdXJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4MjEyNTMsImV4cCI6MjA3OTM5NzI1M30.wILVPfgZVBaPYeJF29d9YG_4mN2HP0kSGid8t9tTLUw",re=Yv(Ir,Jv),V=({children:r,variant:s="primary",size:l="md",className:o="",...c})=>{const u={primary:"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg shadow-indigo-500/20",secondary:"bg-gray-800 hover:bg-gray-700 text-gray-100 border border-gray-700",danger:"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-500/20",ghost:"bg-transparent hover:bg-gray-800 text-gray-400 hover:text-white",outline:"bg-transparent border border-indigo-500/50 hover:border-indigo-500 text-indigo-400"},m={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return e.jsx("button",{className:`rounded-lg font-bold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed ${u[s]} ${m[l]} ${o}`,...c,children:r})},ge=({children:r,color:s="gray",className:l=""})=>{const o={indigo:"bg-indigo-500/10 text-indigo-400 border-indigo-500/20",green:"bg-green-500/10 text-green-400 border-green-500/20",red:"bg-red-500/10 text-red-400 border-red-500/20",yellow:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20",gray:"bg-gray-500/10 text-gray-400 border-gray-500/20"};return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold border ${o[s]} ${l}`,children:r})},me=({children:r,className:s="",title:l,...o})=>e.jsxs("div",{className:`bg-gray-900 border border-gray-800 rounded-xl overflow-hidden ${s}`,...o,children:[l&&e.jsx("div",{className:"px-6 py-4 border-b border-gray-800 font-semibold text-gray-300",children:l}),e.jsx("div",{className:"p-6",children:r})]}),Re=({isOpen:r,onClose:s,title:l,children:o,size:c="md"})=>{if(!r)return null;const u={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl",full:"max-w-[95vw]"};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:s,children:e.jsxs("div",{className:`bg-gray-900 border border-gray-800 w-full ${u[c]} rounded-2xl shadow-2xl animate-in zoom-in-95 duration-200`,onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-800 bg-gray-900/50",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:l}),e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-white transition-colors p-1 hover:bg-gray-800 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto",children:o})]})})},ee=({label:r,error:s,as:l="input",className:o="",...c})=>{const u=l;return e.jsxs("div",{className:"space-y-1",children:[r&&e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:r}),e.jsx(u,{className:`w-full bg-gray-950 border border-gray-800 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all placeholder-gray-600 ${o}`,...c}),s&&e.jsx("p",{className:"text-xs text-red-500",children:s})]})},Kv=({onSuccess:r,initialMode:s="login"})=>{const[l,o]=D.useState(!1),[c,u]=D.useState(""),[m,g]=D.useState(""),[f,x]=D.useState(s==="signup"),[y,_]=D.useState(""),k=async S=>{S.preventDefault(),o(!0),_("");try{if(f){const{error:w}=await re.auth.signUp({email:c,password:m});if(w)throw w;_("Verifique seu email para confirmar o cadastro!")}else{const{error:w}=await re.auth.signInWithPassword({email:c,password:m});if(w)throw w;r()}}catch(w){_(w.message||"Erro ao autenticar")}finally{o(!1)}};return e.jsx("div",{className:"min-h-screen bg-[#02040a] flex items-center justify-center px-6",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"/logo.png",alt:"TripDivide",className:"h-24 w-auto mx-auto mb-6"}),e.jsx("h1",{className:"text-3xl font-black text-white uppercase tracking-tight mb-2",children:f?"Criar Conta":"Entrar"}),e.jsx("p",{className:"text-gray-400 text-sm",children:f?"Crie sua conta para comear":"Entre para acessar suas viagens"})]}),e.jsx(me,{className:"!bg-gray-900/50 !border-white/10",children:e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-300 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:c,onChange:S=>u(S.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 transition-colors",placeholder:"seu@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-300 mb-2",children:"Senha"}),e.jsx("input",{type:"password",value:m,onChange:S=>g(S.target.value),required:!0,minLength:6,className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500 transition-colors",placeholder:""})]}),y&&e.jsx("div",{className:`p-3 rounded-xl text-sm ${y.includes("Erro")||y.includes("erro")?"bg-red-500/10 text-red-400 border border-red-500/20":"bg-green-500/10 text-green-400 border border-green-500/20"}`,children:y}),e.jsx(V,{type:"submit",variant:"primary",disabled:l,className:"w-full !py-3 !text-lg font-black uppercase",children:l?"Aguarde...":f?"Criar Conta":"Entrar"}),e.jsx("button",{type:"button",onClick:()=>{x(!f),_("")},className:"w-full text-sm text-gray-400 hover:text-white transition-colors",children:f?"J tem conta? Entre aqui":"No tem conta? Cadastre-se"})]})}),e.jsx("p",{className:"text-center text-xs text-gray-600 mt-6",children:"Ao criar uma conta, voc concorda com nossos termos de uso"})]})})},Ae={Dashboard:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),Travelers:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),Vendors:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Quotes:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Expenses:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Settlement:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),Plus:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Check:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),X:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Calendar:r=>e.jsx("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),MapPin:r=>e.jsxs("svg",{...r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})},Fv=({children:r,activeTab:s,setActiveTab:l,tripId:o,tripName:c,userEmail:u,onTripChange:m,onCreateTrip:g,onCloseTrip:f})=>{const x=[{id:"general-dashboard",label:"Dashboard",icon:Ae.Dashboard},{id:"trips",label:"Viagens",icon:Ae.Dashboard},{id:"travelers",label:"Viajantes",icon:Ae.Travelers},{id:"vendors",label:"Fornecedores",icon:Ae.Vendors}],y=[{id:"trip-dashboard",label:"Dashboard",icon:Ae.Dashboard},{id:"travelers",label:"Viajantes",icon:Ae.Travelers},{id:"vendors",label:"Fornecedores",icon:Ae.Vendors},{id:"quotes",label:"Oramentos",icon:Ae.Quotes},{id:"expenses",label:"Itens Fechados",icon:Ae.Expenses},{id:"payments",label:"Fluxo de Caixa",icon:Ae.Expenses},{id:"settlement",label:"Acerto de Contas",icon:Ae.Settlement}],_=o?y:x,k=async()=>{await re.auth.signOut(),window.location.reload()};return e.jsxs("div",{className:"flex min-h-screen bg-gray-950 text-gray-100",children:[e.jsxs("aside",{className:"w-64 bg-gray-900 border-r border-gray-800 hidden md:flex flex-col fixed h-full z-10 shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-gray-800 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center font-bold italic text-white shadow-lg shadow-indigo-600/30",children:"TD"}),e.jsx("h1",{className:"text-xl font-black tracking-tight text-white uppercase",children:"TripDivide"})]}),o&&c&&e.jsxs("div",{className:"mt-2 p-3 bg-indigo-600/10 border border-indigo-600/30 rounded-lg",children:[e.jsx("div",{className:"text-[10px] font-bold text-indigo-400 uppercase mb-1",children:"Viagem Ativa"}),e.jsx("div",{className:"text-sm font-bold text-white mb-2",children:c}),e.jsx(V,{onClick:f,className:"w-full bg-gray-800 hover:bg-gray-700 text-xs",children:" Voltar ao Geral"})]})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:_.map(S=>{const w=S.icon;return e.jsxs("button",{onClick:()=>l(S.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-bold text-xs uppercase tracking-tight text-left ${s===S.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-600/20":"text-gray-400 hover:bg-gray-800 hover:text-gray-200"}`,children:[e.jsx(w,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:S.label})]},S.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-800 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-950 rounded-xl border border-gray-800",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-xs font-bold text-indigo-400 border border-indigo-500/30",children:u?u[0].toUpperCase():"U"}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("p",{className:"text-[10px] font-bold truncate text-white uppercase",children:u||"Usurio"}),e.jsx("p",{className:"text-[9px] text-gray-500 font-black uppercase",children:"Organizador"})]})]}),e.jsx("button",{onClick:k,className:"w-full px-4 py-2 bg-red-600/10 hover:bg-red-600/20 border border-red-600/20 hover:border-red-600/30 rounded-xl text-red-400 hover:text-red-300 text-xs font-bold uppercase tracking-tight transition-all",children:"Sair"})]})]}),e.jsx("main",{className:"flex-1 md:ml-64 p-4 md:p-8",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:r})})]})},he={getTrips:async()=>{const{data:{user:r}}=await re.auth.getUser();if(!r)return[];const{data:s,error:l}=await re.from("td_trips").select("*").eq("user_id",r.id).order("updated_at",{ascending:!1});if(l)throw l;return s||[]},getActiveTrip:async()=>{const{data:{user:r}}=await re.auth.getUser();if(!r)return null;const{data:s,error:l}=await re.from("td_user_active_trip").select("active_trip_id").eq("user_id",r.id).single();if(l&&l.code!=="PGRST116")throw l;return(s==null?void 0:s.active_trip_id)||null},setActiveTrip:async r=>{const{data:{user:s}}=await re.auth.getUser();if(!s)throw new Error("Usurio no autenticado");const{error:l}=await re.from("td_user_active_trip").upsert({user_id:s.id,active_trip_id:r,updated_at:new Date().toISOString()});if(l)throw l;return!0},getTripById:async r=>{const{data:s,error:l}=await re.from("td_trips").select("*").eq("id",r).single();if(l)throw l;return s},saveTrip:async r=>{const{data:{user:s}}=await re.auth.getUser();if(!s)throw new Error("Usurio no autenticado");const l=r.startDate&&r.startDate.trim()?r.startDate:null,o=r.endDate&&r.endDate.trim()?r.endDate:null;if(r.id){const{data:c,error:u}=await re.from("td_trips").update({name:r.name,start_date:l,end_date:o,consensus_rule:r.consensusRule,categories:r.categories,status:r.status,destinations:r.destinations,base_currency:r.baseCurrency,default_exchange_rate:r.defaultExchangeRate,default_split_rule:r.defaultSplitRule,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(u)throw u;return c}else{const{data:c,error:u}=await re.from("td_trips").insert({user_id:s.id,name:r.name,start_date:l,end_date:o,consensus_rule:r.consensusRule||"2/3",categories:r.categories||["Voo","Hospedagem","Aluguel de Carro","Restaurantes","Diversos"],status:r.status||"active",destinations:r.destinations||[],base_currency:r.baseCurrency||"BRL",default_exchange_rate:r.defaultExchangeRate||1,default_split_rule:r.defaultSplitRule||"equal"}).select().single();if(u)throw u;return await he.setActiveTrip(c.id),c}},duplicateTrip:async r=>{const{data:{user:s}}=await re.auth.getUser();if(!s)throw new Error("Usurio no autenticado");const{data:l}=await re.from("td_trips").select("*").eq("id",r).single();if(!l)throw new Error("Viagem no encontrada");const{data:o,error:c}=await re.from("td_trips").insert({user_id:s.id,name:`${l.name} (Cpia)`,start_date:l.start_date,end_date:l.end_date,consensus_rule:l.consensus_rule,categories:l.categories,status:"draft",destinations:l.destinations,base_currency:l.base_currency,default_exchange_rate:l.default_exchange_rate,default_split_rule:l.default_split_rule}).select().single();if(c)throw c;const{data:u}=await re.from("td_couples").select("*").eq("trip_id",r);u&&u.length>0&&await re.from("td_couples").insert(u.map(g=>({trip_id:o.id,name:g.name})));const{data:m}=await re.from("td_segments").select("*").eq("trip_id",r);return m&&m.length>0&&await re.from("td_segments").insert(m.map(g=>({trip_id:o.id,name:g.name,start_date:g.start_date,end_date:g.end_date}))),o},archiveTrip:async r=>{const{error:s}=await re.from("td_trips").update({status:"archived",updated_at:new Date().toISOString()}).eq("id",r);if(s)throw s;return!0},deleteTrip:async r=>{const{error:s}=await re.from("td_trips").delete().eq("id",r);if(s)throw s;return!0},finalizeTripDraft:async(r,s)=>{const{error:l}=await re.from("td_trips").update({name:s.name,start_date:s.startDate,end_date:s.endDate,destinations:s.destinations,status:"active",updated_at:new Date().toISOString()}).eq("id",r);if(l)throw l;return await he.setActiveTrip(r),!0},getCouples:async r=>{const{data:s,error:l}=await re.from("td_couples").select("*").eq("trip_id",r).order("created_at",{ascending:!0});if(l)throw l;return s||[]},saveCouple:async(r,s)=>{if(s.id){const{data:l,error:o}=await re.from("td_couples").update({name:s.name}).eq("id",s.id).select().single();if(o)throw o;return l}else{const{data:l,error:o}=await re.from("td_couples").insert({trip_id:r,name:s.name}).select().single();if(o)throw o;return l}},deleteCouple:async r=>{const{data:s}=await re.from("td_travelers").select("id").eq("couple_id",r).eq("status","Ativo").limit(1);if(s&&s.length>0)throw new Error("No  possvel excluir um grupo que possui viajantes. Remova os viajantes primeiro.");const{error:l}=await re.from("td_couples").delete().eq("id",r);if(l)throw l;return!0},getSegments:async r=>{const{data:s,error:l}=await re.from("td_segments").select("*").eq("trip_id",r).order("created_at",{ascending:!0});if(l)throw l;return s||[]},saveSegment:async r=>{const s=r.startDate&&r.startDate.trim()?r.startDate:null,l=r.endDate&&r.endDate.trim()?r.endDate:null;if(r.id){const{data:o,error:c}=await re.from("td_segments").update({name:r.name,start_date:s,end_date:l}).eq("id",r.id).select().single();if(c)throw c;return o}else{const{data:o,error:c}=await re.from("td_segments").insert({trip_id:r.tripId,name:r.name,start_date:s,end_date:l}).select().single();if(c)throw c;return o}},getTravelers:async r=>{const{data:s,error:l}=await re.from("td_travelers").select("*").eq("trip_id",r).eq("status","Ativo").order("created_at",{ascending:!0});if(l)throw l;return(s||[]).map(o=>({id:o.id,tripId:o.trip_id,coupleId:o.couple_id,fullName:o.full_name,documentName:o.document_name,nickname:o.nickname,type:o.type,goesToSegments:o.goes_to_segments||[],isPayer:o.is_payer,status:o.status,createdAt:o.created_at,updatedAt:o.updated_at,phone:o.phone,email:o.email,birthDate:o.birth_date,canDrive:o.can_drive,docType:o.doc_type,docNumber:o.doc_number,docExpiry:o.doc_expiry,tags:o.tags,notes:o.notes}))},saveTraveler:async r=>{if(r.id){const{data:s,error:l}=await re.from("td_travelers").update({couple_id:r.coupleId,full_name:r.fullName,document_name:r.documentName,nickname:r.nickname,type:r.type,goes_to_segments:r.goesToSegments,is_payer:r.isPayer,phone:r.phone,email:r.email,birth_date:r.birthDate,can_drive:r.canDrive,doc_type:r.docType,doc_number:r.docNumber,doc_expiry:r.docExpiry,tags:r.tags,notes:r.notes,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(l)throw l;return{id:s.id,tripId:s.trip_id,coupleId:s.couple_id,fullName:s.full_name,documentName:s.document_name,nickname:s.nickname,type:s.type,goesToSegments:s.goes_to_segments||[],isPayer:s.is_payer,status:s.status,createdAt:s.created_at,updatedAt:s.updated_at,phone:s.phone,email:s.email,birthDate:s.birth_date,canDrive:s.can_drive,docType:s.doc_type,docNumber:s.doc_number,docExpiry:s.doc_expiry,tags:s.tags,notes:s.notes}}else{const{data:s,error:l}=await re.from("td_travelers").insert({trip_id:r.tripId,couple_id:r.coupleId,full_name:r.fullName,document_name:r.documentName,nickname:r.nickname,type:r.type,goes_to_segments:r.goesToSegments,is_payer:r.isPayer,phone:r.phone,email:r.email,birth_date:r.birthDate,can_drive:r.canDrive,doc_type:r.docType,doc_number:r.docNumber,doc_expiry:r.docExpiry,tags:r.tags,notes:r.notes,status:"Ativo"}).select().single();if(l)throw l;return{id:s.id,tripId:s.trip_id,coupleId:s.couple_id,fullName:s.full_name,documentName:s.document_name,nickname:s.nickname,type:s.type,goesToSegments:s.goes_to_segments||[],isPayer:s.is_payer,status:s.status,createdAt:s.created_at,updatedAt:s.updated_at,phone:s.phone,email:s.email,birthDate:s.birth_date,canDrive:s.can_drive,docType:s.doc_type,docNumber:s.doc_number,docExpiry:s.doc_expiry,tags:s.tags,notes:s.notes}}},deleteTraveler:async r=>{const{error:s}=await re.from("td_travelers").update({status:"Arquivado"}).eq("id",r);if(s)throw s},getTravelerDocuments:async r=>{const{data:{session:s}}=await re.auth.getSession();if(!s)throw new Error("No autenticado");const{data:l,error:o}=await re.from("td_traveler_documents").select("*").eq("traveler_id",r).order("created_at",{ascending:!0});if(o)throw o;return await Promise.all((l||[]).map(async u=>{try{const g=await(await fetch(`${Ir}/functions/v1/encrypt-document`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"decrypt",documentId:u.id})})).json(),f=g.success?g.docNumber:""+u.doc_number_last4;return{id:u.id,travelerId:u.traveler_id,docType:u.doc_type,docCategory:u.doc_category,docNumber:f,docNumberLast4:u.doc_number_last4,issuerCountry:u.issuer_country,issuerState:u.issuer_state,issuerAgency:u.issuer_agency,issuerPlace:u.issuer_place,regionOrCountry:u.region_or_country,issueDate:u.issue_date,expiryDate:u.expiry_date,visaCategory:u.visa_category,entryType:u.entry_type,stayDurationDays:u.stay_duration_days,licenseCategory:u.license_category,customLabel:u.custom_label,passportDocumentId:u.passport_document_id,isPrimary:u.is_primary,notes:u.notes,createdAt:u.created_at,updatedAt:u.updated_at}}catch{return{id:u.id,travelerId:u.traveler_id,docType:u.doc_type,docCategory:u.doc_category,docNumber:""+u.doc_number_last4,docNumberLast4:u.doc_number_last4,issuerCountry:u.issuer_country,issuerState:u.issuer_state,issuerAgency:u.issuer_agency,issuerPlace:u.issuer_place,regionOrCountry:u.region_or_country,issueDate:u.issue_date,expiryDate:u.expiry_date,visaCategory:u.visa_category,entryType:u.entry_type,stayDurationDays:u.stay_duration_days,licenseCategory:u.license_category,customLabel:u.custom_label,passportDocumentId:u.passport_document_id,isPrimary:u.is_primary,notes:u.notes,createdAt:u.created_at,updatedAt:u.updated_at}}}))},saveTravelerDocument:async r=>{const{data:{session:s}}=await re.auth.getSession();if(!s)throw new Error("No autenticado");console.log(" Enviando documento para criptografia:",{travelerId:r.travelerId,docType:r.docType,docCategory:r.docCategory,docNumber:r.docNumber?"***"+r.docNumber.slice(-4):"vazio"});const o=await(await fetch(`${Ir}/functions/v1/encrypt-document`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"encrypt",travelerId:r.travelerId,docType:r.docType,docCategory:r.docCategory||(r.docType==="Visto"||r.docType==="ESTA"?"entry":"identity"),docNumber:r.docNumber,issuerCountry:r.issuerCountry,issuerState:r.issuerState,issuerAgency:r.issuerAgency,issuerPlace:r.issuerPlace,regionOrCountry:r.regionOrCountry,issueDate:r.issueDate,expiryDate:r.docExpiry,visaCategory:r.visaCategory,entryType:r.entryType,stayDurationDays:r.stayDurationDays,licenseCategory:r.licenseCategory,customLabel:r.customLabel,passportDocumentId:r.passportDocumentId,isPrimary:r.isPrimary,notes:r.notes,documentId:r.id})})).json();if(!o.success)throw console.error(" Erro ao salvar documento:",o.error),new Error(o.error||"Erro ao salvar documento");return{id:o.documentId,travelerId:r.travelerId,docType:r.docType,docCategory:r.docCategory,docNumber:r.docNumber,docNumberLast4:r.docNumber.replace(/[^A-Za-z0-9]/g,"").slice(-4),issuerCountry:r.issuerCountry,issuerState:r.issuerState,issuerAgency:r.issuerAgency,issuerPlace:r.issuerPlace,regionOrCountry:r.regionOrCountry,issueDate:r.issueDate,expiryDate:r.docExpiry,visaCategory:r.visaCategory,entryType:r.entryType,stayDurationDays:r.stayDurationDays,licenseCategory:r.licenseCategory,customLabel:r.customLabel,passportDocumentId:r.passportDocumentId,isPrimary:r.isPrimary,notes:r.notes,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},decryptTravelerDocument:async r=>{const{data:{session:s}}=await re.auth.getSession();if(!s)throw new Error("No autenticado");const o=await(await fetch(`${Ir}/functions/v1/encrypt-document`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"decrypt",documentId:r})})).json();if(!o.success)throw new Error(o.error);return o.docNumber},deleteTravelerDocument:async r=>{const{error:s}=await re.from("td_traveler_documents").delete().eq("id",r);if(s)throw s},saveTravelerDraft:async r=>{const s={...r,is_draft:!0};return he.saveTraveler(s)},finalizeTravelerDraft:async r=>{const{error:s}=await re.from("td_travelers").update({is_draft:!1}).eq("id",r);if(s)throw s},getTravelerDrafts:async r=>{const{data:s,error:l}=await re.from("td_travelers").select("*").eq("trip_id",r).eq("is_draft",!0).eq("status","Ativo").order("updated_at",{ascending:!1});if(l)throw l;return(s||[]).map(o=>({id:o.id,tripId:o.trip_id,coupleId:o.couple_id,fullName:o.full_name,documentName:o.document_name,nickname:o.nickname,type:o.type,goesToSegments:o.goes_to_segments||[],isPayer:o.is_payer,status:o.status,createdAt:o.created_at,updatedAt:o.updated_at,phone:o.phone,email:o.email,birthDate:o.birth_date,canDrive:o.can_drive,docType:o.doc_type,docNumber:o.doc_number,docExpiry:o.doc_expiry,tags:o.tags,notes:o.notes,isDraft:!0}))},discardTravelerDraft:async r=>{const{error:s}=await re.from("td_travelers").delete().eq("id",r).eq("is_draft",!0);if(s)throw s},getExpiringDocuments:async(r,s=90)=>{const l=new Date,o=new Date;o.setDate(l.getDate()+s);const{data:c,error:u}=await re.from("td_traveler_documents").select(`
        *,
        traveler:td_travelers!inner(
          id,
          full_name,
          trip_id
        )
      `).eq("traveler.trip_id",r).not("doc_expiry","is",null).lte("doc_expiry",o.toISOString().split("T")[0]);if(u)throw u;return(c||[]).map(m=>({documentId:m.id,travelerId:m.traveler.id,travelerName:m.traveler.full_name,docType:m.doc_type,docNumberLast4:m.doc_number_last4,docExpiry:m.doc_expiry,daysUntilExpiry:Math.ceil((new Date(m.doc_expiry).getTime()-l.getTime())/(1e3*60*60*24)),isExpired:new Date(m.doc_expiry)<l}))},calculateDocumentExpiryStatus:r=>{if(!r)return null;const s=new Date,l=new Date(r),o=Math.ceil((l.getTime()-s.getTime())/(1e3*60*60*24));return o<0?{status:"expired",color:"red",label:"Vencido",days:Math.abs(o)}:o<=30?{status:"critical",color:"red",label:`Vence em ${o} dias`,days:o}:o<=90?{status:"warning",color:"yellow",label:`Vence em ${o} dias`,days:o}:{status:"ok",color:"green",label:`Vlido por ${o} dias`,days:o}},normalizeTags:r=>{if(!r||r.length===0)return[];const s=r.map(l=>l.trim()).filter(l=>l.length>0).map(l=>l.replace(/\s+/g," ")).map(l=>l.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" "));return[...new Set(s)]},getExistingTags:async r=>{const{data:s,error:l}=await re.from("td_travelers").select("tags").eq("trip_id",r).eq("status","Ativo").not("tags","is",null);if(l)throw l;const o=(s||[]).flatMap(c=>c.tags||[]).filter(c=>c&&c.trim().length>0);return he.normalizeTags(o)},getVendors:async r=>{const{data:s,error:l}=await re.from("td_vendors").select("*").eq("trip_id",r).eq("status","Ativo").order("created_at",{ascending:!0});if(l)throw l;return s||[]},saveVendor:async r=>{if(r.id){const{data:s,error:l}=await re.from("td_vendors").update({name:r.name,legal_name:r.legalName,categories:r.categories,rating:r.rating,preferred:r.preferred,tags:r.tags,risk_flags:r.riskFlags,contacts:r.contacts,website_url:r.websiteUrl,instagram_url:r.instagramUrl,sla_notes:r.slaNotes,payment_terms_default:r.paymentTermsDefault,cancellation_policy_notes:r.cancellationPolicyNotes,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(l)throw l;return s}else{const{data:s,error:l}=await re.from("td_vendors").insert({trip_id:r.tripId,name:r.name,legal_name:r.legalName,categories:r.categories,rating:r.rating,preferred:r.preferred,tags:r.tags,risk_flags:r.riskFlags,contacts:r.contacts,website_url:r.websiteUrl,instagram_url:r.instagramUrl,sla_notes:r.slaNotes,payment_terms_default:r.paymentTermsDefault,cancellation_policy_notes:r.cancellationPolicyNotes,status:"Ativo"}).select().single();if(l)throw l;return s}},getQuotes:async r=>{const{data:s,error:l}=await re.from("td_quotes").select("*").eq("trip_id",r).order("created_at",{ascending:!1});if(l)throw l;return(s||[]).map(o=>({...o,tripId:o.trip_id,vendorProfileId:o.vendor_profile_id,vendor_profile_id:o.vendor_profile_id,segmentId:o.segment_id,sourceType:o.source_type,source_type:o.source_type,sourceValue:o.source_value,source_value:o.source_value,exchangeRate:o.exchange_rate,totalAmount:o.total_amount,amountBrl:o.amount_brl,validUntil:o.valid_until,participantIds:o.participant_ids,notesGroup:o.notes_group,notesInternal:o.notes_internal,linkUrl:o.link_url,cancellationPolicy:o.cancellation_policy,hotelDetails:o.hotel_details,ticketDetails:o.ticket_details,carDetails:o.car_details,genericDetails:o.generic_details,taxesFees:o.taxes_fees,paymentTerms:o.payment_terms,originalId:o.original_id,variationLabel:o.variation_label,createdBy:o.created_by,createdAt:o.created_at,updatedAt:o.updated_at}))},getQuoteById:async r=>{const{data:s,error:l}=await re.from("td_quotes").select("*").eq("id",r).single();if(l)throw l;return s},saveQuote:async r=>{const{data:{user:s}}=await re.auth.getUser(),l=!!r.vendor_profile_id,o=!!(r.source_type&&r.source_value);if(!l&&!o)throw new Error("Quote deve ter um fornecedor OU uma fonte informada");const c=r.segmentId==="seg-all"?null:r.segmentId;if(r.id){const{data:u,error:m}=await re.from("td_quotes").update({vendor_profile_id:r.vendor_profile_id||null,source_type:r.source_type||null,source_value:r.source_value||null,segment_id:c,title:r.title,category:r.category,provider:r.provider,currency:r.currency,exchange_rate:r.exchangeRate,total_amount:r.totalAmount,amount_brl:r.amountBrl,valid_until:r.validUntil,status:r.status,votes:r.votes,completeness:r.completeness,payment_terms:r.paymentTerms,tags:r.tags,participant_ids:r.participantIds,includes:r.includes,excludes:r.excludes,notes_group:r.notesGroup,notes_internal:r.notesInternal,link_url:r.linkUrl,cancellation_policy:r.cancellationPolicy,hotel_details:r.hotelDetails,ticket_details:r.ticketDetails,car_details:r.carDetails,generic_details:r.genericDetails,taxes_fees:r.taxesFees,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(m)throw m;return u}else{const{data:u,error:m}=await re.from("td_quotes").insert({trip_id:r.tripId,vendor_profile_id:r.vendor_profile_id||null,source_type:r.source_type||null,source_value:r.source_value||null,segment_id:c,title:r.title,category:r.category,provider:r.provider,currency:r.currency,exchange_rate:r.exchangeRate,total_amount:r.totalAmount,amount_brl:r.amountBrl,valid_until:r.validUntil,status:r.status||"Novo",votes:r.votes||[],completeness:r.completeness||0,payment_terms:r.paymentTerms,tags:r.tags||[],participant_ids:r.participantIds||[],includes:r.includes,excludes:r.excludes,notes_group:r.notesGroup,notes_internal:r.notesInternal,link_url:r.linkUrl,cancellation_policy:r.cancellationPolicy,hotel_details:r.hotelDetails,ticket_details:r.ticketDetails,car_details:r.carDetails,generic_details:r.genericDetails,taxes_fees:r.taxesFees,created_by:s==null?void 0:s.id}).select().single();if(m)throw m;return u}},deleteQuote:async r=>{const{error:s}=await re.from("td_quotes").delete().eq("id",r);if(s)throw s},getExpenses:async r=>{const{data:s,error:l}=await re.from("td_expenses").select("*").eq("trip_id",r).neq("status","cancelled").order("created_at",{ascending:!1});if(l)throw l;return s||[]},getExpenseById:async r=>{const{data:s,error:l}=await re.from("td_expenses").select("*").eq("id",r).single();if(l)throw l;return s},saveExpense:async r=>{const s=!!r.vendor_profile_id,l=!!(r.source_type&&r.source_value);if(!s&&!l)throw new Error("Expense deve ter um fornecedor OU uma fonte informada");if(r.id){const{data:o,error:c}=await re.from("td_expenses").update({segment_id:r.segmentId,category:r.category,title:r.title,vendor_profile_id:r.vendor_profile_id||null,source_type:r.source_type||null,source_value:r.source_value||null,source_quote_id:r.sourceQuoteId,currency:r.currency,amount:r.amount,exchange_rate:r.exchangeRate,amount_brl:r.amountBrl,due_date:r.dueDate,status:r.status,notes_group:r.notesGroup,notes_internal:r.notesInternal,hotel_details:r.hotelDetails,ticket_details:r.ticketDetails,car_details:r.carDetails,generic_details:r.genericDetails,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(c)throw c;return o}else{const{data:o,error:c}=await re.from("td_expenses").insert({trip_id:r.tripId,segment_id:r.segmentId,category:r.category,title:r.title,vendor_profile_id:r.vendor_profile_id||null,source_type:r.source_type||null,source_value:r.source_value||null,source_quote_id:r.sourceQuoteId,currency:r.currency,amount:r.amount,exchange_rate:r.exchangeRate,amount_brl:r.amountBrl,due_date:r.dueDate,status:r.status||"planned",notes_group:r.notesGroup,notes_internal:r.notesInternal,hotel_details:r.hotelDetails,ticket_details:r.ticketDetails,car_details:r.carDetails,generic_details:r.genericDetails}).select().single();if(c)throw c;return o}},getPaymentsByTrip:async r=>{const{data:s,error:l}=await re.from("td_payments").select("*").eq("trip_id",r).order("paid_at",{ascending:!1});if(l)throw l;return s||[]},getPaymentsByExpense:async r=>{const{data:s,error:l}=await re.from("td_payments").select("*").eq("expense_id",r).order("paid_at",{ascending:!1});if(l)throw l;return s||[]},savePayment:async r=>{const{data:s,error:l}=await re.from("td_payments").insert({trip_id:r.tripId,expense_id:r.expenseId,paid_by_couple_id:r.paidByCoupleId,method:r.method,installments:r.installments,installment_value:r.installmentValue,paid_amount_brl:r.paidAmountBrl,paid_at:r.paidAt,proof_url:r.proofUrl,notes:r.notes}).select().single();if(l)throw l;if(r.expenseId){const{data:o}=await re.from("td_payments").select("paid_amount_brl").eq("expense_id",r.expenseId),{data:c}=await re.from("td_expenses").select("amount_brl").eq("id",r.expenseId).single();o&&c&&o.reduce((m,g)=>m+g.paid_amount_brl,0)>=c.amount_brl-.01&&await re.from("td_expenses").update({status:"paid"}).eq("id",r.expenseId),await he.generateReimbursementsForExpense(r.expenseId)}return s},getExpenseSplits:async r=>{const{data:s,error:l}=await re.from("td_expense_splits").select("*").eq("expense_id",r);if(l)throw l;return s||[]},updateExpenseSplits:async(r,s)=>{await re.from("td_expense_splits").delete().eq("expense_id",r);const{data:l,error:o}=await re.from("td_expense_splits").insert(s.map(c=>({expense_id:r,couple_id:c.coupleId,split_type:c.splitType,value:c.value,amount_brl:c.amountBrl}))).select();if(o)throw o;return await he.generateReimbursementsForExpense(r),l},getReimbursements:async r=>{const{data:s,error:l}=await re.from("td_reimbursements").select("*").eq("trip_id",r).order("created_at",{ascending:!1});if(l)throw l;return s||[]},markReimbursementAsPaid:async r=>{const{error:s}=await re.from("td_reimbursements").update({status:"paid",paid_at:new Date().toISOString()}).eq("id",r);if(s)throw s},getExpenseSplitsByTrip:async r=>{const{data:s}=await re.from("td_expenses").select("id").eq("trip_id",r).neq("status","cancelled");if(!s||s.length===0)return[];const l=s.map(u=>u.id),{data:o,error:c}=await re.from("td_expense_splits").select("*").in("expense_id",l);if(c)throw c;return o||[]},closeQuoteToExpense:async(r,s)=>{var x;const{data:l}=await re.from("td_quotes").select("*").eq("id",s).single();if(!l)return null;const{data:o}=await re.from("td_couples").select("id").eq("trip_id",r);if(!o)return null;const{data:c,error:u}=await re.from("td_expenses").insert({trip_id:r,segment_id:l.segment_id||null,category:l.category,title:l.title,vendor_profile_id:l.vendor_profile_id||null,source_type:l.source_type||null,source_value:l.source_value||null,source_quote_id:l.id,currency:l.currency,amount:l.total_amount,exchange_rate:l.exchange_rate,amount_brl:l.amount_brl,status:"confirmed",hotel_details:l.hotel_details,ticket_details:l.ticket_details,car_details:l.car_details,generic_details:l.generic_details}).select().single();if(u)throw u;const m=(x=l.participant_ids)!=null&&x.includes("ALL")?o:o.filter(y=>{var _;return(_=l.participant_ids)==null?void 0:_.includes(y.id)}),g=c.amount_brl/m.length,f=m.map(y=>({expense_id:c.id,couple_id:y.id,split_type:"equal",amount_brl:g}));return await re.from("td_expense_splits").insert(f),await re.from("td_quotes").update({status:"Fechada"}).eq("id",s),c},createQuoteVariation:async(r,s)=>{const{data:l}=await re.from("td_quotes").select("*").eq("id",r).single();if(!l)return null;const{data:{user:o}}=await re.auth.getUser(),{data:c,error:u}=await re.from("td_quotes").insert({trip_id:l.trip_id,vendor_profile_id:l.vendor_profile_id,segment_id:l.segment_id,title:l.title,category:l.category,provider:l.provider,currency:l.currency,exchange_rate:l.exchange_rate,total_amount:l.total_amount,amount_brl:l.amount_brl,valid_until:l.valid_until,status:"Novo",votes:[],completeness:l.completeness,payment_terms:l.payment_terms,tags:l.tags,participant_ids:l.participant_ids,includes:l.includes,excludes:l.excludes,notes_group:l.notes_group,notes_internal:l.notes_internal,link_url:l.link_url,cancellation_policy:l.cancellation_policy,hotel_details:l.hotel_details,ticket_details:l.ticket_details,car_details:l.car_details,generic_details:l.generic_details,taxes_fees:l.taxes_fees,original_id:l.original_id||l.id,variation_label:s,created_by:o==null?void 0:o.id}).select().single();if(u)throw u;return c},bulkImportTravelers:async(r,s)=>{var m,g,f,x,y;const l=s.split(`
`).filter(_=>_.trim());let o=0;const{data:c}=await re.from("td_couples").select("id").eq("trip_id",r).limit(1),u=(m=c==null?void 0:c[0])==null?void 0:m.id;if(!u)return 0;for(const _ of l){const k=_.split(";"),S=(g=k[0])==null?void 0:g.trim(),w=((f=k[1])==null?void 0:f.trim())||"Adulto",v=((x=k[2])==null?void 0:x.trim())||u,j=(y=k[4])==null?void 0:y.trim();S&&(await re.from("td_travelers").insert({trip_id:r,couple_id:v,full_name:S,type:w,goes_to_segments:[],is_payer:!0,phone:j||null,status:"Ativo"}),o++)}return o},getQuoteVersions:async r=>{const{data:s}=await re.from("td_quotes").select("*").eq("id",r).single();return s?[{id:"v1",quoteId:s.id,createdAt:s.updated_at||s.created_at,createdBy:"Sistema",changes:[{label:"Valor Total",old:s.total_amount,new:s.total_amount}]}]:[]},restoreQuoteVersion:async r=>null,getVendorRequests:async r=>[],saveVendorRequest:async r=>r,saveComparison:async r=>{const{data:s,error:l}=await re.from("td_quotes").select("id").in("id",r.quoteIds);if(l)throw l;return{...r,id:Math.random().toString(36).substr(2,9)}},saveQuoteFromWhatsApp:async(r,s)=>{var g,f;if(!s.totalAmount||s.totalAmount===0)return null;const{data:{user:l}}=await re.auth.getUser(),o=s.currency==="BRL"?1:s.exchangeRate||5.2,c=s.totalAmount*o,{data:u,error:m}=await re.from("td_quotes").insert({trip_id:r,source_type:"texto",source_value:s.rawText||`WhatsApp: ${s.vendorPhone||"Desconhecido"}`,title:((g=s.suggestedQuote)==null?void 0:g.title)||`Oramento ${s.category}`,category:s.category||"Diversos",provider:((f=s.suggestedQuote)==null?void 0:f.provider)||`Fornecedor ${s.vendorPhone}`,currency:s.currency||"BRL",exchange_rate:o,total_amount:s.totalAmount,amount_brl:c,status:"Novo",votes:[],completeness:70,tags:["WhatsApp"],participant_ids:["ALL"],payment_terms:{installments:s.installments||1,installmentValue:s.installmentValue||s.totalAmount,methods:["PIX","Carto"]},notes_group:s.rawText||"",cancellation_policy:"Ver notas",created_by:l==null?void 0:l.id}).select().single();if(m)throw m;return u},generateReimbursementsForExpense:async r=>{const{data:s}=await re.from("td_expenses").select("*, trip_id").eq("id",r).single();if(!s||s.status==="cancelled")return;const[{data:l},{data:o}]=await Promise.all([re.from("td_expense_splits").select("*").eq("expense_id",r),re.from("td_payments").select("*").eq("expense_id",r)]);if(!l||!o)return;const c={};l.forEach(y=>{c[y.couple_id]=(c[y.couple_id]||0)-y.amount_brl}),o.forEach(y=>{c[y.paid_by_couple_id]=(c[y.paid_by_couple_id]||0)+y.paid_amount_brl}),await re.from("td_reimbursements").delete().eq("expense_id",r).eq("status","pending");const u=Object.entries(c).filter(([y,_])=>_>.01).map(([y,_])=>({id:y,amount:_})),m=Object.entries(c).filter(([y,_])=>_<-.01).map(([y,_])=>({id:y,amount:Math.abs(_)})),g=[];let f=0,x=0;for(;f<u.length&&x<m.length;){const y=Math.min(u[f].amount,m[x].amount);y>.01&&g.push({trip_id:s.trip_id,expense_id:r,from_couple_id:m[x].id,to_couple_id:u[f].id,amount_brl:y,status:"pending"}),u[f].amount-=y,m[x].amount-=y,u[f].amount<=.01&&f++,m[x].amount<=.01&&x++}g.length>0&&await re.from("td_reimbursements").insert(g)},getTravelerProfiles:async()=>{const{data:{user:r}}=await re.auth.getUser();if(!r)return[];const{data:s,error:l}=await re.from("td_traveler_profiles").select("*").eq("user_id",r.id).order("created_at",{ascending:!1});if(l)throw l;return s||[]},getTravelerProfileById:async r=>{const{data:s,error:l}=await re.from("td_traveler_profiles").select("*").eq("id",r).single();if(l)throw l;return s},saveTravelerProfile:async r=>{const{data:{user:s}}=await re.auth.getUser();if(!s)throw new Error("Usurio no autenticado");const l=o=>!o||o===""?null:o;if(r.id){const{data:o,error:c}=await re.from("td_traveler_profiles").update({full_name:r.fullName||r.full_name,nickname:r.nickname||null,phone:r.phone||null,email:r.email||null,birth_date:l(r.birthDate||r.birth_date),type:r.type||"Adulto",can_drive:r.canDrive!==void 0?r.canDrive:r.can_drive,primary_doc_type:r.primaryDocType||r.primary_doc_type||null,primary_doc_number:r.primaryDocNumber||r.primary_doc_number||null,primary_doc_expiry:l(r.primaryDocExpiry||r.primary_doc_expiry),notes:r.notes||null,tags:r.tags||[],updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(c)throw c;return o}else{const{data:o,error:c}=await re.from("td_traveler_profiles").insert({user_id:s.id,full_name:r.fullName||r.full_name,nickname:r.nickname||null,phone:r.phone||null,email:r.email||null,birth_date:l(r.birthDate||r.birth_date),type:r.type||"Adulto",can_drive:r.canDrive!==void 0?r.canDrive:r.can_drive||!1,primary_doc_type:r.primaryDocType||r.primary_doc_type||null,primary_doc_number:r.primaryDocNumber||r.primary_doc_number||null,primary_doc_expiry:l(r.primaryDocExpiry||r.primary_doc_expiry),notes:r.notes||null,tags:r.tags||[]}).select().single();if(c)throw c;return o}},deleteTravelerProfile:async r=>{const{data:s}=await re.from("td_trip_travelers").select("id").eq("traveler_profile_id",r).limit(1);if(s&&s.length>0)throw new Error("No  possvel excluir um perfil que est vinculado a viagens. Remova os vnculos primeiro.");const{error:l}=await re.from("td_traveler_profiles").delete().eq("id",r);if(l)throw l},getTravelerProfileDocuments:async r=>{const{data:{session:s}}=await re.auth.getSession();if(!s)throw new Error("No autenticado");const{data:l,error:o}=await re.from("td_traveler_profile_documents").select("*").eq("traveler_profile_id",r).order("created_at",{ascending:!0});if(o)throw o;return await Promise.all((l||[]).map(async u=>{try{const g=await(await fetch(`${Ir}/functions/v1/encrypt-document`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"decrypt",documentId:u.id,isProfileDocument:!0})})).json(),f=g.success?g.docNumber:""+u.doc_number_last4;return{id:u.id,travelerProfileId:u.traveler_profile_id,docType:u.doc_type,docCategory:u.doc_category,docNumber:f,docNumberLast4:u.doc_number_last4,docExpiry:u.doc_expiry,issueDate:u.issue_date,issuingCountry:u.issuing_country,issuerState:u.issuer_state,issuerAgency:u.issuer_agency,isPrimary:u.is_primary,notes:u.notes,createdAt:u.created_at,updatedAt:u.updated_at}}catch{return{id:u.id,travelerProfileId:u.traveler_profile_id,docType:u.doc_type,docCategory:u.doc_category,docNumber:""+u.doc_number_last4,docNumberLast4:u.doc_number_last4,docExpiry:u.doc_expiry,issueDate:u.issue_date,issuingCountry:u.issuing_country,issuerState:u.issuer_state,issuerAgency:u.issuer_agency,isPrimary:u.is_primary,notes:u.notes,createdAt:u.created_at,updatedAt:u.updated_at}}}))},saveTravelerProfileDocument:async r=>{const{data:{session:s}}=await re.auth.getSession();if(!s)throw new Error("No autenticado");const l=await fetch(`${Ir}/functions/v1/encrypt-document`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"encrypt",isProfileDocument:!0,travelerProfileId:r.travelerProfileId,docType:r.docType,docCategory:r.docCategory||(r.docType==="Visto"||r.docType==="ESTA"?"entry":"identity"),docNumber:r.docNumber,issuerCountry:r.issuerCountry||r.issuingCountry||null,issuerState:r.issuerState||null,issuerAgency:r.issuerAgency||null,issuerPlace:r.issuerPlace||null,regionOrCountry:r.regionOrCountry||null,issueDate:r.issueDate||null,expiryDate:r.expiryDate||r.docExpiry||null,visaCategory:r.visaCategory||null,entryType:r.entryType||null,stayDurationDays:r.stayDurationDays||null,licenseCategory:r.licenseCategory||null,customLabel:r.customLabel||null,passportDocumentId:r.passportDocumentId||null,isPrimary:r.isPrimary||!1,notes:r.notes||null,documentId:r.id||null})}),o=await l.json();if(!l.ok||!o.success)throw new Error(o.error||"Erro ao salvar documento");return o.documentId},deleteTravelerProfileDocument:async r=>{const{error:s}=await re.from("td_traveler_profile_documents").delete().eq("id",r);if(s)throw s},getTripTravelers:async r=>{const{data:s,error:l}=await re.from("td_trip_travelers").select(`
        *,
        profile:td_traveler_profiles(*)
      `).eq("trip_id",r).eq("status","Ativo").order("created_at",{ascending:!0});if(l)throw l;return s||[]},linkTravelerToTrip:async r=>{const{data:s,error:l}=await re.from("td_trip_travelers").insert({trip_id:r.tripId,traveler_profile_id:r.travelerProfileId,couple_id:r.coupleId,type:r.type,is_payer:r.isPayer,goes_to_segments:r.goesToSegments,status:"Ativo",count_in_split:r.countInSplit!==void 0?r.countInSplit:!0}).select().single();if(l)throw l;return s},updateTripTraveler:async(r,s)=>{const{data:l,error:o}=await re.from("td_trip_travelers").update({couple_id:s.coupleId,type:s.type,is_payer:s.isPayer,goes_to_segments:s.goesToSegments,count_in_split:s.countInSplit,updated_at:new Date().toISOString()}).eq("id",r).select().single();if(o)throw o;return l},unlinkTravelerFromTrip:async r=>{const{error:s}=await re.from("td_trip_travelers").update({status:"Arquivado"}).eq("id",r);if(s)throw s},getVendorProfiles:async()=>{const{data:{user:r}}=await re.auth.getUser();if(!r)return[];const{data:s,error:l}=await re.from("td_vendor_profiles").select("*").eq("user_id",r.id).order("name",{ascending:!0});if(l)throw l;return s||[]},getVendorProfileById:async r=>{const{data:s,error:l}=await re.from("td_vendor_profiles").select("*").eq("id",r).single();if(l)throw l;return s},saveVendorProfile:async r=>{console.log(" saveVendorProfile chamado:",{id:r.id,name:r.name});const{data:{user:s}}=await re.auth.getUser();if(!s)throw new Error("Usurio no autenticado");const l={user_id:s.id,name:r.name,legal_name:r.legalName,categories:r.categories||[],rating:r.rating||3,tags:r.tags||[],risk_flags:r.riskFlags||[],contacts:r.contacts||[],website_url:r.websiteUrl,instagram_url:r.instagramUrl,youtube_url:r.youtubeUrl,payment_terms_default:r.paymentTermsDefault,cancellation_policy_notes:r.cancellationPolicyNotes,updated_at:new Date().toISOString()};if(r.id){console.log(" Atualizando perfil existente:",r.id);const{data:o,error:c}=await re.from("td_vendor_profiles").update(l).eq("id",r.id).select().single();if(c)throw c;return console.log(" Perfil atualizado:",o.id),o}else{console.log(" Criando novo perfil");const{data:o,error:c}=await re.from("td_vendor_profiles").insert({...l,created_at:new Date().toISOString()}).select().single();if(c)throw c;return console.log(" Perfil criado:",o.id),o}},deleteVendorProfile:async r=>{const{error:s}=await re.from("td_vendor_profiles").delete().eq("id",r);if(s)throw s},getTripSetupStats:async r=>{const{count:s}=await re.from("td_trip_travelers").select("*",{count:"exact",head:!0}).eq("trip_id",r).eq("status","Ativo"),{count:l}=await re.from("td_trip_vendors").select("*",{count:"exact",head:!0}).eq("trip_id",r).eq("status","Ativo"),{count:o}=await re.from("td_quotes").select("*",{count:"exact",head:!0}).eq("trip_id",r),{count:c}=await re.from("td_expenses").select("*",{count:"exact",head:!0}).eq("trip_id",r),{count:u}=await re.from("td_payments").select("*",{count:"exact",head:!0}).eq("trip_id",r);return{travelersCount:s||0,vendorsCount:l||0,quotesCount:o||0,expensesCount:c||0,paymentsCount:u||0}},getTripVendors:async r=>{const{data:s,error:l}=await re.from("td_trip_vendors").select(`
        *,
        profile:td_vendor_profiles(*)
      `).eq("trip_id",r).order("created_at",{ascending:!0});if(l)throw l;return s||[]},linkVendorToTrip:async(r,s,l={})=>{console.log(" linkVendorToTrip chamado:",{tripId:r,profileId:s,options:l});const{data:o,error:c}=await re.from("td_trip_vendors").insert({trip_id:r,vendor_profile_id:s,preferred:l.preferred||!1,custom_rating:l.customRating,custom_notes:l.customNotes}).select().single();if(c)throw c;return console.log(" Fornecedor vinculado:",o.id),o},unlinkVendorFromTrip:async r=>{const{error:s}=await re.from("td_trip_vendors").delete().eq("id",r);if(s)throw s},updateTripVendor:async(r,s)=>{const{data:l,error:o}=await re.from("td_trip_vendors").update({preferred:s.preferred,custom_rating:s.customRating,custom_notes:s.customNotes,updated_at:new Date().toISOString()}).eq("id",r).select().single();if(o)throw o;return l},getVendorProfileHistory:async r=>{const{data:s,error:l}=await re.from("td_trip_vendors").select(`
        id,
        created_at,
        preferred,
        trip:td_trips(id, name, start_date, end_date, status)
      `).eq("vendor_profile_id",r).order("created_at",{ascending:!1});if(l)throw l;const{data:o,error:c}=await re.from("td_quotes").select(`
        id,
        title,
        category,
        total_amount,
        currency,
        amount_brl,
        status,
        created_at,
        trip:td_trips(id, name)
      `).eq("vendor_profile_id",r).order("created_at",{ascending:!1});if(c)throw c;return{trips:s||[],quotes:o||[],totalTrips:(s||[]).length,totalQuotes:(o||[]).length,totalValue:(o||[]).reduce((u,m)=>u+(m.amount_brl||0),0)}}},Cd=({onClose:r,onCreated:s})=>{const[l,o]=D.useState({name:"",legalName:"",categories:[],rating:3,websiteUrl:"",instagramUrl:"",paymentTermsDefault:""}),[c,u]=D.useState(!1),[m,g]=D.useState(""),f=()=>{m.trim()&&!l.categories.includes(m.trim())&&(o({...l,categories:[...l.categories,m.trim()]}),g(""))},x=_=>{o({...l,categories:l.categories.filter(k=>k!==_)})},y=async()=>{if(l.name.trim()){u(!0);try{const _=await he.saveVendorProfile(l);s(_.id)}catch(_){console.error("Erro ao criar perfil:",_)}finally{u(!1)}}};return e.jsx(Re,{isOpen:!0,onClose:r,children:e.jsxs("div",{className:"p-4 space-y-3 max-h-[85vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-gray-800",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-600/20 to-purple-600/20 flex items-center justify-center text-xl",children:""}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Criar Novo Fornecedor"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Perfil global reutilizvel"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Nome Comercial *"}),e.jsx(ee,{value:l.name,onChange:_=>o({...l,name:_.target.value}),placeholder:"Nome",autoFocus:!0,className:"!py-2 !text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Razo Social"}),e.jsx(ee,{value:l.legalName,onChange:_=>o({...l,legalName:_.target.value}),placeholder:"Opcional",className:"!py-2 !text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Categorias"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(ee,{value:m,onChange:_=>g(_.target.value),placeholder:"Ex: Hotel, Restaurante...",onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),f())},className:"!py-2 !text-sm"}),e.jsx(V,{onClick:f,className:"bg-gray-800 hover:bg-gray-700 !py-2 !px-3 !text-sm",children:"+"})]}),l.categories.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:l.categories.map(_=>e.jsxs("span",{className:"px-2 py-0.5 bg-indigo-600/20 text-indigo-400 text-[10px] rounded flex items-center gap-1 font-bold",children:[_,e.jsx("button",{onClick:()=>x(_),className:"hover:text-indigo-300 text-xs",children:""})]},_))})]}),e.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500",children:"Avaliao:"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(_=>e.jsx("button",{onClick:()=>o({...l,rating:_}),className:`text-xl ${l.rating>=_?"text-amber-400":"text-gray-700"} hover:scale-110 transition-transform`,children:""},_))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" Website"}),e.jsx(ee,{value:l.websiteUrl,onChange:_=>o({...l,websiteUrl:_.target.value}),placeholder:"https://...",className:"!py-2 !text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" Instagram"}),e.jsx(ee,{value:l.instagramUrl,onChange:_=>o({...l,instagramUrl:_.target.value}),placeholder:"@usuario",className:"!py-2 !text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Condies de Pagamento"}),e.jsx(ee,{value:l.paymentTermsDefault,onChange:_=>o({...l,paymentTermsDefault:_.target.value}),placeholder:"Ex: 50% + 50% 30d",className:"!py-2 !text-sm"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-3 border-t border-gray-800",children:[e.jsx(V,{onClick:r,className:"bg-gray-800 hover:bg-gray-700 !py-2 !text-sm",children:"Cancelar"}),e.jsx(V,{onClick:y,className:"bg-indigo-600 hover:bg-indigo-700 !py-2 !text-sm",disabled:!l.name.trim()||c,children:c?"Criando...":"Criar e Vincular"})]})]})})},Ef=({trip:r,onClose:s,onLinked:l})=>{const[o,c]=D.useState([]),[u,m]=D.useState(new Set),[g,f]=D.useState(new Set),[x,y]=D.useState(""),[_,k]=D.useState(!0),[S,w]=D.useState(!1),[v,j]=D.useState(!1);D.useEffect(()=>{U()},[r.id]);const U=async()=>{k(!0);try{const[O,R]=await Promise.all([he.getVendorProfiles(),he.getTripVendors(r.id)]);c(O),m(new Set(R.map(E=>E.vendor_profile_id)))}catch(O){console.error("Erro ao carregar dados:",O)}finally{k(!1)}},q=O=>{const R=new Set(g);R.has(O)?R.delete(O):R.add(O),f(R)},Q=async()=>{if(g.size!==0){w(!0);try{for(const O of Array.from(g))await he.linkVendorToTrip(r.id,String(O),{preferred:!1});l(),s()}catch(O){console.error("Erro ao vincular fornecedores:",O)}finally{w(!1)}}},C=async O=>{try{await he.linkVendorToTrip(r.id,O,{preferred:!1}),j(!1),l(),s()}catch(R){console.error("Erro ao vincular novo perfil:",R)}},N=o.filter(O=>{var H,K;const R=((H=O.name)==null?void 0:H.toLowerCase().includes(x.toLowerCase()))||((K=O.legal_name)==null?void 0:K.toLowerCase().includes(x.toLowerCase())),E=!u.has(O.id);return R&&E});return _?e.jsx(Re,{isOpen:!0,onClose:s,children:e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Carregando perfis..."})}):v?e.jsx(Cd,{onClose:()=>j(!1),onCreated:C}):e.jsx(Re,{isOpen:!0,onClose:s,children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Adicionar Fornecedores"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Selecione perfis da sua lista para vincular a esta viagem"})]}),e.jsx(V,{onClick:()=>j(!0),className:"bg-green-600 hover:bg-green-700 text-sm",children:"+ Criar Novo"})]}),e.jsx(ee,{placeholder:"Buscar por nome ou razo social...",value:x,onChange:O=>y(O.target.value)}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:N.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:u.size===o.length?e.jsx("p",{children:"Todos os perfis j esto vinculados a esta viagem"}):e.jsx("p",{children:"Nenhum perfil encontrado"})}):N.map(O=>{var R,E;return e.jsx("div",{onClick:()=>q(O.id),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${g.has(O.id)?"border-indigo-600 bg-indigo-600/10":"border-gray-800 bg-gray-900 hover:border-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white",children:O.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[O.legal_name&&`${O.legal_name}  `,(R=O.categories)==null?void 0:R.join(", ")]}),e.jsx("div",{className:"flex gap-1 mt-1",children:[1,2,3,4,5].map(H=>e.jsx("span",{className:`text-xs ${O.rating>=H?"text-amber-400":"text-gray-800"}`,children:""},H))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[((E=O.risk_flags)==null?void 0:E.length)>0&&e.jsx(ge,{color:"red",children:""}),g.has(O.id)&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-600 flex items-center justify-center text-white",children:""})]})]})},O.id)})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-800",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[g.size," ",g.size===1?"perfil selecionado":"perfis selecionados"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{onClick:s,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:Q,className:"bg-indigo-600 hover:bg-indigo-700",disabled:g.size===0||S,children:S?"Vinculando...":`Adicionar ${g.size>0?`(${g.size})`:""}`})]})]})]})})},Xv=({trip:r,tripVendor:s,onClose:l,onSaved:o,onUnlink:c})=>{const u=s.profile,[m,g]=D.useState({preferred:s.preferred||!1,customRating:s.custom_rating||null,customNotes:s.custom_notes||""}),[f,x]=D.useState(!1),[y,_]=D.useState(!1),k=async()=>{x(!0);try{await he.updateTripVendor(s.id,m),o(),l()}catch(S){console.error("Erro ao salvar configuraes:",S)}finally{x(!1)}};return y?e.jsx(Re,{isOpen:!0,onClose:()=>_(!1),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-600/20 flex items-center justify-center text-xl",children:""}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Confirmar Desvinculao"})]}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Tem certeza que deseja desvincular ",e.jsx("strong",{children:u==null?void 0:u.name})," desta viagem? O perfil global ser mantido."]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(V,{onClick:()=>_(!1),className:"bg-gray-800 hover:bg-gray-700 !py-2 !text-sm",children:"Cancelar"}),e.jsx(V,{onClick:()=>{_(!1),c()},className:"bg-red-600 hover:bg-red-700 !py-2 !text-sm",children:"Desvincular"})]})]})}):e.jsx(Re,{isOpen:!0,onClose:l,children:e.jsxs("div",{className:"p-4 space-y-3 max-h-[85vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-gray-800",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-600/20 to-purple-600/20 flex items-center justify-center text-xl",children:""}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Configuraes da Viagem"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("strong",{children:u==null?void 0:u.name})," em ",e.jsx("strong",{children:r.name})]})]})]}),e.jsx("div",{className:"p-3 bg-gray-900/50 rounded-lg border border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white text-sm",children:u==null?void 0:u.name}),(u==null?void 0:u.legal_name)&&e.jsx("div",{className:"text-xs text-gray-500",children:u.legal_name})]}),e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(S=>e.jsx("span",{className:`text-sm ${(u==null?void 0:u.rating)>=S?"text-amber-400":"text-gray-800"}`,children:""},S))})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsx("input",{type:"checkbox",checked:m.preferred,onChange:S=>g({...m,preferred:S.target.checked}),className:"w-4 h-4 accent-amber-500"}),e.jsx("label",{className:"text-xs font-bold text-gray-300",children:" Marcar como favorito"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Avaliao Especfica"}),e.jsxs("p",{className:"text-[10px] text-gray-600 mb-2",children:["Padro: ",u==null?void 0:u.rating," estrelas (global)"]}),e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsx("button",{onClick:()=>g({...m,customRating:null}),className:`px-2 py-1 rounded text-[10px] font-bold transition-colors ${m.customRating===null?"bg-indigo-600 text-white":"bg-gray-800 text-gray-500 hover:bg-gray-700"}`,children:"Global"}),e.jsx("span",{className:"text-gray-700",children:"|"}),[1,2,3,4,5].map(S=>e.jsx("button",{onClick:()=>g({...m,customRating:S}),className:`text-xl ${m.customRating!==null&&m.customRating>=S?"text-amber-400":"text-gray-700"} hover:scale-110 transition-transform`,children:""},S))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Notas desta Viagem"}),e.jsx("textarea",{value:m.customNotes,onChange:S=>g({...m,customNotes:S.target.value}),placeholder:"Observaes especficas (ex: contato local, condies especiais)...",className:"w-full bg-gray-900/50 border border-gray-800 rounded-lg p-2 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500",rows:3})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-800",children:[e.jsx(V,{onClick:()=>_(!0),className:"bg-red-600/20 hover:bg-red-600/30 text-red-400 !py-2 !text-sm border border-red-600/30",children:"Desvincular"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:l,className:"bg-gray-800 hover:bg-gray-700 !py-2 !text-sm",children:"Cancelar"}),e.jsx(V,{onClick:k,className:"bg-indigo-600 hover:bg-indigo-700 !py-2 !text-sm",disabled:f,children:f?"Salvando...":"Salvar"})]})]})]})})},Zv=({trip:r,onRefresh:s,onNavigateToVendor:l,onNavigateToWizard:o})=>{const[c,u]=D.useState([]),[m,g]=D.useState(""),[f,x]=D.useState("all"),[y,_]=D.useState(!1),[k,S]=D.useState(!1),[w,v]=D.useState(null),[j,U]=D.useState(null);D.useEffect(()=>{q()},[r.id]);const q=async()=>{try{const O=await he.getTripVendors(r.id);u(O)}catch(O){console.error("Erro ao carregar fornecedores:",O)}},Q=async O=>{try{await he.linkVendorToTrip(r.id,O),S(!1),await q(),s(),U("Fornecedor criado e vinculado com sucesso!"),setTimeout(()=>U(null),3e3)}catch(R){console.error("Erro ao vincular fornecedor:",R)}},C=async O=>{try{await he.unlinkVendorFromTrip(O),v(null),await q(),s(),U("Fornecedor desvinculado com sucesso!"),setTimeout(()=>U(null),3e3)}catch(R){console.error("Erro ao desvincular fornecedor:",R)}},N=D.useMemo(()=>{const O=m.toLowerCase();return c.filter(R=>{var xe;const E=R.profile;if(!E)return!1;const H=E.name||"",K=E.tags||[],ie=H.toLowerCase().includes(O)||K.some(F=>F.toLowerCase().includes(O)),de=f==="all"||((xe=E.categories)==null?void 0:xe.includes(f));return ie&&de})},[c,m,f]);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[j&&e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg animate-in slide-in-from-top-2 duration-300",children:e.jsxs("p",{className:"text-sm font-bold",children:[" ",j]})}),e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600/20 via-purple-600/20 to-pink-600/20 border border-indigo-600/30 p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djItaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-30"}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-2xl shadow-lg",children:""}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:"Fornecedores"}),e.jsx("p",{className:"text-sm text-indigo-300 mt-1",children:"Parceiros vinculados a esta viagem"})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{onClick:()=>_(!0),className:"bg-gray-900/50 hover:bg-gray-900/70 text-white font-bold border-2 border-gray-700 backdrop-blur-sm",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Vincular Existente"]}),e.jsxs(V,{onClick:()=>S(!0),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold shadow-xl border-2 border-indigo-400/50",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Criar Novo"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-indigo-600/20 to-indigo-600/5 !border-indigo-600/30 hover:!border-indigo-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:c.length}),e.jsx("div",{className:"text-xs text-indigo-400 mt-2 uppercase font-bold tracking-wider",children:"Total"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-indigo-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-amber-600/20 to-amber-600/5 !border-amber-600/30 hover:!border-amber-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:c.filter(O=>O.preferred).length}),e.jsx("div",{className:"text-xs text-amber-400 mt-2 uppercase font-bold tracking-wider",children:"Favoritos"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-amber-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-green-600/20 to-green-600/5 !border-green-600/30 hover:!border-green-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:c.filter(O=>{var R,E,H;return((R=O.profile)==null?void 0:R.rating)>=4&&(((H=(E=O.profile)==null?void 0:E.risk_flags)==null?void 0:H.length)||0)===0}).length}),e.jsx("div",{className:"text-xs text-green-400 mt-2 uppercase font-bold tracking-wider",children:"Confiveis"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-green-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-red-600/20 to-red-600/5 !border-red-600/30 hover:!border-red-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:c.filter(O=>{var R,E;return(((E=(R=O.profile)==null?void 0:R.risk_flags)==null?void 0:E.length)||0)>0}).length}),e.jsx("div",{className:"text-xs text-red-400 mt-2 uppercase font-bold tracking-wider",children:"Com Alertas"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-red-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})})]}),e.jsx(me,{className:"!p-6 bg-gradient-to-r from-gray-900/60 to-gray-900/40 border-gray-800 backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:m,onChange:O=>g(O.target.value),placeholder:"Buscar por nome, categoria ou tag...",className:"w-full pl-12 pr-4 py-4 bg-gray-950/50 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all"}),m&&e.jsx("button",{onClick:()=>g(""),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("select",{value:f,onChange:O=>x(O.target.value),className:"px-4 py-4 bg-gray-950/50 border border-gray-800 rounded-xl text-white focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all",children:[e.jsx("option",{value:"all",children:" Todas as categorias"}),r.categories.map(O=>e.jsx("option",{value:O,children:O},O))]})]})}),N.length===0?e.jsx(me,{className:"py-16 text-center bg-gray-900/40 border-gray-800",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-bold text-white",children:c.length===0?"Nenhum fornecedor vinculado":"Nenhum resultado encontrado"}),e.jsx("p",{className:"text-gray-500 text-sm",children:c.length===0?"Fornecedores so perfis globais reutilizveis. Vincule fornecedores existentes ou crie novos para esta viagem.":"Tente ajustar os filtros de busca para encontrar o que procura."}),c.length===0&&e.jsxs("div",{className:"flex gap-3 justify-center pt-4",children:[e.jsxs(V,{variant:"outline",onClick:()=>_(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Vincular da minha lista"]}),e.jsxs(V,{variant:"primary",onClick:()=>S(!0),children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Criar novo agora"]})]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(O=>{var K,ie;const R=O.profile;if(!R)return null;const E=R.rating>=4&&(((K=R.risk_flags)==null?void 0:K.length)||0)===0,H=(((ie=R.risk_flags)==null?void 0:ie.length)||0)>0;return e.jsxs(me,{onClick:()=>v(O),className:"!p-0 hover:!border-indigo-500 hover:shadow-2xl hover:shadow-indigo-500/20 transition-all duration-300 cursor-pointer overflow-hidden group relative",children:[O.preferred&&e.jsx("div",{className:"absolute top-0 right-0 z-10",children:e.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 text-white px-3 py-1.5 rounded-bl-xl shadow-lg",children:e.jsx("span",{className:"text-xs font-black uppercase flex items-center gap-1",children:" Favorito"})})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600/5 via-transparent to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"relative p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-600/20 to-purple-600/20 flex items-center justify-center text-3xl flex-shrink-0 group-hover:scale-110 transition-transform duration-300 border border-indigo-600/30",children:R.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-black text-white text-xl group-hover:text-indigo-400 transition-colors leading-tight",children:R.name}),R.legal_name&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 truncate",children:R.legal_name}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:H?e.jsxs(ge,{color:"red",className:"text-[9px]",children:[" ",R.risk_flags.length," alertas"]}):E?e.jsx(ge,{color:"green",className:"text-[9px]",children:" Confivel"}):e.jsx(ge,{color:"gray",className:"text-[9px]",children:""})})]})]}),R.categories&&R.categories.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[R.categories.slice(0,4).map(de=>e.jsx("span",{className:"text-[10px] px-3 py-1.5 bg-gradient-to-r from-indigo-600/20 to-purple-600/20 text-indigo-300 rounded-lg font-bold uppercase border border-indigo-600/30",children:de},de)),R.categories.length>4&&e.jsxs("span",{className:"text-[10px] px-3 py-1.5 bg-gray-800 text-gray-500 rounded-lg font-bold border border-gray-700",children:["+",R.categories.length-4]})]}),e.jsxs("div",{className:"flex items-center gap-3 py-3 px-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(de=>e.jsx("span",{className:`text-xl ${R.rating>=de?"text-amber-400":"text-gray-800"}`,children:""},de))}),e.jsxs("span",{className:"text-sm text-gray-500 font-bold",children:["(",R.rating,"/5)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-gray-800",children:[R.website_url&&e.jsx("a",{href:R.website_url.startsWith("http")?R.website_url:`https://${R.website_url}`,target:"_blank",rel:"noopener noreferrer",onClick:de=>de.stopPropagation(),className:"w-10 h-10 rounded-lg bg-indigo-600/20 flex items-center justify-center text-indigo-400 hover:bg-indigo-600/30 transition-colors",title:"Website",children:""}),R.instagram_url&&e.jsx("a",{href:R.instagram_url.startsWith("@")?`https://instagram.com/${R.instagram_url.slice(1)}`:`https://instagram.com/${R.instagram_url}`,target:"_blank",rel:"noopener noreferrer",onClick:de=>de.stopPropagation(),className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-600/20 to-pink-600/20 flex items-center justify-center text-pink-400 hover:from-purple-600/30 hover:to-pink-600/30 transition-colors",title:"Instagram",children:""}),R.youtube_url&&e.jsx("a",{href:R.youtube_url.startsWith("http")?R.youtube_url:`https://youtube.com/${R.youtube_url}`,target:"_blank",rel:"noopener noreferrer",onClick:de=>de.stopPropagation(),className:"w-10 h-10 rounded-lg bg-red-600/20 flex items-center justify-center text-red-400 hover:bg-red-600/30 transition-colors",title:"YouTube",children:""}),e.jsx("div",{className:"flex-1"}),e.jsx("span",{className:"text-[9px] text-gray-600 font-bold uppercase tracking-wider opacity-0 group-hover:opacity-100 transition-opacity",children:"Clique para editar "})]}),O.custom_notes&&e.jsx("div",{className:"pt-4 border-t border-gray-800",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-xs text-indigo-400 font-bold",children:""}),e.jsx("p",{className:"text-xs text-gray-500 italic line-clamp-2 flex-1",children:O.custom_notes})]})})]})]},O.id)})}),y&&e.jsx(Ef,{trip:r,onClose:()=>_(!1),onLinked:async()=>{await q(),s(),U("Fornecedores vinculados com sucesso!"),setTimeout(()=>U(null),3e3)}}),w&&e.jsx(Xv,{trip:r,tripVendor:w,onClose:()=>v(null),onSaved:async()=>{await q(),s(),U("Configuraes salvas com sucesso!"),setTimeout(()=>U(null),3e3)},onUnlink:()=>C(w.id)}),k&&e.jsx(Cd,{onClose:()=>S(!1),onCreated:Q})]})};var Ft=(r=>(r.BRL="BRL",r.USD="USD",r))(Ft||{}),Dt=(r=>(r.DRAFT="Novo",r.ANALYSIS="Em anlise",r.SHORTLIST="Shortlist",r.CHOSEN="Aprovada",r.CLOSED="Fechada",r.REJECTED="Rejeitada",r))(Dt||{}),ja=(r=>(r.PLANNED="planned",r.CONFIRMED="confirmed",r.PAID="paid",r.CANCELLED="cancelled",r))(ja||{}),Vr=(r=>(r.EQUAL="equal",r.PERCENT="percent",r.FIXED="fixed",r.PER_PERSON="per_person",r))(Vr||{}),et=(r=>(r.BY_COUPLE="by_couple",r.PER_PERSON="per_person",r.CUSTOM="custom",r))(et||{}),Bt=(r=>(r.INHERIT="inherit",r.ALL="all",r.PAYING_ONLY="paying_only",r.MANUAL="manual",r))(Bt||{}),ca=(r=>(r.PIX="pix",r.CREDIT_CARD="card",r.CASH="cash",r.BOLETO="boleto",r.MILES="miles",r.TRANSFER="transfer",r))(ca||{}),St=(r=>(r.ADULT="Adulto",r.CHILD="Criana",r.INFANT="Infante",r))(St||{});const Oe={...he,computeTravelerIssues:(r,s)=>{const l=[];return r.phone||l.push({type:"warning",message:"Sem telefone de contato"}),r.docType==="Passaporte"&&(!r.docNumber||!r.docExpiry)&&l.push({type:"error",message:"Dados de passaporte pendentes"}),l}},Ei=r=>{if(!r)return"";const s=r.replace(/\D/g,"");return s.length===11?s.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):s.length===10?s.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):s.length===13&&s.startsWith("55")?s.replace(/(\d{2})(\d{2})(\d{5})(\d{4})/,"+$1 ($2) $3-$4"):r},Wv=r=>r.replace(/\D/g,""),eb=r=>{if(!r)return"";const s=typeof r=="string"?new Date(r):r;if(isNaN(s.getTime()))return"";const l=String(s.getDate()).padStart(2,"0"),o=String(s.getMonth()+1).padStart(2,"0"),c=s.getFullYear();return`${l}/${o}/${c}`},tb=r=>{if(!r)return"";const s=typeof r=="string"?new Date(r):r;if(isNaN(s.getTime()))return"";const l=String(s.getDate()).padStart(2,"0"),o=String(s.getMonth()+1).padStart(2,"0"),c=s.getFullYear(),u=String(s.getHours()).padStart(2,"0"),m=String(s.getMinutes()).padStart(2,"0");return`${l}/${o}/${c} ${u}:${m}`},mt=r=>{if(!r)return"";if(typeof r=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(r))return r;if(typeof r=="string"){const u=r.split("T")[0].split("-");if(u.length===3)return`${u[0]}-${u[1].padStart(2,"0")}-${u[2].padStart(2,"0")}`}const s=typeof r=="string"?new Date(r):r;if(isNaN(s.getTime()))return"";const l=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0"),c=String(s.getDate()).padStart(2,"0");return`${l}-${o}-${c}`},Di=r=>{if(!r)return null;if(typeof r=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(r)){const[l,o,c]=r.split("-").map(Number);return new Date(l,o-1,c)}const s=new Date(r);return isNaN(s.getTime())?null:s},Ai=r=>{const s=Di(r);return s?eb(s):""},Ni=r=>{const s=Di(r);return s?tb(s):""},Na=r=>{if(!r)return"";const s=Di(typeof r=="string"?r:r.toISOString());return s?s.toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}):""},Hs=r=>{if(!r)return"";const s=Di(typeof r=="string"?r:r.toISOString());return s?s.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}):""},pe=r=>r==null?"R$ 0,00":r.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),ab=r=>r.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/[]/g,'"').replace(/(\d+)\s*[xX]/g,"$1x").replace(/R\$\s*/g,"R$").replace(/U\$S?\s*/g,"U$"),sb=r=>{const s=/R\$\s*([\d.,]+)/gi,l=/U\$\s*([\d.,]+)/gi,o=x=>{const y=x.replace(/\./g,"").replace(",",".");return parseFloat(y)},c=[...r.matchAll(s)].map(x=>o(x[1])),u=[...r.matchAll(l)].map(x=>o(x[1])),m=r.match(/(?:a\s*vista|\s*vista|pix).*?R\$\s*([\d.,]+)/i),g=r.match(/(?:carto|crdito|credit).*?R\$\s*([\d.,]+)/i),f=r.match(/pix.*?R\$\s*([\d.,]+)/i);return{brl:c,usd:u,cashPrice:m?o(m[1]):void 0,creditPrice:g?o(g[1]):void 0,pixPrice:f?o(f[1]):void 0}},nf=(r,s)=>{const o=r.split(`
`).map(j=>j.trim()).filter(Boolean)[0]||"Oramento sem ttulo";let c="Diversos";const u=r.toLowerCase();/ticket|park|disney|universal|seaworld|ingress|parque|legoland|kennedy/i.test(u)?c="Ingressos/Atraes":/pickup|dropoff|diria|diarias|locao|locacao|carro|van|mini van|alamo|hertz|sienna|pacifica/i.test(u)?c="Aluguel de Carro":/hotel|hospedagem|quarto|stay|check-in|checkout/i.test(u)?c="Hospedagem":/voo|flight|passagem|areo|aereo/i.test(u)?c="Voo":/restaurante|refeio|jantar|almoo/i.test(u)&&(c="Restaurantes");const m=sb(r),g=m.usd.length>m.brl.length?Ft.USD:Ft.BRL;let f=0,x=0;if(m.cashPrice&&m.creditPrice)f=m.cashPrice,x=m.creditPrice-m.cashPrice;else if(m.pixPrice)f=m.pixPrice;else{const j=g===Ft.USD?m.usd:m.brl;f=j.length>0?Math.max(...j):0}let y=1;const _=r.match(/(\d+)\s*[xX]/i);_&&(y=parseInt(_[1]));const k=[];f===0&&k.push("Preo total"),c==="Diversos"&&k.push("Categoria precisa");let S="alta";k.length>0&&(S="mdia"),f===0&&(S="baixa");const w=g===Ft.BRL?1:5.2,v=[];return(m.pixPrice||/pix/i.test(r))&&v.push(ca.PIX),(m.creditPrice||/carto|crdito|credit/i.test(r))&&v.push(ca.CREDIT_CARD),(m.cashPrice||/dinheiro|cash/i.test(r))&&v.push(ca.CASH),v.length===0&&v.push(ca.PIX),{id:Math.random().toString(36).substr(2,9),rawText:r,vendorPhone:s,vendorName:s,title:o.length>80?o.substring(0,80)+"...":o,category:c,currency:g,totalAmount:f,installments:y,installmentValue:f/y,confidence:S,missingFields:k,cashPrice:m.cashPrice,creditPrice:m.creditPrice,pixPrice:m.pixPrice,cashDiscount:x,suggestedQuote:{title:o.length>100?o.substring(0,100)+"...":o,category:c,currency:g,totalAmount:f,exchangeRate:w,amountBrl:f*w,validUntil:new Date(Date.now()+7*864e5).toISOString().split("T")[0],status:Dt.ANALYSIS,notesInternal:`Importado do WhatsApp
---
${r}`,paymentTerms:{methods:v,installments:y,installmentValue:f*w/y,cashDiscount:x>0?x*w:void 0}}}},Df=(r,s)=>{const l=ab(r),o=/(?:\[?(\d{2}\/\d{2}\/\d{2,4}),?\s+(\d{2}:\d{2})(?::\d{2})?\]?)\s*(?:-\s*)?([^:]+):\s*/g,c=[];let u=0,m;for(;(m=o.exec(l))!==null;)c.length>0&&(c[c.length-1].content=l.substring(u,m.index).trim()),c.push({author:m[3].trim(),content:""}),u=o.lastIndex;c.length>0&&(c[c.length-1].content=l.substring(u).trim());const g=c.filter(_=>!(s.myNames.some(S=>_.author.includes(S))||s.myPhones.some(S=>_.author.includes(S))||(_.content.toLowerCase(),_.content.length<10&&!/R\$|U\$|\d/.test(_.content)))),f=[];let x="",y="";return g.forEach(_=>{const k=/R\$|U\$|Valor|Preo/i.test(_.content);/Aluguel|Carro|Ingresso|Ticket|Hospedagem/i.test(_.content),x&&(_.author!==y||k&&x.length>100)&&(f.push(nf(x,y)),x=""),y=_.author,x+=(x?`
`:"")+_.content}),x&&f.push(nf(x,y)),f},lf=({trip:r,onImport:s,onClose:l,onEditBlock:o})=>{const[c,u]=D.useState(1),[m,g]=D.useState(""),[f,x]=D.useState([]),[y,_]=D.useState([]),[k,S]=D.useState({myName:"Daniel Manske",ignoreUser:!0}),w=()=>{if(!m.trim())return;const U=Df(m,{myNames:[k.myName],myPhones:[]});x(U),_(U.filter(q=>q.confidence!=="baixa").map(q=>q.id)),u(2)},v=U=>{_(q=>q.includes(U)?q.filter(Q=>Q!==U):[...q,U])},j=()=>{const U=f.filter(q=>y.includes(q.id));s(U)};return e.jsx("div",{className:"space-y-6",children:c===1?e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"bg-indigo-600/10 border border-indigo-500/20 p-4 rounded-xl",children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-400 uppercase mb-2",children:"Como Funciona"}),e.jsxs("ul",{className:"text-xs text-gray-400 space-y-1 list-disc ml-4",children:[e.jsx("li",{children:"Exporte a conversa do WhatsApp (sem mdia)."}),e.jsx("li",{children:"Cole o texto bruto abaixo."}),e.jsx("li",{children:"O sistema ignorar suas mensagens e extrair preos e datas automaticamente."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Meu Nome no WhatsApp",value:k.myName,onChange:U=>S({...k,myName:U.target.value}),placeholder:"Ex: Daniel Manske"}),e.jsx("div",{className:"flex items-center gap-3 h-full pt-6",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"accent-indigo-500",checked:k.ignoreUser,onChange:U=>S({...k,ignoreUser:U.target.checked})}),e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:"Filtrar minhas mensagens"})]})})]}),e.jsx(ee,{as:"textarea",label:"Contedo da Conversa",rows:12,value:m,onChange:U=>g(U.target.value),placeholder:"[09:11, 21/01/2026] Fornecedor: Oramento SeaWorld...",className:"font-mono text-[10px]"}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:l,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:w,disabled:!m.trim(),children:"Analisar Texto "})]})]}):e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-black text-white",children:[f.length," Oramentos Detectados"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Selecione quais deseja criar na viagem"})]}),e.jsx(V,{variant:"ghost",className:"text-xs",onClick:()=>u(1),children:" Voltar e Ajustar"})]}),e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto pr-2 custom-scrollbar",children:f.map(U=>e.jsxs(me,{className:`!p-4 border-2 transition-all cursor-pointer ${y.includes(U.id)?"border-indigo-500 bg-indigo-500/5":"border-gray-800 opacity-60"}`,onClick:()=>v(U.id),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:y.includes(U.id),onChange:()=>{},className:"w-5 h-5 accent-indigo-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:U.category}),e.jsx("h4",{className:"font-bold text-gray-100",children:U.title})]})]}),e.jsxs(ge,{color:U.confidence==="alta"?"green":U.confidence==="mdia"?"yellow":"red",children:["Confiana ",U.confidence]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 bg-gray-950 p-3 rounded-lg border border-gray-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-gray-600 uppercase",children:"Valor"}),e.jsxs("p",{className:"text-sm font-black text-indigo-400",children:[U.currency," ",pe(U.totalAmount)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-gray-600 uppercase",children:"Pagamento"}),e.jsxs("p",{className:"text-sm font-bold text-gray-300",children:[U.installments,"x de ",pe(U.installmentValue)]})]}),e.jsx("div",{className:"text-right",children:e.jsx(V,{variant:"ghost",className:"text-[9px] py-1 px-2 h-7",onClick:q=>{q.stopPropagation(),o(U)},children:"Editar"})})]}),U.missingFields.length>0&&e.jsxs("p",{className:"text-[9px] text-red-400 mt-2 font-bold uppercase",children:[" Faltando: ",U.missingFields.join(", ")]})]},U.id))}),e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t border-gray-800",children:[e.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:[y.length," selecionados para importao"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",onClick:l,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:j,disabled:y.length===0,children:"Criar Selecionados "})]})]})]})})},rb=r=>r?r.replace(/[\u{1F300}-\u{1F9FF}]/gu,"").replace(/[\n\r]+/g," ").replace(/\s+/g," ").trim():"",nb=({trip:r,onClose:s,onImported:l})=>{const[o,c]=D.useState(1),[u,m]=D.useState(""),[g,f]=D.useState([]),[x,y]=D.useState(new Set),[_,k]=D.useState([]),[S,w]=D.useState(null),[v,j]=D.useState(!1),[U,q]=D.useState(null);D.useEffect(()=>{Q()},[]);const Q=async()=>{try{const E=await he.getVendorProfiles();k(E)}catch(E){console.error("Erro ao carregar perfis:",E)}},C=()=>{if(!u.trim())return;const E=Df(u,{myNames:["Voc","Eu"],myPhones:[]});if(f(E),y(new Set(E.map(H=>H.id))),E.length>0){const H=E[0].vendorPhone.replace(/\D/g,""),K=_.find(ie=>{var de;return(de=ie.whatsapp_numbers)==null?void 0:de.some(xe=>xe.replace(/\D/g,"")===H)});w(K)}c(2)},N=async()=>{var E;j(!0);try{const H=g.filter(K=>x.has(K.id));for(const K of H){const ie={...K.suggestedQuote,tripId:r.id,segmentId:((E=r.segments[0])==null?void 0:E.id)||null,participantIds:["ALL"],vendor_profile_id:S==null?void 0:S.id,source_type:S?void 0:"texto",source_value:S?void 0:K.rawText};await he.saveQuote(ie)}l(),s()}catch(H){console.error("Erro ao importar:",H),q("Erro ao importar oramentos. Tente novamente."),setTimeout(()=>q(null),3e3)}finally{j(!1)}},O=E=>{const H=new Set(x);H.has(E)?H.delete(E):H.add(E),y(H)},R=E=>{switch(E){case"alta":return"green";case"mdia":return"yellow";case"baixa":return"red";default:return"gray"}};return e.jsx(Re,{isOpen:!0,onClose:s,size:"xl",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight",children:" Importar Oramentos do WhatsApp"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cole a conversa do WhatsApp e o sistema detectar automaticamente os oramentos"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center gap-2 ${o>=1?"text-indigo-400":"text-gray-600"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border-2 ${o>=1?"bg-indigo-600 border-indigo-400":"bg-gray-900 border-gray-700"}`,children:"1"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Colar Texto"})]}),e.jsx("div",{className:"flex-1 h-0.5 bg-gray-800"}),e.jsxs("div",{className:`flex items-center gap-2 ${o>=2?"text-indigo-400":"text-gray-600"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border-2 ${o>=2?"bg-indigo-600 border-indigo-400":"bg-gray-900 border-gray-700"}`,children:"2"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Revisar"})]})]}),o===1&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Cole o texto da conversa do WhatsApp"}),e.jsx("textarea",{value:u,onChange:E=>m(E.target.value),placeholder:`[09:11, 21/01/2026] +1 (407) 936-4569: TOYOTA SIENNA OR SIMILAR...
a vista com desconto R$6.876,00
Carto de crdito R$7.190,00...`,rows:12,className:"w-full px-4 py-3 bg-gray-900 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors font-mono text-sm resize-none"}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:" Dica: Copie toda a conversa incluindo as mensagens do fornecedor"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:s,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:C,disabled:!u.trim(),children:"Analisar Mensagens "})]})]}),o===2&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[S&&e.jsx(me,{className:"!bg-emerald-600/10 !border-emerald-600/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-600 flex items-center justify-center text-white font-bold",children:""}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-emerald-400",children:"Fornecedor Reconhecido"}),e.jsx("p",{className:"text-xs text-gray-400",children:S.name})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("p",{className:"text-sm font-bold text-gray-400",children:[g.length," oramento(s) detectado(s)"]}),e.jsx(V,{variant:"ghost",className:"text-xs",onClick:()=>{x.size===g.length?y(new Set):y(new Set(g.map(E=>E.id)))},children:x.size===g.length?"Desmarcar Todos":"Selecionar Todos"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto custom-scrollbar",children:g.map(E=>e.jsx(me,{className:`!p-4 cursor-pointer transition-all ${x.has(E.id)?"!border-indigo-500 !bg-indigo-500/10":"!border-gray-800 hover:!border-gray-700"}`,onClick:()=>O(E.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:x.has(E.id),onChange:()=>O(E.id),className:"mt-1 w-5 h-5 accent-indigo-500",onClick:H=>H.stopPropagation()}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm leading-tight",children:rb(E.title)}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[e.jsx(ge,{color:"indigo",className:"text-[9px]",children:E.category}),e.jsx(ge,{color:R(E.confidence),className:"text-[9px]",children:E.confidence})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-black text-white",children:pe(E.totalAmount)}),E.installments>1&&e.jsxs("p",{className:"text-xs text-gray-500",children:[E.installments,"x de ",pe(E.installmentValue)]})]})]}),(E.cashPrice||E.creditPrice)&&e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[E.cashPrice&&e.jsxs("span",{className:"px-2 py-1 bg-green-600/20 text-green-400 rounded",children:["  vista: ",pe(E.cashPrice)]}),E.creditPrice&&e.jsxs("span",{className:"px-2 py-1 bg-blue-600/20 text-blue-400 rounded",children:[" Carto: ",pe(E.creditPrice)]}),E.cashDiscount&&E.cashDiscount>0&&e.jsxs("span",{className:"px-2 py-1 bg-amber-600/20 text-amber-400 rounded",children:[" Economia: ",pe(E.cashDiscount)]})]}),E.missingFields.length>0&&e.jsxs("p",{className:"text-xs text-amber-500",children:[" Faltando: ",E.missingFields.join(", ")]})]})]})},E.id))})]}),e.jsxs("div",{className:"flex justify-between gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:()=>c(1),children:" Voltar"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{variant:"ghost",onClick:s,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:N,disabled:x.size===0||v,children:v?"Importando...":`Importar ${x.size} Oramento(s)`})]})]})]})]})})},lb=({trip:r,onClose:s,onImported:l})=>{const[o,c]=D.useState(1),[u,m]=D.useState(""),[g,f]=D.useState(!1),[x,y]=D.useState(null),[_,k]=D.useState(!1),[S,w]=D.useState(null),[v,j]=D.useState({title:"",category:r.categories[0]||"Diversos",price:0,currency:"BRL",notes:""}),U=N=>{const O=new URL(N).hostname.toLowerCase();let R="Diversos",E="";return O.includes("booking.com")?(R="Hospedagem",E="Booking.com"):O.includes("airbnb")?(R="Hospedagem",E="Airbnb"):O.includes("hotels.com")?(R="Hospedagem",E="Hotels.com"):O.includes("expedia")?(R="Hospedagem",E="Expedia"):O.includes("decolar")||O.includes("despegar")?(R="Voo",E="Decolar"):O.includes("maxmilhas")?(R="Voo",E="MaxMilhas"):O.includes("skyscanner")?(R="Voo",E="Skyscanner"):O.includes("kayak")?(R="Voo",E="Kayak"):O.includes("rentcars")?(R="Aluguel de Carro",E="RentCars"):O.includes("rentalcars")?(R="Aluguel de Carro",E="RentalCars"):O.includes("localiza")?(R="Aluguel de Carro",E="Localiza"):O.includes("getyourguide")?(R="Ingressos/Atraes",E="GetYourGuide"):O.includes("viator")?(R="Ingressos/Atraes",E="Viator"):O.includes("ticketmaster")&&(R="Ingressos/Atraes",E="Ticketmaster"),{category:R,provider:E}},q=async()=>{if(u.trim()){f(!0);try{const N=new URL(u),O=U(u),R={url:u,title:`Oramento de ${O.provider||N.hostname}`,description:`Link importado de ${N.hostname}`,category:O.category||"Diversos",provider:O.provider||N.hostname,confidence:O.provider?"alta":"mdia"};y(R),j({title:R.title,category:R.category||r.categories[0],price:0,currency:"BRL",notes:`Link: ${u}`}),c(2)}catch{w("URL invlida. Por favor, cole um link vlido."),setTimeout(()=>w(null),3e3)}finally{f(!1)}}},Q=async()=>{var N;if(!v.price||v.price<=0){w("Por favor, informe o valor do oramento."),setTimeout(()=>w(null),3e3);return}k(!0);try{const O={tripId:r.id,title:v.title,category:v.category,currency:v.currency,totalAmount:v.price,exchangeRate:v.currency==="BRL"?1:5.2,amountBrl:v.currency==="BRL"?v.price:v.price*5.2,linkUrl:u,source_type:"link",source_value:u,provider:x==null?void 0:x.provider,status:Dt.ANALYSIS,validUntil:new Date(Date.now()+6048e5).toISOString().split("T")[0],segmentId:((N=r.segments[0])==null?void 0:N.id)||null,participantIds:["ALL"],notesInternal:v.notes,paymentTerms:{methods:[ca.CREDIT_CARD],installments:1,installmentValue:v.currency==="BRL"?v.price:v.price*5.2}};await he.saveQuote(O),l(),s()}catch(O){console.error("Erro ao importar:",O),w("Erro ao importar oramento. Tente novamente."),setTimeout(()=>w(null),3e3)}finally{k(!1)}},C=N=>{if(!N)return"";const O=N.toLowerCase();return O.includes("booking")?"":O.includes("airbnb")?"":O.includes("decolar")||O.includes("voo")?"":O.includes("car")||O.includes("localiza")?"":O.includes("guide")||O.includes("viator")?"":""};return e.jsx(Re,{isOpen:!0,onClose:s,size:"lg",children:e.jsxs("div",{className:"p-6 space-y-6",children:[S&&e.jsxs("div",{className:"bg-red-600/20 border border-red-600/30 text-red-400 px-4 py-3 rounded-xl text-sm animate-in fade-in duration-300",children:[" ",S]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight",children:" Importar de Site/Link"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cole o link do Booking, Airbnb, Decolar ou qualquer site de viagem"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center gap-2 ${o>=1?"text-indigo-400":"text-gray-600"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border-2 ${o>=1?"bg-indigo-600 border-indigo-400":"bg-gray-900 border-gray-700"}`,children:"1"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Colar Link"})]}),e.jsx("div",{className:"flex-1 h-0.5 bg-gray-800"}),e.jsxs("div",{className:`flex items-center gap-2 ${o>=2?"text-indigo-400":"text-gray-600"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm border-2 ${o>=2?"bg-indigo-600 border-indigo-400":"bg-gray-900 border-gray-700"}`,children:"2"}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Completar Dados"})]})]}),o===1&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Cole o link do site"}),e.jsx(ee,{value:u,onChange:N=>m(N.target.value),placeholder:"https://www.booking.com/hotel/...",onKeyDown:N=>{N.key==="Enter"&&u.trim()&&q()}}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:" Suportado: Booking, Airbnb, Decolar, Hotels.com, RentCars, GetYourGuide, Viator e mais"})]}),e.jsxs(me,{className:"!bg-gray-900/40 !border-gray-800",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Exemplos:"}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsx("p",{children:" Booking: https://www.booking.com/hotel/..."}),e.jsx("p",{children:" Airbnb: https://www.airbnb.com/rooms/..."}),e.jsx("p",{children:" Decolar: https://www.decolar.com/..."}),e.jsx("p",{children:" RentCars: https://www.rentcars.com/..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:s,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:q,disabled:!u.trim()||g,children:g?"Analisando...":"Analisar Link "})]})]}),o===2&&x&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsx(me,{className:"!bg-indigo-600/10 !border-indigo-600/30",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-3xl",children:C(x.provider)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-sm font-bold text-white",children:x.provider}),e.jsx(ge,{color:x.confidence==="alta"?"green":"yellow",className:"text-[9px]",children:x.confidence})]}),e.jsx("p",{className:"text-xs text-gray-400",children:x.description}),e.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-indigo-400 hover:text-indigo-300 mt-1 inline-block",children:"Abrir link original "})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee,{label:"Ttulo do Oramento *",value:v.title,onChange:N=>j({...v,title:N.target.value}),placeholder:"Ex: Hotel Hilton Orlando - 5 noites"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{as:"select",label:"Categoria *",value:v.category,onChange:N=>j({...v,category:N.target.value}),children:r.categories.map(N=>e.jsx("option",{value:N,children:N},N))}),e.jsxs(ee,{as:"select",label:"Moeda *",value:v.currency,onChange:N=>j({...v,currency:N.target.value}),children:[e.jsx("option",{value:"BRL",children:"BRL (Real)"}),e.jsx("option",{value:"USD",children:"USD (Dlar)"})]})]}),e.jsx(ee,{label:"Valor Total *",type:"number",step:"0.01",value:v.price||"",onChange:N=>j({...v,price:parseFloat(N.target.value)||0}),placeholder:"0.00"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Notas (opcional)"}),e.jsx("textarea",{value:v.notes,onChange:N=>j({...v,notes:N.target.value}),placeholder:"Adicione observaes sobre este oramento...",rows:3,className:"w-full px-4 py-3 bg-gray-900 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors resize-none"})]})]}),e.jsxs("div",{className:"flex justify-between gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:()=>c(1),children:" Voltar"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{variant:"ghost",onClick:s,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:Q,disabled:!v.title.trim()||!v.price||_,children:_?"Importando...":"Importar Oramento"})]})]})]})]})})},ib=({trip:r,vendors:s,quotes:l,onRefresh:o,onNavigateToQuote:c,onNavigateToWizard:u,onNavigateToCompare:m})=>{const[g,f]=D.useState(!1),[x,y]=D.useState([]),[_,k]=D.useState(!1),[S,w]=D.useState(!1),[v,j]=D.useState(!1),[U,q]=D.useState(!1),[Q,C]=D.useState(null),[N,O]=D.useState(null),[R,E]=D.useState({category:"all",status:"all",vendor:"all"}),H=F=>F?F.replace(/[\u{1F300}-\u{1F9FF}]/gu,"").replace(/[\n\r]+/g," ").replace(/\s+/g," ").trim():"",K=l.filter(F=>(R.category==="all"||F.category===R.category)&&(R.status==="all"||F.status===R.status)),ie=async F=>{for(const Y of F)await Oe.saveQuoteFromWhatsApp(r.id,Y);k(!1),o(),C(`${F.length} oramentos importados com sucesso!`),setTimeout(()=>C(null),3e3)},de=(F,Y)=>{if(F.stopPropagation(),x.includes(Y))y(P=>P.filter(ae=>ae!==Y));else{if(x.length>=5){C(" Mximo de 5 oramentos para comparar"),setTimeout(()=>C(null),3e3);return}y(P=>[...P,Y])}},xe=async F=>{try{await he.deleteQuote(F),O(null),o(),C("Oramento excludo com sucesso!"),setTimeout(()=>C(null),3e3)}catch(Y){console.error("Erro ao deletar oramento:",Y),C(" Erro ao excluir oramento"),setTimeout(()=>C(null),3e3)}};return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500 relative",children:[Q&&e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg animate-in slide-in-from-top-2 duration-300",children:e.jsx("p",{className:"text-sm font-bold",children:Q})}),e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600/20 via-purple-600/20 to-pink-600/20 border border-indigo-600/30 p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djItaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-30"}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-2xl shadow-lg",children:""}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:"Oramentos"}),e.jsx("p",{className:"text-sm text-indigo-300 mt-1",children:"Compare fornecedores e prepare a votao"})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:()=>{f(!g),y([])},className:g?"bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold border-2 border-indigo-400/50":"bg-gray-900/50 hover:bg-gray-900/70 text-white font-bold border-2 border-gray-700 backdrop-blur-sm",children:g?" Sair Comparador":" Modo Comparar"}),e.jsxs("div",{className:"relative group",children:[e.jsxs(V,{onClick:()=>q(!U),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold shadow-xl border-2 border-indigo-400/50",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nova Opo "]}),U&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-gray-900 border border-gray-800 rounded-xl shadow-2xl z-50 overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("button",{onClick:()=>{q(!1),u()},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-300 hover:bg-gray-800 hover:text-white border-b border-gray-800 transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsxs("div",{children:[e.jsx("div",{children:"Lanamento Manual"}),e.jsx("div",{className:"text-xs text-gray-600 font-normal",children:"Criar do zero"})]})]}),e.jsxs("button",{onClick:()=>{q(!1),w(!0)},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-300 hover:bg-gray-800 hover:text-white border-b border-gray-800 transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsxs("div",{children:[e.jsx("div",{children:"Importar do WhatsApp"}),e.jsx("div",{className:"text-xs text-gray-600 font-normal",children:"Cole conversas"})]})]}),e.jsxs("button",{onClick:()=>{q(!1),j(!0)},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-300 hover:bg-gray-800 hover:text-white transition-colors flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsxs("div",{children:[e.jsx("div",{children:"Importar de Site/Link"}),e.jsx("div",{className:"text-xs text-gray-600 font-normal",children:"URL de hotel, etc"})]})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-indigo-600/20 to-indigo-600/5 !border-indigo-600/30 hover:!border-indigo-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:l.length}),e.jsx("div",{className:"text-xs text-indigo-400 mt-2 uppercase font-bold tracking-wider",children:"Total"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-indigo-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-green-600/20 to-green-600/5 !border-green-600/30 hover:!border-green-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:l.filter(F=>F.status===Dt.CHOSEN).length}),e.jsx("div",{className:"text-xs text-green-400 mt-2 uppercase font-bold tracking-wider",children:"Escolhidos"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-green-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-amber-600/20 to-amber-600/5 !border-amber-600/30 hover:!border-amber-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:l.filter(F=>F.status===Dt.ANALYSIS).length}),e.jsx("div",{className:"text-xs text-amber-400 mt-2 uppercase font-bold tracking-wider",children:"Em Anlise"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-amber-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-purple-600/20 to-purple-600/5 !border-purple-600/30 hover:!border-purple-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:["R$ ",pe(l.reduce((F,Y)=>F+(Y.amountBrl||0),0))]}),e.jsx("div",{className:"text-xs text-purple-400 mt-2 uppercase font-bold tracking-wider",children:"Valor Total"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-purple-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})})]}),e.jsx(me,{className:"!p-6 bg-gradient-to-r from-gray-900/60 to-gray-900/40 border-gray-800 backdrop-blur-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("select",{value:R.category,onChange:F=>E({...R,category:F.target.value}),className:"px-4 py-3 bg-gray-950/50 border border-gray-800 rounded-xl text-white focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all",children:[e.jsx("option",{value:"all",children:" Todas as categorias"}),r.categories.map(F=>e.jsx("option",{value:F,children:F},F))]}),e.jsxs("select",{value:R.status,onChange:F=>E({...R,status:F.target.value}),className:"px-4 py-3 bg-gray-950/50 border border-gray-800 rounded-xl text-white focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all",children:[e.jsx("option",{value:"all",children:" Todos os status"}),Object.values(Dt).map(F=>e.jsx("option",{value:F,children:F},F))]}),e.jsxs("select",{value:R.vendor,onChange:F=>E({...R,vendor:F.target.value}),className:"px-4 py-3 bg-gray-950/50 border border-gray-800 rounded-xl text-white focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all",children:[e.jsx("option",{value:"all",children:" Todos os fornecedores"}),s.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsx(V,{onClick:()=>E({category:"all",status:"all",vendor:"all"}),className:"bg-gray-800 hover:bg-gray-700 text-white font-bold",children:"Limpar Filtros"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20",children:K.map(F=>{const Y=x.includes(F.id);return e.jsxs(me,{className:`!p-0 group transition-all overflow-hidden hover:shadow-2xl hover:shadow-indigo-500/20 ${Y?"!border-indigo-500 bg-indigo-500/5":"!border-gray-800 hover:!border-indigo-500"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600/5 via-transparent to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"relative p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsx("input",{type:"checkbox",className:"w-5 h-5 accent-indigo-500 rounded cursor-pointer",checked:Y,onChange:P=>de(P,F.id),onClick:P=>P.stopPropagation()}),e.jsx(ge,{color:"indigo",className:"text-[9px]",children:F.category})]}),e.jsx(ge,{color:F.status===Dt.CHOSEN?"green":"gray",className:"text-[9px]",children:F.status})]}),e.jsxs("div",{onClick:()=>g?de(null,F.id):c(F.id),className:"cursor-pointer space-y-3",children:[e.jsx("h3",{className:"text-xl font-black text-white leading-tight uppercase group-hover:text-indigo-400 transition-colors",children:H(F.title)}),e.jsx("div",{className:"flex items-center gap-2",children:F.vendor_profile_id?e.jsx("p",{className:"text-xs text-gray-600 font-bold",children:F.provider}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{color:"amber",className:"text-[9px]",children:"Sem fornecedor"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Fonte: ",F.source_type==="link"?"":F.source_type==="texto"?"":"",F.source_type]})]})})]}),e.jsxs("div",{onClick:()=>g?de(null,F.id):c(F.id),className:"bg-gray-950 p-4 rounded-xl border border-gray-800 group-hover:bg-indigo-600/5 transition-colors cursor-pointer",children:[e.jsxs("p",{className:"text-2xl font-black text-indigo-400",children:["R$ ",pe(F.amountBrl)]}),e.jsx("p",{className:"text-[10px] text-gray-700 uppercase font-black",children:"Total Calculado"})]}),e.jsx("div",{className:"pt-4 border-t border-gray-800",children:e.jsxs(V,{onClick:P=>{P.stopPropagation(),O(F.id)},className:"w-full bg-red-600/20 hover:bg-red-600/30 text-red-400 !py-2 !text-sm font-bold border border-red-600/30",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Excluir Oramento"]})})]})]},F.id)})}),N&&e.jsx(Re,{isOpen:!0,onClose:()=>O(null),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-600/20 flex items-center justify-center text-xl",children:""}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Confirmar Excluso"})]}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Tem certeza que deseja ",e.jsx("span",{className:"font-bold text-red-400",children:"excluir permanentemente"})," este oramento? Esta ao no pode ser desfeita."]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(V,{onClick:()=>O(null),className:"bg-gray-800 hover:bg-gray-700 !py-2 !text-sm",children:"Cancelar"}),e.jsxs(V,{onClick:()=>xe(N),className:"bg-red-600 hover:bg-red-700 !py-2 !text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Sim, Excluir"]})]})]})}),e.jsx(Re,{isOpen:_,onClose:()=>k(!1),title:"Importar do WhatsApp",children:e.jsx(lf,{trip:r,onClose:()=>k(!1),onImport:ie,onEditBlock:F=>{k(!1),u(F.suggestedQuote)}})}),g&&x.length>0&&e.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 animate-in slide-in-from-bottom-10 duration-500",children:e.jsxs("div",{className:"bg-gray-900 border-2 border-indigo-500 rounded-2xl shadow-2xl p-4 flex items-center gap-6 backdrop-blur-md",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"text-white font-black text-sm uppercase",children:[x.length," Selecionadas"]}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:"Limite de 5 itens"})]}),e.jsx("div",{className:"h-10 w-px bg-gray-800"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",onClick:()=>y([]),children:"Limpar"}),e.jsx(V,{variant:"primary",disabled:x.length<2,onClick:()=>m(x),children:"Comparar Agora "})]})]})}),S&&e.jsx(nb,{trip:r,onClose:()=>w(!1),onImported:()=>{w(!1),o(),C(" Oramentos importados com sucesso!"),setTimeout(()=>C(null),3e3)}}),v&&e.jsx(lb,{trip:r,onClose:()=>j(!1),onImported:()=>{j(!1),o(),C(" Oramento importado com sucesso!"),setTimeout(()=>C(null),3e3)}}),_&&e.jsx(lf,{trip:r,onClose:()=>k(!1),onFinalize:ie})]})},ob=({trip:r,expenses:s,onRefresh:l,onNavigateToExpense:o})=>{const[c,u]=D.useState({segment:"all",category:"all",status:"all",search:""}),m=D.useMemo(()=>{const f=s.filter(_=>_.status!==ja.CANCELLED).reduce((_,k)=>_+k.amountBrl,0),x=s.filter(_=>_.status===ja.CONFIRMED).reduce((_,k)=>_+k.amountBrl,0),y=s.filter(_=>_.status===ja.PAID).reduce((_,k)=>_+k.amountBrl,0);return{total:f,confirmed:x,paid:y}},[s]),g=D.useMemo(()=>s.filter(f=>{const x=f.title.toLowerCase().includes(c.search.toLowerCase())||f.category.toLowerCase().includes(c.search.toLowerCase()),y=c.segment==="all"||f.segmentId===c.segment,_=c.category==="all"||f.category===c.category,k=c.status==="all"||f.status===c.status;return x&&y&&_&&k}).sort((f,x)=>(x.createdAt||"").localeCompare(f.createdAt||"")),[s,c]);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"Itens Fechados"}),e.jsx("p",{className:"text-gray-500",children:"Gesto de despesas oficiais e racha"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"outline",onClick:l,children:"Sincronizar"}),e.jsx(V,{variant:"primary",children:"Exportar PDF"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(me,{className:"!bg-indigo-600/5 !border-indigo-500/20",children:[e.jsx("p",{className:"text-[10px] font-black text-indigo-400 uppercase mb-1",children:"Total Fechado"}),e.jsx("p",{className:"text-3xl font-black text-white",children:pe(m.total)})]}),e.jsxs(me,{className:"!bg-amber-600/5 !border-amber-500/20",children:[e.jsx("p",{className:"text-[10px] font-black text-amber-400 uppercase mb-1",children:"Total Confirmado (Pendente)"}),e.jsx("p",{className:"text-3xl font-black text-white",children:pe(m.confirmed)})]}),e.jsxs(me,{className:"!bg-emerald-600/5 !border-emerald-500/20",children:[e.jsx("p",{className:"text-[10px] font-black text-emerald-400 uppercase mb-1",children:"Total Efetivamente Pago"}),e.jsx("p",{className:"text-3xl font-black text-white",children:pe(m.paid)})]})]}),e.jsx(me,{className:"!p-4 bg-gray-900/40 border-gray-800",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ee,{placeholder:"Buscar por ttulo ou categoria...",value:c.search,onChange:f=>u({...c,search:f.target.value})}),e.jsxs(ee,{as:"select",value:c.segment,onChange:f=>u({...c,segment:f.target.value}),children:[e.jsx("option",{value:"all",children:"Todos os Segmentos"}),r.segments.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]}),e.jsxs(ee,{as:"select",value:c.category,onChange:f=>u({...c,category:f.target.value}),children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),r.categories.map(f=>e.jsx("option",{value:f,children:f},f))]}),e.jsxs(ee,{as:"select",value:c.status,onChange:f=>u({...c,status:f.target.value}),children:[e.jsx("option",{value:"all",children:"Todos Status"}),e.jsx("option",{value:ja.CONFIRMED,children:"Confirmado"}),e.jsx("option",{value:ja.PAID,children:"Pago"}),e.jsx("option",{value:ja.PLANNED,children:"Planejado"})]})]})}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-gray-800",children:e.jsxs("table",{className:"w-full text-left border-collapse bg-gray-900",children:[e.jsx("thead",{className:"bg-gray-950 text-[10px] font-black uppercase text-gray-500 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Ttulo / Segmento"}),e.jsx("th",{className:"p-4",children:"Categoria"}),e.jsx("th",{className:"p-4",children:"Fornecedor / Fonte"}),e.jsx("th",{className:"p-4",children:"Valor Total"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4 text-right",children:"Ao"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-800",children:[g.map(f=>{var x;return e.jsxs("tr",{className:"hover:bg-gray-800/40 transition-colors cursor-pointer group",onClick:()=>o(f.id),children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-bold text-gray-100 group-hover:text-indigo-400 transition-colors",children:f.title}),e.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-black",children:((x=r.segments.find(y=>y.id===f.segmentId))==null?void 0:x.name)||"Geral"})]}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{color:"indigo",children:f.category})}),e.jsx("td",{className:"p-4",children:f.vendor_profile_id?e.jsx("div",{className:"text-sm text-gray-300 font-medium",children:"Fornecedor vinculado"}):f.source_type?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{color:"amber",className:"text-[9px]",children:"Sem fornecedor"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[f.source_type==="link"?"":f.source_type==="texto"?"":"",f.source_type]})]}):e.jsx("span",{className:"text-xs text-gray-600 italic",children:"No informado"})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-black text-white",children:pe(f.amountBrl||0)}),e.jsxs("div",{className:"text-[10px] text-gray-600",children:[f.currency," ",pe(f.amount||0)," (",pe(f.exchangeRate),")"]})]}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{color:f.status===ja.PAID?"green":f.status===ja.CONFIRMED?"yellow":"gray",children:f.status.toUpperCase()})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(V,{variant:"ghost",className:"text-[10px] py-1 opacity-0 group-hover:opacity-100 transition-opacity",children:"Ver Detalhes"})})]},f.id)}),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-20 text-center text-gray-600 italic",children:"Nenhuma despesa oficial encontrada com estes filtros."})})]})]})})]})},Fe={toCents:r=>Math.round(r*100),fromCents:r=>r/100,format:r=>(r||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),sanitize:r=>Math.round(r*100)/100,splitEqual:(r,s)=>{const l=Fe.toCents(r),o=Math.floor(l/s),c=new Array(s).fill(o),u=l-o*s;return c[s-1]+=u,c.map(Fe.fromCents)},splitByWeight:(r,s)=>{const l=Fe.toCents(r),o=s.reduce((m,g)=>m+g,0);let c=0;return s.map((m,g)=>{if(g===s.length-1)return l-c;const f=Math.floor(l*m/o);return c+=f,f}).map(Fe.fromCents)}},cb=({travelers:r,selectedIds:s,onSelectionChange:l,onClose:o})=>{const[c,u]=D.useState(""),m=D.useMemo(()=>{if(!c)return r;const y=c.toLowerCase();return r.filter(_=>{var k,S,w,v;return((S=(k=_.profile)==null?void 0:k.fullName)==null?void 0:S.toLowerCase().includes(y))||((v=(w=_.profile)==null?void 0:w.nickname)==null?void 0:v.toLowerCase().includes(y))})},[r,c]),g=y=>{s.includes(y)?l(s.filter(_=>_!==y)):l([...s,y])},f=()=>{l(m.map(y=>y.id))},x=()=>{l([])};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:c,onChange:y=>u(y.target.value),placeholder:"Buscar viajante...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:f,variant:"secondary",size:"sm",children:"Selecionar todos"}),e.jsx(V,{onClick:x,variant:"secondary",size:"sm",children:"Limpar"}),e.jsxs("div",{className:"ml-auto text-sm text-gray-600 flex items-center",children:[s.length," selecionado",s.length!==1?"s":""]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:m.map(y=>{var _;return e.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.includes(y.id),onChange:()=>g(y.id),className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:((_=y.profile)==null?void 0:_.fullName)||"Sem nome"}),e.jsxs("div",{className:"text-xs text-gray-500 flex gap-2",children:[e.jsx("span",{children:y.type}),y.isPayer&&e.jsx("span",{className:"text-green-600",children:" Pagante"}),y.countInSplit&&e.jsx("span",{className:"text-blue-600",children:" Conta no split"})]})]})]},y.id)})}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t border-gray-200",children:[e.jsx(V,{onClick:o,variant:"secondary",children:"Cancelar"}),e.jsxs(V,{onClick:o,children:["Confirmar (",s.length,")"]})]})]})},db=({couples:r,selectedIds:s,onSelectionChange:l,onClose:o})=>{const c=g=>{s.includes(g)?l(s.filter(f=>f!==g)):l([...s,g])},u=()=>{l(r.map(g=>g.id))},m=()=>{l([])};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:u,variant:"secondary",size:"sm",children:"Selecionar todos"}),e.jsx(V,{onClick:m,variant:"secondary",size:"sm",children:"Limpar"}),e.jsxs("div",{className:"ml-auto text-sm text-gray-600 flex items-center",children:[s.length," selecionado",s.length!==1?"s":""]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:r.map(g=>{var f,x;return e.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.includes(g.id),onChange:()=>c(g.id),className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:g.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((f=g.members)==null?void 0:f.length)||0," membro",((x=g.members)==null?void 0:x.length)!==1?"s":"",g.members&&g.members.length>0&&e.jsxs("span",{className:"ml-2",children:["(",g.members.map(y=>y.name).join(", "),")"]})]})]})]},g.id)})}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t border-gray-200",children:[e.jsx(V,{onClick:o,variant:"secondary",children:"Cancelar"}),e.jsxs(V,{onClick:o,children:["Confirmar (",s.length,")"]})]})]})},ub=({expenseId:r,tripId:s,expenseTotal:l,travelers:o,couples:c,onClose:u})=>{const[m,g]=D.useState([]),[f,x]=D.useState(!1),[y,_]=D.useState(!1),[k,S]=D.useState("traveler"),[w,v]=D.useState("");D.useEffect(()=>{j()},[r]);const j=async()=>{try{const{data:H,error:K}=await re.from("td_expense_splits").select(`
          *,
          trip_traveler:td_trip_travelers(
            id,
            profile:td_traveler_profiles(full_name)
          ),
          couple:td_couples(id, name)
        `).eq("expense_id",r);if(K)throw K;if(H&&H.length>0){const ie=H.map(de=>{var xe,F,Y;return{id:de.id,participantType:de.participant_type,participantId:de.participant_type==="traveler"?de.trip_traveler_id:de.couple_id,participantName:de.participant_type==="traveler"?((F=(xe=de.trip_traveler)==null?void 0:xe.profile)==null?void 0:F.full_name)||"Sem nome":((Y=de.couple)==null?void 0:Y.name)||"Sem nome",amount:de.amount_brl}});g(ie)}}catch(H){console.error("Erro ao carregar splits:",H)}},U=D.useMemo(()=>m.reduce((H,K)=>H+K.amount,0),[m]),q=D.useMemo(()=>l-U,[l,U]),Q=D.useMemo(()=>Math.abs(q)<.01,[q]),C=(H,K,ie)=>{if(m.some(F=>F.participantType===H&&F.participantId===K)){v("Este participante j foi adicionado"),setTimeout(()=>v(""),3e3);return}const xe={participantType:H,participantId:K,participantName:ie,amount:0};g([...m,xe]),_(!1),v("")},N=H=>{g(m.filter((K,ie)=>ie!==H))},O=(H,K)=>{const ie=parseFloat(K)||0,de=[...m];de[H].amount=ie,g(de)},R=()=>{if(m.length===0)return;const H=l/m.length,K=m.map(ie=>({...ie,amount:H}));g(K)},E=async()=>{if(v(""),!Q){v("A soma dos valores deve ser igual ao total da despesa");return}if(m.length===0){v("Adicione pelo menos um participante");return}x(!0);try{await re.from("td_expense_splits").delete().eq("expense_id",r);const H=m.map(de=>({expense_id:r,trip_id:s,participant_type:de.participantType,trip_traveler_id:de.participantType==="traveler"?de.participantId:null,couple_id:de.participantType==="couple"?de.participantId:null,split_type:"fixed",amount_brl:de.amount})),{error:K}=await re.from("td_expense_splits").insert(H);if(K)throw K;const ie=document.createElement("div");ie.className="fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50",ie.textContent="Splits customizados salvos!",document.body.appendChild(ie),setTimeout(()=>ie.remove(),3e3),u()}catch(H){v(H.message||"Erro ao salvar splits")}finally{x(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total da despesa:"}),e.jsxs("span",{className:"text-lg font-bold",children:["R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Soma atual:"}),e.jsxs("span",{className:"text-lg font-bold",children:["R$ ",U.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Diferena:"}),e.jsxs("span",{className:`text-lg font-bold ${Q?"text-green-600":"text-red-600"}`,children:["R$ ",q.toFixed(2)]})]}),w&&e.jsxs("div",{className:"mt-3 bg-red-100 text-red-800 text-sm px-3 py-2 rounded",children:[" ",w]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:()=>_(!0),variant:"secondary",size:"sm",children:"+ Adicionar participante"}),e.jsx(V,{onClick:R,variant:"secondary",size:"sm",disabled:m.length===0,children:"Ajustar automaticamente"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Participante"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipo"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Valor"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase w-20",children:"Aes"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-gray-500 text-sm",children:'Nenhum participante adicionado. Clique em "+ Adicionar participante" para comear.'})}):m.map((H,K)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:H.participantName}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs ${H.participantType==="couple"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:H.participantType==="couple"?"Casal":"Pessoa"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("input",{type:"number",step:"0.01",value:H.amount,onChange:ie=>O(K,ie.target.value),className:"w-32 px-2 py-1 text-right border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:()=>N(K),className:"text-red-600 hover:text-red-800 text-sm",children:""})})]},K))})]})}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t border-gray-200",children:[e.jsx(V,{onClick:u,variant:"secondary",disabled:f,children:"Cancelar"}),e.jsx(V,{onClick:E,disabled:f||!Q,children:f?"Salvando...":"Salvar splits"})]}),y&&e.jsx(Re,{isOpen:y,onClose:()=>_(!1),title:"Adicionar Participante",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:()=>S("traveler"),variant:k==="traveler"?"primary":"secondary",size:"sm",children:"Viajante"}),e.jsx(V,{onClick:()=>S("couple"),variant:k==="couple"?"primary":"secondary",size:"sm",children:"Casal"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:k==="traveler"?o.map(H=>{var K;return e.jsxs("button",{onClick:()=>{var ie;return C("traveler",H.id,((ie=H.profile)==null?void 0:ie.fullName)||"Sem nome")},className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"font-medium text-sm",children:((K=H.profile)==null?void 0:K.fullName)||"Sem nome"}),e.jsx("div",{className:"text-xs text-gray-500",children:H.type})]},H.id)}):c.map(H=>{var K,ie;return e.jsxs("button",{onClick:()=>C("couple",H.id,H.name),className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"font-medium text-sm",children:H.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((K=H.members)==null?void 0:K.length)||0," membro",((ie=H.members)==null?void 0:ie.length)!==1?"s":""]})]},H.id)})})]})})]})},hb=({tripId:r,expenseId:s,expenseTotal:l,currentSplitMode:o,currentParticipationMode:c,onUpdated:u})=>{const[m,g]=D.useState(o||et.BY_COUPLE),[f,x]=D.useState(c||Bt.INHERIT),[y,_]=D.useState([]),[k,S]=D.useState([]),[w,v]=D.useState(!1),[j,U]=D.useState(!1),[q,Q]=D.useState(!1),[C,N]=D.useState(!1),[O,R]=D.useState([]),[E,H]=D.useState([]),[K,ie]=D.useState(null),[de,xe]=D.useState([]),[F,Y]=D.useState("");D.useEffect(()=>{P()},[r]);const P=async()=>{try{const[A,M]=await Promise.all([he.getTripTravelers(r),he.getCouples(r)]);_(A),S(M),ae(A,m)}catch(A){console.error("Erro ao carregar dados:",A)}},ae=(A,M)=>{const b=[];if(M===et.BY_COUPLE){const B=A.filter(z=>!z.coupleId);B.length>0&&b.push(`${B.length} viajante(s) sem grupo no entram no racha por casal`)}xe(b)},ue=async()=>{if(Y(""),f===Bt.MANUAL){if(m===et.PER_PERSON&&O.length===0){Y("Selecione pelo menos um viajante");return}if(m===et.BY_COUPLE&&E.length===0){Y("Selecione pelo menos um casal");return}}if(m===et.CUSTOM&&(K==null?void 0:K.count)>0){N(!0);return}await L()},L=async()=>{v(!0);try{const A=await he.recalculateExpenseSplits(s,{splitMode:m,participationMode:f,manualSelectedTripTravelerIds:O,manualSelectedCoupleIds:E});ie(A.summary);const M=document.createElement("div");M.className="fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50",M.textContent="Split atualizado com sucesso!",document.body.appendChild(M),setTimeout(()=>M.remove(),3e3),u&&u(),N(!1)}catch(A){Y(A.message||"Erro ao recalcular split")}finally{v(!1)}},X=()=>{if(!K)return"Nenhum split calculado ainda";if(K.mode===et.CUSTOM)return"Diviso: Customizada";const A=K.mode===et.BY_COUPLE?"Por casal":"Por pessoa",M=K.count||0,b=K.mode===et.BY_COUPLE?`${M} casal${M!==1?"is":""}`:`${M} pessoa${M!==1?"s":""}`;return`Diviso: ${A}  ${b}`};return e.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Regras de Diviso"}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-800 rounded border border-gray-700",children:[e.jsx("div",{className:"text-sm text-gray-200",children:X()}),f===Bt.INHERIT&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Participao: herdada da viagem"}),de.length>0&&e.jsx("div",{className:"mt-2",children:de.map((A,M)=>e.jsxs("div",{className:"inline-block bg-yellow-500/10 text-yellow-400 text-xs px-2 py-1 rounded mr-2",children:[" ",A]},M))}),F&&e.jsxs("div",{className:"mt-2 bg-red-500/10 text-red-400 text-xs px-2 py-1 rounded",children:[" ",F]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Como dividir"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:m===et.BY_COUPLE,onChange:()=>{g(et.BY_COUPLE),ae(y,et.BY_COUPLE)},className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Por casal"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:m===et.PER_PERSON,onChange:()=>{g(et.PER_PERSON),ae(y,et.PER_PERSON)},className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Por pessoa"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:m===et.CUSTOM,onChange:()=>{g(et.CUSTOM),Q(!0)},className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Custom (manual)"})]})]})]}),m!==et.CUSTOM&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quem participa"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:f===Bt.INHERIT,onChange:()=>x(Bt.INHERIT),className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Herdar da viagem"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:f===Bt.ALL,onChange:()=>x(Bt.ALL),className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Todos"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:f===Bt.PAYING_ONLY,onChange:()=>x(Bt.PAYING_ONLY),className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"S pagantes"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:f===Bt.MANUAL,onChange:()=>{x(Bt.MANUAL),U(!0)},className:"text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-200",children:"Manual"})]})]}),f===Bt.MANUAL&&e.jsx("div",{className:"mt-2",children:e.jsx(V,{onClick:()=>U(!0),variant:"secondary",size:"sm",children:m===et.PER_PERSON?`Selecionar viajantes (${O.length})`:`Selecionar casais (${E.length})`})})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-700",children:[e.jsx(V,{onClick:ue,disabled:w||m===et.CUSTOM,className:"w-full",children:w?"Recalculando...":"Recalcular split"}),m===et.CUSTOM&&e.jsx("p",{className:"text-xs text-gray-400 mt-1 text-center",children:"Use o editor customizado para gerenciar splits manualmente"})]})]}),j&&e.jsx(Re,{isOpen:j,onClose:()=>U(!1),title:m===et.PER_PERSON?"Selecionar Viajantes":"Selecionar Casais",children:m===et.PER_PERSON?e.jsx(cb,{travelers:y,selectedIds:O,onSelectionChange:R,onClose:()=>U(!1)}):e.jsx(db,{couples:k,selectedIds:E,onSelectionChange:H,onClose:()=>U(!1)})}),C&&e.jsx(Re,{isOpen:C,onClose:()=>N(!1),title:"Confirmar reclculo",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-300",children:"Isso vai substituir os valores customizados existentes. Deseja continuar?"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(V,{onClick:()=>N(!1),variant:"secondary",children:"Cancelar"}),e.jsx(V,{onClick:L,disabled:w,children:w?"Recalculando...":"Confirmar"})]})]})}),q&&m===et.CUSTOM&&e.jsx(Re,{isOpen:q,onClose:()=>Q(!1),title:"Editor de Split Customizado",size:"large",children:e.jsx(ub,{expenseId:s,tripId:r,expenseTotal:l,travelers:y,couples:k,onClose:()=>{Q(!1),u&&u()}})})]})},mb=({trip:r,expense:s,onBack:l,onRefresh:o})=>{var C;const[c,u]=D.useState("summary"),[m,g]=D.useState([]),[f,x]=D.useState([]),[y,_]=D.useState([]),[k,S]=D.useState(!1),w={...s,amountBrl:s.amountBrl||0,amountUsd:s.amountUsd||0};D.useEffect(()=>{v()},[s.id]);const v=async()=>{const[N,O,R]=await Promise.all([Oe.getExpenseSplits(s.id),Oe.getPaymentsByExpense(s.id),Oe.getReimbursements(r.id)]);g(N),x(O),_(R.filter(E=>E.expenseId===s.id))},j=D.useMemo(()=>f.reduce((N,O)=>N+(O.paidAmountBrl||0),0),[f]),U=Math.min(100,Math.round(j/(w.amountBrl||1)*100)),q=async N=>{N.preventDefault();const O=new FormData(N.currentTarget),R=Number(O.get("amount"));await Oe.savePayment({id:"",tripId:r.id,expenseId:s.id,paidByCoupleId:O.get("coupleId"),method:O.get("method"),paidAmountBrl:R,paidAt:new Date().toISOString()}),S(!1),o(),v()},Q=async N=>{let O=[];if(N===Vr.EQUAL){const R=Fe.splitEqual(s.amountBrl,r.couples.length);O=r.couples.map((E,H)=>({id:Math.random().toString(36).substr(2,9),expenseId:s.id,coupleId:E.id,splitType:N,amountBrl:R[H]}))}else if(N===Vr.PER_PERSON){const R=r.couples.map(H=>H.members.length),E=Fe.splitByWeight(s.amountBrl,R);O=r.couples.map((H,K)=>({id:Math.random().toString(36).substr(2,9),expenseId:s.id,coupleId:H.id,splitType:N,amountBrl:E[K],value:H.members.length}))}O.length>0&&(await Oe.updateExpenseSplits(s.id,O),v())};return e.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-400 hover:text-white group",children:[e.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Lista de Fechados"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"outline",onClick:()=>S(!0),children:"+ Adicionar Pagamento"}),e.jsx(V,{variant:"primary",onClick:()=>u("split"),children:"Ajustar Racha"})]})]}),e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 pb-6 border-b border-gray-800",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{color:"indigo",children:s.category}),e.jsx(ge,{color:s.status===ja.PAID?"green":"yellow",children:s.status.toUpperCase()})]}),e.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:s.title}),e.jsxs("p",{className:"text-lg text-gray-500 font-medium",children:["Segmento: ",((C=r.segments.find(N=>N.id===s.segmentId))==null?void 0:C.name)||"Geral"]})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4 justify-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase",children:"Pago"}),e.jsxs("p",{className:"text-lg font-black text-emerald-400",children:["R$ ",Fe.format(j)]})]}),e.jsx("div",{className:"w-px h-8 bg-gray-800"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase",children:"Total Geral"}),e.jsxs("p",{className:"text-3xl font-black text-white",children:["R$ ",Fe.format(s.amountBrl)]})]})]}),e.jsx("div",{className:"w-full bg-gray-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-emerald-500 h-full transition-all duration-1000",style:{width:`${U}%`}})})]})]}),e.jsx("div",{className:"flex border-b border-gray-800 overflow-x-auto",children:["summary","split","payments","reimbursements"].map(N=>e.jsx("button",{onClick:()=>u(N),className:`px-6 py-4 text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${c===N?"text-indigo-400 border-b-2 border-indigo-500 bg-indigo-500/5":"text-gray-500 hover:text-gray-300"}`,children:N==="summary"?"Resumo":N==="split"?"Diviso (Racha)":N==="payments"?"Pagamentos":"Reembolsos Automticos"},N))}),e.jsxs("div",{className:"min-h-[400px]",children:[c==="summary"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-in fade-in duration-300",children:[e.jsxs(me,{title:"Dados Tcnicos",children:[s.hotelDetails&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-xs text-gray-400",children:["Hotel: ",s.hotelDetails.roomType||"Standard"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black",children:"Check-in"}),e.jsx("p",{className:"text-sm font-bold text-gray-200",children:s.hotelDetails.checkin})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black",children:"Check-out"}),e.jsx("p",{className:"text-sm font-bold text-gray-200",children:s.hotelDetails.checkout})]})]})]}),!s.hotelDetails&&e.jsx("p",{className:"text-gray-600 italic",children:"Nenhum detalhe tcnico especfico disponvel."})]}),e.jsx(me,{title:"Notas e Observaes",children:e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:s.notesGroup||"Sem notas adicionais para o grupo."})})]}),c==="split"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx(hb,{tripId:r.id,expenseId:s.id,expenseTotal:s.amountBrl,currentSplitMode:s.splitMode,currentParticipationMode:s.participationMode||Bt.INHERIT,onUpdated:()=>{v(),o()}}),e.jsxs("div",{className:"border-t border-gray-800 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Diviso Atual"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",className:"text-[10px]",onClick:()=>Q(Vr.EQUAL),children:"Igualitrio (Legado)"}),e.jsx(V,{variant:"ghost",className:"text-[10px]",onClick:()=>Q(Vr.PER_PERSON),children:"Por Pessoa (Legado)"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map(N=>{const O=r.couples.find(R=>R.id===N.coupleId);return e.jsxs(me,{className:"text-center group border-2 hover:border-indigo-500 transition-all",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:O==null?void 0:O.name}),e.jsxs("p",{className:"text-2xl font-black text-white",children:["R$ ",Fe.format(N.amountBrl)]}),e.jsx(ge,{color:"indigo",className:"mt-2",children:N.splitType===Vr.EQUAL?"Igual":`${N.value} Pessoas`})]},N.id)})})]})]}),c==="payments"&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Histrico de Pagamentos Efetuados"}),e.jsx(V,{variant:"primary",onClick:()=>S(!0),children:"+ Novo Pagamento"})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-800",children:e.jsxs("table",{className:"w-full text-left bg-gray-900",children:[e.jsx("thead",{className:"bg-gray-950 text-[10px] uppercase font-black text-gray-600 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Data"}),e.jsx("th",{className:"p-4",children:"Quem Pagou"}),e.jsx("th",{className:"p-4",children:"Mtodo"}),e.jsx("th",{className:"p-4 text-right",children:"Valor Pago"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:f.map(N=>{var O;return e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"p-4 text-gray-400",children:Ai(N.paidAt)}),e.jsx("td",{className:"p-4 text-white font-bold",children:(O=r.couples.find(R=>R.id===N.paidByCoupleId))==null?void 0:O.name}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{color:"indigo",children:N.method.toUpperCase()})}),e.jsxs("td",{className:"p-4 text-right font-black text-emerald-400",children:["R$ ",Fe.format(N.paidAmountBrl)]})]},N.id)})})]})})]}),c==="reimbursements"&&e.jsx("div",{className:"space-y-4 animate-in fade-in duration-300",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map(N=>{var O,R;return e.jsxs(me,{className:`flex items-center justify-between !p-4 border-2 ${N.status==="paid"?"opacity-40 border-gray-800":"border-indigo-500/30"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-white",children:(O=r.couples.find(E=>E.id===N.fromCoupleId))==null?void 0:O.name}),e.jsx("span",{className:"text-[10px] text-gray-600 font-black uppercase",children:"deve para"}),e.jsx("span",{className:"text-sm font-bold text-indigo-400",children:(R=r.couples.find(E=>E.id===N.toCoupleId))==null?void 0:R.name})]}),e.jsxs("p",{className:"text-lg font-black text-white mt-1",children:["R$ ",Fe.format(N.amountBrl)]})]}),e.jsx("div",{className:"flex gap-2",children:N.status==="pending"?e.jsx(V,{variant:"primary",className:"text-[10px] py-1",onClick:async()=>{await Oe.markReimbursementAsPaid(N.id),v()},children:"Marcar Pago"}):e.jsx(ge,{color:"green",children:"LIQUIDADO"})})]},N.id)})})})]}),e.jsx(Re,{isOpen:k,onClose:()=>S(!1),title:"Registrar Pagamento",children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsx(ee,{as:"select",label:"Quem pagou?",name:"coupleId",required:!0,children:r.couples.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(ee,{as:"select",label:"Mtodo",name:"method",required:!0,children:[e.jsx("option",{value:ca.PIX,children:"PIX"}),e.jsx("option",{value:ca.CREDIT_CARD,children:"Carto"}),e.jsx("option",{value:ca.CASH,children:"Espcie"})]}),e.jsx(ee,{label:"Valor (R$)",name:"amount",type:"number",step:"0.01",defaultValue:s.amountBrl,required:!0})]}),e.jsx("div",{className:"pt-4 flex justify-end gap-3 border-t border-gray-800",children:e.jsx(V,{variant:"primary",type:"submit",children:"Confirmar"})})]})})]})},fb=({trip:r})=>{const[s,l]=D.useState([]),[o,c]=D.useState([]),[u,m]=D.useState("all");D.useEffect(()=>{g()},[r.id]);const g=async()=>{const[y,_]=await Promise.all([Oe.getPaymentsByTrip(r.id),Oe.getExpenses(r.id)]);l(y),c(_)},f=D.useMemo(()=>s.filter(y=>u==="all"||y.paidByCoupleId===u).sort((y,_)=>_.paidAt.localeCompare(y.paidAt)),[s,u]),x=D.useMemo(()=>f.reduce((y,_)=>y+_.paidAmountBrl,0),[f]);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"Fluxo de Caixa"}),e.jsx("p",{className:"text-gray-500",children:"Todos os pagamentos realizados na viagem"})]}),e.jsxs(me,{className:"!p-3 !bg-indigo-600/10 border-indigo-500/20",children:[e.jsx("p",{className:"text-[10px] font-black text-indigo-400 uppercase",children:"Total Desembolsado"}),e.jsx("p",{className:"text-2xl font-black text-white",children:pe(x)})]})]}),e.jsx(me,{className:"!p-4 bg-gray-900/40 border-gray-800",children:e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs(ee,{as:"select",label:"Filtrar por Pagador",value:u,onChange:y=>m(y.target.value),className:"max-w-xs",children:[e.jsx("option",{value:"all",children:"Todos os Casais"}),r.couples.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]}),e.jsx(V,{variant:"ghost",className:"text-xs",onClick:()=>m("all"),children:"Limpar Filtros"})]})}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-gray-800",children:e.jsxs("table",{className:"w-full text-left bg-gray-900",children:[e.jsx("thead",{className:"bg-gray-950 text-[10px] font-black uppercase text-gray-500 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Data"}),e.jsx("th",{className:"p-4",children:"Quem Pagou"}),e.jsx("th",{className:"p-4",children:"Despesa Vinculada"}),e.jsx("th",{className:"p-4",children:"Mtodo"}),e.jsx("th",{className:"p-4 text-right",children:"Valor BRL"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-800",children:[f.map(y=>{const _=o.find(S=>S.id===y.expenseId),k=r.couples.find(S=>S.id===y.paidByCoupleId);return e.jsxs("tr",{className:"hover:bg-gray-800/20 transition-colors",children:[e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:Ai(y.paidAt)}),e.jsx("td",{className:"p-4 font-bold text-gray-200 text-sm",children:k==null?void 0:k.name}),e.jsx("td",{className:"p-4 text-gray-400 text-sm",children:(_==null?void 0:_.title)||"Avulso"}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{color:"indigo",children:y.method.toUpperCase()})}),e.jsx("td",{className:"p-4 text-right font-black text-emerald-400",children:pe(y.paidAmountBrl||0)})]},y.id)}),f.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-20 text-center text-gray-600 italic",children:"Nenhum pagamento registrado."})})]})]})})]})},gb=({trip:r})=>{const[s,l]=D.useState([]),[o,c]=D.useState([]),[u,m]=D.useState([]),[g,f]=D.useState([]);D.useEffect(()=>{x()},[r.id]);const x=async()=>{const[k,S,w,v]=await Promise.all([Oe.getExpenses(r.id),Oe.getReimbursements(r.id),Oe.getPaymentsByTrip(r.id),Oe.getExpenseSplitsByTrip(r.id)]);l(k),c(S),m(w),f(v)},y=D.useMemo(()=>{const k={};r.couples.forEach(w=>k[w.id]={share:0,paid:0}),u.forEach(w=>{k[w.paidByCoupleId]&&(k[w.paidByCoupleId].paid+=Fe.toCents(w.paidAmountBrl))}),g.forEach(w=>{k[w.coupleId]&&(k[w.coupleId].share+=Fe.toCents(w.amountBrl))}),o.filter(w=>w.status==="paid").forEach(w=>{const v=Fe.toCents(w.amountBrl);k[w.fromCoupleId]&&(k[w.fromCoupleId].paid+=v),k[w.toCoupleId]&&(k[w.toCoupleId].paid-=v)});const S={};return Object.keys(k).forEach(w=>{S[w]={share:Fe.fromCents(k[w].share),paid:Fe.fromCents(k[w].paid),net:Fe.fromCents(k[w].paid-k[w].share)}}),S},[g,u,o,r.couples]),_=D.useMemo(()=>{const k=Object.keys(y).filter(U=>y[U].net<-.009).map(U=>({id:U,cents:Math.abs(Fe.toCents(y[U].net))})),S=Object.keys(y).filter(U=>y[U].net>.009).map(U=>({id:U,cents:Fe.toCents(y[U].net)})),w=[];let v=0,j=0;for(;v<k.length&&j<S.length;){const U=Math.min(k[v].cents,S[j].cents);U>0&&w.push({from:k[v].id,to:S[j].id,amount:Fe.fromCents(U)}),k[v].cents-=U,S[j].cents-=U,k[v].cents<=0&&v++,S[j].cents<=0&&j++}return w},[y]);return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-20",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter leading-none",children:"Acerto de Contas"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Saldo consolidado baseado nos rachas definidos em cada item"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r.couples.map(k=>{const S=y[k.id],w=S.net>.009,v=S.net<-.009;return e.jsxs(me,{className:`border-2 transition-all ${w?"border-emerald-500/30 bg-emerald-500/5":v?"border-red-500/30 bg-red-500/5":"border-gray-800"}`,children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:k.name}),e.jsxs("div",{className:"mt-4 flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-black",children:"Saldo Lquido"}),e.jsxs("p",{className:`text-3xl font-black ${w?"text-emerald-400":v?"text-red-400":"text-gray-400"}`,children:[w?"+":""," R$ ",Fe.format(S.net)]})]}),e.jsx(ge,{color:w?"green":v?"red":"gray",children:w?"A RECEBER":v?"DEVEDOR":"QUITE"})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-800/30 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-gray-600",children:[e.jsx("span",{children:"Sua cota total nos rachas:"}),e.jsxs("span",{children:["R$ ",Fe.format(S.share)]})]}),e.jsxs("div",{className:"flex justify-between text-[10px] text-gray-600",children:[e.jsx("span",{children:"Total desembolsado por voc:"}),e.jsxs("span",{children:["R$ ",Fe.format(S.paid)]})]})]})]},k.id)})}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Transferncias Recomendadas (Para Liquidar Viagem)"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[_.map((k,S)=>{var w,v;return e.jsxs(me,{className:"flex items-center justify-between !p-4 !bg-gray-950 border border-indigo-500/20 shadow-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-gray-200",children:(w=r.couples.find(j=>j.id===k.from))==null?void 0:w.name}),e.jsx("div",{className:"flex-1 h-px bg-gray-800 border-dashed border-b mx-2"}),e.jsx("span",{className:"text-sm font-bold text-indigo-400",children:(v=r.couples.find(j=>j.id===k.to))==null?void 0:v.name})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("p",{className:"text-xl font-black text-white",children:["R$ ",Fe.format(k.amount)]}),e.jsx(ge,{color:"yellow",children:"ACERTO GLOBAL"})]})]}),e.jsxs("div",{className:"ml-6 flex flex-col gap-2",children:[e.jsx(V,{variant:"primary",className:"text-[10px] py-2 px-4",onClick:()=>{alert("Para liquidar um saldo global, registre um pagamento avulso ou marque os reembolsos individuais das despesas como pagos.")},children:"Como Liquidar?"}),e.jsx(V,{variant:"ghost",className:"text-[10px] py-1",onClick:()=>{var j;navigator.clipboard.writeText(`Oi ${(j=r.couples.find(U=>U.id===k.to))==null?void 0:j.name}, segundo o TripDivide meu saldo global devedor  R$ ${Fe.format(k.amount)}. Me manda o PIX para eu liquidar?`),alert("Mensagem copiada!")},children:"Copiar Cobrana"})]})]},S)}),_.length===0&&e.jsxs("div",{className:"col-span-full py-20 bg-gray-900 border border-dashed border-gray-800 rounded-2xl flex flex-col items-center",children:[e.jsx("span",{className:"text-4xl mb-4",children:""}),e.jsx("p",{className:"font-bold text-gray-100",children:"Viagem Liquidada!"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 uppercase tracking-widest font-black",children:"Nenhum acerto global pendente."})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Detalhes por Item (Reembolsos)"}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-800",children:e.jsxs("table",{className:"w-full text-left bg-gray-900",children:[e.jsx("thead",{className:"bg-gray-950 text-[10px] font-black uppercase text-gray-600 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Item"}),e.jsx("th",{className:"p-4",children:"De"}),e.jsx("th",{className:"p-4",children:"Para"}),e.jsx("th",{className:"p-4",children:"Valor"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4 text-right",children:"Ao"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:o.map(k=>{var S,w,v;return e.jsxs("tr",{className:"text-xs group hover:bg-gray-800/40",children:[e.jsx("td",{className:"p-4 font-bold text-gray-400",children:((S=s.find(j=>j.id===k.expenseId))==null?void 0:S.title)||"Ajuste"}),e.jsx("td",{className:"p-4",children:(w=r.couples.find(j=>j.id===k.fromCoupleId))==null?void 0:w.name}),e.jsx("td",{className:"p-4 text-indigo-400",children:(v=r.couples.find(j=>j.id===k.toCoupleId))==null?void 0:v.name}),e.jsxs("td",{className:"p-4 font-black",children:["R$ ",Fe.format(k.amountBrl)]}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{color:k.status==="paid"?"green":"yellow",children:k.status.toUpperCase()})}),e.jsx("td",{className:"p-4 text-right",children:k.status==="pending"&&e.jsx(V,{variant:"ghost",className:"text-[10px] py-1",onClick:async()=>{await Oe.markReimbursementAsPaid(k.id),x()},children:"Liquidado"})})]},k.id)})})]})})]})]})},Af=({value:r,onChange:s,placeholder:l="(00) 00000-0000",className:o="",required:c=!1})=>{const u=m=>{const g=m.target.value,f=Wv(g);f.length<=11&&s(f)};return e.jsx("input",{type:"tel",value:Ei(r),onChange:u,placeholder:l,required:c,className:o})},xi=(r,s)=>{const l=r.replace(/[^A-Za-z0-9]/g,"");switch(s){case"CPF":return l.slice(0,11).replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{3})(\d{1})$/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{2})$/,"$1.$2.$3").replace(/(\d{3})(\d{2})$/,"$1.$2");case"RG":return l.slice(0,9).replace(/(\d{2})(\d{3})(\d{3})(\d{1})/,"$1.$2.$3-$4").replace(/(\d{2})(\d{3})(\d{3})$/,"$1.$2.$3").replace(/(\d{2})(\d{3})$/,"$1.$2");case"CNH":return l.slice(0,11);case"Passaporte":return l.slice(0,8).toUpperCase();default:return r}},pi=r=>r.replace(/[^A-Za-z0-9]/g,""),Oi=({tripId:r,trip:s,existingProfileId:l,onDone:o,onCancel:c})=>{var Ne,Pe,Tt,Gs,Hr,xa;const[u,m]=D.useState(1),[g,f]=D.useState(!1),[x,y]=D.useState(""),[_,k]=D.useState([]),[S,w]=D.useState(null),[v,j]=D.useState(null),[U,q]=D.useState(-1),[Q,C]=D.useState(!0),[N,O]=D.useState(""),[R,E]=D.useState(!1),[H,K]=D.useState(!1),[ie,de]=D.useState(l),[xe,F]=D.useState(),[Y,P]=D.useState({fullName:"",nickname:"",phone:"",email:"",birthDate:"",type:St.ADULT,canDrive:!1,tags:[],notes:""}),[ae,ue]=D.useState({type:St.ADULT,coupleId:((Pe=(Ne=s==null?void 0:s.couples)==null?void 0:Ne[0])==null?void 0:Pe.id)||"",goesToSegments:((Tt=s==null?void 0:s.segments)==null?void 0:Tt.filter($=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test($.id)).map($=>$.id))||[],isPayer:!0,countInSplit:!0}),[L,X]=D.useState(!0);D.useEffect(()=>{(async()=>{var Ee;if(l){E(!0);try{const it=await he.getTravelerProfileById(l);if(it){P({fullName:it.full_name||"",nickname:it.nickname||"",phone:it.phone||"",email:it.email||"",birthDate:it.birth_date||"",type:it.type||St.ADULT,canDrive:it.can_drive||!1,tags:it.tags||[],notes:it.notes||""});const Ha=await he.getTravelerProfileDocuments(l);if(k(Ha),r){const kt=(await he.getTripTravelers(r)).find(ys=>ys.traveler_profile_id===l);kt&&(F(kt.id),ue({type:kt.type||St.ADULT,coupleId:kt.couple_id||((Ee=s==null?void 0:s.couples[0])==null?void 0:Ee.id)||"",goesToSegments:kt.goes_to_segments||[],isPayer:kt.is_payer!==void 0?kt.is_payer:!0,countInSplit:kt.count_in_split!==void 0?kt.count_in_split:!0}))}}}catch(it){console.error("Erro ao carregar perfil:",it)}finally{E(!1)}}})()},[l,r]),D.useEffect(()=>{Y.type===St.INFANT||Y.type==="Pet"?(ue($=>({...$,isPayer:!1,countInSplit:!1})),P($=>({...$,canDrive:!1}))):Y.type===St.ADULT&&ue($=>({...$,isPayer:!0,countInSplit:!0}))},[Y.type]);const A=r?[{id:1,title:"Bsico"},{id:2,title:"Participao"},{id:3,title:"Documentos"}]:[{id:1,title:"Bsico"},{id:3,title:"Documentos"}],M=async()=>{if(!H){if(u===1){K(!0);try{const $=await he.saveTravelerProfile({id:ie,full_name:Y.fullName,nickname:Y.nickname,phone:Y.phone,email:Y.email,birth_date:Y.birthDate,type:Y.type,can_drive:Y.canDrive,tags:Y.tags,notes:Y.notes});if($!=null&&$.id&&de($.id),!r||!L){m(3);return}m(2);return}catch($){console.error("Erro ao salvar perfil:",$);return}finally{K(!1)}}if(u===2&&r&&ie&&L){K(!0);try{if(xe)await he.updateTripTraveler(xe,{type:ae.type,coupleId:ae.coupleId,goesToSegments:ae.goesToSegments,isPayer:ae.isPayer,countInSplit:ae.countInSplit});else{const $=await he.linkTravelerToTrip({tripId:r,travelerProfileId:ie,type:ae.type,coupleId:ae.coupleId,goesToSegments:ae.goesToSegments,isPayer:ae.isPayer,countInSplit:ae.countInSplit});$!=null&&$.id&&F($.id)}m(3);return}catch($){console.error("Erro ao vincular:",$);return}finally{K(!1)}}m($=>Math.min($+1,3))}},b=()=>{m(u===3&&(!r||!L)?1:$=>Math.max($-1,1))},B=()=>!(!Y.fullName||!Y.fullName.trim()||(Y.type===St.CHILD||Y.type===St.INFANT)&&!Y.birthDate),z=$=>!$||$.length<=4?$:`${$.slice(-4)}`,oe=()=>{var $;N.trim()&&!(($=Y.tags)!=null&&$.includes(N.trim()))&&(P({...Y,tags:[...Y.tags||[],N.trim()]}),O(""))},fe=$=>{var Ee;P({...Y,tags:(Ee=Y.tags)==null?void 0:Ee.filter(it=>it!==$)})},Ce=$=>$==="Visto"||$==="ESTA"?"entry":"identity";return e.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center relative pb-8",children:[e.jsx("div",{className:"absolute top-4 left-0 w-full h-0.5 bg-gray-800 -z-10"}),A.map(($,Ee)=>e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs border-2 transition-all ${u===$.id?"bg-indigo-600 border-indigo-400 text-white":u>$.id?"bg-emerald-600 border-emerald-400 text-white":"bg-gray-900 border-gray-700 text-gray-500"}`,children:u>$.id?"":Ee+1}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:$.title})]},$.id))]}),e.jsxs("div",{className:"min-h-[300px]",children:[u===1&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 animate-in fade-in duration-300",children:[e.jsx(ee,{label:"Nome Completo *",value:Y.fullName,onChange:$=>P({...Y,fullName:$.target.value}),placeholder:"Como o grupo conhece"}),e.jsx(ee,{label:"Apelido",value:Y.nickname,onChange:$=>P({...Y,nickname:$.target.value}),placeholder:"Opcional"}),e.jsx(ee,{as:"select",label:"Tipo *",value:Y.type,onChange:$=>P({...Y,type:$.target.value}),children:Object.values(St).map($=>e.jsx("option",{value:$,children:$},$))}),s&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Casal / Grupo *"}),g?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,onChange:$=>y($.target.value),placeholder:"Nome do novo grupo",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-indigo-500 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-400 transition-colors",autoFocus:!0,onKeyDown:async $=>{if($.key==="Enter"&&x.trim()){if($.preventDefault(),!(s!=null&&s.id))return;const Ee=await he.saveCouple(s.id,{name:x.trim()});Ee&&(s.couples.push({id:Ee.id,name:Ee.name,members:[]}),ue({...ae,coupleId:Ee.id}),f(!1),y(""))}else $.key==="Escape"&&(f(!1),y(""))}}),e.jsx(V,{variant:"primary",className:"text-xs whitespace-nowrap",disabled:!x.trim(),onClick:async $=>{if($.preventDefault(),x.trim()){if(!(s!=null&&s.id))return;const Ee=await he.saveCouple(s.id,{name:x.trim()});Ee&&(s.couples.push({id:Ee.id,name:Ee.name,members:[]}),ue({...ae,coupleId:Ee.id}),f(!1),y(""))}},children:"Criar"}),e.jsx(V,{variant:"ghost",className:"text-xs",onClick:$=>{$.preventDefault(),f(!1),y("")},children:""})]}),e.jsx("p",{className:"text-[10px] text-gray-600",children:"Enter para criar, Esc para cancelar"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:ae.coupleId,onChange:$=>ue({...ae,coupleId:$.target.value}),className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors",children:(Gs=s==null?void 0:s.couples)==null?void 0:Gs.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))}),e.jsx(V,{variant:"outline",className:"text-xs whitespace-nowrap",onClick:$=>{$.preventDefault(),f(!0),y("")},children:"+ Grupo"})]})]}),Y.type!=="Pet"&&e.jsx(ee,{label:`Data de Nascimento ${Y.type===St.CHILD||Y.type===St.INFANT?"*":""}`,type:"date",value:mt(Y.birthDate),onChange:$=>P({...Y,birthDate:$.target.value})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"WhatsApp (Fone)"}),e.jsx(Af,{value:Y.phone||"",onChange:$=>P({...Y,phone:$}),placeholder:"(00) 00000-0000",className:"w-full px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"})]}),e.jsx(ee,{label:"Email",className:"col-span-1 md:col-span-2",value:Y.email,onChange:$=>P({...Y,email:$.target.value}),placeholder:"Recomendado para comunicao"})]}),u===2&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[r&&e.jsx("div",{className:"p-4 bg-indigo-600/10 border border-indigo-500/30 rounded-xl",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5 mt-0.5 accent-indigo-500",checked:L,onChange:$=>X($.target.checked)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white",children:"Vincular a esta viagem agora"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Se desmarcar, o perfil ser criado mas no vinculado. Voc pode vincular depois pela opo "Adicionar da Lista".'})]})]})}),L&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Segmentos da Viagem"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{var $;return ue({...ae,goesToSegments:(($=s==null?void 0:s.segments)==null?void 0:$.map(Ee=>Ee.id))||[]})},className:"text-[10px] text-indigo-400 hover:text-indigo-300 font-bold uppercase",children:"Marcar todos"}),e.jsx("span",{className:"text-gray-700",children:""}),e.jsx("button",{onClick:()=>ue({...ae,goesToSegments:[]}),className:"text-[10px] text-gray-500 hover:text-gray-400 font-bold uppercase",children:"Limpar"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:(Hr=s==null?void 0:s.segments)==null?void 0:Hr.map($=>{var Ee,it;return e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-xl border transition-all cursor-pointer ${(Ee=ae.goesToSegments)!=null&&Ee.includes($.id)?"bg-indigo-600/10 border-indigo-500/40 text-white":"bg-gray-950 border-gray-800 text-gray-500 hover:border-gray-700"}`,children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-indigo-500",checked:(it=ae.goesToSegments)==null?void 0:it.includes($.id),onChange:Ha=>{const ps=ae.goesToSegments||[],kt=Ha.target.checked?[...ps,$.id]:ps.filter(ys=>ys!==$.id);ue({...ae,goesToSegments:kt})}}),e.jsx("span",{className:"text-sm font-bold",children:$.name})]},$.id)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-950 border border-gray-800 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:"Viajante Pagante?"}),e.jsx("p",{className:"text-[10px] text-gray-600 uppercase",children:"Considerar no racha de custos"})]}),e.jsx("input",{type:"checkbox",className:"w-6 h-6 accent-emerald-500",checked:ae.isPayer,onChange:$=>ue({...ae,isPayer:$.target.checked}),disabled:Y.type===St.INFANT||Y.type==="Pet"})]}),Y.type===St.ADULT&&e.jsxs("div",{className:"p-4 bg-gray-950 border border-gray-800 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:"Pode Dirigir?"}),e.jsx("p",{className:"text-[10px] text-gray-600 uppercase",children:"CNH Habilitada"})]}),e.jsx("input",{type:"checkbox",className:"w-6 h-6 accent-indigo-500",checked:Y.canDrive,onChange:$=>P({...Y,canDrive:$.target.checked})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(xa=Y.tags)==null?void 0:xa.map($=>e.jsxs(ge,{color:"indigo",className:"flex items-center gap-1",children:[$,e.jsx("button",{onClick:()=>fe($),className:"ml-1 hover:text-red-400",children:""})]},$))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:N,onChange:$=>O($.target.value),onKeyDown:$=>$.key==="Enter"&&($.preventDefault(),oe()),placeholder:"Ex: Vegetariano, Alergia, Prefere janela",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors text-sm"}),e.jsx(V,{variant:"outline",onClick:oe,disabled:!N.trim(),children:"+ Add"})]})]}),e.jsx(ee,{as:"textarea",label:"Observaes Livres",rows:2,value:Y.notes,onChange:$=>P({...Y,notes:$.target.value}),placeholder:"Detalhes adicionais, restries, preferncias..."})]}),u===3&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs(me,{className:"!bg-indigo-600/5 !border-indigo-500/20",children:[e.jsx("p",{className:"text-[10px] text-indigo-400 font-bold uppercase mb-1",children:" Documentao (Opcional)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Adicione documentos para controle. Nmeros so protegidos e no aparecem completos na listagem."})]}),e.jsx("div",{className:"space-y-2",children:_.map(($,Ee)=>e.jsxs("div",{className:"p-3 bg-gray-950 border border-gray-800 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-bold text-white",children:[$.docType," - ",z($.docNumber)]}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:[$.issuingCountry&&`${$.issuingCountry}  `,$.docExpiry&&`Vence: ${$.docExpiry}`]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{j($),q(Ee),C(!0)},className:"text-indigo-400 hover:text-indigo-300 text-xs",children:""}),e.jsx("button",{onClick:()=>k(_.filter((it,Ha)=>Ha!==Ee)),className:"text-red-400 hover:text-red-300 text-xs",children:""})]})]},Ee))}),v!==null?e.jsxs(me,{className:"!bg-gray-900/50",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 mb-3",children:U>=0?"Editar Documento":"Novo Documento"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ee,{as:"select",label:"Tipo *",value:v.docType||"Passaporte",onChange:$=>j({...v,docType:$.target.value,docCategory:Ce($.target.value)}),children:[e.jsx("option",{value:"Passaporte",children:" Passaporte"}),e.jsx("option",{value:"RG",children:" RG"}),e.jsx("option",{value:"CPF",children:" CPF"}),e.jsx("option",{value:"CNH",children:" CNH"}),e.jsx("option",{value:"Visto",children:" Visto"}),e.jsx("option",{value:"ESTA",children:" ESTA/ETA"}),e.jsx("option",{value:"Outro",children:" Outro"})]}),v.docType==="Passaporte"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(ee,{label:"Pas Emissor *",value:v.issuingCountry||"",onChange:$=>j({...v,issuingCountry:$.target.value||""}),placeholder:"Ex: Brasil"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:Q?xi(v.docNumber||"",v.docType):v.docNumber||"",onChange:$=>{const Ee=pi($.target.value);j({...v,docNumber:Ee||""})},placeholder:"Ex: AB123456",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsx(ee,{label:"Data de Emisso",type:"date",value:mt(v.issueDate)||"",onChange:$=>j({...v,issueDate:$.target.value||""})}),e.jsx(ee,{label:"Vencimento *",type:"date",value:mt(v.docExpiry)||"",onChange:$=>j({...v,docExpiry:$.target.value||""})}),e.jsx(ee,{label:"Local de Emisso",value:v.issuerPlace||"",onChange:$=>j({...v,issuerPlace:$.target.value||""}),placeholder:"Ex: So Paulo"}),e.jsx(ee,{label:"Observaes",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value||""}),placeholder:"Detalhes adicionais"})]}),v.docType==="RG"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(ee,{label:"Estado Emissor *",value:v.issuerState||"",onChange:$=>j({...v,issuerState:$.target.value}),placeholder:"Ex: SP"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:Q?xi(v.docNumber||"",v.docType):v.docNumber||"",onChange:$=>{const Ee=pi($.target.value);j({...v,docNumber:Ee})},placeholder:"Ex: 00.000.000-0",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsx(ee,{label:"rgo Emissor",value:v.issuerAgency||"",onChange:$=>j({...v,issuerAgency:$.target.value}),placeholder:"Ex: SSP"}),e.jsx(ee,{label:"Data de Emisso",type:"date",value:mt(v.issueDate)||"",onChange:$=>j({...v,issueDate:$.target.value||""})}),e.jsx(ee,{label:"Vencimento (opcional)",type:"date",value:mt(v.docExpiry)||"",onChange:$=>j({...v,docExpiry:$.target.value||""})}),e.jsx(ee,{label:"Observaes",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value}),placeholder:"Detalhes adicionais"})]}),v.docType==="CPF"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:Q?xi(v.docNumber||"",v.docType):v.docNumber||"",onChange:$=>{const Ee=pi($.target.value);j({...v,docNumber:Ee})},placeholder:"Ex: 000.000.000-00",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsx(ee,{label:"Observaes",className:"md:col-span-2",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value}),placeholder:"Detalhes adicionais"})]}),v.docType==="CNH"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero de Registro *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:Q?xi(v.docNumber||"",v.docType):v.docNumber||"",onChange:$=>{const Ee=pi($.target.value);j({...v,docNumber:Ee})},placeholder:"Ex: 12345678900",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsxs(ee,{as:"select",label:"Categoria",value:v.licenseCategory||"",onChange:$=>j({...v,licenseCategory:$.target.value}),children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"A",children:"A - Moto"}),e.jsx("option",{value:"B",children:"B - Carro"}),e.jsx("option",{value:"AB",children:"AB - Moto e Carro"}),e.jsx("option",{value:"C",children:"C - Caminho"}),e.jsx("option",{value:"D",children:"D - nibus"}),e.jsx("option",{value:"E",children:"E - Carreta"})]}),e.jsx(ee,{label:"UF Emissora",value:v.issuerState||"",onChange:$=>j({...v,issuerState:$.target.value}),placeholder:"Ex: SP"}),e.jsx(ee,{label:"Data de Emisso",type:"date",value:mt(v.issueDate)||"",onChange:$=>j({...v,issueDate:$.target.value||""})}),e.jsx(ee,{label:"Vencimento *",type:"date",value:mt(v.docExpiry)||"",onChange:$=>j({...v,docExpiry:$.target.value||""})}),e.jsx(ee,{label:"Observaes",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value}),placeholder:"Detalhes adicionais"})]}),v.docType==="Visto"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(ee,{label:"Pas/Regio *",value:v.regionOrCountry||"",onChange:$=>j({...v,regionOrCountry:$.target.value}),placeholder:"Ex: EUA, Schengen"}),e.jsx(ee,{label:"Categoria",value:v.visaCategory||"",onChange:$=>j({...v,visaCategory:$.target.value}),placeholder:"Ex: B1/B2, Turismo"}),e.jsxs(ee,{as:"select",label:"Tipo de Entrada",value:v.entryType||"",onChange:$=>j({...v,entryType:$.target.value}),children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"single",children:"Entrada nica"}),e.jsx("option",{value:"multiple",children:"Mltiplas Entradas"})]}),e.jsx(ee,{label:"Durao (dias)",type:"number",value:v.stayDurationDays||"",onChange:$=>j({...v,stayDurationDays:parseInt($.target.value)||null}),placeholder:"Ex: 90"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero/ID (opcional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:v.docNumber||"",onChange:$=>j({...v,docNumber:$.target.value}),placeholder:"Ex: 123456789",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsx(ee,{label:"Vencimento *",type:"date",value:mt(v.docExpiry)||"",onChange:$=>j({...v,docExpiry:$.target.value||""})}),e.jsx(ee,{label:"Observaes",className:"md:col-span-2",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value}),placeholder:"Ex: Vlido para turismo"})]}),v.docType==="ESTA"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(ee,{label:"Pas/Regio *",value:v.regionOrCountry||"",onChange:$=>j({...v,regionOrCountry:$.target.value}),placeholder:"Ex: EUA, Canad"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero/ID (opcional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:v.docNumber||"",onChange:$=>j({...v,docNumber:$.target.value}),placeholder:"Ex: 123456789",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsx(ee,{label:"Vencimento *",type:"date",value:mt(v.docExpiry)||"",onChange:$=>j({...v,docExpiry:$.target.value||""})}),e.jsx(ee,{label:"Observaes",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value}),placeholder:"Detalhes adicionais"})]}),v.docType==="Outro"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(ee,{label:"Nome do Documento *",value:v.customLabel||"",onChange:$=>j({...v,customLabel:$.target.value}),placeholder:"Ex: Carteira do Plano"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Nmero/ID (opcional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:Q?"text":"password",value:v.docNumber||"",onChange:$=>j({...v,docNumber:$.target.value}),placeholder:"Ex: 123456",className:"flex-1 px-4 py-2.5 bg-gray-950 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors"}),e.jsx("button",{onClick:()=>C(!Q),className:"px-3 text-gray-500 hover:text-gray-300",children:Q?"":""})]})]}),e.jsx(ee,{label:"Pas/Estado Emissor",value:v.issuingCountry||v.issuerState||"",onChange:$=>j({...v,issuingCountry:$.target.value}),placeholder:"Ex: Brasil"}),e.jsx(ee,{label:"Vencimento (opcional)",type:"date",value:mt(v.docExpiry)||"",onChange:$=>j({...v,docExpiry:$.target.value||""})}),e.jsx(ee,{label:"Observaes",className:"md:col-span-2",value:v.notes||"",onChange:$=>j({...v,notes:$.target.value}),placeholder:"Detalhes adicionais"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(V,{variant:"primary",className:"flex-1",disabled:!v.docType||v.docType==="Passaporte"&&(!v.issuingCountry||!v.docNumber||!v.docExpiry)||v.docType==="RG"&&(!v.issuerState||!v.docNumber)||v.docType==="CPF"&&!v.docNumber||v.docType==="CNH"&&(!v.docNumber||!v.docExpiry)||v.docType==="Visto"&&(!v.regionOrCountry||!v.docExpiry)||v.docType==="ESTA"&&(!v.regionOrCountry||!v.docExpiry)||v.docType==="Outro"&&!v.customLabel,onClick:()=>{if(U>=0){const $=[..._];$[U]=v,k($)}else k([..._,v]);j(null),q(-1),C(!1)},children:U>=0?"Atualizar":"Adicionar"}),e.jsx(V,{variant:"ghost",onClick:()=>{j(null),q(-1),C(!0)},children:"Cancelar"})]})]}):e.jsx(V,{variant:"outline",className:"w-full",onClick:()=>{j({docType:"Passaporte",docCategory:"identity",docNumber:"",issuingCountry:"",docExpiry:"",notes:""}),q(-1),C(!0)},children:"+ Adicionar Documento"}),e.jsxs(me,{className:"!bg-amber-600/5 !border-amber-500/20",children:[e.jsx("p",{className:"text-[10px] text-amber-500 font-bold uppercase mb-1",children:" Dados Protegidos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Nmeros de documentos so criptografados e s aparecem mascarados (1234) nas listagens."})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:u===1?c:b,children:u===1?"Cancelar":"Voltar"}),e.jsx("div",{className:"flex gap-2",children:u<3?e.jsx(V,{onClick:M,disabled:H||u===1&&!B(),children:H?"Salvando...":"Prximo"}):e.jsx(V,{variant:"primary",onClick:async()=>{if(ie){for(const $ of _)if(!$.id)try{await he.saveTravelerProfileDocument({travelerProfileId:ie,docType:$.docType,docCategory:$.docCategory,docNumber:$.docNumber,issuingCountry:$.issuingCountry,issuerState:$.issuerState,issuerAgency:$.issuerAgency,issuerPlace:$.issuerPlace,regionOrCountry:$.regionOrCountry,issueDate:$.issueDate,docExpiry:$.docExpiry,visaCategory:$.visaCategory,entryType:$.entryType,stayDurationDays:$.stayDurationDays,licenseCategory:$.licenseCategory,customLabel:$.customLabel,isPrimary:$.isPrimary,notes:$.notes})}catch(Ee){console.error("Erro ao salvar documento:",Ee)}}o&&ie&&o(ie)},disabled:!B()||!ie,children:l?"Salvar Alteraes":"Concluir"})})]})]})},Of=({onClose:r,onCreated:s})=>{const[l,o]=D.useState({fullName:"",nickname:"",type:"Adulto",phone:"",email:"",birthDate:"",canDrive:!1}),[c,u]=D.useState(!1),m=async()=>{if(l.fullName.trim()){u(!0);try{const g=await he.saveTravelerProfile(l);s(g.id)}catch(g){console.error("Erro ao criar perfil:",g)}finally{u(!1)}}};return e.jsx(Re,{isOpen:!0,onClose:r,children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Criar Novo Viajante"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Perfil global reutilizvel em todas as viagens"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Nome Completo *"}),e.jsx(ee,{value:l.fullName,onChange:g=>o({...l,fullName:g.target.value}),placeholder:"Nome completo",autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Apelido"}),e.jsx(ee,{value:l.nickname,onChange:g=>o({...l,nickname:g.target.value}),placeholder:"Apelido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Tipo *"}),e.jsxs(ee,{as:"select",value:l.type,onChange:g=>o({...l,type:g.target.value}),children:[e.jsx("option",{value:"Adulto",children:"Adulto"}),e.jsx("option",{value:"Criana",children:"Criana"}),e.jsx("option",{value:"Beb",children:"Beb"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Telefone"}),e.jsx(ee,{value:l.phone,onChange:g=>o({...l,phone:g.target.value}),placeholder:"+55 11 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Data de Nascimento"}),e.jsx(ee,{type:"date",value:l.birthDate,onChange:g=>o({...l,birthDate:g.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Email"}),e.jsx(ee,{type:"email",value:l.email,onChange:g=>o({...l,email:g.target.value}),placeholder:"email@exemplo.com"})]}),l.type==="Adulto"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:l.canDrive,onChange:g=>o({...l,canDrive:g.target.checked}),className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-bold text-gray-400",children:"Pode dirigir"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-800",children:[e.jsx(V,{onClick:r,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:m,className:"bg-indigo-600 hover:bg-indigo-700",disabled:!l.fullName.trim()||c,children:c?"Criando...":"Criar e Vincular"})]})]})})},Rf=({trip:r,onClose:s,onLinked:l})=>{const[o,c]=D.useState(r.couples&&r.couples.length>0?"travelers":"groups"),[u,m]=D.useState([]),[g,f]=D.useState(new Set),[x,y]=D.useState(new Map),[_,k]=D.useState(""),[S,w]=D.useState(!0),[v,j]=D.useState(!1),[U,q]=D.useState(!1),[Q,C]=D.useState(null),[N,O]=D.useState(r.couples||[]),[R,E]=D.useState(""),[H,K]=D.useState(!1),[ie,de]=D.useState(!1);D.useEffect(()=>{xe()},[r.id]);const xe=async()=>{w(!0);try{const[M,b]=await Promise.all([he.getTravelerProfiles(),he.getTripTravelers(r.id)]);m(M),f(new Set(b.map(z=>z.traveler_profile_id)));const B=await he.getTripById(r.id);B.couples&&O(B.couples)}catch(M){console.error("Erro ao carregar dados:",M)}finally{w(!1)}},F=async()=>{if(R.trim()){de(!0);try{const M=await he.saveCouple(r.id,{name:R.trim()});O([...N,M]),E(""),K(!1)}catch(M){console.error("Erro ao criar grupo:",M),C("Erro ao criar grupo. Tente novamente.")}finally{de(!1)}}},Y=async M=>{try{await he.deleteCouple(M),O(N.filter(B=>B.id!==M));const b=new Map(x);b.forEach((B,z)=>{B.coupleId===M&&b.set(z,{...B,coupleId:"solo"})}),y(b)}catch(b){console.error("Erro ao deletar grupo:",b),C("Erro ao deletar grupo. Tente novamente.")}},P=M=>{const b=new Map(x);if(b.has(M))b.delete(M);else{const B=N.length>0?N[0].id:"solo",z=r.segments.map(oe=>oe.id);b.set(M,{coupleId:B,segments:z})}y(b)},ae=(M,b)=>{const B=new Map(x);if(B.has(M)){const z=B.get(M);B.set(M,{...z,coupleId:b}),y(B)}},ue=(M,b)=>{const B=new Map(x);if(B.has(M)){const z=B.get(M),oe=z.segments.includes(b)?z.segments.filter(fe=>fe!==b):[...z.segments,b];B.set(M,{...z,segments:oe}),y(B)}},L=async()=>{if(x.size!==0){for(const[M,b]of Array.from(x.entries())){if(!b.coupleId||b.coupleId.trim()===""){C("Por favor, selecione um grupo para todos os viajantes.");return}if(b.segments.length===0){C("Cada viajante deve participar de pelo menos um destino.");return}}j(!0),C(null);try{for(const[M,b]of Array.from(x.entries())){const B=b.segments.filter(z=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(z));await he.linkTravelerToTrip({tripId:r.id,travelerProfileId:M,coupleId:b.coupleId==="solo"?null:b.coupleId,goesToSegments:B,isPayer:!0,countInSplit:!0})}l(),s()}catch(M){console.error("Erro ao vincular viajantes:",M),C("Erro ao vincular viajantes. Tente novamente.")}finally{j(!1)}}},X=async M=>{var b;try{await he.linkTravelerToTrip(r.id,M,{coupleId:(b=r.couples[0])==null?void 0:b.id,goesToSegments:r.segments.map(B=>B.id),isPayer:!0}),q(!1),l(),s()}catch(B){console.error("Erro ao vincular novo perfil:",B)}},A=u.filter(M=>{var z,oe,fe;const b=((z=M.full_name)==null?void 0:z.toLowerCase().includes(_.toLowerCase()))||((oe=M.nickname)==null?void 0:oe.toLowerCase().includes(_.toLowerCase()))||((fe=M.phone)==null?void 0:fe.includes(_)),B=!g.has(M.id);return b&&B});return S?e.jsx(Re,{isOpen:!0,onClose:s,children:e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Carregando perfis..."})}):U?e.jsx(Of,{onClose:()=>q(!1),onCreated:X}):e.jsx(Re,{isOpen:!0,onClose:s,children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Adicionar Viajantes"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:o==="groups"?"Passo 1: Defina os grupos/famlias":"Passo 2: Selecione os viajantes"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${o==="groups"?"bg-indigo-600 text-white":"bg-green-600 text-white"}`,children:"1"}),e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${o==="travelers"?"bg-indigo-600 text-white":"bg-gray-800 text-gray-500"}`,children:"2"})]})]}),Q&&e.jsx("div",{className:"p-3 bg-red-600/10 border border-red-500/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-400",children:Q})}),o==="groups"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-blue-600/10 border border-blue-600/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-300",children:[" ",e.jsx("strong",{children:"Grupos/Famlias"}),' so usados para organizar a diviso de despesas. Crie grupos para famlias, casais ou deixe viajantes como "Solo".']})}),e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-3",children:"Criar Novo Grupo"}),H?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:R,onChange:M=>E(M.target.value),placeholder:"Ex: Famlia Silva, Casal Santos",autoFocus:!0,onKeyDown:async M=>{M.key==="Enter"&&R.trim()?await F():M.key==="Escape"&&(K(!1),E(""))},className:"flex-1 px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none"}),e.jsx(V,{onClick:F,disabled:!R.trim()||ie,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50",children:ie?"...":""}),e.jsx(V,{onClick:()=>{K(!1),E("")},className:"bg-gray-800 hover:bg-gray-700",children:""})]}):e.jsx(V,{onClick:()=>K(!0),className:"w-full bg-indigo-600 hover:bg-indigo-700",children:"+ Adicionar Grupo/Famlia"})]}),N.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400",children:"Grupos Criados"}),e.jsx("div",{className:"space-y-2",children:N.map(M=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-600/10 border border-indigo-600/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600/20 flex items-center justify-center text-indigo-400 font-bold",children:""}),e.jsx("span",{className:"font-bold text-white",children:M.name})]}),e.jsx("button",{onClick:()=>Y(M.id),className:"text-red-400 hover:text-red-300 text-sm",children:""})]},M.id))})]}),N.length===0&&!H&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-sm",children:"Nenhum grupo criado ainda."}),e.jsx("p",{className:"text-xs mt-1",children:"Crie grupos para organizar famlias/casais ou pule para adicionar viajantes solo."})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{onClick:s,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:()=>c("travelers"),className:"flex-1 bg-indigo-600 hover:bg-indigo-700",children:"Prximo: Adicionar Viajantes "})]})]}),o==="travelers"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx(V,{onClick:()=>c("groups"),className:"text-sm bg-gray-800 hover:bg-gray-700",children:" Voltar para Grupos"})}),e.jsx(V,{onClick:()=>q(!0),className:"bg-green-600 hover:bg-green-700 text-sm",children:"+ Criar Novo Perfil"})]}),e.jsx(ee,{placeholder:"Buscar por nome, apelido ou telefone...",value:_,onChange:M=>k(M.target.value)}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:A.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:g.size===u.length?e.jsx("p",{children:"Todos os perfis j esto vinculados a esta viagem"}):e.jsx("p",{children:"Nenhum perfil encontrado"})}):A.map(M=>{var z;const b=x.has(M.id),B=x.get(M.id);return e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${b?"border-indigo-600 bg-indigo-600/10":"border-gray-800 bg-gray-900 hover:border-gray-700"}`,children:[e.jsxs("div",{onClick:()=>P(M.id),className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold ${M.type==="Adulto"?"bg-indigo-600/20 text-indigo-400":"bg-yellow-600/20 text-yellow-400"}`,children:((z=M.full_name)==null?void 0:z.charAt(0))||"?"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:M.full_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[M.type,M.nickname&&`  ${M.nickname}`,M.phone&&`  ${M.phone}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[M.can_drive&&e.jsx(ge,{color:"green",children:"Dirige"}),b&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-600 flex items-center justify-center text-white",children:""})]})]}),b&&B&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-800 space-y-3",onClick:oe=>oe.stopPropagation(),children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Grupo / Famlia:"}),e.jsxs("select",{value:B.coupleId,onChange:oe=>ae(M.id,oe.target.value),className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white text-sm focus:outline-none focus:border-indigo-500",children:[e.jsx("option",{value:"solo",children:" Solo (sem grupo)"}),N.map(oe=>e.jsxs("option",{value:oe.id,children:[" ",oe.name]},oe.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Participa de quais destinos?"}),e.jsx("div",{className:"space-y-1",children:r.segments.map(oe=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-2 hover:bg-gray-800 rounded",children:[e.jsx("input",{type:"checkbox",checked:B.segments.includes(oe.id),onChange:()=>ue(M.id,oe.id),className:"w-4 h-4 rounded border-gray-700 bg-gray-900 text-indigo-600 focus:ring-indigo-600 focus:ring-offset-gray-950"}),e.jsx("span",{className:"text-sm text-gray-300",children:oe.name}),oe.startDate&&oe.endDate&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",Hs(oe.startDate)," - ",Hs(oe.endDate),")"]})]},oe.id))}),B.segments.length===0&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:" Selecione pelo menos um destino"})]})]})]},M.id)})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-800",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[x.size," ",x.size===1?"perfil selecionado":"perfis selecionados"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{onClick:s,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:L,className:"bg-indigo-600 hover:bg-indigo-700",disabled:x.size===0||v,children:v?"Vinculando...":`Adicionar ${x.size>0?`(${x.size})`:""}`})]})]})]})]})})},xb=({trip:r,tripTraveler:s,onClose:l,onSaved:o,onUnlink:c})=>{var w,v;const u=s.profile,[m,g]=D.useState({coupleId:s.couple_id||((w=r.couples[0])==null?void 0:w.id),goesToSegments:s.goes_to_segments||[],isPayer:s.is_payer!==void 0?s.is_payer:!0,canDriveThisTrip:s.can_drive_this_trip||!1,customNotes:s.custom_notes||""}),[f,x]=D.useState(!1),[y,_]=D.useState(!1),k=async()=>{x(!0);try{await he.updateTripTraveler(s.id,m),o(),l()}catch(j){console.error("Erro ao salvar configuraes:",j)}finally{x(!1)}},S=j=>{const U=m.goesToSegments.includes(j)?m.goesToSegments.filter(q=>q!==j):[...m.goesToSegments,j];g({...m,goesToSegments:U})};return y?e.jsx(Re,{isOpen:!0,onClose:()=>_(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Confirmar Desvinculao"}),e.jsxs("p",{className:"text-gray-400 mb-6",children:["Tem certeza que deseja desvincular ",e.jsx("strong",{children:u==null?void 0:u.full_name})," desta viagem? O perfil global ser mantido."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(V,{onClick:()=>_(!1),className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:()=>{_(!1),c()},className:"bg-red-600 hover:bg-red-700",children:"Desvincular"})]})]})}):e.jsx(Re,{isOpen:!0,onClose:l,children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Configuraes desta Viagem"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Ajuste como ",e.jsx("strong",{children:u==null?void 0:u.full_name})," participa de ",e.jsx("strong",{children:r.name})]}),e.jsx("p",{className:"text-xs text-amber-500 mt-2",children:' Para editar dados pessoais ou documentos, clique em "Ver Perfil" na lista'})]}),e.jsx("div",{className:"p-3 bg-gray-900 rounded-lg border border-gray-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold ${(u==null?void 0:u.type)==="Adulto"?"bg-indigo-600/20 text-indigo-400":"bg-yellow-600/20 text-yellow-400"}`,children:((v=u==null?void 0:u.full_name)==null?void 0:v.charAt(0))||"?"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:u==null?void 0:u.full_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[u==null?void 0:u.type,(u==null?void 0:u.nickname)&&`  ${u==null?void 0:u.nickname}`]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Grupo"}),e.jsx(ee,{as:"select",value:m.coupleId,onChange:j=>g({...m,coupleId:j.target.value}),children:r.couples.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Participa dos Segmentos"}),e.jsx("div",{className:"space-y-2",children:r.segments.map(j=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.goesToSegments.includes(j.id),onChange:()=>S(j.id),className:"w-4 h-4"}),e.jsx("label",{className:"text-sm text-gray-300",children:j.name})]},j.id))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.isPayer,onChange:j=>g({...m,isPayer:j.target.checked}),className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-bold text-gray-300",children:" pagante (divide despesas)"})]}),(u==null?void 0:u.type)==="Adulto"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:m.canDriveThisTrip,onChange:j=>g({...m,canDriveThisTrip:j.target.checked}),className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-bold text-gray-300",children:"Pode dirigir nesta viagem"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Notas desta Viagem"}),e.jsx("textarea",{value:m.customNotes,onChange:j=>g({...m,customNotes:j.target.value}),placeholder:"Observaes especficas para esta viagem...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-2 text-white",rows:3})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-800",children:[e.jsx(V,{onClick:()=>_(!0),className:"bg-red-600/20 hover:bg-red-600/30 text-red-400",children:"Desvincular"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{onClick:l,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:k,className:"bg-indigo-600 hover:bg-indigo-700",disabled:f,children:f?"Salvando...":"Salvar"})]})]})]})})},pb=({trip:r,onRefresh:s,onNavigateToDetail:l})=>{const[o,c]=D.useState([]),[u,m]=D.useState(!1),[g,f]=D.useState(!1),[x,y]=D.useState(!1),[_,k]=D.useState(!1),[S,w]=D.useState(!1),[v,j]=D.useState(null),[U,q]=D.useState(null),[Q,C]=D.useState(""),[N,O]=D.useState("all"),[R,E]=D.useState("all"),[H,K]=D.useState(null);D.useEffect(()=>{ie()},[r.id]);const ie=async()=>{try{const P=await he.getTripTravelers(r.id);c(P)}catch(P){console.error("Erro ao carregar viajantes:",P)}},de=async P=>{try{await he.unlinkTravelerFromTrip(P),j(null),await ie(),s(),K("Viajante desvinculado com sucesso!"),setTimeout(()=>K(null),3e3)}catch(ae){console.error("Erro ao desvincular viajante:",ae)}},xe=async P=>{var ae;try{await he.linkTravelerToTrip(r.id,P,{coupleId:(ae=r.couples[0])==null?void 0:ae.id,goesToSegments:r.segments.map(ue=>ue.id),isPayer:!0}),w(!1),await ie(),s(),K("Perfil criado e vinculado com sucesso!"),setTimeout(()=>K(null),3e3)}catch(ue){console.error("Erro ao vincular novo perfil:",ue)}},F=D.useMemo(()=>{const P=Q.toLowerCase();return o.filter(ae=>{const ue=ae.profile;if(!ue)return!1;const L=ue.full_name||"",X=ue.nickname||"",A=ue.phone||"",M=r.couples.find(fe=>fe.id===ae.couple_id),b=(M==null?void 0:M.name)||"",B=L.toLowerCase().includes(P)||A.includes(Q)||X.toLowerCase().includes(P)||b.toLowerCase().includes(P),z=N==="all"||ue.type===N,oe=R==="all"||ae.couple_id===R;return B&&z&&oe})},[o,Q,N,R,r.couples]),Y=D.useMemo(()=>{const P={};return F.forEach(ae=>{const ue=ae.couple_id||"sem-grupo";P[ue]||(P[ue]=[]),P[ue].push(ae)}),Object.keys(P).forEach(ae=>{P[ae].sort((ue,L)=>{var M,b,B,z;const X=((M=ue.profile)==null?void 0:M.type)||"",A=((b=L.profile)==null?void 0:b.type)||"";return X==="Adulto"&&A!=="Adulto"?-1:X!=="Adulto"&&A==="Adulto"?1:(((B=ue.profile)==null?void 0:B.full_name)||"").localeCompare(((z=L.profile)==null?void 0:z.full_name)||"")})}),P},[F]);return e.jsxs("div",{className:"flex flex-col h-full gap-8 animate-in fade-in duration-500",children:[H&&e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg animate-in slide-in-from-top-2 duration-300",children:e.jsxs("p",{className:"text-sm font-bold",children:[" ",H]})}),e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter",children:"Viajantes"}),e.jsx("p",{className:"text-gray-500",children:"Gesto de participantes e documentos"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"outline",onClick:()=>k(!0),children:" Adicionar da Lista"}),e.jsx(V,{variant:"outline",onClick:()=>w(!0),children:" Criar Rpido"}),e.jsx(V,{variant:"primary",onClick:()=>f(!0),children:" Novo Completo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 bg-gray-900/40 p-4 rounded-2xl border border-gray-800",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx(ee,{placeholder:"Buscar por nome, fone, grupo...",value:Q,onChange:P=>C(P.target.value)})}),e.jsxs(ee,{as:"select",value:N,onChange:P=>O(P.target.value),children:[e.jsx("option",{value:"all",children:"Todos os tipos"}),Object.values(St).map(P=>e.jsx("option",{value:P,children:P},P))]}),e.jsxs(ee,{as:"select",value:R,onChange:P=>E(P.target.value),children:[e.jsx("option",{value:"all",children:"Todos os grupos"}),r.couples.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))]}),e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsxs(ge,{color:"indigo",children:[o.length," Total"]}),e.jsxs(ge,{color:"gray",children:[o.filter(P=>{var ae;return((ae=P.profile)==null?void 0:ae.type)===St.ADULT}).length," ADU"]})]})]}),e.jsxs("div",{className:"space-y-6",children:[Object.entries(Y).map(([P,ae])=>{const ue=r.couples.find(X=>X.id===P),L=(ue==null?void 0:ue.name)||"Sem Grupo";return e.jsxs("div",{className:"bg-gray-900/40 rounded-2xl border border-gray-800 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-3 bg-gray-900/60 border-b border-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-wide",children:L}),e.jsxs(ge,{color:"gray",children:[ae.length," ",ae.length===1?"viajante":"viajantes"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"text-[10px] font-black uppercase text-gray-500 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Nome / Tipo"}),e.jsx("th",{className:"p-4",children:"Segmentos"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4 text-center",children:"Aes"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:ae.map(X=>{const A=X.profile;if(!A)return null;const M=A.full_name||"Sem Nome";return e.jsxs("tr",{onClick:()=>j(X),className:"hover:bg-gray-900/40 transition-colors cursor-pointer",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs ${A.type===St.ADULT?"bg-indigo-600/20 text-indigo-400":"bg-yellow-600/20 text-yellow-400"}`,children:M.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-200",children:M}),e.jsxs("p",{className:"text-[10px] text-gray-500 uppercase",children:[A.type," ",A.nickname?` ${A.nickname}`:""]})]})]})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(X.goes_to_segments||[]).map(b=>{const B=r.segments.find(z=>z.id===b);return e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 bg-gray-800 text-gray-500 rounded uppercase font-bold",children:B==null?void 0:B.name},b)})})}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{color:X.is_payer?"green":"gray",children:X.is_payer?"Pagante":"No pagante"})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(V,{onClick:b=>{b.stopPropagation(),l(A.id)},className:"bg-emerald-600/20 hover:bg-emerald-600/30 text-emerald-400 text-xs",children:"Ver Perfil"}),e.jsx(V,{onClick:b=>{b.stopPropagation(),j(X)},className:"bg-indigo-600/20 hover:bg-indigo-600/30 text-indigo-400 text-xs",children:"Configurar"})]})})]},X.id)})})]})})]},P)}),Object.keys(Y).length===0&&e.jsx("div",{className:"py-20 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-white uppercase tracking-tight mb-2",children:"Nenhum viajante vinculado"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Perfis de viajantes so globais e reutilizveis. Vincule perfis existentes ou crie novos."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx(V,{onClick:()=>k(!0),className:"bg-indigo-600 hover:bg-indigo-700",children:" Adicionar da minha lista"}),e.jsx(V,{onClick:()=>w(!0),className:"bg-green-600 hover:bg-green-700",children:" Criar novo agora"})]})]})})]})]}),_&&e.jsx(Rf,{trip:r,onClose:()=>k(!1),onLinked:async()=>{await ie(),s(),K("Viajantes vinculados com sucesso!"),setTimeout(()=>K(null),3e3)}}),v&&e.jsx(xb,{trip:r,tripTraveler:v,onClose:()=>j(null),onSaved:async()=>{await ie(),s(),K("Configuraes salvas com sucesso!"),setTimeout(()=>K(null),3e3)},onUnlink:()=>de(v.id)}),S&&e.jsx(Of,{onClose:()=>w(!1),onCreated:xe}),g&&e.jsx(Re,{isOpen:!0,onClose:()=>f(!1),title:"Novo Viajante Completo",size:"xl",children:e.jsx(Oi,{tripId:r.id,trip:r,onDone:async P=>{await ie(),s(),f(!1),K("Perfil criado com sucesso!"),setTimeout(()=>K(null),3e3)},onCancel:()=>f(!1)})})]})},yb={Passaporte:"",RG:"",CPF:"",CNH:"",Visto:"",ESTA:"",Outro:""},yi=(r,s)=>{if(!r)return"";const l=r.replace(/[^A-Za-z0-9]/g,"");switch(s){case"CPF":return l.slice(0,11).replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{3})(\d{1})$/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{2})$/,"$1.$2.$3").replace(/(\d{3})(\d{2})$/,"$1.$2");case"RG":return l.slice(0,9).replace(/(\d{2})(\d{3})(\d{3})(\d{1})/,"$1.$2.$3-$4").replace(/(\d{2})(\d{3})(\d{3})$/,"$1.$2.$3").replace(/(\d{2})(\d{3})$/,"$1.$2");case"CNH":return l.slice(0,11);case"Passaporte":return l.slice(0,8).toUpperCase();default:return r}},Lf=({document:r,passports:s,onClose:l,onSave:o,onDelete:c,onUpdateNumber:u,isNewDocument:m=!1})=>{const[g,f]=D.useState(m),[x,y]=D.useState(!1),[_,k]=D.useState(!1),[S,w]=D.useState(""),[v,j]=D.useState(!0),[U,q]=D.useState(m),[Q,C]=D.useState(!1),[N,O]=D.useState(r);D.useEffect(()=>{O(r),f(m),q(m)},[r,m]);const R=(Y,P)=>{O({...N,[Y]:P}),q(!0)},E=async()=>{await o(N),f(!1),q(!1)},H=()=>{if(U){C(!0);return}O(r),f(!1),q(!1)},K=()=>{O(r),f(!1),q(!1),C(!1)},ie=()=>{if(U){C(!0);return}l()},de=()=>{C(!1),l()},xe=async()=>{S.trim()&&(await u(r.id,S),y(!1),w(""))},F=async()=>{await c(r.id),l()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:ie,children:e.jsxs("div",{className:"bg-gray-900 border border-gray-800 w-full max-w-3xl rounded-2xl shadow-2xl animate-in zoom-in-95 duration-200 max-h-[90vh] flex flex-col",onClick:Y=>Y.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-800 bg-gray-900/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-3xl",children:yb[N.docType]||""}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:N.docType}),e.jsx("p",{className:"text-xs text-gray-500",children:m?"Novo documento":g?"Modo de edio":"Visualizao"})]})]}),e.jsx("button",{onClick:ie,className:"text-gray-500 hover:text-white transition-colors p-1 hover:bg-gray-800 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[Q&&e.jsxs("div",{className:"p-4 bg-amber-600/10 rounded-xl border border-amber-600/20 space-y-3 animate-in slide-in-from-top-2",children:[e.jsx("p",{className:"text-sm text-amber-400 font-bold",children:" Voc tem alteraes no salvas. Deseja descartar?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",className:"flex-1 bg-amber-600/20 text-amber-400 hover:bg-amber-600/30",onClick:g?K:de,children:"Descartar alteraes"}),e.jsx(V,{variant:"ghost",onClick:()=>C(!1),children:"Continuar editando"})]})]}),e.jsxs("div",{className:"p-5 bg-gray-950 rounded-xl border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-xs font-black text-gray-500 uppercase",children:"Nmero do Documento"}),!m&&!x&&N.docNumber&&!g&&e.jsx("button",{onClick:()=>y(!0),className:"text-xs text-indigo-400 hover:text-indigo-300 font-bold px-3 py-1 hover:bg-indigo-600/10 rounded-lg transition-all",children:"Atualizar nmero"})]}),m&&g||x?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:v?"text":"password",value:v?yi(m?N.docNumber:S,N.docType):m?N.docNumber:S,onChange:Y=>{const P=Y.target.value.replace(/[^A-Za-z0-9]/g,"");m?R("docNumber",P):w(P)},placeholder:"Digite o nmero do documento",className:"flex-1 px-4 py-3 bg-gray-900 border border-gray-700 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all",autoFocus:m}),e.jsx("button",{onClick:()=>j(!v),className:"px-4 text-gray-500 hover:text-gray-300 hover:bg-gray-800 rounded-xl transition-all",children:v?"":""})]}),!m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"primary",onClick:xe,disabled:!S.trim(),className:"flex-1",children:"Confirmar atualizao"}),e.jsx(V,{variant:"ghost",onClick:()=>{y(!1),w("")},children:"Cancelar"})]}),e.jsxs("p",{className:"text-xs text-amber-500 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"O nmero ser criptografado e substituir o atual"})]})]})]}):e.jsx("p",{className:"text-2xl font-black tracking-widest text-white font-mono",children:yi(N.docNumber,N.docType)||"(no informado)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N.docType==="Passaporte"&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{label:"Pas Emissor",value:N.issuerCountry||"",onChange:Y=>R("issuerCountry",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Local de Emisso",value:N.issuerPlace||"",onChange:Y=>R("issuerPlace",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Data de Emisso",type:"date",value:mt(N.issueDate)||"",onChange:Y=>R("issueDate",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Vencimento",type:"date",value:mt(N.expiryDate)||"",onChange:Y=>R("expiryDate",Y.target.value),disabled:!g}),e.jsx("div",{className:"p-4 bg-gray-950 rounded-xl border border-gray-800",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:N.isPrimary||!1,onChange:Y=>R("isPrimary",Y.target.checked),disabled:!g,className:"w-5 h-5 accent-indigo-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white",children:"Passaporte Principal"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Usado como referncia para vistos"})]})]})})]}),N.docType==="RG"&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{label:"Estado Emissor",value:N.issuerState||"",onChange:Y=>R("issuerState",Y.target.value),disabled:!g}),e.jsx(ee,{label:"rgo Emissor",value:N.issuerAgency||"",onChange:Y=>R("issuerAgency",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Data de Emisso",type:"date",value:mt(N.issueDate)||"",onChange:Y=>R("issueDate",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Vencimento",type:"date",value:mt(N.expiryDate)||"",onChange:Y=>R("expiryDate",Y.target.value),disabled:!g})]}),N.docType==="CNH"&&e.jsxs(e.Fragment,{children:[e.jsxs(ee,{as:"select",label:"Categoria",value:N.licenseCategory||"",onChange:Y=>R("licenseCategory",Y.target.value),disabled:!g,children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"A",children:"A - Moto"}),e.jsx("option",{value:"B",children:"B - Carro"}),e.jsx("option",{value:"AB",children:"AB - Moto e Carro"}),e.jsx("option",{value:"C",children:"C - Caminho"}),e.jsx("option",{value:"D",children:"D - nibus"}),e.jsx("option",{value:"E",children:"E - Carreta"})]}),e.jsx(ee,{label:"UF Emissora",value:N.issuerState||"",onChange:Y=>R("issuerState",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Data de Emisso",type:"date",value:mt(N.issueDate)||"",onChange:Y=>R("issueDate",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Vencimento",type:"date",value:mt(N.expiryDate)||"",onChange:Y=>R("expiryDate",Y.target.value),disabled:!g})]}),N.docType==="Visto"&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{label:"Pas/Regio",value:N.regionOrCountry||"",onChange:Y=>R("regionOrCountry",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Categoria",value:N.visaCategory||"",onChange:Y=>R("visaCategory",Y.target.value),disabled:!g,placeholder:"Ex: B1/B2, Turismo"}),e.jsxs(ee,{as:"select",label:"Tipo de Entrada",value:N.entryType||"",onChange:Y=>R("entryType",Y.target.value),disabled:!g,children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"single",children:"Entrada nica"}),e.jsx("option",{value:"multiple",children:"Mltiplas Entradas"})]}),e.jsx(ee,{label:"Durao (dias)",type:"number",value:N.stayDurationDays||"",onChange:Y=>R("stayDurationDays",parseInt(Y.target.value)||null),disabled:!g}),e.jsxs(ee,{as:"select",label:"Vinculado ao Passaporte",value:N.passportDocumentId||"",onChange:Y=>R("passportDocumentId",Y.target.value||null),disabled:!g,children:[e.jsx("option",{value:"",children:"Nenhum"}),s.map(Y=>e.jsxs("option",{value:Y.id,children:[yi(Y.docNumber,"Passaporte")," - ",Y.issuerCountry]},Y.id))]}),e.jsx(ee,{label:"Vencimento",type:"date",value:mt(N.expiryDate)||"",onChange:Y=>R("expiryDate",Y.target.value),disabled:!g})]}),N.docType==="ESTA"&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{label:"Pas/Regio",value:N.regionOrCountry||"",onChange:Y=>R("regionOrCountry",Y.target.value),disabled:!g}),e.jsxs(ee,{as:"select",label:"Vinculado ao Passaporte",value:N.passportDocumentId||"",onChange:Y=>R("passportDocumentId",Y.target.value||null),disabled:!g,children:[e.jsx("option",{value:"",children:"Nenhum"}),s.map(Y=>e.jsxs("option",{value:Y.id,children:[yi(Y.docNumber,"Passaporte")," - ",Y.issuerCountry]},Y.id))]}),e.jsx(ee,{label:"Vencimento",type:"date",value:mt(N.expiryDate)||"",onChange:Y=>R("expiryDate",Y.target.value),disabled:!g})]}),N.docType==="Outro"&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{label:"Nome do Documento",value:N.customLabel||"",onChange:Y=>R("customLabel",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Pas/Estado Emissor",value:N.issuerCountry||N.issuerState||"",onChange:Y=>R("issuerCountry",Y.target.value),disabled:!g}),e.jsx(ee,{label:"Vencimento",type:"date",value:mt(N.expiryDate)||"",onChange:Y=>R("expiryDate",Y.target.value),disabled:!g})]}),e.jsx(ee,{as:"textarea",label:"Observaes",rows:3,value:N.notes||"",onChange:Y=>R("notes",Y.target.value),disabled:!g,placeholder:"Detalhes adicionais sobre o documento"})]}),!m&&e.jsx(e.Fragment,{children:_?e.jsxs("div",{className:"p-4 bg-red-600/10 rounded-xl border border-red-600/20 space-y-3 animate-in slide-in-from-top-2",children:[e.jsx("p",{className:"text-sm text-red-400 font-bold",children:" Tem certeza que deseja excluir este documento?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",className:"flex-1 bg-red-600/20 text-red-400 hover:bg-red-600/30",onClick:F,children:"Confirmar excluso"}),e.jsx(V,{variant:"ghost",onClick:()=>k(!1),children:"Cancelar"})]})]}):e.jsx("button",{onClick:()=>k(!0),className:"w-full p-3 text-red-400 hover:bg-red-600/10 rounded-xl border border-red-600/20 transition-colors text-sm font-bold",children:" Excluir documento"})})]}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-800 bg-gray-900/50 flex gap-3",children:g?e.jsxs(e.Fragment,{children:[e.jsx(V,{variant:"primary",className:"flex-1",onClick:E,disabled:!U,children:m?" Cadastrar documento":" Salvar alteraes"}),e.jsx(V,{variant:"ghost",onClick:H,children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{variant:"primary",className:"flex-1",onClick:()=>f(!0),children:" Editar"}),e.jsx(V,{variant:"ghost",onClick:ie,children:"Fechar"})]})})]})})},vb={Passaporte:"",RG:"",CPF:"",CNH:"",Visto:"",ESTA:"",Outro:""},bb=(r,s)=>{if(!r)return"";const l=r.replace(/[^A-Za-z0-9]/g,"");switch(s){case"CPF":return l.slice(0,11).replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{3})(\d{1})$/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{2})$/,"$1.$2.$3").replace(/(\d{3})(\d{2})$/,"$1.$2");case"RG":return l.slice(0,9).replace(/(\d{2})(\d{3})(\d{3})(\d{1})/,"$1.$2.$3-$4").replace(/(\d{2})(\d{3})(\d{3})$/,"$1.$2.$3").replace(/(\d{2})(\d{3})$/,"$1.$2");case"CNH":return l.slice(0,11);case"Passaporte":return l.slice(0,8).toUpperCase();default:return r}},jb=({trip:r,travelerId:s,onBack:l,onRefresh:o})=>{const[c,u]=D.useState(null),[m,g]=D.useState([]),[f,x]=D.useState(!0),[y,_]=D.useState(!1),[k,S]=D.useState(null),[w,v]=D.useState(!1),[j,U]=D.useState(!1),[q,Q]=D.useState(!1),[C,N]=D.useState(null),[O,R]=D.useState("all"),[E,H]=D.useState("all"),[K,ie]=D.useState("");D.useEffect(()=>{de()},[s]);const de=async()=>{x(!0);try{const B=(await Oe.getTravelers(r.id)).find(z=>z.id===s);if(B){u(B);const z=await Oe.getTravelerDocuments(B.id);g(z)}else console.error(" Viajante no encontrado com ID:",s)}catch(b){console.error(" Erro ao carregar viajante:",b)}x(!1)},xe=async()=>{c&&(await Oe.deleteTraveler(c.id),o(),l())},F=async b=>{try{const B={id:b.id,travelerId:b.travelerId||(c==null?void 0:c.id),docType:b.docType,docCategory:b.docCategory,docNumber:b.docNumber||"",issuerCountry:b.issuerCountry||"",issuerState:b.issuerState||"",issuerAgency:b.issuerAgency||"",issuerPlace:b.issuerPlace||"",regionOrCountry:b.regionOrCountry||"",issueDate:b.issueDate||"",docExpiry:b.expiryDate||b.docExpiry||"",visaCategory:b.visaCategory||"",entryType:b.entryType||"",stayDurationDays:b.stayDurationDays||null,licenseCategory:b.licenseCategory||"",customLabel:b.customLabel||"",passportDocumentId:b.passportDocumentId||null,isPrimary:b.isPrimary||!1,notes:b.notes||""};await Oe.saveTravelerDocument(B),await de(),N("Documento salvo com sucesso!"),setTimeout(()=>N(null),3e3),S(null),v(!1)}catch(B){alert("Erro ao salvar documento: "+B.message)}},Y=async b=>{try{await Oe.deleteTravelerDocument(b),await de(),N("Documento excludo com sucesso!"),setTimeout(()=>N(null),3e3)}catch(B){alert("Erro ao excluir documento: "+B.message)}},P=async(b,B)=>{try{const z=m.find(oe=>oe.id===b);if(!z)return;await Oe.saveTravelerDocument({...z,id:b,docNumber:B}),await de(),N("Nmero do documento atualizado com sucesso!"),setTimeout(()=>N(null),3e3)}catch(z){alert("Erro ao atualizar nmero: "+z.message)}},ae=()=>{U(!0)},ue=b=>{U(!1),v(!0);const B={travelerId:c==null?void 0:c.id,docType:b,docCategory:b==="Visto"||b==="ESTA"?"entry":"identity",docNumber:"",notes:"",issuerCountry:"",issuerState:"",issuerAgency:"",issuerPlace:"",regionOrCountry:"",issueDate:"",expiryDate:"",visaCategory:"",entryType:"",stayDurationDays:null,licenseCategory:"",customLabel:"",passportDocumentId:null,isPrimary:!1};S(B)};if(f||!c)return f?e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 animate-pulse",children:"Carregando viajante..."})}):e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-400 mb-4",children:" Viajante no encontrado"}),e.jsx(V,{variant:"outline",onClick:l,children:" Voltar para lista"})]})});const L=m.filter(b=>{var fe,Ce,Ne,Pe;const B=O==="all"||b.docCategory===O,z=E==="all"||b.docType===E,oe=!K||((fe=b.docNumber)==null?void 0:fe.toLowerCase().includes(K.toLowerCase()))||((Ce=b.issuerCountry)==null?void 0:Ce.toLowerCase().includes(K.toLowerCase()))||((Ne=b.issuerState)==null?void 0:Ne.toLowerCase().includes(K.toLowerCase()))||((Pe=b.customLabel)==null?void 0:Pe.toLowerCase().includes(K.toLowerCase()));return B&&z&&oe}),X={passports:L.filter(b=>b.docType==="Passaporte"),identity:L.filter(b=>["RG","CPF","CNH"].includes(b.docType)),entry:L.filter(b=>["Visto","ESTA"].includes(b.docType)),others:L.filter(b=>b.docType==="Outro")},A=Oe.computeTravelerIssues(c,r),M=r.couples.find(b=>b.id===c.coupleId);return e.jsxs("div",{className:"min-h-screen bg-gray-950",children:[C&&e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg animate-in slide-in-from-top-2 duration-300",children:e.jsxs("p",{className:"text-sm font-bold",children:[" ",C]})}),e.jsx("div",{className:"bg-gray-900/50 border-b border-gray-800 px-8 py-6",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto",children:[e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-500 hover:text-white transition-colors mb-4",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Viajantes"})]}),e.jsxs("div",{className:"flex items-start justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("h1",{className:"text-3xl font-black text-white tracking-tight",children:c.fullName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{color:"indigo",className:"text-[10px] px-2 py-0.5",children:c.type}),M&&e.jsx(ge,{color:"gray",className:"text-[10px] px-2 py-0.5",children:M.name}),c.isPayer&&e.jsx(ge,{color:"green",className:"text-[10px] px-2 py-0.5",children:"PAGANTE"}),c.canDrive&&e.jsx(ge,{color:"blue",className:"text-[10px] px-2 py-0.5",children:"DIRIGE"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[c.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:""}),e.jsx("span",{children:Ei(c.phone)})]}),c.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:""}),e.jsx("span",{className:"truncate max-w-xs",children:c.email})]}),!c.phone&&!c.email&&e.jsx("span",{className:"text-gray-600 italic text-xs",children:"Sem informaes de contato"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",size:"sm",onClick:()=>_(!0),children:" Editar"}),e.jsx(V,{variant:"primary",size:"sm",onClick:ae,children:"+ Documento"}),e.jsx("div",{className:"relative",children:q?e.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-gray-900 border border-gray-800 rounded-xl shadow-xl p-3 w-64 z-10 animate-in slide-in-from-top-2",children:[e.jsx("p",{className:"text-xs text-red-400 font-bold mb-3",children:" Confirmar excluso?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",className:"flex-1 bg-red-600/20 text-red-400 hover:bg-red-600/30 text-xs",onClick:xe,children:"Excluir"}),e.jsx(V,{variant:"ghost",className:"text-xs",onClick:()=>Q(!1),children:"Cancelar"})]})]}):e.jsx("button",{onClick:()=>Q(!0),className:"px-3 py-2 text-gray-500 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]})]})]})}),e.jsxs("div",{className:"max-w-[1600px] mx-auto px-8 py-6",children:[A.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-amber-600/10 rounded-xl border border-amber-600/20",children:[e.jsxs("p",{className:"text-xs font-black text-amber-500 uppercase mb-3",children:[" ",A.length," Pendncia",A.length>1?"s":""]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:A.map((b,B)=>e.jsxs("p",{className:"text-xs text-amber-400 leading-tight",children:[" ",b.message]},B))})]}),e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-5",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-black text-white uppercase mb-3",children:"Documentos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsxs(ee,{as:"select",value:O,onChange:b=>R(b.target.value),className:"text-xs",children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),e.jsx("option",{value:"identity",children:"Identidade"}),e.jsx("option",{value:"entry",children:"Entrada no Pas"})]}),e.jsxs(ee,{as:"select",value:E,onChange:b=>H(b.target.value),className:"text-xs",children:[e.jsx("option",{value:"all",children:"Todos os Tipos"}),e.jsx("option",{value:"Passaporte",children:"Passaporte"}),e.jsx("option",{value:"RG",children:"RG"}),e.jsx("option",{value:"CPF",children:"CPF"}),e.jsx("option",{value:"CNH",children:"CNH"}),e.jsx("option",{value:"Visto",children:"Visto"}),e.jsx("option",{value:"ESTA",children:"ESTA/ETA"}),e.jsx("option",{value:"Outro",children:"Outros"})]}),e.jsx(ee,{placeholder:"Buscar...",value:K,onChange:b=>ie(b.target.value),className:"text-xs"})]})]}),L.length===0?e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 italic mb-3",children:"Nenhum documento encontrado"}),e.jsx(V,{variant:"outline",size:"sm",onClick:ae,children:"+ Adicionar primeiro documento"})]}):e.jsxs("div",{className:"space-y-4",children:[X.passports.length>0&&e.jsx(vi,{title:" Passaportes",count:X.passports.length,documents:X.passports,onEdit:b=>{S(b),v(!1)}}),X.identity.length>0&&e.jsx(vi,{title:" Identidade",count:X.identity.length,documents:X.identity,onEdit:b=>{S(b),v(!1)}}),X.entry.length>0&&e.jsx(vi,{title:" Entrada no Pas",count:X.entry.length,documents:X.entry,onEdit:b=>{S(b),v(!1)}}),X.others.length>0&&e.jsx(vi,{title:" Outros",count:X.others.length,documents:X.others,onEdit:b=>{S(b),v(!1)}})]})]})]}),e.jsx(Re,{isOpen:y,onClose:()=>_(!1),title:"Editar Viajante",size:"xl",children:e.jsx(Oi,{trip:r,initialData:c,onCancel:()=>_(!1),onSave:async b=>{if(await Oe.saveTraveler(b),b.documents&&b.documents.length>0)for(const B of b.documents)await Oe.saveTravelerDocument({...B,travelerId:b.id});_(!1),await de(),o()}})}),e.jsx(Re,{isOpen:j,onClose:()=>U(!1),title:"Selecione o tipo de documento",size:"lg",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[{type:"Passaporte",icon:"",desc:"Documento internacional",color:"indigo"},{type:"RG",icon:"",desc:"Registro Geral",color:"blue"},{type:"CPF",icon:"",desc:"Cadastro de Pessoa Fsica",color:"green"},{type:"CNH",icon:"",desc:"Carteira de Habilitao",color:"purple"},{type:"Visto",icon:"",desc:"Autorizao de entrada",color:"yellow"},{type:"ESTA",icon:"",desc:"Autorizao eletrnica",color:"cyan"},{type:"Outro",icon:"",desc:"Documento customizado",color:"gray"}].map(({type:b,icon:B,desc:z,color:oe})=>e.jsxs("button",{onClick:()=>ue(b),className:"group relative p-6 bg-gray-950 hover:bg-gray-900 border border-gray-800 hover:border-indigo-500 rounded-xl transition-all text-left overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600/0 via-indigo-600/0 to-indigo-600/0 group-hover:from-indigo-600/5 group-hover:via-indigo-600/10 group-hover:to-indigo-600/5 transition-all duration-300"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-4xl mb-3 transform group-hover:scale-110 transition-transform duration-200",children:B}),e.jsx("p",{className:"font-black text-white text-lg mb-1",children:b}),e.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:z})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-indigo-600 to-purple-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300"})]},b))})}),k&&e.jsx(Lf,{document:k,passports:m.filter(b=>b.docType==="Passaporte"),onClose:()=>{S(null),v(!1)},onSave:F,onDelete:Y,onUpdateNumber:P,isNewDocument:w})]})},vi=({title:r,count:s,documents:l,onEdit:o})=>{const[c,u]=D.useState(!1),m=y=>{if(!y)return null;const _=new Date,k=new Date(y),S=Math.ceil((k.getTime()-_.getTime())/(1e3*60*60*24));return S<0?{color:"bg-red-600/20 text-red-400 border-red-600/30",textColor:"text-red-400",label:"Vencido"}:S<=30?{color:"bg-red-600/20 text-red-400 border-red-600/30",textColor:"text-red-400",label:`Vence em ${S}d`}:S<=90?{color:"bg-yellow-600/20 text-yellow-400 border-yellow-600/30",textColor:"text-yellow-400",label:`Vence em ${S}d`}:null},g=y=>y.issuerCountry||y.issuerState||y.regionOrCountry||"",f=y=>{if(y.docType==="Visto"&&y.visaCategory)return y.visaCategory;if(y.docType==="CNH"&&y.licenseCategory)return`Cat. ${y.licenseCategory}`;if(y.docType==="RG"&&(y.issuerAgency||y.issuerState)){const _=[];return y.issuerAgency&&_.push(y.issuerAgency),y.issuerState&&_.push(y.issuerState),_.join("/")}return y.docType==="Outro"&&y.customLabel?y.customLabel:y.docType==="Visto"&&y.entryType?y.entryType==="multiple"?"Mltiplas":"nica":null},x=l.filter(y=>m(y.expiryDate)!==null).length;return e.jsxs("div",{className:"border border-gray-800 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>u(!c),className:"w-full px-5 py-3 bg-gray-900/50 flex items-center justify-between hover:bg-gray-900 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-black text-gray-300 uppercase tracking-wide",children:r}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[s," ",s===1?"item":"itens"]}),x>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{className:"text-amber-400 font-bold",children:[x," ",x===1?"alerta":"alertas"]})]})]})]}),e.jsx("svg",{className:`w-4 h-4 text-gray-600 transition-transform duration-200 ${c?"":"rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!c&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900/30 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Emissor"}),e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Nmero"}),e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Validade"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:l.map(y=>{const _=m(y.expiryDate),k=g(y),S=f(y);return e.jsxs("tr",{onClick:()=>o(y),className:"hover:bg-gray-900/40 transition-colors cursor-pointer group",children:[e.jsx("td",{className:"px-5 py-3.5",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("span",{className:"text-xl",children:vb[y.docType]||""}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white",children:y.docType}),S&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:S}),y.isPrimary&&e.jsx("span",{className:"inline-block mt-1 text-[8px] px-1.5 py-0.5 bg-emerald-600/20 text-emerald-400 rounded uppercase font-bold border border-emerald-600/30",children:"Principal"})]})]})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("p",{className:"text-sm text-gray-300",children:k})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("p",{className:"text-sm font-mono text-white",children:bb(y.docNumber,y.docType)})}),e.jsx("td",{className:"px-5 py-3.5",children:y.expiryDate?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:`text-sm ${_?_.textColor:"text-gray-300"}`,children:Ai(y.expiryDate)}),_&&e.jsx("span",{className:`inline-block text-[10px] px-2 py-0.5 rounded uppercase font-bold border ${_.color}`,children:_.label})]}):e.jsx("p",{className:"text-sm text-gray-600 italic",children:"Sem validade"})})]},y.id)})})]})})]})},Nb=({trip:r,quote:s,onEdit:l,onBack:o,onRefresh:c,onNavigateToExpense:u,onNavigateToQuote:m})=>{var L,X,A,M;const[g,f]=D.useState("summary"),[x,y]=D.useState([]),[_,k]=D.useState(!1),[S,w]=D.useState(!1),[v,j]=D.useState(null),[U,q]=D.useState(!1),[Q,C]=D.useState({}),N=b=>b?b.replace(/[\u{1F300}-\u{1F9FF}]/gu,"").replace(/[\n\r]+/g," ").replace(/\s+/g," ").trim():"";D.useEffect(()=>{R(),O()},[s.id]);const O=()=>{const b={};if(!s.participantIds||s.participantIds.length===0||s.participantIds.includes("ALL")){C({});return}r.couples.forEach(B=>{var z;(z=s.participantIds)!=null&&z.includes(B.id)&&(b[B.id]=B.members.map(oe=>oe.id))}),C(b)},R=async()=>{const b=await Oe.getQuotes(r.id);y(b.filter(B=>B.originalId===(s.originalId||s.id)&&B.id!==s.id)),s.originalId?j(b.find(B=>B.id===s.originalId)||null):j(null)},E=async b=>{b.preventDefault();const B=new FormData(b.currentTarget),z={...s,totalAmount:Number(B.get("totalAmount")),exchangeRate:Number(B.get("exchangeRate")),validUntil:B.get("validUntil"),amountBrl:Number(B.get("totalAmount"))*Number(B.get("exchangeRate"))};await Oe.saveQuote(z),k(!1),c(),R()},H=async b=>{b.preventDefault();const B=new FormData(b.currentTarget).get("label"),z=await Oe.createQuoteVariation(s.id,B);z&&(w(!1),m(z.id))},K=()=>{if(!v)return[];const b=[];if(s.totalAmount!==v.totalAmount){const B=s.amountBrl-v.amountBrl;b.push(`${B>0?"+":""}${pe(B)}`)}return s.linkUrl!==v.linkUrl&&b.push("Link diferente"),b},ie=r.couples.reduce((b,B)=>b+B.members.length,0),de=b=>{var B,z;if(Q[b])return Q[b];if((B=s.participantIds)!=null&&B.includes("ALL")||(z=s.participantIds)!=null&&z.includes(b)){const oe=r.couples.find(fe=>fe.id===b);return(oe==null?void 0:oe.members.map(fe=>fe.id))||[]}return[]},xe=r.couples.reduce((b,B)=>b+de(B.id).length,0),F=xe||ie,Y=r.segments.find(b=>b.id===s.segmentId),P=()=>{q(!1)},ae=(b,B)=>{C(z=>{const oe=r.couples.find(Ne=>Ne.id===b);if(!oe)return z;const fe=z[b]||oe.members.map(Ne=>Ne.id),Ce=fe.includes(B)?fe.filter(Ne=>Ne!==B):[...fe,B];return{...z,[b]:Ce}})},ue=b=>{const B=r.couples.find(fe=>fe.id===b);if(!B)return;const oe=(Q[b]||B.members.map(fe=>fe.id)).length===B.members.length;C(fe=>({...fe,[b]:oe?[]:B.members.map(Ce=>Ce.id)}))};return e.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors group",children:[e.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Lista de Oramentos"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(V,{variant:"outline",onClick:()=>k(!0),children:"Atualizar Valor"}),e.jsx(V,{variant:"outline",onClick:()=>w(!0),children:"Criar Variao"}),e.jsx(V,{variant:"outline",onClick:l,children:"Editar Completo"}),s.status!==Dt.CHOSEN&&e.jsx(V,{variant:"primary",onClick:u,children:"Oficializar "})]})]}),s.originalId&&e.jsxs("div",{className:"bg-indigo-600/10 border border-indigo-500/20 p-4 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-[10px] text-indigo-400 font-black uppercase",children:["Variao: ",s.variationLabel]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Esta  uma opo alternativa de"," ",e.jsx("span",{className:"text-white font-bold cursor-pointer hover:underline",onClick:()=>m(s.originalId),children:v==null?void 0:v.title})]})]})]}),e.jsx("div",{className:"flex gap-2",children:K().map(b=>e.jsx(ge,{color:"indigo",children:b},b))})]}),e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 pb-6 border-b border-gray-800",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{color:"indigo",children:s.category}),e.jsx(ge,{color:s.status===Dt.CHOSEN?"green":"gray",children:s.status}),s.completeness&&e.jsxs(ge,{color:s.completeness===100?"green":s.completeness>=70?"yellow":"red",children:[s.completeness,"% completo"]})]}),e.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:N(s.title)}),e.jsx("p",{className:"text-lg text-gray-500 font-medium",children:s.provider})]}),e.jsx("div",{className:"flex gap-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase",children:"Total BRL"}),e.jsx("p",{className:"text-3xl font-black text-indigo-400",children:pe(s.amountBrl)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Por pessoa: ",pe(s.amountBrl/F)]})]})})]}),e.jsx("div",{className:"flex border-b border-gray-800 overflow-x-auto",children:["summary","details","payment","variations"].map(b=>e.jsx("button",{onClick:()=>f(b),className:`px-6 py-4 text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${g===b?"text-indigo-400 border-b-2 border-indigo-500 bg-indigo-500/5":"text-gray-500 hover:text-gray-300"}`,children:b==="summary"?"Resumo":b==="details"?"Dados Tcnicos":b==="payment"?"Pagamento":"Opes"},b))}),e.jsxs("div",{className:"min-h-[400px]",children:[g==="summary"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[(s.includes||s.excludes)&&e.jsx(me,{title:"Escopo do Oramento",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.includes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-emerald-500 uppercase mb-2",children:" O que est includo"}),e.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-wrap",children:s.includes})]}),s.excludes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-red-500 uppercase mb-2",children:" O que NO est includo"}),e.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-wrap",children:s.excludes})]})]})}),(s.notesGroup||s.notesInternal)&&e.jsxs(me,{title:"Observaes",children:[s.notesGroup&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase mb-2",children:" Notas do Grupo"}),e.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-wrap",children:s.notesGroup})]}),s.notesInternal&&e.jsxs("div",{className:s.notesGroup?"pt-4 border-t border-gray-800":"",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase mb-2",children:" Notas Internas"}),e.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-wrap",children:s.notesInternal})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(me,{title:"Valores",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Moeda Original"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:[s.currency," ",pe(s.totalAmount)]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Valor em BRL"}),e.jsx("p",{className:"text-3xl font-black text-indigo-400",children:pe(s.amountBrl)}),s.currency!=="BRL"&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Taxa: ",pe(s.exchangeRate)]})]}),s.validUntil&&e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Vlido at"}),e.jsx("p",{className:"text-sm text-gray-400",children:new Date(s.validUntil).toLocaleDateString("pt-BR")})]})]})}),e.jsxs(me,{title:" Diviso de Valores",children:[e.jsxs("div",{className:"bg-indigo-600/10 p-4 rounded-xl mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Participantes"}),e.jsx("p",{className:"text-lg font-bold text-white",children:xe===ie?`Todos (${ie} pessoas)`:`${xe} de ${ie} pessoas`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total"}),e.jsx("p",{className:"text-2xl font-black text-indigo-400",children:pe(s.amountBrl)})]})]}),e.jsx(V,{variant:"outline",className:"w-full text-xs",onClick:()=>q(!0),children:" Ajustar Quem Vai Usar"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Diviso Detalhada"}),r.couples.map(b=>{const B=de(b.id),z=B.length>0,oe=z?s.amountBrl/xe*B.length:0,fe=B.length>0?oe/B.length:0;return e.jsxs("div",{className:`p-4 rounded-xl border-2 transition-all ${z?"bg-indigo-600/5 border-indigo-600/30":"bg-gray-900/50 border-gray-800 opacity-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:b.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[B.length," de ",b.members.length," ",b.members.length===1?"pessoa":"pessoas"]})]}),z&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-black text-indigo-400",children:pe(oe)}),e.jsxs("p",{className:"text-xs text-gray-600",children:[pe(fe),"/pessoa"]})]})]}),b.members.length>0&&e.jsx("div",{className:"space-y-1 pl-2 border-l-2 border-gray-800",children:b.members.map(Ce=>{const Ne=B.includes(Ce.id);return e.jsxs("div",{className:`flex items-center justify-between text-sm ${Ne?"text-white":"text-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:Ne?"text-emerald-400":"text-gray-700",children:Ne?"":""}),e.jsx("span",{children:Ce.name}),!Ne&&e.jsx("span",{className:"text-xs italic",children:"(no vai usar)"})]}),Ne&&e.jsx("span",{className:"text-xs text-indigo-400 font-bold",children:pe(fe)})]},Ce.id)})})]},b.id)})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-800 bg-gray-950 p-4 rounded-xl",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Valor por pessoa"}),e.jsx("p",{className:"text-xl font-bold text-white",children:pe(s.amountBrl/xe)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total geral"}),e.jsx("p",{className:"text-2xl font-black text-indigo-400",children:pe(s.amountBrl)})]})]})})]}),e.jsxs(me,{title:"ltima Atualizao",children:[e.jsxs("p",{className:"text-xs text-gray-400",children:["Criado em: ",Ni(s.createdAt)]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Atualizado: ",Ni(s.updatedAt)]})]})]})]}),g==="details"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-in fade-in duration-300",children:[e.jsx(me,{title:"Informaes do Oramento",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Categoria"}),e.jsx("p",{className:"text-sm text-white",children:s.category})]}),Y&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Segmento"}),e.jsx("p",{className:"text-sm text-white",children:Y.name}),Y.startDate&&Y.endDate&&e.jsxs("p",{className:"text-xs text-gray-600",children:[new Date(Y.startDate).toLocaleDateString("pt-BR")," - ",new Date(Y.endDate).toLocaleDateString("pt-BR")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Criado em"}),e.jsx("p",{className:"text-sm text-white",children:Ni(s.createdAt)})]}),s.completeness!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Completude"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s.completeness===100?"bg-emerald-500":s.completeness>=70?"bg-amber-500":"bg-red-500"}`,style:{width:`${s.completeness}%`}})}),e.jsxs("span",{className:"text-sm font-bold text-white",children:[s.completeness,"%"]})]})]}),s.validUntil&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Validade"}),e.jsx("p",{className:"text-sm text-white",children:new Date(s.validUntil).toLocaleDateString("pt-BR")})]})]})}),e.jsx(me,{title:"Fornecedor",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Nome"}),e.jsx("p",{className:"text-sm text-white",children:s.provider})]}),s.vendor_profile_id?e.jsx(ge,{color:"green",children:"Fornecedor vinculado"}):e.jsxs("div",{children:[e.jsx(ge,{color:"amber",children:"Sem fornecedor"}),s.source_type&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Fonte"}),e.jsx("p",{className:"text-xs text-gray-400",children:s.source_type==="link"?" Link":s.source_type==="texto"?" Texto":" Manual"}),s.source_value&&s.source_type==="link"&&e.jsx("a",{href:s.source_value,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-indigo-400 hover:text-indigo-300 underline break-all",children:s.source_value})]})]}),s.linkUrl&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Link do Oramento"}),e.jsx("a",{href:s.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-indigo-400 hover:text-indigo-300 underline break-all",children:s.linkUrl})]}),s.tags&&s.tags.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map(b=>e.jsx(ge,{color:"gray",children:b},b))})]})]})}),e.jsx(me,{title:"Detalhes Financeiros",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Moeda Original"}),e.jsxs("p",{className:"text-xl font-bold text-white",children:[s.currency," ",pe(s.totalAmount)]})]}),s.currency!==Ft.BRL&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Cmbio Aplicado"}),e.jsx("p",{className:"text-sm text-white",children:pe(s.exchangeRate)})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Total em BRL"}),e.jsx("p",{className:"text-2xl font-black text-indigo-400",children:pe(s.amountBrl)})]}),s.taxesFees&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Taxas e Impostos"}),e.jsx("p",{className:"text-sm text-gray-400",children:s.taxesFees})]})]})}),e.jsx(me,{title:"Poltica de Cancelamento",children:e.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-wrap",children:s.cancellationPolicy||"No informada"})}),s.hotelDetails&&e.jsx(me,{title:"Detalhes do Hotel",className:"lg:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.hotelDetails.checkin&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Check-in"}),e.jsx("p",{className:"text-sm text-white",children:new Date(s.hotelDetails.checkin).toLocaleDateString("pt-BR")})]}),s.hotelDetails.checkout&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Check-out"}),e.jsx("p",{className:"text-sm text-white",children:new Date(s.hotelDetails.checkout).toLocaleDateString("pt-BR")})]}),s.hotelDetails.roomType&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Tipo de Quarto"}),e.jsx("p",{className:"text-sm text-white",children:s.hotelDetails.roomType})]}),s.hotelDetails.bedrooms&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Quartos"}),e.jsx("p",{className:"text-sm text-white",children:s.hotelDetails.bedrooms})]}),s.hotelDetails.breakfastIncluded!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Caf da Manh"}),e.jsx(ge,{color:s.hotelDetails.breakfastIncluded?"green":"red",children:s.hotelDetails.breakfastIncluded?"Incluso":"No incluso"})]}),s.hotelDetails.location&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Localizao"}),e.jsx("p",{className:"text-sm text-white",children:s.hotelDetails.location})]}),s.hotelDetails.amenities&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase mb-2",children:"Comodidades"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.hotelDetails.amenities.split(",").map((b,B)=>e.jsx(ge,{color:"gray",className:"text-[9px]",children:b.trim()},B))})]})]})}),s.carDetails&&e.jsx(me,{title:"Detalhes do Carro",className:"lg:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.carDetails.pickupDateTime&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Retirada"}),e.jsx("p",{className:"text-sm text-white",children:new Date(s.carDetails.pickupDateTime).toLocaleString("pt-BR")})]}),s.carDetails.dropoffDateTime&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Devoluo"}),e.jsx("p",{className:"text-sm text-white",children:new Date(s.carDetails.dropoffDateTime).toLocaleString("pt-BR")})]}),s.carDetails.carClass&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Classe"}),e.jsx("p",{className:"text-sm text-white",children:s.carDetails.carClass})]}),s.carDetails.deductible!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Franquia"}),e.jsx("p",{className:"text-sm text-white",children:pe(s.carDetails.deductible)})]})]})}),s.ticketDetails&&e.jsx(me,{title:"Detalhes dos Ingressos",className:"lg:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.ticketDetails.kind&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Tipo"}),e.jsx("p",{className:"text-sm text-white",children:s.ticketDetails.kind})]}),s.ticketDetails.adultQty!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Adultos"}),e.jsxs("p",{className:"text-sm text-white",children:[s.ticketDetails.adultQty,"  ",pe(s.ticketDetails.adultPrice||0)]})]}),s.ticketDetails.childQty!==void 0&&s.ticketDetails.childQty>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Crianas"}),e.jsxs("p",{className:"text-sm text-white",children:[s.ticketDetails.childQty,"  ",pe(s.ticketDetails.childPrice||0)]})]})]})})]}),g==="payment"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-in fade-in duration-300",children:[e.jsx(me,{title:"Condies de Pagamento",children:e.jsxs("div",{className:"space-y-4",children:[((L=s.paymentTerms)==null?void 0:L.methods)&&s.paymentTerms.methods.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase mb-2",children:"Mtodos Aceitos"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.paymentTerms.methods.map(b=>e.jsx(ge,{color:"indigo",children:b},b))})]}),((X=s.paymentTerms)==null?void 0:X.installments)&&e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Parcelamento"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:[s.paymentTerms.installments,"x"]}),s.paymentTerms.installmentValue&&e.jsxs("p",{className:"text-sm text-gray-400",children:["de ",pe(s.paymentTerms.installmentValue)]})]}),((A=s.paymentTerms)==null?void 0:A.cashDiscount)&&e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Desconto  Vista"}),e.jsx("p",{className:"text-xl font-bold text-emerald-400",children:pe(s.paymentTerms.cashDiscount)}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Total  vista: ",pe(s.amountBrl-s.paymentTerms.cashDiscount)]})]})]})}),s.taxesFees&&e.jsx(me,{title:"Taxas e Impostos",children:e.jsx("p",{className:"text-sm text-gray-400 whitespace-pre-wrap",children:s.taxesFees})}),e.jsx(me,{title:"Resumo Financeiro",className:"lg:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-950 rounded-xl",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Valor Base"}),e.jsx("p",{className:"text-xl font-bold text-white",children:pe(s.totalAmount*s.exchangeRate)})]}),s.taxesFees&&e.jsxs("div",{className:"p-4 bg-gray-950 rounded-xl",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Taxas"}),e.jsx("p",{className:"text-xl font-bold text-amber-400",children:"+ Consultar"})]}),((M=s.paymentTerms)==null?void 0:M.cashDiscount)&&e.jsxs("div",{className:"p-4 bg-gray-950 rounded-xl",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Desconto"}),e.jsxs("p",{className:"text-xl font-bold text-emerald-400",children:["- ",pe(s.paymentTerms.cashDiscount)]})]}),e.jsxs("div",{className:"p-4 bg-indigo-600/20 rounded-xl border border-indigo-600/30",children:[e.jsx("p",{className:"text-[10px] font-black text-indigo-400 uppercase",children:"Total Final"}),e.jsx("p",{className:"text-2xl font-black text-white",children:pe(s.amountBrl)})]})]})})]}),g==="variations"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("div",{className:"bg-indigo-600/10 border border-indigo-500/20 p-6 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"text-4xl",children:""}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:"O que so Variaes?"}),e.jsx("p",{className:"text-sm text-gray-400",children:'Variaes so opes alternativas do mesmo oramento. Por exemplo: "Com seguro" vs "Sem seguro", ou "Quarto Standard" vs "Quarto Deluxe". Use variaes para comparar diferentes configuraes do mesmo fornecedor sem perder o histrico.'})]})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:["Outras Opes Vinculadas (",x.length,")"]}),e.jsx(V,{variant:"primary",onClick:()=>w(!0),children:"+ Criar Variao"})]}),x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map(b=>{const B=b.amountBrl-s.amountBrl,z=B>0;return e.jsx(me,{onClick:()=>m(b.id),className:"cursor-pointer hover:border-indigo-500 transition-all border-2 !p-0 overflow-hidden group",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(ge,{color:"indigo",className:"text-[9px]",children:b.variationLabel||"Variao"}),e.jsx(ge,{color:b.status===Dt.CHOSEN?"green":"gray",className:"text-[9px]",children:b.status})]}),e.jsx("h4",{className:"font-bold text-white group-hover:text-indigo-400 transition-colors",children:N(b.title)}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-black text-indigo-400",children:pe(b.amountBrl)}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Por pessoa: ",pe(b.amountBrl/F)]})]}),B!==0&&e.jsxs("div",{className:`text-right ${z?"text-red-400":"text-emerald-400"}`,children:[e.jsxs("p",{className:"text-sm font-bold",children:[z?"+":"",pe(B)]}),e.jsx("p",{className:"text-[10px] text-gray-500",children:z?"mais caro":"mais barato"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase mb-2",children:"Diferenas:"}),e.jsxs("div",{className:"space-y-1",children:[B!==0&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:z?"text-red-400":"text-emerald-400",children:z?"":""}),e.jsxs("span",{className:"text-gray-400",children:[pe(Math.abs(B))," ",z?"mais caro":"de economia"]})]}),b.linkUrl!==s.linkUrl&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-indigo-400",children:""}),e.jsx("span",{className:"text-gray-400",children:"Link/opo diferente"})]}),b.validUntil!==s.validUntil&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"text-amber-400",children:""}),e.jsx("span",{className:"text-gray-400",children:"Validade diferente"})]})]})]})]})},b.id)})}):e.jsxs("div",{className:"text-center py-20 bg-gray-900/50 rounded-xl border border-gray-800 border-dashed",children:[e.jsx("div",{className:"text-5xl mb-4 opacity-20",children:""}),e.jsx("p",{className:"text-gray-600 italic mb-4",children:"Nenhuma variao criada ainda."}),e.jsx(V,{variant:"primary",onClick:()=>w(!0),children:"Criar Primeira Variao"})]})]})]}),e.jsx(Re,{isOpen:_,onClose:()=>k(!1),title:"Atualizar Valores Rpido",children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Valor Original",name:"totalAmount",type:"number",step:"0.01",defaultValue:s.totalAmount}),e.jsx(ee,{label:"Cmbio",name:"exchangeRate",type:"number",step:"0.01",defaultValue:s.exchangeRate})]}),e.jsx(ee,{label:"Nova Validade",name:"validUntil",type:"date",defaultValue:mt(s.validUntil)}),e.jsxs("div",{className:"pt-4 border-t border-gray-800 flex justify-end gap-3",children:[e.jsx(V,{variant:"ghost",type:"button",onClick:()=>k(!1),children:"Cancelar"}),e.jsx(V,{variant:"primary",type:"submit",children:"Atualizar"})]})]})}),e.jsx(Re,{isOpen:S,onClose:()=>w(!1),title:"Criar Nova Variao",children:e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsx(ee,{label:"Nome da Variao",name:"label",placeholder:"Ex: Com Seguro Total, Incluindo Caf, Quarto Deluxe...",required:!0}),e.jsx("div",{className:"bg-indigo-600/10 border border-indigo-500/20 p-4 rounded-xl",children:e.jsx("p",{className:"text-xs text-gray-400",children:" Iremos copiar todos os dados do oramento atual para uma nova variao vinculada. Voc poder editar os detalhes depois."})}),e.jsxs("div",{className:"pt-4 border-t border-gray-800 flex justify-end gap-3",children:[e.jsx(V,{variant:"ghost",type:"button",onClick:()=>w(!1),children:"Cancelar"}),e.jsx(V,{variant:"primary",type:"submit",children:"Gerar Variao"})]})]})}),e.jsx(Re,{isOpen:U,onClose:()=>q(!1),title:"Ajustar Quem Vai Usar",size:"lg",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-amber-600/10 border border-amber-500/20 p-4 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:""}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-400",children:"Marque apenas as pessoas que vo usar este servio. Por exemplo: se  ingresso s para adultos, desmarque as crianas. Se  aluguel de carro e s uma pessoa vai dirigir, marque apenas ela."})})]})}),e.jsxs("div",{className:"bg-indigo-600/10 p-4 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Pessoas selecionadas"}),e.jsxs("p",{className:"text-2xl font-black text-white",children:[r.couples.reduce((b,B)=>{const z=de(B.id);return b+z.length},0)," de ",ie]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Valor por pessoa"}),e.jsx("p",{className:"text-xl font-bold text-indigo-400",children:pe(s.amountBrl/Math.max(1,r.couples.reduce((b,B)=>b+de(B.id).length,0)))})]})]}),e.jsx("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto pr-2",children:r.couples.map(b=>{const B=de(b.id),z=B.length===b.members.length,oe=B.length>0&&!z;return e.jsxs("div",{className:"bg-gray-950 border border-gray-800 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 pb-3 border-b border-gray-800",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer flex-1",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:()=>ue(b.id),className:"w-5 h-5 accent-indigo-500 cursor-pointer"}),oe&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-2.5 h-0.5 bg-indigo-500"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:b.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[B.length," de ",b.members.length," ",b.members.length===1?"pessoa":"pessoas"]})]})]}),B.length>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold text-indigo-400",children:pe(s.amountBrl/Math.max(1,r.couples.reduce((fe,Ce)=>fe+de(Ce.id).length,0))*B.length)}),e.jsx("p",{className:"text-xs text-gray-600",children:"subtotal"})]})]}),e.jsx("div",{className:"space-y-2 pl-8",children:b.members.map(fe=>{const Ce=B.includes(fe.id),Ne=s.amountBrl/Math.max(1,r.couples.reduce((Pe,Tt)=>Pe+de(Tt.id).length,0));return e.jsxs("label",{className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-all ${Ce?"bg-indigo-600/10 hover:bg-indigo-600/20":"hover:bg-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:Ce,onChange:()=>ae(b.id,fe.id),className:"w-4 h-4 accent-indigo-500 cursor-pointer"}),e.jsxs("div",{children:[e.jsx("span",{className:`text-sm ${Ce?"text-white font-medium":"text-gray-500"}`,children:fe.name}),fe.isChild&&e.jsx(ge,{color:"gray",className:"ml-2 text-[9px]",children:"Criana"})]})]}),Ce&&e.jsx("span",{className:"text-xs text-indigo-400 font-bold",children:pe(Ne)})]},fe.id)})})]},b.id)})}),e.jsxs("div",{className:"pt-4 border-t border-gray-800 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total do oramento"}),e.jsx("p",{className:"text-2xl font-black text-white",children:pe(s.amountBrl)})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{variant:"ghost",onClick:()=>{q(!1),O()},children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:P,children:"Salvar Ajustes"})]})]})]})})]})},wb=({trip:r,vendor:s,onEdit:l,onBack:o,onRefresh:c,onNavigateToQuote:u,onCreateQuote:m})=>{var R;const[g,f]=D.useState("info"),[x,y]=D.useState([]),[_,k]=D.useState([]),[S,w]=D.useState(!1),[v,j]=D.useState({category:s.categories[0]||"Geral",segmentId:((R=r.segments[0])==null?void 0:R.id)||null,notes:""});D.useEffect(()=>{loadData()},[s.id]);const[U,q]=D.useState(!1),Q=()=>{var ie;const E=((ie=r.segments.find(de=>de.id===v.segmentId))==null?void 0:ie.name)||"Toda a viagem",H=r.couples.reduce((de,xe)=>de+xe.members.length,0);let K=`Ol ${s.name},
Gostaria de solicitar um oramento para ${r.name}.

`;return K+=`*Contexto:* ${E}
`,K+=`*Pessoas:* ${H} viajantes totais.

`,v.category==="Hospedagem"?K+=`*Pedido de Hotel:*
- Check-in/out: Consultar datas do segmento
- Ocupao: Quartos para ${H} pessoas
- Requisitos: Caf incluso, Poltica de cancelamento flexvel.
`:v.category==="Ingressos/Atraes"?K+=`*Pedido de Ingressos:*
- Tipo: Consultar disponibilidade
- Adultos/Crianas: ${H} totais
`:K+=`*Pedido Geral:*
${v.notes||"- Solicito valores e condies conforme disponibilidade."}
`,K+=`
Aguardo retorno com valores e formas de pagamento.
Obrigado!`,K},[C,N]=D.useState(null),O=async()=>{const E=s.contacts.find(ie=>ie.phone)||s.contacts[0];if(!(E!=null&&E.phone)){N("Nenhum telefone cadastrado para este fornecedor."),setTimeout(()=>N(null),3e3);return}const H=Q();await Oe.saveVendorRequest({id:"",tripId:r.id,vendor_profile_id:s.id,category:v.category,segmentId:v.segmentId,message:H,createdAt:""});const K=encodeURIComponent(H);window.open(`https://wa.me/${E.phone.replace(/\D/g,"")}?text=${K}`,"_blank"),w(!1),loadData()};return e.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors group",children:[e.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Lista de Fornecedores"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(V,{variant:"outline",onClick:()=>w(!0),children:" Pedir Oramento"}),e.jsx(V,{variant:"outline",onClick:l,children:"Editar"}),e.jsx(V,{variant:"primary",onClick:m,children:"+ Novo Oramento"})]})]}),e.jsx("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 pb-6 border-b border-gray-800",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:s.name}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.categories.map(E=>e.jsx(ge,{color:"indigo",children:E},E))})]})}),e.jsx("div",{className:"flex border-b border-gray-800 overflow-x-auto",children:["info","contacts","terms","quotes","requests"].map(E=>e.jsx("button",{onClick:()=>f(E),className:`px-6 py-4 text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap ${g===E?"text-indigo-400 border-b-2 border-indigo-500 bg-indigo-500/5":"text-gray-500 hover:text-gray-300"}`,children:E==="info"?"Resumo":E==="contacts"?"Contatos":E==="terms"?"Condies":E==="quotes"?"Oramentos":"Pedidos Enviados"},E))}),e.jsxs("div",{className:"min-h-[400px]",children:[g==="info"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx(me,{className:"!bg-gradient-to-br from-indigo-600/10 to-indigo-600/5 !border-indigo-600/30",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase mb-2",children:"Razo Social"}),e.jsx("p",{className:"text-lg font-bold text-white",children:s.legalName||"No informada"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Avaliao"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>e.jsx("span",{className:`text-xl ${s.rating>=E?"text-amber-400":"text-gray-800"}`,children:""},E))}),e.jsxs("span",{className:"text-sm font-bold text-gray-400",children:["(",s.rating,"/5)"]})]}),s.preferred&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-indigo-600/20 border border-indigo-600/30 rounded-xl",children:[e.jsx("span",{className:"text-2xl",children:""}),e.jsx("span",{className:"text-sm font-bold text-indigo-400",children:"Fornecedor Preferido"})]})]})}),e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Links e Redes Sociais"}),e.jsxs("div",{className:"space-y-3",children:[s.websiteUrl&&e.jsxs("a",{href:s.websiteUrl.startsWith("http")?s.websiteUrl:`https://${s.websiteUrl}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-gray-900 hover:bg-gray-800 border border-gray-800 hover:border-indigo-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600/20 flex items-center justify-center text-indigo-400 group-hover:bg-indigo-600/30",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Website"}),e.jsx("p",{className:"text-sm text-white truncate group-hover:text-indigo-400 transition-colors",children:s.websiteUrl})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600 group-hover:text-indigo-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),s.instagramUrl&&e.jsxs("a",{href:s.instagramUrl.startsWith("@")?`https://instagram.com/${s.instagramUrl.slice(1)}`:`https://instagram.com/${s.instagramUrl}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-gray-900 hover:bg-gray-800 border border-gray-800 hover:border-pink-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-600/20 to-pink-600/20 flex items-center justify-center text-pink-400 group-hover:from-purple-600/30 group-hover:to-pink-600/30",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Instagram"}),e.jsx("p",{className:"text-sm text-white truncate group-hover:text-pink-400 transition-colors",children:s.instagramUrl.startsWith("@")?s.instagramUrl:`@${s.instagramUrl}`})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600 group-hover:text-pink-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),!s.websiteUrl&&!s.instagramUrl&&e.jsx("div",{className:"text-center py-8 text-gray-600 italic text-sm",children:"Nenhum link cadastrado"})]})]}),s.tags&&s.tags.length>0&&e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-3",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map(E=>e.jsx("span",{className:"px-3 py-1.5 bg-gray-900 border border-gray-800 rounded-lg text-xs font-bold text-gray-400",children:E},E))})]}),s.riskFlags&&s.riskFlags.length>0&&e.jsxs(me,{className:"!bg-red-600/10 !border-red-600/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsx("h3",{className:"text-sm font-black text-red-400 uppercase",children:"Alertas de Risco"})]}),e.jsx("div",{className:"space-y-2",children:s.riskFlags.map(E=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400",children:[e.jsx("span",{children:""}),e.jsx("span",{children:E})]},E))})]})]}),g==="contacts"&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase",children:"Equipe de Atendimento"}),s.contacts&&s.contacts.length>0?e.jsx("div",{className:"grid gap-4",children:s.contacts.map(E=>e.jsxs(me,{className:"!p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-white",children:E.name}),e.jsx("p",{className:"text-sm text-gray-500",children:E.role})]}),E.isPrimary&&e.jsx(ge,{color:"indigo",children:"Principal"})]}),e.jsxs("div",{className:"space-y-3",children:[E.phone&&e.jsxs("a",{href:`https://wa.me/${E.phone.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-green-600/10 hover:bg-green-600/20 border border-green-600/30 hover:border-green-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-600/20 flex items-center justify-center text-green-400 group-hover:bg-green-600/30",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"WhatsApp"}),e.jsx("p",{className:"text-sm text-white group-hover:text-green-400 transition-colors",children:E.phone})]}),e.jsx("svg",{className:"w-5 h-5 text-gray-600 group-hover:text-green-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),E.email&&e.jsxs("a",{href:`mailto:${E.email}`,className:"flex items-center gap-3 p-3 bg-blue-600/10 hover:bg-blue-600/20 border border-blue-600/30 hover:border-blue-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-600/20 flex items-center justify-center text-blue-400 group-hover:bg-blue-600/30",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Email"}),e.jsx("p",{className:"text-sm text-white truncate group-hover:text-blue-400 transition-colors",children:E.email})]}),e.jsx("button",{onClick:H=>{H.preventDefault(),navigator.clipboard.writeText(E.email);const K=H.currentTarget,ie=K.innerHTML;K.innerHTML='<svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>',setTimeout(()=>K.innerHTML=ie,1500)},className:"p-1 hover:bg-blue-600/20 rounded transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600 group-hover:text-blue-400 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"Mtodo preferido:"}),e.jsx(ge,{color:"gray",className:"text-[9px]",children:E.preferredMethod})]})]})]},E.id))}):e.jsx("div",{className:"text-center py-12 text-gray-600 italic",children:"Nenhum contato cadastrado"})]}),g==="terms"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Condies de Pagamento"}),s.paymentTermsDefault?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-4 bg-gray-900 border border-gray-800 rounded-xl",children:e.jsx("p",{className:"text-white",children:s.paymentTermsDefault})}),s.paymentTermsDefault&&e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.paymentTermsDefault);const E=document.activeElement,H=E.textContent;E.textContent=" Copiado!",E.classList.add("!text-green-400"),setTimeout(()=>{E.textContent=H,E.classList.remove("!text-green-400")},1500)},className:"text-xs text-gray-500 hover:text-indigo-400 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar condies"]})]}):e.jsx("p",{className:"text-gray-600 italic",children:"No informado"})]}),e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Poltica de Cancelamento"}),s.cancellationPolicyNotes?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-4 bg-gray-900 border border-gray-800 rounded-xl",children:e.jsx("p",{className:"text-white whitespace-pre-wrap",children:s.cancellationPolicyNotes})}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.cancellationPolicyNotes);const E=document.activeElement,H=E.textContent;E.textContent=" Copiado!",E.classList.add("!text-green-400"),setTimeout(()=>{E.textContent=H,E.classList.remove("!text-green-400")},1500)},className:"text-xs text-gray-500 hover:text-indigo-400 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar poltica"]})]}):e.jsx("p",{className:"text-gray-600 italic",children:"No informado"})]}),s.slaNotes&&e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"SLA de Resposta"}),e.jsx("div",{className:"p-4 bg-indigo-600/10 border border-indigo-600/30 rounded-xl",children:e.jsx("p",{className:"text-white",children:s.slaNotes})})]})]}),g==="requests"&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest",children:"Histrico de Mensagens Enviadas"}),_.map(E=>e.jsxs(me,{className:"!p-4 !bg-gray-900/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx(ge,{color:"indigo",children:E.category}),e.jsx("span",{className:"text-[10px] text-gray-500 font-bold",children:Ni(E.createdAt)})]}),e.jsx("pre",{className:"text-[10px] font-mono bg-black/50 p-4 rounded text-gray-400 whitespace-pre-wrap",children:E.message}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(V,{variant:"ghost",className:"text-[10px]",onClick:()=>{navigator.clipboard.writeText(E.message),alert("Copiado!")},children:"Copiar Novamente"})})]},E.id)),_.length===0&&e.jsx("p",{className:"text-center py-20 text-gray-600 italic",children:"Nenhum pedido enviado ainda."})]}),g==="quotes"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 animate-in fade-in duration-300",children:x.map(E=>e.jsxs(me,{onClick:()=>u(E.id),className:"cursor-pointer hover:border-indigo-500 transition-all border-2",children:[e.jsx("h4",{className:"font-black text-white uppercase",children:E.title}),e.jsx("p",{className:"text-sm font-bold text-indigo-400",children:pe(E.amountBrl)})]},E.id))})]}),e.jsx(Re,{isOpen:S,onClose:()=>w(!1),title:"Gerador de Pedido de Oramento",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee,{as:"select",label:"Categoria do Oramento",value:v.category,onChange:E=>j({...v,category:E.target.value}),children:r.categories.map(E=>e.jsx("option",{value:E,children:E},E))}),e.jsxs(ee,{as:"select",label:"Segmento de Referncia",value:v.segmentId,onChange:E=>j({...v,segmentId:E.target.value}),children:[e.jsx("option",{value:"seg-all",children:"Geral (Toda Viagem)"}),r.segments.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]}),e.jsx(ee,{as:"textarea",label:"Notas Adicionais",rows:3,value:v.notes,onChange:E=>j({...v,notes:E.target.value}),placeholder:"Ex: Preferncia por andar alto, carro SUV..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Preview da Mensagem"}),e.jsxs("div",{className:"bg-emerald-950/20 border border-emerald-500/20 rounded-xl p-4 min-h-[250px] flex flex-col",children:[e.jsx("pre",{className:"text-[10px] font-mono text-gray-300 whitespace-pre-wrap flex-1",children:Q()}),e.jsxs("div",{className:"pt-4 flex gap-2",children:[e.jsx(V,{variant:"ghost",className:"flex-1 text-[10px]",onClick:()=>{navigator.clipboard.writeText(Q()),alert("Copiado!")},children:"Copiar Texto"}),e.jsx(V,{variant:"primary",className:"flex-1 text-[10px] bg-emerald-600 hover:bg-emerald-700",onClick:O,children:"Abrir WhatsApp "})]})]})]})]})})]})},_b=({trip:r,initialData:s,onSave:l,onCancel:o})=>{var O,R;const[c,u]=D.useState(1),[m,g]=D.useState([]),[f,x]=D.useState(!!(s!=null&&s.vendor_profile_id)),[y,_]=D.useState((s==null?void 0:s.source_type)||"link"),[k,S]=D.useState((s==null?void 0:s.source_value)||""),[w,v]=D.useState(!1),[j,U]=D.useState({tripId:r.id,currency:Ft.BRL,exchangeRate:1,status:Dt.DRAFT,tags:[],participantIds:["ALL"],totalAmount:0,amountBrl:0,category:r.categories[0],segmentId:((O=r.segments[0])==null?void 0:O.id)||null,paymentTerms:{methods:[ca.PIX],installments:1,installmentValue:0},attachments:[],completeness:0,...s});D.useEffect(()=>{q()},[]);const q=async()=>{try{const E=await he.getTripVendors(r.id);g(E)}catch(E){console.error("Erro ao carregar fornecedores:",E)}},Q=D.useMemo(()=>{var xe,F,Y,P;const E=j,H=E.vendor_profile_id||E.source_type&&E.source_value,K={base:!!(E.title&&E.category&&H&&E.totalAmount&&E.validUntil&&E.cancellationPolicy),hotel:E.category==="Hospedagem"?!!((xe=E.hotelDetails)!=null&&xe.checkin&&((F=E.hotelDetails)!=null&&F.checkout)):!0,ticket:E.category==="Ingressos/Atraes"?!!((Y=E.ticketDetails)!=null&&Y.kind):!0,car:E.category==="Aluguel de Carro"?!!((P=E.carDetails)!=null&&P.pickupDateTime):!0},ie=Object.keys(K).length,de=Object.values(K).filter(Boolean).length;return Math.round(de/ie*100)},[j]);D.useEffect(()=>{U(E=>({...E,completeness:Q}))},[Q]),D.useEffect(()=>{j.currency===Ft.BRL&&j.exchangeRate!==1&&U(E=>({...E,exchangeRate:1}))},[j.currency]),D.useEffect(()=>{var de;const E=j.totalAmount||0,H=j.currency===Ft.BRL?1:j.exchangeRate||1,K=E*H,ie=K/(((de=j.paymentTerms)==null?void 0:de.installments)||1);U(xe=>({...xe,amountBrl:K,paymentTerms:{...xe.paymentTerms,installmentValue:ie}}))},[j.totalAmount,j.currency,j.exchangeRate,(R=j.paymentTerms)==null?void 0:R.installments]);const C=[{id:1,title:"Bsico"},{id:2,title:"Valores"},{id:3,title:"Pagamento"},{id:4,title:"Detalhes"},{id:5,title:"Participantes"},{id:6,title:"Regras"}],N=()=>{var E,H,K,ie,de,xe,F,Y,P,ae,ue,L,X,A,M,b,B;switch(c){case 1:return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4 duration-300",children:[e.jsx(ee,{label:"Ttulo do Oramento *",value:j.title,onChange:z=>U({...j,title:z.target.value}),placeholder:"Ex: Voo Ida - LATAM Premium"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{as:"select",label:"Categoria *",value:j.category,onChange:z=>U({...j,category:z.target.value}),children:r.categories.map(z=>e.jsx("option",{value:z,children:z},z))}),e.jsxs(ee,{as:"select",label:"Segmento",value:j.segmentId,onChange:z=>U({...j,segmentId:z.target.value}),children:[e.jsx("option",{value:"seg-all",children:"Geral (Toda Viagem)"}),r.segments.map(z=>e.jsx("option",{value:z.id,children:z.name},z.id))]})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-gray-950 rounded-xl border border-gray-800",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-3",children:"Fornecedor"}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-900 rounded-lg cursor-pointer hover:bg-gray-800 transition-colors",children:[e.jsx("input",{type:"radio",checked:f,onChange:()=>{x(!0),U({...j,source_type:void 0,source_value:void 0})},className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold text-white",children:"Selecionar fornecedor vinculado"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Escolher da lista de fornecedores desta viagem"})]})]}),f&&e.jsxs("div",{className:"space-y-2 ml-7",children:[e.jsxs("select",{value:j.vendor_profile_id||"",onChange:z=>{const oe=m.find(fe=>fe.profile.id===z.target.value);U({...j,vendor_profile_id:z.target.value,provider:oe==null?void 0:oe.profile.name})},className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none",children:[e.jsx("option",{value:"",children:"Selecione um fornecedor..."}),m.map(z=>e.jsx("option",{value:z.profile.id,children:z.profile.name},z.id))]}),e.jsx(V,{variant:"outline",onClick:()=>v(!0),className:"w-full text-sm",children:"+ Criar novo fornecedor"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-900 rounded-lg cursor-pointer hover:bg-gray-800 transition-colors",children:[e.jsx("input",{type:"radio",checked:!f,onChange:()=>{x(!1),U({...j,vendor_profile_id:void 0,provider:void 0})},className:"w-4 h-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold text-white",children:"Sem fornecedor (informar fonte)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Para cotaes de sites, pesquisas, etc"})]})]}),!f&&e.jsxs("div",{className:"space-y-3 ml-7",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_("link"),className:`flex-1 px-3 py-2 rounded-lg text-xs font-bold border transition-all ${y==="link"?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-900 border-gray-800 text-gray-500"}`,children:"Link"}),e.jsx("button",{onClick:()=>_("texto"),className:`flex-1 px-3 py-2 rounded-lg text-xs font-bold border transition-all ${y==="texto"?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-900 border-gray-800 text-gray-500"}`,children:"Texto"}),e.jsx("button",{onClick:()=>_("manual"),className:`flex-1 px-3 py-2 rounded-lg text-xs font-bold border transition-all ${y==="manual"?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-900 border-gray-800 text-gray-500"}`,children:"Manual"})]}),y==="link"&&e.jsx(ee,{label:"URL da Fonte *",value:k,onChange:z=>{S(z.target.value),U({...j,source_type:"link",source_value:z.target.value})},placeholder:"https://exemplo.com/cotacao"}),y==="texto"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Texto da Cotao *"}),e.jsx("textarea",{placeholder:"Cole aqui o texto da cotao (email, mensagem, etc)...",value:k,onChange:z=>{S(z.target.value),U({...j,source_type:"texto",source_value:z.target.value})},rows:4,className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none resize-none"})]}),y==="manual"&&e.jsx(ee,{label:"Descrio da Fonte *",value:k,onChange:z=>{S(z.target.value),U({...j,source_type:"manual",source_value:z.target.value})},placeholder:"Ex: Cotao por telefone, WhatsApp, pessoalmente"})]})]}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx(ee,{label:"Link do Oramento (URL)",className:"flex-1",value:j.linkUrl,onChange:z=>U({...j,linkUrl:z.target.value})}),j.linkUrl&&e.jsx(V,{variant:"secondary",onClick:()=>window.open(j.linkUrl,"_blank"),children:"Abrir"})]})]});case 2:return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(ee,{as:"select",label:"Moeda *",value:j.currency,onChange:z=>U({...j,currency:z.target.value}),children:[e.jsx("option",{value:Ft.BRL,children:"BRL (Real)"}),e.jsx("option",{value:Ft.USD,children:"USD (Dlar)"})]}),e.jsx(ee,{label:"Cmbio *",type:"number",step:"0.01",value:j.exchangeRate,disabled:j.currency===Ft.BRL,onChange:z=>U({...j,exchangeRate:Number(z.target.value)})})]}),e.jsx(ee,{label:"Valor Total (Moeda Original) *",type:"number",step:"0.01",value:j.totalAmount,onChange:z=>U({...j,totalAmount:Number(z.target.value)})}),e.jsx(ee,{label:"Taxas e Impostos Opcionais",type:"number",step:"0.01",value:j.taxesFees,onChange:z=>U({...j,taxesFees:Number(z.target.value)})}),e.jsxs("div",{className:"p-4 bg-indigo-500/10 border border-indigo-500/20 rounded-xl",children:[e.jsx("p",{className:"text-xs font-bold text-indigo-400 uppercase mb-1",children:"Total em Reais"}),e.jsx("p",{className:"text-3xl font-black text-white",children:pe(j.amountBrl||0)})]})]});case 3:return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4 duration-300",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Mtodos Aceitos"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.values(ca).map(z=>{var oe;return e.jsx("button",{onClick:()=>{var Ne;const fe=((Ne=j.paymentTerms)==null?void 0:Ne.methods)||[],Ce=fe.includes(z)?fe.filter(Pe=>Pe!==z):[...fe,z];U({...j,paymentTerms:{...j.paymentTerms,methods:Ce}})},className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition-all ${(oe=j.paymentTerms)!=null&&oe.methods.includes(z)?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-950 border-gray-800 text-gray-500"}`,children:z},z)})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Parcelas (Max)",type:"number",min:"1",max:"12",value:(E=j.paymentTerms)==null?void 0:E.installments,onChange:z=>U({...j,paymentTerms:{...j.paymentTerms,installments:Number(z.target.value)}})}),e.jsx(ee,{label:"Valor da Parcela",value:pe(((H=j.paymentTerms)==null?void 0:H.installmentValue)||0),disabled:!0})]}),e.jsx(ee,{label:"Desconto  Vista (Valor)",type:"number",value:(K=j.paymentTerms)==null?void 0:K.cashDiscount,onChange:z=>U({...j,paymentTerms:{...j.paymentTerms,cashDiscount:Number(z.target.value)}})})]});case 4:return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4 duration-300",children:[j.category==="Ingressos/Atraes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ee,{as:"select",label:"Tipo",value:(ie=j.ticketDetails)==null?void 0:ie.kind,onChange:z=>U({...j,ticketDetails:{...j.ticketDetails,kind:z.target.value}}),children:[e.jsx("option",{value:"Parque",children:"Parque"}),e.jsx("option",{value:"Show",children:"Show"}),e.jsx("option",{value:"Jogo",children:"Jogo"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-950 p-4 rounded-xl border border-gray-800",children:[e.jsx(ee,{label:"Qtd Adultos",type:"number",value:(de=j.ticketDetails)==null?void 0:de.adultQty,onChange:z=>U({...j,ticketDetails:{...j.ticketDetails,adultQty:Number(z.target.value)}})}),e.jsx(ee,{label:"Preo Unit. Adulto",type:"number",value:(xe=j.ticketDetails)==null?void 0:xe.adultPrice,onChange:z=>U({...j,ticketDetails:{...j.ticketDetails,adultPrice:Number(z.target.value)}})})]}),e.jsx(V,{variant:"ghost",className:"w-full text-[10px]",onClick:()=>{const z=j.ticketDetails,oe=z.adultQty*z.adultPrice+z.childQty*z.childPrice;U({...j,totalAmount:oe})},children:"Calcular total pelo detalhamento"})]}),j.category==="Hospedagem"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Check-in",type:"date",value:(F=j.hotelDetails)==null?void 0:F.checkin,onChange:z=>U({...j,hotelDetails:{...j.hotelDetails,checkin:z.target.value}})}),e.jsx(ee,{label:"Check-out",type:"date",value:(Y=j.hotelDetails)==null?void 0:Y.checkout,onChange:z=>U({...j,hotelDetails:{...j.hotelDetails,checkout:z.target.value}})}),e.jsx(ee,{label:"Tipo Quarto",value:(P=j.hotelDetails)==null?void 0:P.roomType,onChange:z=>U({...j,hotelDetails:{...j.hotelDetails,roomType:z.target.value}})}),e.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[e.jsx("input",{type:"checkbox",checked:(ae=j.hotelDetails)==null?void 0:ae.breakfastIncluded,onChange:z=>U({...j,hotelDetails:{...j.hotelDetails,breakfastIncluded:z.target.checked}})}),e.jsx("span",{className:"text-sm",children:"Caf da Manh?"})]})]}),j.category==="Aluguel de Carro"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Retirada",type:"datetime-local",value:(ue=j.carDetails)==null?void 0:ue.pickupDateTime,onChange:z=>U({...j,carDetails:{...j.carDetails,pickupDateTime:z.target.value}})}),e.jsx(ee,{label:"Devoluo",type:"datetime-local",value:(L=j.carDetails)==null?void 0:L.dropoffDateTime,onChange:z=>U({...j,carDetails:{...j.carDetails,dropoffDateTime:z.target.value}})}),e.jsx(ee,{label:"Classe do Carro",value:(X=j.carDetails)==null?void 0:X.carClass,onChange:z=>U({...j,carDetails:{...j.carDetails,carClass:z.target.value}})}),e.jsx(ee,{label:"Franquia (Deductible)",type:"number",value:(A=j.carDetails)==null?void 0:A.deductible,onChange:z=>U({...j,carDetails:{...j.carDetails,deductible:Number(z.target.value)}})})]}),!["Hospedagem","Ingressos/Atraes","Aluguel de Carro"].includes(j.category||"")&&e.jsx("p",{className:"text-gray-500 italic text-center py-10",children:"Categoria genrica: use notas para detalhes adicionais."})]});case 5:return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>U({...j,participantIds:["ALL"]}),className:`p-4 rounded-xl border text-left ${(M=j.participantIds)!=null&&M.includes("ALL")?"bg-indigo-600 border-indigo-400":"bg-gray-950 border-gray-800 text-gray-500"}`,children:[e.jsx("p",{className:"font-bold",children:"Todos"}),e.jsx("p",{className:"text-[10px]",children:"Toda a viagem"})]}),e.jsxs("button",{onClick:()=>U({...j,participantIds:[]}),className:`p-4 rounded-xl border text-left ${(b=j.participantIds)!=null&&b.includes("ALL")?"bg-gray-950 border-gray-800 text-gray-500":"bg-indigo-600 border-indigo-400"}`,children:[e.jsx("p",{className:"font-bold",children:"Selecionar"}),e.jsx("p",{className:"text-[10px]",children:"Escolher casais"})]})]}),!((B=j.participantIds)!=null&&B.includes("ALL"))&&e.jsx("div",{className:"space-y-2 mt-4",children:r.couples.map(z=>{var oe;return e.jsxs("label",{className:"flex items-center justify-between p-3 bg-gray-950 rounded-lg border border-gray-800 cursor-pointer hover:border-gray-600",children:[e.jsx("span",{className:"text-sm font-medium",children:z.name}),e.jsx("input",{type:"checkbox",className:"w-5 h-5 accent-indigo-500",checked:(oe=j.participantIds)==null?void 0:oe.includes(z.id),onChange:fe=>{const Ce=j.participantIds||[],Ne=fe.target.checked?[...Ce,z.id]:Ce.filter(Pe=>Pe!==z.id);U({...j,participantIds:Ne})}})]},z.id)})})]});case 6:return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Validade *",type:"date",value:j.validUntil,onChange:z=>U({...j,validUntil:z.target.value})}),e.jsxs(ee,{as:"select",label:"Poltica Cancelamento *",value:j.cancellationPolicy,onChange:z=>U({...j,cancellationPolicy:z.target.value}),children:[e.jsx("option",{value:"Reembolsvel",children:"Reembolsvel Total"}),e.jsx("option",{value:"Parcial",children:"Parcial"}),e.jsx("option",{value:"No Reembolsvel",children:"No Reembolsvel"})]})]}),e.jsx(ee,{as:"textarea",label:"O que INCLUI",rows:2,value:j.includes,onChange:z=>U({...j,includes:z.target.value})}),e.jsx(ee,{as:"textarea",label:"O que EXCLUI",rows:2,value:j.excludes,onChange:z=>U({...j,excludes:z.target.value})}),e.jsx(ee,{as:"textarea",label:"Notas p/ Grupo",rows:2,value:j.notesGroup,onChange:z=>U({...j,notesGroup:z.target.value})})]});default:return null}};return e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 min-h-[600px]",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"flex justify-between items-center mb-10 overflow-x-auto pb-4",children:C.map(E=>e.jsxs("button",{onClick:()=>u(E.id),className:`flex flex-col items-center gap-2 group transition-all px-4 ${c===E.id?"opacity-100 scale-105":"opacity-40 hover:opacity-70"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs border-2 ${c===E.id?"bg-indigo-600 border-indigo-400 text-white shadow-lg":"bg-gray-900 border-gray-700"}`,children:E.id}),e.jsx("span",{className:`text-[9px] uppercase font-black tracking-widest ${c===E.id?"text-indigo-400":"text-gray-500"}`,children:E.title})]},E.id))}),e.jsx("div",{className:"flex-1",children:N()}),e.jsxs("div",{className:"flex justify-between mt-10 pt-6 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:()=>c>1?u(c-1):o(),children:c===1?"Cancelar":"Voltar"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"secondary",onClick:()=>l(j),children:"Salvar Rascunho"}),c<6?e.jsx(V,{onClick:()=>u(c+1),children:"Prximo Passo"}):e.jsx(V,{variant:"primary",onClick:()=>l({...j,status:Dt.SHORTLIST}),children:"Finalizar e Shortlist"})]})]})]}),e.jsx("div",{className:"w-full lg:w-80 space-y-4 sticky top-4 h-fit",children:e.jsx(me,{title:"Resumo ao Vivo",className:"!bg-gray-950/50 border-gray-800",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(ge,{color:"indigo",children:j.category}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-gray-600 font-bold uppercase",children:"Completude"}),e.jsxs("p",{className:`text-sm font-black ${j.completeness===100?"text-emerald-500":"text-amber-500"}`,children:[j.completeness,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white leading-tight",children:j.title||"Sem ttulo"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:j.provider||(j.source_type?`Fonte: ${j.source_type}`:"Sem fornecedor")})]}),e.jsxs("div",{className:"p-3 bg-gray-900 rounded-xl space-y-1",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase",children:"Impacto Financeiro"}),e.jsx("p",{className:"text-2xl font-black text-white",children:pe(j.amountBrl||0)}),e.jsxs("p",{className:"text-[10px] text-gray-600",children:["Por casal: ",pe((j.amountBrl||0)/3)]})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase",children:"Checklist"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx(bi,{label:"Campos Bsicos",checked:!!(j.title&&(j.vendor_profile_id||j.source_type&&j.source_value))}),e.jsx(bi,{label:"Financeiro",checked:!!j.totalAmount}),e.jsx(bi,{label:"Regras & Validade",checked:!!(j.validUntil&&j.cancellationPolicy)}),e.jsx(bi,{label:"Participantes",checked:j.participantIds&&j.participantIds.length>0})]})]})]})})}),w&&e.jsx(Cd,{onClose:()=>v(!1),onCreated:async E=>{await he.linkVendorToTrip(r.id,E),await q();const K=(await he.getVendorProfiles()).find(ie=>ie.id===E);U({...j,vendor_profile_id:E,provider:K==null?void 0:K.name}),v(!1)}})]})},bi=({label:r,checked:s})=>e.jsxs("li",{className:"flex items-center gap-2 text-[10px] font-bold",children:[e.jsx("div",{className:`w-3 h-3 rounded-full flex items-center justify-center border ${s?"bg-emerald-500 border-emerald-400":"border-gray-700"}`,children:s&&e.jsx("span",{className:"text-white text-[8px]",children:""})}),e.jsx("span",{className:s?"text-gray-300":"text-gray-600",children:r})]}),Sb=({trip:r,initialData:s,onSave:l,onCancel:o})=>{var k,S;const[c,u]=D.useState({tripId:r.id,status:"Ativo",categories:[],rating:3,preferred:!1,tags:[],riskFlags:[],contacts:[],attachments:[],...s}),[m,g]=D.useState("info"),f=w=>{const v=c.contacts||[],j=v.findIndex(q=>q.id===w.id),U=[...v];j>=0?U[j]=w:U.push({...w,id:Math.random().toString(36).substr(2,9)}),u({...c,contacts:U})},x=w=>{u({...c,contacts:(c.contacts||[]).filter(v=>v.id!==w)})},y=c.name&&c.name.trim().length>0,_=["Taxas ocultas","Reembolso difcil","Atraso na resposta","Preo instvel","Comunicao difcil"];return e.jsxs("div",{className:"flex flex-col h-full bg-gray-950 border border-gray-800 rounded-2xl overflow-hidden shadow-2xl animate-in slide-in-from-right-10 duration-500",children:[e.jsxs("header",{className:"p-6 bg-gray-900 border-b border-gray-800 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tighter",children:s!=null&&s.id?"Editar Fornecedor":"Novo Fornecedor"}),e.jsxs("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-widest mt-1",children:["Viagem: ",r.name]})]}),e.jsx(ge,{color:c.preferred?"indigo":"gray",children:c.preferred?" Favorito":"Fornecedor Comum"})]}),e.jsx("div",{className:"flex border-b border-gray-800 bg-gray-900/50",children:["info","contacts","terms"].map(w=>e.jsx("button",{onClick:()=>g(w),className:`flex-1 py-3 text-[10px] font-black uppercase tracking-widest transition-all ${m===w?"text-indigo-400 border-b-2 border-indigo-500 bg-indigo-500/5":"text-gray-500 hover:text-gray-300"}`,children:w==="info"?"Identificao":w==="contacts"?"Contatos":"Polticas"},w))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar",children:[m==="info"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Nome do Fornecedor *",value:c.name,onChange:w=>u({...c,name:w.target.value}),placeholder:"Ex: Hilton Orlando"}),e.jsx(ee,{label:"Razo Social / Legal",value:c.legalName,onChange:w=>u({...c,legalName:w.target.value}),placeholder:"Nome completo da empresa"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Categorias de Servio"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.categories.map(w=>{var v;return e.jsx("button",{onClick:()=>{const j=c.categories||[],U=j.includes(w)?j.filter(q=>q!==w):[...j,w];u({...c,categories:U})},className:`px-3 py-1.5 rounded-xl text-[10px] font-bold uppercase transition-all border ${(v=c.categories)!=null&&v.includes(w)?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-950 border-gray-800 text-gray-500 hover:border-gray-600"}`,children:w},w)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Rating (Confiabilidade)"}),e.jsx("div",{className:"flex gap-2 p-2 bg-gray-950 border border-gray-800 rounded-lg",children:[1,2,3,4,5].map(w=>e.jsx("button",{onClick:()=>u({...c,rating:w}),className:`text-xl transition-all ${c.rating>=w?"text-amber-400":"text-gray-800"}`,children:""},w))})]}),e.jsx("div",{className:"flex items-end h-full",children:e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-950 border border-gray-800 rounded-xl cursor-pointer w-full",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5 accent-indigo-500",checked:c.preferred,onChange:w=>u({...c,preferred:w.target.checked})}),e.jsx("span",{className:"text-sm font-bold text-gray-300",children:"Marcar como Favorito"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee,{label:"Website",value:c.websiteUrl,onChange:w=>u({...c,websiteUrl:w.target.value}),placeholder:"https://..."}),e.jsx(ee,{label:"Instagram",value:c.instagramUrl,onChange:w=>u({...c,instagramUrl:w.target.value}),placeholder:"@perfil"})]})]}),m==="contacts"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Equipe de Atendimento"}),e.jsx(V,{variant:"outline",className:"text-[10px] py-1",onClick:()=>f({id:"",name:"",role:"Comercial",phone:"",email:"",preferredMethod:"WhatsApp",isPrimary:(c.contacts||[]).length===0}),children:"+ Novo Contato"})]}),e.jsxs("div",{className:"space-y-3",children:[(c.contacts||[]).map(w=>e.jsx("div",{className:"p-4 bg-gray-900 border border-gray-800 rounded-2xl space-y-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:"Nome *"}),e.jsx("input",{type:"text",value:w.name,onChange:v=>f({...w,name:v.target.value}),placeholder:"Ex: Joo Silva",className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:"Cargo/Setor *"}),e.jsx("input",{type:"text",value:w.role,onChange:v=>f({...w,role:v.target.value}),placeholder:"Ex: Comercial, Vendas",className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:e.jsxs("span",{className:"flex items-center gap-1",children:[" WhatsApp/Telefone",w.preferredMethod==="WhatsApp"&&e.jsx(ge,{color:"green",className:"text-[8px]",children:"Preferido"})]})}),e.jsx(Af,{value:w.phone||"",onChange:v=>f({...w,phone:v}),placeholder:"(00) 00000-0000",className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 mb-1",children:e.jsxs("span",{className:"flex items-center gap-1",children:[" Email",w.preferredMethod==="Email"&&e.jsx(ge,{color:"blue",className:"text-[8px]",children:"Preferido"})]})}),e.jsx("input",{type:"email",value:w.email||"",onChange:v=>f({...w,email:v.target.value}),placeholder:"contato@empresa.com",className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors text-sm"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-2 border-t border-gray-800",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs font-medium text-gray-500 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w.isPrimary,onChange:v=>{if(v.target.checked){const j=(c.contacts||[]).map(U=>({...U,isPrimary:U.id===w.id}));u({...c,contacts:j})}else f({...w,isPrimary:!1})},className:"accent-indigo-500"})," Contato Principal"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Mtodo preferido:"}),["WhatsApp","Email","Telefone"].map(v=>e.jsx("button",{type:"button",onClick:()=>f({...w,preferredMethod:v}),className:`px-2 py-1 rounded text-[9px] font-black uppercase border transition-all ${w.preferredMethod===v?"bg-indigo-600 border-indigo-400 text-white":"bg-gray-950 border-gray-800 text-gray-600 hover:border-gray-700"}`,children:v},v))]})]})]}),e.jsx("button",{type:"button",onClick:()=>x(w.id),className:"ml-4 text-red-500/50 hover:text-red-500 p-2 transition-colors",children:""})]})},w.id)),(c.contacts||[]).length===0&&e.jsxs("div",{className:"text-center py-10 bg-gray-900/50 border border-gray-800 rounded-xl",children:[e.jsx("p",{className:"text-gray-600 italic text-sm mb-3",children:"Nenhum contato cadastrado."}),e.jsx(V,{variant:"outline",className:"text-xs",onClick:()=>f({id:"",name:"",role:"Comercial",phone:"",email:"",preferredMethod:"WhatsApp",isPrimary:!0}),children:"+ Adicionar Primeiro Contato"})]})]})]}),m==="terms"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Flags de Risco / Alertas"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(w=>{var v;return e.jsx("button",{onClick:()=>{const j=c.riskFlags||[],U=j.includes(w)?j.filter(q=>q!==w):[...j,w];u({...c,riskFlags:U})},className:`px-3 py-1.5 rounded-xl text-[10px] font-bold border transition-all ${(v=c.riskFlags)!=null&&v.includes(w)?"bg-red-600/10 border-red-500/40 text-red-400":"bg-gray-950 border-gray-800 text-gray-600 hover:border-gray-700"}`,children:w},w)})})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Termos de Pagamento Padro"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Max Parcelamento",type:"number",min:"1",value:(k=c.paymentTermsDefault)==null?void 0:k.installmentsMax,onChange:w=>u({...c,paymentTermsDefault:{...c.paymentTermsDefault,installmentsMax:Number(w.target.value)}})}),e.jsx(ee,{label:"% Desconto  Vista",type:"number",min:"0",value:(S=c.paymentTermsDefault)==null?void 0:S.cashDiscountPercent,onChange:w=>u({...c,paymentTermsDefault:{...c.paymentTermsDefault,cashDiscountPercent:Number(w.target.value),cashDiscountPossible:Number(w.target.value)>0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase",children:"Mtodos aceitos"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.values(ca).map(w=>{var v;return e.jsx("button",{onClick:()=>{var q;const j=((q=c.paymentTermsDefault)==null?void 0:q.methods)||[],U=j.includes(w)?j.filter(Q=>Q!==w):[...j,w];u({...c,paymentTermsDefault:{...c.paymentTermsDefault,methods:U}})},className:`px-3 py-1.5 rounded-lg text-[9px] font-black border transition-all ${(v=c.paymentTermsDefault)!=null&&v.methods.includes(w)?"bg-emerald-600 border-emerald-400 text-white":"bg-gray-950 border-gray-800 text-gray-600"}`,children:w},w)})})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx(ee,{as:"textarea",label:"Notas de Cancelamento",rows:2,value:c.cancellationPolicyNotes,onChange:w=>u({...c,cancellationPolicyNotes:w.target.value}),placeholder:"Ex: Reembolsvel at 48h antes..."}),e.jsx(ee,{label:"SLA de Resposta",value:c.slaNotes,onChange:w=>u({...c,slaNotes:w.target.value}),placeholder:"Ex: Responde em 2h"})]})]})]}),e.jsxs("footer",{className:"p-6 bg-gray-900 border-t border-gray-800 flex justify-end gap-3",children:[e.jsx(V,{variant:"ghost",onClick:o,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:()=>l(c),disabled:!y,children:"Salvar Fornecedor"})]})]})},Cb=({trip:r,quotes:s,onBack:l,onRefresh:o,onNavigateToQuote:c})=>{const[u,m]=D.useState(!1),[g,f]=D.useState("price"),[x,y]=D.useState({}),[_,k]=D.useState(!1),S=D.useMemo(()=>{const C=[...s];if(g==="price")return C.sort((N,O)=>N.amountBrl-O.amountBrl);if(g==="pricePerPerson"){const N=r.couples.reduce((O,R)=>O+R.members.length,0);return C.sort((O,R)=>O.amountBrl/N-R.amountBrl/N)}return C.sort((N,O)=>{const R=v(N)||1,E=v(O)||1;return N.amountBrl/R-O.amountBrl/E})},[s,g,r]),w=r.couples.reduce((C,N)=>C+N.members.length,0),v=C=>{const O=`${C.title} ${C.notesInternal||""}`.toLowerCase().match(/(\d+)\s*(dia|day|noite|night)/i);return O?parseInt(O[1]):null},j=C=>{if(s.length<2)return!1;const N=C(s[0]);return!s.every(O=>C(O)===N)},U=[{label:"Fornecedor",accessor:C=>C.provider},{label:"Status",accessor:C=>C.status},{label:"Total Original",accessor:C=>`${C.currency} ${pe(C.totalAmount)}`},{label:"Total BRL",accessor:C=>pe(C.amountBrl),critical:!0},{label:"Custo por Pessoa",accessor:C=>pe(C.amountBrl/w)},{label:"Custo por Dia",accessor:C=>{const N=v(C);return N?`${pe(C.amountBrl/N)} (${N} dias)`:"N/A"}},{label:"Cmbio Aplicado",accessor:C=>C.currency===Ft.BRL?"-":pe(C.exchangeRate)},{label:"Vencimento",accessor:C=>new Date(C.validUntil).toLocaleDateString("pt-BR")},{label:"Cancelamento",accessor:C=>C.cancellationPolicy},{label:"Parcelas",accessor:C=>`${C.paymentTerms.installments}x`},{label:"Desconto  Vista",accessor:C=>C.paymentTerms.cashDiscount?pe(C.paymentTerms.cashDiscount):"Nenhum"},{label:"Completude",accessor:C=>`${C.completeness}%`}],q=async C=>{const N=s.find(O=>O.id===C);N&&(await Oe.saveQuote({...N,status:Dt.SHORTLIST}),o())},Q=async()=>{await Oe.saveComparison({id:"",tripId:r.id,quoteIds:s.map(N=>N.id),createdAt:""});const C=document.createElement("div");C.className="fixed top-4 right-4 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg z-50 animate-in slide-in-from-top-2 duration-300",C.textContent=" Comparao salva no histrico!",document.body.appendChild(C),setTimeout(()=>C.remove(),3e3)};return e.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-500 pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-400 hover:text-white group",children:[e.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Voltar para a Lista"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-900 border border-gray-800 rounded-xl p-1",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-black uppercase px-2",children:"Ordenar:"}),e.jsx("button",{onClick:()=>f("price"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${g==="price"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Preo Total"}),e.jsx("button",{onClick:()=>f("pricePerPerson"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${g==="pricePerPerson"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Por Pessoa"}),e.jsx("button",{onClick:()=>f("pricePerDay"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${g==="pricePerDay"?"bg-indigo-600 text-white":"text-gray-500 hover:text-gray-300"}`,children:"Por Dia"})]}),e.jsx(V,{variant:"outline",onClick:()=>m(!u),children:u?"Mostrar Tudo":"Apenas Diferenas"}),e.jsx(V,{variant:"primary",onClick:Q,children:"Salvar Comparao"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(me,{className:"!bg-gradient-to-br from-emerald-600/10 to-emerald-600/5 !border-emerald-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-emerald-400 uppercase",children:"Melhor Preo"}),e.jsx("p",{className:"text-2xl font-black text-white mt-1",children:pe(Math.min(...S.map(C=>C.amountBrl)))})]}),e.jsx("div",{className:"text-3xl",children:""})]})}),e.jsx(me,{className:"!bg-gradient-to-br from-amber-600/10 to-amber-600/5 !border-amber-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-amber-400 uppercase",children:"Diferena Mx"}),e.jsx("p",{className:"text-2xl font-black text-white mt-1",children:pe(Math.max(...S.map(C=>C.amountBrl))-Math.min(...S.map(C=>C.amountBrl)))})]}),e.jsx("div",{className:"text-3xl",children:""})]})}),e.jsx(me,{className:"!bg-gradient-to-br from-indigo-600/10 to-indigo-600/5 !border-indigo-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-indigo-400 uppercase",children:"Comparando"}),e.jsxs("p",{className:"text-2xl font-black text-white mt-1",children:[S.length," opes"]})]}),e.jsx("div",{className:"text-3xl",children:""})]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-2xl border border-gray-800 bg-gray-900 shadow-2xl",children:e.jsxs("table",{className:"w-full border-collapse text-left min-w-[800px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-950",children:[e.jsx("th",{className:"p-6 border-b border-gray-800 sticky left-0 bg-gray-950 z-10 w-48",children:e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase",children:"Atributo"})}),S.map(C=>e.jsx("th",{className:"p-6 border-b border-gray-800 min-w-[250px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(ge,{color:"indigo",children:C.category}),e.jsx("button",{onClick:()=>c(C.id),className:"text-[10px] text-indigo-400 font-bold hover:underline",children:"Detalhes "})]}),e.jsx("h4",{className:"text-sm font-black text-white uppercase truncate",children:C.title})]})},C.id))]})}),e.jsxs("tbody",{className:"divide-y divide-gray-800",children:[U.map((C,N)=>{const O=j(C.accessor);return u&&!O?null:e.jsxs("tr",{className:`group hover:bg-gray-800/20 transition-colors ${O?"bg-indigo-500/5":""}`,children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase tracking-tighter sticky left-0 bg-gray-900 group-hover:bg-gray-800 transition-colors z-10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[C.label,O&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500",title:"Diferena detectada"})]})}),S.map(R=>e.jsx("td",{className:`p-4 text-sm ${C.critical?"font-black text-white":"text-gray-400"}`,children:C.accessor(R)},R.id))]},N)}),e.jsx("tr",{className:"bg-gray-950/50",children:e.jsx("td",{colSpan:s.length+1,className:"p-2 text-[8px] font-black text-gray-700 uppercase tracking-widest text-center",children:"Notas de Comparao (Editvel)"})}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900 z-10",children:"Observaes"}),S.map(C=>e.jsx("td",{className:"p-4",children:e.jsx("textarea",{value:x[C.id]||"",onChange:N=>y({...x,[C.id]:N.target.value}),placeholder:"Adicione observaes sobre este oramento...",rows:3,className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-xs text-gray-300 placeholder-gray-600 focus:outline-none focus:border-indigo-500 transition-colors resize-none"})},C.id))]}),s.every(C=>C.category==="Hospedagem")&&e.jsxs(e.Fragment,{children:[e.jsx("tr",{className:"bg-gray-950/50",children:e.jsx("td",{colSpan:s.length+1,className:"p-2 text-[8px] font-black text-gray-700 uppercase tracking-widest text-center",children:"Especificaes de Hospedagem"})}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Caf da Manh"}),S.map(C=>{var N;return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:(N=C.hotelDetails)!=null&&N.breakfastIncluded?e.jsx(ge,{color:"green",children:"Incluso"}):e.jsx(ge,{color:"red",children:"No incluso"})},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Tipo de Quarto"}),S.map(C=>{var N;return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:((N=C.hotelDetails)==null?void 0:N.roomType)||"-"},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Quartos"}),S.map(C=>{var N;return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:((N=C.hotelDetails)==null?void 0:N.bedrooms)||"-"},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Localizao"}),S.map(C=>{var N;return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:((N=C.hotelDetails)==null?void 0:N.location)||"-"},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Comodidades"}),S.map(C=>{var N;return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:(N=C.hotelDetails)!=null&&N.amenities?e.jsx("div",{className:"flex flex-wrap gap-1",children:C.hotelDetails.amenities.split(",").map((O,R)=>e.jsx(ge,{color:"gray",className:"text-[9px]",children:O.trim()},R))}):"-"},C.id)})]})]}),s.every(C=>C.category==="Ingressos/Atraes")&&e.jsxs(e.Fragment,{children:[e.jsx("tr",{className:"bg-gray-950/50",children:e.jsx("td",{colSpan:s.length+1,className:"p-2 text-[8px] font-black text-gray-700 uppercase tracking-widest text-center",children:"Especificaes de Ingressos"})}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Parque/Atrao"}),S.map(C=>e.jsx("td",{className:"p-4 text-sm text-gray-400",children:C.title.includes("Disney")?" Disney":C.title.includes("Universal")?" Universal":C.title.includes("SeaWorld")?" SeaWorld":C.title.includes("Legoland")?" Legoland":"-"},C.id))]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Dias de Ingresso"}),S.map(C=>{const N=v(C);return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:N?`${N} dias`:"-"},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Park Hopper?"}),S.map(C=>e.jsx("td",{className:"p-4 text-sm text-gray-400",children:C.title.toLowerCase().includes("hopper")?e.jsx(ge,{color:"green",children:"Sim"}):e.jsx(ge,{color:"gray",children:"No"})},C.id))]})]}),s.every(C=>C.category==="Aluguel de Carro")&&e.jsxs(e.Fragment,{children:[e.jsx("tr",{className:"bg-gray-950/50",children:e.jsx("td",{colSpan:s.length+1,className:"p-2 text-[8px] font-black text-gray-700 uppercase tracking-widest text-center",children:"Especificaes de Veculo"})}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Modelo"}),S.map(C=>{var N;return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:((N=C.title.match(/(Toyota|Honda|Chevrolet|Ford|Dodge|Chrysler|Nissan)\s+\w+/i))==null?void 0:N[0])||"-"},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Dias de Locao"}),S.map(C=>{const N=v(C);return e.jsx("td",{className:"p-4 text-sm text-gray-400",children:N?`${N} dias`:"-"},C.id)})]}),e.jsxs("tr",{className:"hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900",children:"Preo por Dia"}),S.map(C=>{const N=v(C);return e.jsx("td",{className:"p-4 text-sm font-bold text-indigo-400",children:N?pe(C.amountBrl/N):"-"},C.id)})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-4 border-r border-gray-800 font-bold text-xs text-gray-500 uppercase sticky left-0 bg-gray-900 z-10",children:"Deciso"}),S.map(C=>e.jsxs("td",{className:"p-4",children:[C.status!==Dt.CHOSEN&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{variant:"outline",className:"w-full text-[10px] py-1",onClick:()=>q(C.id),children:"Votar / Shortlist"}),e.jsx(V,{variant:"ghost",className:"w-full text-[10px] py-1 text-red-400",children:"Descartar"})]}),C.status===Dt.CHOSEN&&e.jsx(ge,{color:"green",children:"Vencedora "})]},C.id))]})]})]})})]})},of=({onCreateTrip:r,onEnter:s,hasTrip:l})=>{const o=()=>{var c;(c=document.getElementById("como-funciona"))==null||c.scrollIntoView({behavior:"smooth"})};return e.jsxs("section",{className:"relative w-full h-[95vh] md:h-screen overflow-hidden flex items-center justify-center bg-[#02040a]",children:[e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,poster:"https://images.unsplash.com/photo-1542296332-2e4473faf563?auto=format&fit=crop&q=80&w=2000",className:"w-full h-full object-cover opacity-40 scale-",style:{filter:"brightness(0.7) contrast(1.2) saturate(0.8) blur(1px)"},children:e.jsx("source",{src:"https://assets.mixkit.co/videos/preview/mixkit-night-city-traffic-in-a-time-lapse-4444-large.mp4",type:"video/mp4"})}),e.jsx("div",{className:"absolute inset-0 z-[1] pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]"}),e.jsx("div",{className:"absolute inset-0 z-[2] bg-[radial-gradient(circle_at_center,_transparent_0%,_#02040a_120%)]"}),e.jsx("div",{className:"absolute inset-0 z-[2] bg-gradient-to-b from-[#02040a]/80 via-transparent to-[#02040a]"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-blue-500/30 to-transparent blur-[100px] z-[3] animate-pulse"}),e.jsx("div",{className:"absolute top-1/3 right-0 w-full h-[1px] bg-gradient-to-r from-transparent via-orange-500/20 to-transparent blur-[100px] z-[3] animate-pulse",style:{animationDelay:"1s"}})]}),e.jsxs("div",{className:"relative z-10 container mx-auto px-6 flex flex-col items-center text-center -mt-20 md:-mt-32",children:[e.jsx("div",{className:"relative z-20 -mb-40 md:-mb-56",children:e.jsx("img",{src:"/logo.png",alt:"TripDivide Logo",className:"h-[32rem] md:h-[42rem] w-auto object-contain transform hover:scale-105 transition-transform duration-700"})}),e.jsxs("div",{className:"space-y-4 max-w-4xl mb-12 animate-in fade-in slide-in-from-bottom-8 duration-1000 relative z-30",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 mb-4 backdrop-blur-md",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-cyan-400 animate-pulse"}),e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-[0.4em]",children:"Clculo em centavos exatos"})]}),e.jsxs("h1",{className:"text-4xl md:text-6xl font-black text-white uppercase tracking-tighter leading-[1.5] select-none italic px-4 py-3",children:["O racha ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-500 via-yellow-400 to-orange-500",children:"perfeito"}),e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-400 drop-shadow-[0_0_30px_rgba(59,130,246,0.5)]",children:"comea aqui."})]}),e.jsxs("p",{className:"text-gray-400 text-base md:text-lg max-w-2xl mx-auto font-light leading-relaxed tracking-tight mt-6 px-4",children:["Planeje, vote e divida custos da sua viagem em grupo com ",e.jsx("span",{className:"text-white font-bold",children:"preciso absoluta"}),".",e.jsx("span",{className:"block text-xs text-gray-600 mt-3 uppercase font-black tracking-widest",children:"Sem planilhas  Sem confuso"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 mb-16",children:[e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-600 to-cyan-500 rounded-2xl blur-md opacity-40 group-hover:opacity-100 transition duration-500"}),e.jsx(V,{variant:"primary",className:"relative !px-12 !py-5 !text-xl !rounded-2xl !bg-indigo-600 hover:!bg-indigo-500 transition-all transform hover:scale-105 active:scale-95 font-black uppercase tracking-tight shadow-2xl",onClick:l?s:r,children:l?"Acessar Viagem":"Criar Viagem Agora"})]}),e.jsx(V,{variant:"outline",className:"!px-10 !py-5 !text-xl !rounded-2xl !border-white/10 hover:!bg-white/5 transition-all text-white/70 font-bold uppercase tracking-tight",onClick:o,children:"Ver como funciona"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-4 border-t border-white/5 pt-8 w-full max-w-xl",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[0.5em]",children:"Ideal para grupos de 6 a 20 pessoas"}),e.jsxs("div",{className:"flex gap-8 opacity-30 grayscale hover:grayscale-0 transition-all duration-500",children:[e.jsx("span",{className:"text-xs font-black text-white",children:"ORLANDO 2026"}),e.jsx("span",{className:"text-xs font-black text-white",children:"EUROTRIP"}),e.jsx("span",{className:"text-xs font-black text-white",children:"MIAMI NIGHTS"})]})]})]}),e.jsx("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_150px_rgba(0,0,0,0.9)] z-20"}),e.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2 z-30 flex flex-col items-center gap-2",children:e.jsx("div",{className:"w-[1px] h-12 bg-gradient-to-b from-orange-500 to-transparent animate-bounce"})})]})},Tb=[{number:"01",title:"Destino e Logstica",benefit:"Organize o calendrio sem esforo.",bullets:["Defina datas e roteiros gerais","Crie segmentos (ex: Orlando vs Miami)"],icon:""},{number:"02",title:"Grupos e Viajantes",benefit:"Gesto completa de participantes.",bullets:["Organize por grupos/famlias","Cadastre documentos (passaporte, RG, visto)","Alertas de vencimento automticos"],icon:""},{number:"03",title:"Cotaes Inteligentes",benefit:"Centralize tudo, do manual ao WhatsApp.",bullets:["Cole textos brutos do WhatsApp","Anexe links e validade de preo","Compare lado a lado"],icon:""},{number:"04",title:"Votao e Consenso",benefit:"Decises democrticas e rpidas.",bullets:["Compare opes lado a lado","Vote e oficialize o vencedor","Histrico de decises"],icon:""},{number:"05",title:"Fechamento e Acerto",benefit:"Paz financeira com centavos exatos.",bullets:["Gere reembolsos automticos","Acompanhe quem j pagou o qu","Rastreie cada transao"],icon:""}],kb=[{icon:"",title:"Centavos Exatos",benefit:"Zero arredondamentos, zero confuso.",bullets:["Algoritmo ajusta resto automaticamente","ltimo pagante recebe o ajuste"]},{icon:"",title:"Import WhatsApp",benefit:"Cole e pronto. Sem digitao manual.",bullets:["Extrai preos e datas automaticamente","Suporta textos brutos de fornecedores"]},{icon:"",title:"Gesto de Fornecedores",benefit:"Saiba com quem est fechando.",bullets:["Avalie reputao e SLA","Marque favoritos e red flags"]},{icon:"",title:"Reembolsos Automticos",benefit:"Quem pagou por quem, calculado.",bullets:["Detecta pagamentos cruzados","Gera lista de transferncias"]},{icon:"",title:"Segmentos de Viagem",benefit:"Nem todos vo a todos os lugares.",bullets:["Divida em etapas (Orlando, Miami)","Racha s quem participa"]},{icon:"",title:"Multi-Moeda",benefit:"Compare mas com mas.",bullets:["Cotaes em USD, BRL ou outras","Converso automtica para comparao"]},{icon:"",title:"Gesto de Documentos",benefit:"Nunca mais perca um visto vencido.",bullets:["Cadastre passaportes, vistos, RG, CNH","Alertas de vencimento automticos","Criptografia de nmeros sensveis"]},{icon:"",title:"Racha Flexvel",benefit:"Divida do seu jeito.",bullets:["Por grupo, pessoa ou percentual","Crianas com peso diferenciado"]}],cf=()=>e.jsxs("section",{id:"como-funciona",className:"py-32 bg-[#02040a] relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40 grayscale-[0.3] animate-slow-zoom",style:{backgroundImage:"url('https://images.unsplash.com/photo-1488646953014-85cb44e25828?auto=format&fit=crop&q=80&w=2000')",filter:"brightness(0.6)"}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#02040a] via-[#02040a]/70 to-[#02040a]"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_transparent_0%,_#02040a_100%)]"})]}),e.jsx("div",{className:"absolute top-1/4 -left-20 w-[500px] h-[500px] bg-indigo-600/20 rounded-full blur-[120px] pointer-events-none animate-pulse"}),e.jsx("div",{className:"absolute bottom-1/4 -right-20 w-[500px] h-[500px] bg-cyan-600/20 rounded-full blur-[120px] pointer-events-none animate-pulse",style:{animationDelay:"2s"}}),e.jsxs("div",{className:"container mx-auto px-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-24 space-y-4",children:[e.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 mb-4 backdrop-blur-md",children:e.jsx("span",{className:"text-[9px] font-black text-indigo-400 uppercase tracking-[0.4em]",children:"Metodologia TripDivide"})}),e.jsxs("h2",{className:"text-5xl md:text-7xl font-black text-white uppercase tracking-tighter leading-none italic",children:["Como transformamos ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-gray-300 to-gray-600",children:"caos em preciso."})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 mb-32",children:Tb.map((r,s)=>e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-b from-indigo-500/30 to-transparent rounded-[2.5rem] opacity-0 group-hover:opacity-100 transition duration-500 blur-sm"}),e.jsxs("div",{className:"relative h-full bg-[#05070a]/40 border border-white/10 p-8 rounded-[2.5rem] backdrop-blur-xl flex flex-col hover:bg-white/[0.05] transition-all duration-500",children:[e.jsx("span",{className:"text-5xl font-black text-white/5 mb-6 group-hover:text-indigo-500/20 transition-colors italic",children:r.number}),e.jsx("div",{className:"text-4xl mb-6 transform group-hover:scale-110 transition-transform duration-500",children:r.icon}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight mb-2 leading-tight",children:r.title}),e.jsx("p",{className:"text-indigo-400 text-[10px] font-black mb-6 leading-relaxed uppercase tracking-widest",children:r.benefit}),e.jsx("ul",{className:"space-y-3 mt-auto border-t border-white/5 pt-6",children:r.bullets.map((l,o)=>e.jsxs("li",{className:"flex items-start gap-2 text-[11px] text-gray-300 font-medium leading-snug group-hover:text-white transition-colors",children:[e.jsx("span",{className:"text-indigo-500/80 mt-0.5",children:""}),l]},o))})]})]},s))}),e.jsxs("div",{className:"mb-32",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 mb-4 backdrop-blur-md",children:e.jsx("span",{className:"text-[9px] font-black text-cyan-400 uppercase tracking-[0.4em]",children:"Funcionalidades Exclusivas"})}),e.jsxs("h2",{className:"text-4xl md:text-6xl font-black text-white uppercase tracking-tighter leading-none italic",children:["Tudo que voc precisa",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-gray-300 to-gray-600",children:"em um s lugar."})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:kb.map((r,s)=>e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-b from-cyan-500/30 to-transparent rounded-[2.5rem] opacity-0 group-hover:opacity-100 transition duration-500 blur-sm"}),e.jsxs("div",{className:"relative h-full bg-[#05070a]/40 border border-white/10 p-8 rounded-[2.5rem] backdrop-blur-xl flex flex-col hover:bg-white/[0.05] transition-all duration-500",children:[e.jsx("div",{className:"text-4xl mb-6 transform group-hover:scale-110 transition-transform duration-500",children:r.icon}),e.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight mb-2 leading-tight",children:r.title}),e.jsx("p",{className:"text-cyan-400 text-[10px] font-black mb-6 leading-relaxed uppercase tracking-widest",children:r.benefit}),e.jsx("ul",{className:"space-y-3 mt-auto border-t border-white/5 pt-6",children:r.bullets.map((l,o)=>e.jsxs("li",{className:"flex items-start gap-2 text-[11px] text-gray-300 font-medium leading-snug group-hover:text-white transition-colors",children:[e.jsx("span",{className:"text-cyan-500/80 mt-0.5",children:""}),l]},o))})]})]},s))})]}),e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-indigo-500/20 via-cyan-500/20 to-indigo-500/20 rounded-[4rem] blur-2xl opacity-50"}),e.jsxs("div",{className:"relative bg-[#05070a]/90 border border-white/10 rounded-[4rem] p-10 md:p-16 backdrop-blur-3xl",children:[e.jsx("h3",{className:"text-center text-[10px] font-black text-gray-500 uppercase tracking-[0.5em] mb-16",children:"O diferencial tecnolgico"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-16",children:[e.jsx(id,{title:"Centavos Exatos",desc:"Nosso algoritmo ajusta o resto matemtico no ltimo pagante automaticamente. Sem arredondamentos que geram desconforto."}),e.jsx(id,{title:"Racha Flexvel",desc:"Divida por casal, por pessoa ou participao customizada. O sistema recalcula tudo em tempo real."}),e.jsx(id,{title:"Auditoria SaaS",desc:"Histrico imutvel de cada oramento e pagamento. Transparncia bancria para sua viagem de amigos."})]})]})]})}),e.jsxs("div",{className:"mt-24 flex flex-col items-center gap-10",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6",children:[e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"absolute -inset-1 bg-indigo-500 rounded-2xl blur opacity-25 group-hover:opacity-60 transition duration-500"}),e.jsx(V,{variant:"primary",className:"relative !px-16 !py-6 !text-2xl !rounded-2xl !bg-indigo-600 hover:!bg-indigo-500 shadow-[0_25px_50px_rgba(79,70,229,0.3)] font-black uppercase tracking-tight",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:"Comear agora"})]}),e.jsx(V,{variant:"outline",className:"!px-12 !py-6 !text-2xl !rounded-2xl !border-white/10 hover:!bg-white/5 transition-all text-white font-bold uppercase tracking-tight backdrop-blur-md",children:"Importar WhatsApp "})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-700 uppercase tracking-[0.5em]",children:"Segurana ponta-a-ponta  Sem anncios"}),e.jsx("div",{className:"w-12 h-[1px] bg-gradient-to-r from-transparent via-gray-800 to-transparent"})]})]})]}),e.jsx("style",{children:`
        @keyframes slow-zoom {
          0% { transform: scale(1); }
          100% { transform: scale(1.15); }
        }
        .animate-slow-zoom {
          animation: slow-zoom 30s linear infinite alternate;
        }
      `})]}),id=({title:r,desc:s})=>e.jsxs("div",{className:"text-center md:text-left space-y-6 group",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center text-indigo-400 mx-auto md:mx-0 group-hover:bg-indigo-500 group-hover:text-white transition-all duration-500 shadow-xl",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xl font-black text-white uppercase tracking-tight italic",children:r}),e.jsx("p",{className:"text-sm text-gray-500 font-medium leading-relaxed group-hover:text-gray-400 transition-colors",children:s})]})]}),Ur=({value:r,label:s,sublabel:l,color:o,icon:c,delay:u=0})=>{const[m,g]=D.useState(!1);D.useEffect(()=>{const y=setTimeout(()=>g(!0),u);return()=>clearTimeout(y)},[u]);const f={indigo:"bg-indigo-600/20 border-indigo-600/30 hover:bg-indigo-600/30",cyan:"bg-cyan-600/20 border-cyan-600/30 hover:bg-cyan-600/30",green:"bg-green-600/20 border-green-600/30 hover:bg-green-600/30",orange:"bg-orange-600/20 border-orange-600/30 hover:bg-orange-600/30",purple:"bg-purple-600/20 border-purple-600/30 hover:bg-purple-600/30"},x={indigo:"text-indigo-400",cyan:"text-cyan-400",green:"text-green-400",orange:"text-orange-400",purple:"text-purple-400"};return e.jsx(me,{className:`${f[o]} transition-all duration-300 transform ${m?"scale-100 opacity-100":"scale-95 opacity-0"} cursor-pointer group`,children:e.jsxs("div",{className:"text-center relative overflow-hidden",children:[e.jsx(c,{className:`w-8 h-8 mx-auto mb-2 ${x[o]} opacity-50 group-hover:opacity-100 transition-opacity`}),e.jsx("div",{className:"text-4xl font-black text-white mb-1 group-hover:scale-110 transition-transform",children:r}),e.jsx("div",{className:"text-sm text-gray-300 font-semibold",children:s}),e.jsx("div",{className:`text-xs ${x[o]} mt-1 font-medium`,children:l})]})})},df=({onNavigate:r,onOpenTrip:s})=>{const[l,o]=D.useState({totalTrips:0,activeTrips:0,totalTravelers:0,totalVendors:0,totalQuotes:0,totalExpenses:0}),[c,u]=D.useState([]),[m,g]=D.useState(!0),[f,x]=D.useState("");D.useEffect(()=>{_(),x(y())},[]);const y=()=>{const k=new Date().getHours();return k<12?"Bom dia":k<18?"Boa tarde":"Boa noite"},_=async()=>{g(!0);try{const[k,S,w]=await Promise.all([he.getTrips(),he.getTravelerProfiles(),he.getVendorProfiles()]),v=k.filter(q=>q.status==="active");let j=0,U=0;for(const q of k){const Q=await he.getQuotes(q.id),C=await he.getExpenses(q.id);j+=Q.length,U+=C.length}o({totalTrips:k.length,activeTrips:v.length,totalTravelers:S.length,totalVendors:w.length,totalQuotes:j,totalExpenses:U}),u(k.slice(0,5))}catch(k){console.error("Erro ao carregar dados:",k)}finally{g(!1)}};return m?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 animate-pulse",children:"Carregando dashboard..."})]})}):e.jsxs("div",{className:"space-y-6 animate-fadeIn",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-indigo-600 via-purple-600 to-cyan-500 rounded-2xl p-8 text-white overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsx("div",{className:"absolute -top-24 -right-24 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-24 -left-24 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ae.Dashboard,{className:"w-8 h-8"}),e.jsxs("h1",{className:"text-4xl font-black uppercase tracking-tight",children:[f,"!"]})]}),e.jsx("p",{className:"text-lg opacity-90 font-medium",children:"Viso geral de todas as suas viagens e recursos"}),l.activeTrips>0&&e.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-sm font-bold",children:[l.activeTrips," viagem",l.activeTrips>1?"s":""," ativa",l.activeTrips>1?"s":""]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(Ur,{value:l.totalTrips,label:"Viagens",sublabel:`${l.activeTrips} ativas`,color:"indigo",icon:Ae.Dashboard,delay:0}),e.jsx(Ur,{value:l.activeTrips,label:"Ativas",sublabel:"Em andamento",color:"green",icon:Ae.Check,delay:100}),e.jsx(Ur,{value:l.totalTravelers,label:"Viajantes",sublabel:"Cadastrados",color:"cyan",icon:Ae.Travelers,delay:200}),e.jsx(Ur,{value:l.totalVendors,label:"Fornecedores",sublabel:"Cadastrados",color:"purple",icon:Ae.Vendors,delay:300}),e.jsx(Ur,{value:l.totalQuotes,label:"Oramentos",sublabel:"Total",color:"orange",icon:Ae.Quotes,delay:400}),e.jsx(Ur,{value:l.totalExpenses,label:"Despesas",sublabel:"Registradas",color:"green",icon:Ae.Expenses,delay:500})]}),e.jsxs(me,{className:"bg-gradient-to-br from-gray-900 to-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-indigo-500 to-cyan-500 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight",children:"Aes Rpidas"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>r("trips"),className:"group relative bg-gradient-to-br from-indigo-600 to-indigo-700 hover:from-indigo-500 hover:to-indigo-600 rounded-xl p-6 transition-all duration-300 transform hover:scale-105 hover:shadow-xl hover:shadow-indigo-500/50",children:[e.jsx("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/10 rounded-xl transition-colors"}),e.jsxs("div",{className:"relative flex flex-col items-center gap-3",children:[e.jsx(Ae.Dashboard,{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Ver Viagens"})]})]}),e.jsxs("button",{onClick:()=>r("travelers"),className:"group relative bg-gradient-to-br from-cyan-600 to-cyan-700 hover:from-cyan-500 hover:to-cyan-600 rounded-xl p-6 transition-all duration-300 transform hover:scale-105 hover:shadow-xl hover:shadow-cyan-500/50",children:[e.jsx("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/10 rounded-xl transition-colors"}),e.jsxs("div",{className:"relative flex flex-col items-center gap-3",children:[e.jsx(Ae.Travelers,{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Viajantes"})]})]}),e.jsxs("button",{onClick:()=>r("vendors"),className:"group relative bg-gradient-to-br from-purple-600 to-purple-700 hover:from-purple-500 hover:to-purple-600 rounded-xl p-6 transition-all duration-300 transform hover:scale-105 hover:shadow-xl hover:shadow-purple-500/50",children:[e.jsx("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/10 rounded-xl transition-colors"}),e.jsxs("div",{className:"relative flex flex-col items-center gap-3",children:[e.jsx(Ae.Vendors,{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Fornecedores"})]})]}),e.jsxs("button",{onClick:()=>r("trips"),className:"group relative bg-gradient-to-br from-orange-600 to-orange-700 hover:from-orange-500 hover:to-orange-600 rounded-xl p-6 transition-all duration-300 transform hover:scale-105 hover:shadow-xl hover:shadow-orange-500/50",children:[e.jsx("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/10 rounded-xl transition-colors"}),e.jsxs("div",{className:"relative flex flex-col items-center gap-3",children:[e.jsx(Ae.Plus,{className:"w-8 h-8 text-white group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Nova Viagem"})]})]})]})]}),e.jsxs(me,{className:"bg-gradient-to-br from-gray-900 to-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-8 bg-gradient-to-b from-indigo-500 to-cyan-500 rounded-full"}),e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight",children:"Viagens Recentes"})]}),c.length>0&&e.jsx(V,{onClick:()=>r("trips"),className:"bg-gray-800 hover:bg-gray-700 text-sm font-bold",children:"Ver Todas "})]}),c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx(Ae.Dashboard,{className:"w-10 h-10 text-gray-600"})}),e.jsx("p",{className:"text-gray-400 text-lg mb-2",children:"Nenhuma viagem criada ainda"}),e.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"Comece criando sua primeira viagem"}),e.jsxs(V,{onClick:()=>r("trips"),className:"bg-gradient-to-r from-indigo-600 to-cyan-600 hover:from-indigo-500 hover:to-cyan-500 font-bold",children:[e.jsx(Ae.Plus,{className:"w-4 h-4 mr-2"}),"Criar Primeira Viagem"]})]}):e.jsx("div",{className:"space-y-3",children:c.map((k,S)=>e.jsx("div",{className:"group relative bg-gray-800/50 hover:bg-gray-800 rounded-xl p-5 transition-all duration-300 transform hover:scale-[1.02] hover:shadow-lg border border-gray-700/50 hover:border-indigo-500/50",style:{animationDelay:`${S*50}ms`},children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-600 to-cyan-600 flex items-center justify-center flex-shrink-0",children:e.jsx(Ae.Dashboard,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-bold text-white text-lg truncate",children:k.name}),k.status==="active"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-600/20 text-green-400 text-xs font-bold rounded-full border border-green-500/30",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"}),"ATIVA"]}),k.status==="draft"&&e.jsx("span",{className:"px-2 py-1 bg-yellow-600/20 text-yellow-400 text-xs font-bold rounded-full border border-yellow-500/30",children:"RASCUNHO"}),k.status==="completed"&&e.jsx("span",{className:"px-2 py-1 bg-gray-600/20 text-gray-400 text-xs font-bold rounded-full border border-gray-500/30",children:"CONCLUDA"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ae.Calendar,{className:"w-4 h-4"}),Na(k.start_date)," - ",Na(k.end_date)]}),k.destinations&&k.destinations.length>0&&e.jsxs("span",{className:"flex items-center gap-1 truncate",children:[e.jsx(Ae.MapPin,{className:"w-4 h-4"}),k.destinations.join(", ")]})]})]})]})}),e.jsx(V,{onClick:()=>s(k.id),className:"bg-gradient-to-r from-indigo-600 to-cyan-600 hover:from-indigo-500 hover:to-cyan-500 text-sm font-bold flex-shrink-0 group-hover:scale-105 transition-transform",children:"Abrir "})]})},k.id))})]}),l.totalTrips===0&&e.jsxs(me,{className:"!bg-indigo-600/10 !border-indigo-600/30",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight mb-4",children:"Comeando"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-600 flex items-center justify-center font-bold text-white flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:"Crie sua primeira viagem"}),e.jsx("div",{className:"text-sm text-gray-400",children:"Defina nome, datas e destinos"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center font-bold text-white flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-400",children:"Cadastre viajantes e fornecedores"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Perfis globais reutilizveis"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center font-bold text-white flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-400",children:"Vincule perfis  viagem"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Selecione quem participa"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center font-bold text-white flex-shrink-0",children:"4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-400",children:"Comece a cotar e fechar itens"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Organize oramentos e despesas"})]})]})]})]})]})},vd=({onClose:r,onSave:s,initialTrip:l})=>{var ue;const o=!!l,[c,u]=D.useState(1),[m,g]=D.useState({id:(l==null?void 0:l.id)||void 0,name:(l==null?void 0:l.name)||"",startDate:(l==null?void 0:l.start_date)||(l==null?void 0:l.startDate)||"",endDate:(l==null?void 0:l.end_date)||(l==null?void 0:l.endDate)||"",segments:((ue=l==null?void 0:l.segments)==null?void 0:ue.filter(L=>L.name!=="Viagem Completa"))||[],baseCurrency:(l==null?void 0:l.base_currency)||(l==null?void 0:l.baseCurrency)||"BRL",defaultExchangeRate:(l==null?void 0:l.default_exchange_rate)||(l==null?void 0:l.defaultExchangeRate)||1,defaultSplitRule:(l==null?void 0:l.default_split_rule)||(l==null?void 0:l.defaultSplitRule)||"equal",consensusRule:(l==null?void 0:l.consensus_rule)||(l==null?void 0:l.consensusRule)||"2/3",categories:(l==null?void 0:l.categories)||["Voo","Hospedagem","Aluguel de Carro","Restaurantes","Diversos"],selectedTravelerIds:[],selectedVendorIds:[],markVendorsAsFavorite:!0}),[f,x]=D.useState({name:"",startDate:"",endDate:""}),[y,_]=D.useState(null),[k,S]=D.useState(!1),[w,v]=D.useState([]),[j,U]=D.useState([]),[q,Q]=D.useState(""),[C,N]=D.useState("");D.useEffect(()=>{c===4?O():c===5&&R()},[c]);const O=async()=>{try{const L=await he.getTravelerProfiles();v(L)}catch(L){console.error("Erro ao carregar perfis:",L)}},R=async()=>{try{const L=await he.getVendorProfiles();U(L)}catch(L){console.error("Erro ao carregar fornecedores:",L)}},E=()=>{if(f.name.trim()&&f.startDate&&f.endDate){if(y!==null){const L=[...m.segments];L[y]=f,g({...m,segments:L}),_(null)}else g({...m,segments:[...m.segments,f]});x({name:"",startDate:"",endDate:""})}},H=L=>{x(m.segments[L]),_(L)},K=L=>{g({...m,segments:m.segments.filter((X,A)=>A!==L)})},ie=()=>{x({name:"",startDate:"",endDate:""}),_(null)},de=(L,X)=>{const A=[],M=new Date(L.startDate).getTime(),b=new Date(L.endDate).getTime();return m.segments.forEach((B,z)=>{if(X!==void 0&&z===X)return;const oe=new Date(B.startDate).getTime(),fe=new Date(B.endDate).getTime();(M>=oe&&M<fe||b>oe&&b<=fe||M<=oe&&b>=fe)&&A.push(B.name)}),{hasOverlap:A.length>0,overlappingSegments:A}},xe=()=>{if(!m.startDate||!m.endDate)return null;const L=new Date(m.startDate+"T00:00:00").getTime(),X=new Date(m.endDate+"T00:00:00").getTime(),A=Math.ceil((X-L)/(1e3*60*60*24))+1,M=new Set;m.segments.forEach(B=>{const z=new Date(B.startDate+"T00:00:00"),oe=new Date(B.endDate+"T00:00:00"),fe=new Date(z);for(;fe<=oe;)M.add(fe.toISOString().split("T")[0]),fe.setDate(fe.getDate()+1)});const b=m.segments.reduce((B,z)=>{const oe=new Date(z.startDate+"T00:00:00").getTime(),fe=new Date(z.endDate+"T00:00:00").getTime();return B+Math.ceil((fe-oe)/(1e3*60*60*24))+1},0);return{totalDays:A,coveredDays:M.size,segmentDays:b,uncoveredDays:A-M.size,hasGaps:M.size<A,hasOverlaps:b>M.size}},F=()=>{c<5&&u(c+1)},Y=()=>{c>1&&u(c-1)},P=async()=>{S(!0);try{await s(m)}catch(L){console.error("Erro ao salvar viagem:",L)}finally{S(!1)}},ae=()=>c===1?m.name.trim()&&m.startDate&&m.endDate:c===2?m.segments.length>0:!0;return e.jsx(Re,{isOpen:!0,onClose:r,size:"lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-black text-white uppercase tracking-tight",children:o?"Editar Viagem":"Nova Viagem"}),e.jsx("div",{className:"flex items-center gap-2 mt-4",children:[1,2,3,4,5].map(L=>e.jsx("div",{className:"flex items-center flex-1",children:e.jsx("div",{className:`h-1 flex-1 rounded ${L<=c?"bg-indigo-600":"bg-gray-800"}`})},L))}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Passo ",c," de 5: ",c===1?"Informaes Bsicas":c===2?"Destinos":c===3?"Configuraes":c===4?"Viajantes":"Fornecedores"]})]}),c===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Nome da Viagem"}),e.jsx("input",{type:"text",value:m.name,onChange:L=>g({...m,name:L.target.value}),placeholder:"Ex: Frias em Paris",className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none",autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Data de Ida"}),e.jsx("input",{type:"date",value:m.startDate,onChange:L=>g({...m,startDate:L.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Data de Volta"}),e.jsx("input",{type:"date",value:m.endDate,onChange:L=>g({...m,endDate:L.target.value}),min:m.startDate,className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none"})]})]})]}),c===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:y!==null?"Editar Destino/Trecho":"Adicionar Destino/Trecho"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Defina os destinos da viagem com suas datas especficas. til para viagens com mltiplas cidades."}),e.jsxs("div",{className:"space-y-3 p-4 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Nome do Destino"}),e.jsx("input",{type:"text",value:f.name,onChange:L=>x({...f,name:L.target.value}),onKeyDown:L=>{L.key==="Enter"?(L.preventDefault(),E()):L.key==="Escape"&&ie()},placeholder:"Ex: Miami, Orlando, Nova York",className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none",autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Data de Chegada"}),e.jsx("input",{type:"date",value:f.startDate,onChange:L=>x({...f,startDate:L.target.value}),min:m.startDate,max:m.endDate,className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Data de Sada"}),e.jsx("input",{type:"date",value:f.endDate,onChange:L=>x({...f,endDate:L.target.value}),min:f.startDate||m.startDate,max:m.endDate,className:"w-full px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none"})]})]}),f.name&&f.startDate&&f.endDate&&(()=>{const L=de(f,y??void 0);return L.hasOverlap?e.jsx("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-500 text-lg",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-yellow-400",children:"Sobreposio de Datas"}),e.jsxs("p",{className:"text-xs text-yellow-300 mt-1",children:["Este perodo sobrepe com: ",e.jsx("strong",{children:L.overlappingSegments.join(", ")})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Isso  normal se o grupo vai se dividir entre destinos diferentes no mesmo perodo."})]})]})}):null})(),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:E,disabled:!f.name.trim()||!f.startDate||!f.endDate,className:"flex-1 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:y!==null?e.jsx(e.Fragment,{children:" Salvar Alteraes"}):e.jsxs(e.Fragment,{children:[e.jsx(Ae.Plus,{className:"w-4 h-4 mr-1"})," Adicionar"]})}),y!==null&&e.jsx(V,{onClick:ie,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"})]})]})]}),m.segments.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400",children:"Destinos Adicionados"}),m.startDate&&m.endDate&&e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsx("div",{className:"text-xs font-bold text-gray-500 mb-2",children:"TIMELINE DA VIAGEM"}),e.jsxs("div",{className:"relative h-12 bg-gray-950 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full h-1 bg-gray-800"})}),m.segments.map((L,X)=>{const A=new Date(m.startDate).getTime(),b=new Date(m.endDate).getTime()-A,B=new Date(L.startDate).getTime(),z=new Date(L.endDate).getTime(),oe=(B-A)/b*100,fe=(z-B)/b*100,Ce=["bg-indigo-600","bg-cyan-600","bg-purple-600","bg-pink-600","bg-green-600","bg-yellow-600"];return e.jsx("div",{className:`absolute h-8 ${Ce[X%Ce.length]} rounded opacity-80 hover:opacity-100 transition-opacity cursor-pointer`,style:{left:`${oe}%`,width:`${fe}%`,top:"50%",transform:"translateY(-50%)"},title:`${L.name}: ${Na(L.startDate)} - ${Na(L.endDate)}`,children:e.jsx("div",{className:"px-2 py-1 text-[10px] font-bold text-white truncate",children:L.name})},X)}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex justify-between px-2 text-[9px] text-gray-600",children:[e.jsx("span",{children:Hs(m.startDate)}),e.jsx("span",{children:Hs(m.endDate)})]})]}),(()=>{const L=xe();return L?e.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-gray-950 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:L.totalDays}),e.jsx("div",{className:"text-[9px] text-gray-500 uppercase",children:"Total"})]}),e.jsxs("div",{className:"p-2 bg-gray-950 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-indigo-400",children:L.coveredDays}),e.jsx("div",{className:"text-[9px] text-gray-500 uppercase",children:"Cobertos"})]}),e.jsxs("div",{className:"p-2 bg-gray-950 rounded",children:[e.jsx("div",{className:`text-lg font-bold ${L.uncoveredDays>0?"text-yellow-400":"text-green-400"}`,children:L.uncoveredDays}),e.jsx("div",{className:"text-[9px] text-gray-500 uppercase",children:"Livres"})]})]}):null})(),(()=>{const L=xe();return L?e.jsxs("div",{className:"mt-2 space-y-1",children:[L.hasOverlaps&&e.jsxs("div",{className:"text-xs text-yellow-400 flex items-center gap-1",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"H sobreposio de datas (grupo se divide)"})]}),L.hasGaps&&e.jsxs("div",{className:"text-xs text-blue-400 flex items-center gap-1",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[L.uncoveredDays," dia(s) sem destino definido (descanso/deslocamento)"]})]}),!L.hasGaps&&!L.hasOverlaps&&e.jsxs("div",{className:"text-xs text-green-400 flex items-center gap-1",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Toda a viagem est coberta sequencialmente"})]})]}):null})()]}),e.jsx("div",{className:"space-y-2",children:m.segments.map((L,X)=>e.jsx("div",{className:"p-3 bg-indigo-600/10 border border-indigo-600/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white text-lg",children:L.name}),e.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:[" ",Hs(L.startDate)," - ",Na(L.endDate),e.jsxs("span",{className:"ml-2 text-indigo-400",children:["(",Math.ceil((new Date(L.endDate+"T00:00:00").getTime()-new Date(L.startDate+"T00:00:00").getTime())/(1e3*60*60*24))+1," dias)"]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-3",children:[e.jsx("button",{onClick:()=>H(X),className:"text-indigo-400 hover:text-indigo-300 text-sm",children:""}),e.jsx("button",{onClick:()=>K(X),className:"text-red-400 hover:text-red-300",children:e.jsx(Ae.X,{className:"w-4 h-4"})})]})]})},X))}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:" Dica: Voc poder definir quem vai em cada destino no prximo passo"})]})]}),c===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Moeda Base"}),e.jsxs("select",{value:m.baseCurrency,onChange:L=>g({...m,baseCurrency:L.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none",children:[e.jsx("option",{value:"BRL",children:"BRL (Real)"}),e.jsx("option",{value:"USD",children:"USD (Dlar)"}),e.jsx("option",{value:"EUR",children:"EUR (Euro)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Taxa de Cmbio Padro"}),e.jsx("input",{type:"number",step:"0.01",value:m.defaultExchangeRate,onChange:L=>g({...m,defaultExchangeRate:parseFloat(L.target.value)||1}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Regra Padro de Diviso"}),e.jsxs("select",{value:m.defaultSplitRule,onChange:L=>g({...m,defaultSplitRule:L.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none",children:[e.jsx("option",{value:"equal",children:"Dividir Igualmente"}),e.jsx("option",{value:"percent",children:"Por Percentual"}),e.jsx("option",{value:"per_person",children:"Por Pessoa"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Regra de Consenso"}),e.jsxs("select",{value:m.consensusRule,onChange:L=>g({...m,consensusRule:L.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-800 rounded-lg text-white focus:border-indigo-600 focus:outline-none",children:[e.jsx("option",{value:"2/3",children:"2/3 dos votos"}),e.jsx("option",{value:"3/3",children:"Unanimidade"})]})]})]}),c===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Quem vai nessa viagem?"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Selecione os viajantes que participaro desta viagem. Voc pode pular e adicionar depois."}),e.jsx(ee,{placeholder:"Buscar viajante...",value:q,onChange:L=>Q(L.target.value)})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:w.filter(L=>{const X=q.toLowerCase();return(L.full_name||"").toLowerCase().includes(X)||L.email&&L.email.toLowerCase().includes(X)||L.phone&&L.phone.includes(X)}).map(L=>{const X=m.selectedTravelerIds.includes(L.id);return e.jsx("div",{onClick:()=>{g(X?{...m,selectedTravelerIds:m.selectedTravelerIds.filter(A=>A!==L.id)}:{...m,selectedTravelerIds:[...m.selectedTravelerIds,L.id]})},className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${X?"bg-indigo-600/20 border-indigo-600":"bg-gray-900/40 border-gray-800 hover:border-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:L.full_name||L.name}),e.jsx("p",{className:"text-xs text-gray-500",children:L.email||L.phone||"Sem contato"})]}),X&&e.jsx("div",{className:"w-6 h-6 bg-indigo-600 rounded-full flex items-center justify-center",children:e.jsx(Ae.Check,{className:"w-4 h-4 text-white"})})]})},L.id)})}),m.selectedTravelerIds.length>0&&e.jsx("div",{className:"pt-3 border-t border-gray-800",children:e.jsxs("p",{className:"text-sm text-gray-400",children:[m.selectedTravelerIds.length," viajante(s) selecionado(s)"]})}),w.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-sm",children:"Nenhum perfil de viajante cadastrado ainda."}),e.jsx("p",{className:"text-xs mt-1",children:"Voc pode adicionar viajantes depois de criar a viagem."})]})]}),c===5&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2",children:"Fornecedores desta viagem (opcional)"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Selecione fornecedores que voc j conhece e quer usar nesta viagem. Voc pode pular e adicionar depois."}),e.jsx(ee,{placeholder:"Buscar fornecedor...",value:C,onChange:L=>N(L.target.value)})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:j.filter(L=>{const X=C.toLowerCase();return(L.name||"").toLowerCase().includes(X)||L.categories&&L.categories.some(A=>A.toLowerCase().includes(X))}).map(L=>{const X=m.selectedVendorIds.includes(L.id);return e.jsx("div",{onClick:()=>{g(X?{...m,selectedVendorIds:m.selectedVendorIds.filter(A=>A!==L.id)}:{...m,selectedVendorIds:[...m.selectedVendorIds,L.id]})},className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${X?"bg-indigo-600/20 border-indigo-600":"bg-gray-900/40 border-gray-800 hover:border-gray-700"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:L.name||"Sem nome"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(L.categories||[]).slice(0,3).map(A=>e.jsx("span",{className:"text-[9px] font-black uppercase text-indigo-400",children:A},A))})]}),X&&e.jsx("div",{className:"w-6 h-6 bg-indigo-600 rounded-full flex items-center justify-center",children:e.jsx(Ae.Check,{className:"w-4 h-4 text-white"})})]})},L.id)})}),m.selectedVendorIds.length>0&&e.jsxs("div",{className:"pt-3 border-t border-gray-800 space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-400",children:[m.selectedVendorIds.length," fornecedor(es) selecionado(s)"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.markVendorsAsFavorite,onChange:L=>g({...m,markVendorsAsFavorite:L.target.checked}),className:"w-4 h-4 rounded border-gray-700 bg-gray-900 text-indigo-600 focus:ring-indigo-600 focus:ring-offset-gray-950"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Marcar como favoritos desta viagem"})]})]}),j.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-sm",children:"Nenhum fornecedor cadastrado ainda."}),e.jsx("p",{className:"text-xs mt-1",children:"Voc pode adicionar fornecedores depois de criar a viagem."})]})]}),e.jsxs("div",{className:"flex gap-3 justify-between mt-6 pt-6 border-t border-gray-800",children:[e.jsx(V,{onClick:r,className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsxs("div",{className:"flex gap-3",children:[c>1&&e.jsx(V,{onClick:Y,className:"bg-gray-800 hover:bg-gray-700",children:"Voltar"}),c<5?e.jsx(V,{onClick:F,disabled:!ae(),className:"bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prximo"}):e.jsx(V,{onClick:P,disabled:k,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Salvando...":o?"Salvar Alteraes":"Criar Viagem"})]})]})]})})},Eb=({onNavigateToTrip:r,onRefresh:s})=>{const[l,o]=D.useState([]),[c,u]=D.useState([]),[m,g]=D.useState(!0),[f,x]=D.useState(!1),[y,_]=D.useState(null),[k,S]=D.useState(!1),[w,v]=D.useState(!1),[j,U]=D.useState(null),q=async()=>{g(!0);try{const H=await he.getTrips(),K=H.filter(de=>de.status==="active"||de.status==="archived"),ie=H.filter(de=>de.status==="draft");o(K),u(ie)}catch(H){console.error(" TripList: Erro ao carregar viagens:",H)}finally{g(!1)}};D.useEffect(()=>{q()},[]);const Q=async H=>{try{await he.duplicateTrip(H),await q(),s()}catch(K){console.error("Erro ao duplicar viagem:",K)}},C=async H=>{try{await he.archiveTrip(H),await q(),s()}catch(K){console.error("Erro ao arquivar viagem:",K)}},N=async H=>{try{await he.deleteTrip(H),_(null),await q(),s()}catch(K){console.error("Erro ao excluir viagem:",K)}},O=async()=>{v(!0);try{const H=await he.resetDemo();S(!1),U("Demo recriado com sucesso!"),setTimeout(()=>U(null),3e3),await q(),s(),await he.setActiveTrip(H),r(H,!0)}catch(H){console.error("Erro ao resetar demo:",H),U("Erro ao resetar demo"),setTimeout(()=>U(null),3e3)}finally{v(!1)}},R=async H=>{try{await he.setActiveTrip(H),r(H,!0),s()}catch(K){console.error("Erro ao definir viagem ativa:",K)}},E=(H,K)=>{if(!H||!K)return"";const ie=new Date(H+"T00:00:00"),de=new Date(K+"T00:00:00");return`${Math.ceil((de.getTime()-ie.getTime())/(1e3*60*60*24))+1} dias`};return m?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Carregando viagens..."}):e.jsxs("div",{className:"space-y-6",children:[j&&e.jsx("div",{className:"fixed top-4 right-4 bg-emerald-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-in slide-in-from-top",children:j}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-white uppercase tracking-tight",children:"Minhas Viagens"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Gerencie todas as suas viagens"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{onClick:()=>S(!0),variant:"outline",className:"border-purple-500/30 text-purple-400 hover:bg-purple-500/10",children:" Reset Demo"}),e.jsxs(V,{onClick:()=>x(!0),className:"bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Ae.Plus,{className:"w-4 h-4 mr-2"}),"Nova Viagem"]})]})]}),c.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Rascunhos"}),e.jsx("div",{className:"grid gap-3",children:c.map(H=>e.jsx("div",{className:"bg-gray-900 border border-yellow-600/30 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:H.name||"Viagem sem nome"}),e.jsx("span",{className:"px-2 py-0.5 bg-yellow-600/20 text-yellow-400 text-xs font-bold rounded",children:"RASCUNHO"})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Criado em ",Na(H.created_at)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:()=>r(H.id),className:"bg-yellow-600 hover:bg-yellow-700 text-xs",children:"Finalizar"}),e.jsx(V,{onClick:()=>_(H.id),className:"bg-red-600/20 hover:bg-red-600/30 text-red-400 text-xs",children:"Descartar"})]})]})},H.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider",children:"Viagens"}),l.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-900 rounded-xl border border-gray-800",children:[e.jsx(Ae.Travelers,{className:"w-12 h-12 text-gray-700 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma viagem criada ainda"}),e.jsx(V,{onClick:()=>x(!0),className:"mt-4 bg-indigo-600 hover:bg-indigo-700",children:"Criar primeira viagem"})]}):e.jsx("div",{className:"grid gap-3",children:l.map(H=>e.jsx("div",{className:`bg-gray-900 border rounded-xl p-4 ${H.status==="archived"?"border-gray-800 opacity-60":"border-gray-800 hover:border-indigo-600/50"} transition-all`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:H.name}),H.status==="archived"&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-400 text-xs font-bold rounded",children:"ARQUIVADA"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[e.jsxs("span",{children:[Na(H.start_date)," - ",Na(H.end_date)]}),e.jsx("span",{children:""}),e.jsx("span",{children:E(H.start_date,H.end_date)}),H.destinations&&H.destinations.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{children:H.destinations.join(", ")})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:()=>R(H.id),className:"bg-indigo-600 hover:bg-indigo-700 text-xs",children:"Abrir"}),e.jsx(V,{onClick:()=>Q(H.id),className:"bg-gray-800 hover:bg-gray-700 text-xs",children:"Duplicar"}),H.status==="active"?e.jsx(V,{onClick:()=>C(H.id),className:"bg-gray-800 hover:bg-gray-700 text-xs",children:"Arquivar"}):null,e.jsx(V,{onClick:()=>_(H.id),className:"bg-red-600/20 hover:bg-red-600/30 text-red-400 text-xs",children:"Excluir"})]})]})},H.id))})]}),f&&e.jsx(vd,{onClose:()=>x(!1),onSave:async H=>{const{selectedTravelerIds:K,selectedVendorIds:ie,markVendorsAsFavorite:de,...xe}=H,F=await he.saveTrip(xe);if(K&&K.length>0)for(const Y of K)await he.linkTravelerToTrip(F.id,Y);if(ie&&ie.length>0)for(const Y of ie)await he.linkVendorToTrip(F.id,Y,{preferred:de||!1});x(!1),await he.setActiveTrip(F.id),r(F.id),s()}}),y&&e.jsx(Re,{isOpen:!0,onClose:()=>_(null),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Confirmar Excluso"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Tem certeza que deseja excluir esta viagem? Esta ao no pode ser desfeita."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(V,{onClick:()=>_(null),className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:()=>N(y),className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),e.jsx(Re,{isOpen:k,onClose:()=>S(!1),title:"Reset Demo",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-lg font-bold text-white mb-2",children:" Recriar Cenrio de Demonstrao"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Isso vai criar um cenrio completo de demonstrao no seu banco de dados com:"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-bold text-gray-300 mb-2",children:"O que ser criado:"}),e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1 ml-4",children:[e.jsx("li",{children:' 1 viagem "Orlando & Miami (Demo)"'}),e.jsx("li",{children:" 7 viajantes (3 casais + 1 criana)"}),e.jsx("li",{children:" 6 fornecedores globais"}),e.jsx("li",{children:" 8 cotaes (com e sem fornecedor)"}),e.jsx("li",{children:" 3 despesas fechadas"}),e.jsx("li",{children:" Pagamentos e divises"})]})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-300",children:[" ",e.jsx("strong",{children:"Ateno:"})," Seus dados atuais sero removidos. Esta ao no pode ser desfeita."]})}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-800",children:[e.jsx(V,{variant:"ghost",onClick:()=>S(!1),className:"flex-1",disabled:w,children:"Cancelar"}),e.jsx(V,{variant:"primary",onClick:O,className:"flex-1 bg-purple-600 hover:bg-purple-700",disabled:w,children:w?"Criando...":"Recriar Demo"})]})]})})]})},Db=({trip:r,onNavigate:s,onOpenLinkTravelers:l,onOpenLinkVendors:o,onRefresh:c})=>{const[u,m]=D.useState({travelersCount:0,vendorsCount:0,quotesCount:0,expensesCount:0,paymentsCount:0}),[g,f]=D.useState(!1),[x,y]=D.useState(!0);D.useEffect(()=>{_(),localStorage.getItem(`checklist-collapsed-${r.id}`)==="true"&&f(!0)},[r.id]);const _=async()=>{y(!0);try{const q=await he.getTripSetupStats(r.id);m(q)}catch(q){console.error("Erro ao carregar stats:",q)}finally{y(!1)}};D.useEffect(()=>{_()},[c]);const k=[{id:"travelers",label:"Vincule viajantes",completed:u.travelersCount>=1,action:l,buttonLabel:"Adicionar viajantes"},{id:"vendors",label:"Vincule fornecedores",completed:u.vendorsCount>=1,action:o,buttonLabel:"Adicionar fornecedores"},{id:"quotes",label:"Crie sua primeira cotao",completed:u.quotesCount>=1,action:()=>s("quotes"),buttonLabel:"Nova cotao"},{id:"expenses",label:"Feche sua primeira cotao",completed:u.expensesCount>=1,action:()=>s("quotes"),buttonLabel:"Ver cotaes"},{id:"payments",label:"Registre um pagamento",completed:u.paymentsCount>=1,action:()=>s("payments"),buttonLabel:"Pagamentos"}],S=k.filter(q=>q.completed).length,w=k.length,v=Math.round(S/w*100),j=S===w,U=()=>{const q=!g;f(q),localStorage.setItem(`checklist-collapsed-${r.id}`,String(q))};return D.useEffect(()=>{if(j&&!g){const q=setTimeout(()=>{f(!0),localStorage.setItem(`checklist-collapsed-${r.id}`,"true")},3e3);return()=>clearTimeout(q)}},[j,g,r.id]),x?null:e.jsxs(me,{className:"border-2 border-indigo-500/30 bg-gradient-to-br from-indigo-500/5 to-purple-500/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center",children:j?e.jsx(Ae.Check,{className:"w-6 h-6 text-indigo-400"}):e.jsx("span",{className:"text-lg font-black text-indigo-400",children:S})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-white",children:j?" Checklist Completo!":"Checklist da Viagem"}),e.jsx("p",{className:"text-sm text-gray-400",children:j?"Sua viagem est pronta para comear!":`${S}/${w} concludos`})]})]}),e.jsx(V,{variant:"ghost",onClick:U,className:"text-xs",children:g?"Expandir":"Ocultar"})]}),!g&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"w-full bg-gray-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 h-full transition-all duration-1000",style:{width:`${v}%`}})})}),e.jsx("div",{className:"space-y-3",children:k.map(q=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-all ${q.completed?"bg-emerald-500/10 border-emerald-500/30":"bg-gray-800/50 border-gray-700 hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ${q.completed?"bg-emerald-500 border-emerald-400":"border-gray-600"}`,children:q.completed&&e.jsx(Ae.Check,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:`text-sm font-bold ${q.completed?"text-emerald-400 line-through":"text-gray-300"}`,children:q.label})]}),!q.completed&&e.jsx(V,{variant:"ghost",onClick:q.action,className:"text-xs py-1 px-3",children:q.buttonLabel})]},q.id))}),j&&e.jsx("div",{className:"mt-4 p-3 bg-indigo-500/10 border border-indigo-500/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-indigo-300 text-center",children:"Parabns! Voc completou todas as etapas essenciais. Agora  s aproveitar! "})})]})]})},Ab=({trip:r,quotes:s,expenses:l,onNavigate:o,onRefresh:c,onEditTrip:u})=>{const[m,g]=D.useState([]),[f,x]=D.useState(!0),[y,_]=D.useState(!1),[k,S]=D.useState(!1),[w,v]=D.useState(!1),j=F=>F?F.replace(/[\u{1F300}-\u{1F9FF}]/gu,"").replace(/[\n\r]+/g," ").replace(/\s+/g," ").trim():"";D.useEffect(()=>{U()},[r.id,r]);const U=async()=>{x(!0);try{const F=await he.getTripTravelers(r.id);g(F)}catch(F){console.error("Erro ao carregar viajantes:",F)}finally{x(!1)}},q=(F,Y)=>{if(!F||!Y)return"";const P=new Date(F+"T00:00:00"),ae=new Date(Y+"T00:00:00");return`${Math.ceil((ae.getTime()-P.getTime())/(1e3*60*60*24))+1} dias`},Q=s.length,C=s.filter(F=>F.status==="Aprovada"||F.status==="Fechada").length,N=l.length,O=s.reduce((F,Y)=>F+(Y.amountBRL||0),0),R=l.reduce((F,Y)=>F+(Y.amountBRL||0),0),E=O-R,H=m.length>0,K=r.segments&&r.segments.length>1,ie=s.length>0,de=[{id:"travelers",label:"Adicionar viajantes",completed:H,action:()=>o("travelers"),priority:!H},{id:"segments",label:"Definir segmentos da viagem",completed:K,action:()=>o("dashboard"),priority:!1},{id:"quotes",label:"Importar ou criar oramentos",completed:ie,action:()=>o("quotes"),priority:H&&!ie}],xe=de.find(F=>!F.completed&&F.priority)||de.find(F=>!F.completed);return f?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Carregando..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-cyan-500 rounded-xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h1",{className:"text-3xl font-black uppercase tracking-tight",children:r.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:u,className:"bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white border-0",children:" Editar"}),e.jsx(V,{onClick:()=>v(!0),className:"bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white border-0",children:" Checklist"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm opacity-90",children:[e.jsxs("span",{children:[" ",Na(r.startDate)," - ",Na(r.endDate)]}),e.jsx("span",{children:""}),e.jsxs("span",{children:[" ",q(r.startDate,r.endDate)]})]}),r.segments&&r.segments.length>0&&r.segments[0].name!=="Viagem Completa"&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.segments.map((F,Y)=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-white/10 rounded-full text-xs",children:[e.jsxs("span",{className:"font-bold",children:[" ",F.name]}),F.startDate&&F.endDate&&e.jsxs("span",{className:"opacity-75",children:[Hs(F.startDate)," - ",Hs(F.endDate)]})]},F.id))})]})]}),xe&&e.jsx(me,{className:"!bg-yellow-500/10 !border-yellow-500/30",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"text-3xl",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Prximo passo"}),e.jsx("p",{className:"text-gray-400 mb-3",children:xe.label}),e.jsx(V,{onClick:xe.action,className:"bg-yellow-500 hover:bg-yellow-600 text-black font-bold",children:xe.id==="travelers"?"Adicionar Viajantes":xe.id==="quotes"?"Ver Oramentos":"Continuar"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(me,{className:"!bg-indigo-600/20 !border-indigo-600/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-black text-white",children:Q}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Oramentos"}),e.jsxs("div",{className:"text-xs text-indigo-400 mt-1",children:[C," aprovados"]})]})}),e.jsx(me,{className:"!bg-green-600/20 !border-green-600/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-black text-white",children:N}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Itens Fechados"})]})}),e.jsx(me,{className:"!bg-cyan-600/20 !border-cyan-600/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-black text-white",children:pe(O)}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Oramento Total"})]})}),e.jsx(me,{className:`${E>=0?"!bg-green-600/20 !border-green-600/30":"!bg-red-600/20 !border-red-600/30"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-black text-white",children:pe(E)}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Saldo"})]})})]}),e.jsxs(me,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Viajantes"}),e.jsxs(V,{onClick:()=>o("travelers"),className:"bg-indigo-600 hover:bg-indigo-700 text-xs",children:[e.jsx(Ae.Plus,{className:"w-4 h-4 mr-1"}),"Gerenciar"]})]}),m.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"Nenhum viajante adicionado ainda"}),e.jsx(V,{onClick:()=>o("travelers"),className:"mt-4 bg-indigo-600 hover:bg-indigo-700",children:"Adicionar Viajantes"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:m.map(F=>{var Y,P,ae,ue;return e.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:((Y=F.profile)==null?void 0:Y.type)==="Adulto"?"":((P=F.profile)==null?void 0:P.type)==="Criana"?"":""}),e.jsx("div",{className:"font-bold text-white text-sm",children:(ae=F.profile)==null?void 0:ae.full_name}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(ue=F.profile)==null?void 0:ue.type})]},F.id)})})]}),e.jsxs(me,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Oramentos Recentes"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{onClick:()=>o("quotes"),className:"bg-cyan-600 hover:bg-cyan-700 text-xs",children:"Importar do WhatsApp"}),e.jsxs(V,{onClick:()=>o("quotes"),className:"bg-indigo-600 hover:bg-indigo-700 text-xs",children:[e.jsx(Ae.Plus,{className:"w-4 h-4 mr-1"}),"Novo Oramento"]})]})]}),s.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ae.Quotes,{className:"w-12 h-12 mx-auto mb-3 text-gray-700"}),e.jsx("p",{children:"Nenhum oramento cadastrado ainda"}),e.jsx(V,{onClick:()=>o("quotes"),className:"mt-4 bg-indigo-600 hover:bg-indigo-700",children:"Criar Primeiro Oramento"})]}):e.jsxs("div",{className:"space-y-2",children:[s.slice(0,5).map(F=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg hover:bg-gray-750 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white",children:j(F.title)}),e.jsxs("div",{className:"text-sm text-gray-500",children:[F.provider,"  ",F.category]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-white",children:pe(F.amountBRL||0)}),e.jsx("div",{className:`text-xs px-2 py-0.5 rounded inline-block ${F.status==="Aprovada"?"bg-green-600/20 text-green-400":F.status==="Fechada"?"bg-blue-600/20 text-blue-400":"bg-gray-700 text-gray-400"}`,children:F.status})]})]},F.id)),s.length>5&&e.jsxs(V,{onClick:()=>o("quotes"),className:"w-full bg-gray-800 hover:bg-gray-700 text-xs",children:["Ver todos os ",s.length," oramentos"]})]})]}),l.length>0&&e.jsxs(me,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Itens Fechados Recentes"}),e.jsx(V,{onClick:()=>o("expenses"),className:"bg-gray-800 hover:bg-gray-700 text-xs",children:"Ver Todos"})]}),e.jsx("div",{className:"space-y-2",children:l.slice(0,5).map(F=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white",children:F.title}),e.jsx("div",{className:"text-sm text-gray-500",children:F.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-white",children:pe(F.amountBRL||0)}),e.jsx("div",{className:`text-xs px-2 py-0.5 rounded inline-block ${F.status==="paid"?"bg-green-600/20 text-green-400":F.status==="confirmed"?"bg-blue-600/20 text-blue-400":"bg-gray-700 text-gray-400"}`,children:F.status==="paid"?"Pago":F.status==="confirmed"?"Confirmado":"Planejado"})]})]},F.id))})]}),y&&e.jsx(Rf,{trip:r,onClose:()=>_(!1),onLinked:()=>{_(!1),U(),c()}}),k&&e.jsx(Ef,{trip:r,onClose:()=>S(!1),onLinked:()=>{S(!1),c()}}),w&&e.jsx(Re,{isOpen:!0,onClose:()=>v(!1),title:"Checklist de Configurao",children:e.jsx("div",{className:"p-6",children:e.jsx(Db,{trip:r,onNavigate:F=>{v(!1),o(F)},onOpenLinkTravelers:()=>{v(!1),_(!0)},onOpenLinkVendors:()=>{v(!1),S(!0)},onRefresh:c},`checklist-${w}`)})})]})},Ob=({onNavigateToDetail:r})=>{const[s,l]=D.useState([]),[o,c]=D.useState(!0),[u,m]=D.useState(""),[g,f]=D.useState(!1),[x,y]=D.useState(null);D.useEffect(()=>{_()},[]);const _=async()=>{c(!0);try{const w=await he.getTravelerProfiles();l(w)}catch(w){console.error("Erro ao carregar perfis:",w)}finally{c(!1)}},k=async w=>{try{await he.deleteTravelerProfile(w),y(null),await _()}catch(v){console.error("Erro ao deletar perfil:",v)}},S=s.filter(w=>{var v,j,U,q;return((v=w.full_name)==null?void 0:v.toLowerCase().includes(u.toLowerCase()))||((j=w.nickname)==null?void 0:j.toLowerCase().includes(u.toLowerCase()))||((U=w.email)==null?void 0:U.toLowerCase().includes(u.toLowerCase()))||((q=w.phone)==null?void 0:q.toLowerCase().includes(u.toLowerCase()))});return o?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Carregando perfis..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-white uppercase tracking-tight",children:"Perfis de Viajantes"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cadastros globais reutilizveis em qualquer viagem"})]}),e.jsxs(V,{onClick:()=>f(!0),className:"bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Ae.Plus,{className:"w-4 h-4 mr-2"}),"Novo Viajante"]})]}),e.jsx(me,{className:"!p-4 bg-gray-900/40 border-gray-800",children:e.jsx(ee,{placeholder:"Buscar por nome, apelido, email ou telefone...",value:u,onChange:w=>m(w.target.value)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(me,{className:"!bg-indigo-600/20 !border-indigo-600/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-black text-white",children:s.length}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Total"})]})}),e.jsx(me,{className:"!bg-blue-600/20 !border-blue-600/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-black text-white",children:s.filter(w=>w.can_drive).length}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Motoristas"})]})}),e.jsx(me,{className:"!bg-green-600/20 !border-green-600/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-black text-white",children:s.filter(w=>w.email||w.phone).length}),e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Com Contato"})]})})]}),S.length===0?e.jsxs(me,{className:"text-center py-12",children:[e.jsx(Ae.Travelers,{className:"w-12 h-12 text-gray-700 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum perfil cadastrado ainda"}),e.jsx(V,{onClick:()=>f(!0),className:"mt-4 bg-indigo-600 hover:bg-indigo-700",children:"Criar primeiro perfil"})]}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(w=>e.jsx(me,{className:"!p-4 hover:!border-indigo-600/50 transition-all cursor-pointer",onClick:()=>r(w.id),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white text-lg",children:w.full_name}),w.nickname&&e.jsxs("div",{className:"text-xs text-gray-500",children:['"',w.nickname,'"']})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[w.can_drive&&e.jsx(ge,{color:"blue",className:"text-[9px]",children:" DIRIGE"}),w.tags&&w.tags.length>0&&w.tags.map(v=>e.jsx(ge,{color:"gray",className:"text-[9px]",children:v},v))]}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-400",children:[w.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{children:Ei(w.phone)})]}),w.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{className:"truncate",children:w.email})]}),!w.phone&&!w.email&&e.jsx("div",{className:"text-gray-600 italic",children:"Sem contato"})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-800",children:[e.jsx(ge,{color:"indigo",children:"Ver Perfil "}),e.jsx(V,{onClick:v=>{v.stopPropagation(),y(w.id)},className:"bg-red-600/20 hover:bg-red-600/30 text-red-400 text-xs",children:"Excluir"})]})]})},w.id))}),x&&e.jsx(Re,{isOpen:!0,onClose:()=>y(null),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Confirmar Excluso"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Tem certeza que deseja excluir este perfil? Esta ao no pode ser desfeita."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(V,{onClick:()=>y(null),className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:()=>k(x),className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),e.jsx(Re,{isOpen:g,onClose:()=>f(!1),title:"Novo Viajante",size:"xl",children:e.jsx(Oi,{onCancel:()=>f(!1),onDone:async w=>{f(!1),await _()}})})]})},Rb={Passaporte:"",RG:"",CPF:"",CNH:"",Visto:"",ESTA:"",Outro:""},Lb=(r,s)=>{if(!r)return"";const l=r.replace(/[^A-Za-z0-9]/g,"");switch(s){case"CPF":return l.slice(0,11).replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{3})(\d{1})$/,"$1.$2.$3-$4").replace(/(\d{3})(\d{3})(\d{2})$/,"$1.$2.$3").replace(/(\d{3})(\d{2})$/,"$1.$2");case"RG":return l.slice(0,9).replace(/(\d{2})(\d{3})(\d{3})(\d{1})/,"$1.$2.$3-$4").replace(/(\d{2})(\d{3})(\d{3})$/,"$1.$2.$3").replace(/(\d{2})(\d{3})$/,"$1.$2");case"CNH":return l.slice(0,11);case"Passaporte":return l.slice(0,8).toUpperCase();default:return r}},Ub=({profileId:r,onBack:s,onRefresh:l})=>{const[o,c]=D.useState(null),[u,m]=D.useState([]),[g,f]=D.useState(!0),[x,y]=D.useState(!1),[_,k]=D.useState(null),[S,w]=D.useState(!1),[v,j]=D.useState(!1),[U,q]=D.useState(!1),[Q,C]=D.useState(null),[N,O]=D.useState(null),[R,E]=D.useState("all"),[H,K]=D.useState("all"),[ie,de]=D.useState("");D.useEffect(()=>{xe()},[r]);const xe=async()=>{f(!0);try{const b=await he.getTravelerProfileById(r);if(b){c(b);const B=await he.getTravelerProfileDocuments(r);m(B)}else console.error(" Perfil no encontrado com ID:",r)}catch(b){console.error(" Erro ao carregar perfil:",b)}f(!1)},F=async()=>{if(o)try{await he.deleteTravelerProfile(o.id),l(),s()}catch(b){console.error("Erro ao excluir perfil:",b)}},Y=async b=>{try{if(!b.docNumber||b.docNumber.trim()===""){O("Por favor, preencha o nmero do documento"),setTimeout(()=>O(null),5e3);return}const B={id:b.id,travelerProfileId:b.travelerProfileId||(o==null?void 0:o.id),docType:b.docType,docCategory:b.docCategory,docNumber:b.docNumber.trim(),issuerCountry:b.issuerCountry||"",issuerState:b.issuerState||"",issuerAgency:b.issuerAgency||"",issuerPlace:b.issuerPlace||"",regionOrCountry:b.regionOrCountry||"",issueDate:b.issueDate||"",expiryDate:b.expiryDate||b.docExpiry||"",visaCategory:b.visaCategory||"",entryType:b.entryType||"",stayDurationDays:b.stayDurationDays||null,licenseCategory:b.licenseCategory||"",customLabel:b.customLabel||"",passportDocumentId:b.passportDocumentId||null,isPrimary:b.isPrimary||!1,notes:b.notes||""};await he.saveTravelerProfileDocument(B),await xe(),C("Documento salvo com sucesso!"),setTimeout(()=>C(null),3e3),k(null),w(!1)}catch(B){O("Erro ao salvar documento: "+B.message),setTimeout(()=>O(null),5e3)}},P=async b=>{try{await he.deleteTravelerProfileDocument(b),await xe(),C("Documento excludo com sucesso!"),setTimeout(()=>C(null),3e3)}catch(B){O("Erro ao excluir documento: "+B.message),setTimeout(()=>O(null),5e3)}},ae=async(b,B)=>{try{const z=u.find(oe=>oe.id===b);if(!z)return;await he.saveTravelerProfileDocument({...z,id:b,docNumber:B}),await xe(),C("Nmero do documento atualizado com sucesso!"),setTimeout(()=>C(null),3e3)}catch(z){O("Erro ao atualizar nmero: "+z.message),setTimeout(()=>O(null),5e3)}},ue=()=>{j(!0)},L=b=>{j(!1),w(!0);const B={travelerProfileId:o==null?void 0:o.id,docType:b,docCategory:b==="Visto"||b==="ESTA"?"entry":"identity",docNumber:"",notes:"",issuerCountry:"",issuerState:"",issuerAgency:"",issuerPlace:"",regionOrCountry:"",issueDate:"",expiryDate:"",visaCategory:"",entryType:"",stayDurationDays:null,licenseCategory:"",customLabel:"",passportDocumentId:null,isPrimary:!1};k(B)};if(g||!o)return g?e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 animate-pulse",children:"Carregando perfil..."})}):e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-400 mb-4",children:" Perfil no encontrado"}),e.jsx(V,{variant:"outline",onClick:s,children:" Voltar para lista"})]})});const X=u.filter(b=>{var fe,Ce,Ne,Pe;const B=R==="all"||b.docCategory===R,z=H==="all"||b.docType===H,oe=!ie||((fe=b.docNumber)==null?void 0:fe.toLowerCase().includes(ie.toLowerCase()))||((Ce=b.issuerCountry)==null?void 0:Ce.toLowerCase().includes(ie.toLowerCase()))||((Ne=b.issuerState)==null?void 0:Ne.toLowerCase().includes(ie.toLowerCase()))||((Pe=b.customLabel)==null?void 0:Pe.toLowerCase().includes(ie.toLowerCase()));return B&&z&&oe}),A={passports:X.filter(b=>b.docType==="Passaporte"),identity:X.filter(b=>["RG","CPF","CNH"].includes(b.docType)),entry:X.filter(b=>["Visto","ESTA"].includes(b.docType)),others:X.filter(b=>b.docType==="Outro")},M=[];return e.jsxs("div",{className:"min-h-screen bg-gray-950",children:[Q&&e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg animate-in slide-in-from-top-2 duration-300",children:e.jsxs("p",{className:"text-sm font-bold",children:[" ",Q]})}),N&&e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-red-600 text-white px-6 py-3 rounded-xl shadow-lg animate-in slide-in-from-top-2 duration-300",children:e.jsxs("p",{className:"text-sm font-bold",children:[" ",N]})}),e.jsx("div",{className:"bg-gray-900/50 border-b border-gray-800 px-8 py-6",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto",children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-2 text-gray-500 hover:text-white transition-colors mb-4",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Viajantes"})]}),e.jsxs("div",{className:"flex items-start justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("h1",{className:"text-3xl font-black text-white tracking-tight",children:o.full_name}),e.jsx("div",{className:"flex items-center gap-2",children:o.can_drive&&e.jsx(ge,{color:"blue",className:"text-[10px] px-2 py-0.5",children:"DIRIGE"})})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-400",children:[o.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:""}),e.jsx("span",{children:Ei(o.phone)})]}),o.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:""}),e.jsx("span",{className:"truncate max-w-xs",children:o.email})]}),!o.phone&&!o.email&&e.jsx("span",{className:"text-gray-600 italic text-xs",children:"Sem informaes de contato"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",size:"sm",onClick:()=>y(!0),children:" Editar"}),e.jsx(V,{variant:"primary",size:"sm",onClick:ue,children:"+ Documento"}),e.jsx("div",{className:"relative",children:U?e.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-gray-900 border border-gray-800 rounded-xl shadow-xl p-3 w-64 z-10 animate-in slide-in-from-top-2",children:[e.jsx("p",{className:"text-xs text-red-400 font-bold mb-3",children:" Confirmar excluso?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"ghost",className:"flex-1 bg-red-600/20 text-red-400 hover:bg-red-600/30 text-xs",onClick:F,children:"Excluir"}),e.jsx(V,{variant:"ghost",className:"text-xs",onClick:()=>q(!1),children:"Cancelar"})]})]}):e.jsx("button",{onClick:()=>q(!0),className:"px-3 py-2 text-gray-500 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]})]})]})}),e.jsxs("div",{className:"max-w-[1600px] mx-auto px-8 py-6",children:[M.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-amber-600/10 rounded-xl border border-amber-600/20",children:[e.jsxs("p",{className:"text-xs font-black text-amber-500 uppercase mb-3",children:[" ",M.length," Pendncia",M.length>1?"s":""]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:M.map((b,B)=>e.jsxs("p",{className:"text-xs text-amber-400 leading-tight",children:[" ",b.message]},B))})]}),e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-5",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-black text-white uppercase mb-3",children:"Documentos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsxs(ee,{as:"select",value:R,onChange:b=>E(b.target.value),className:"text-xs",children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),e.jsx("option",{value:"identity",children:"Identidade"}),e.jsx("option",{value:"entry",children:"Entrada no Pas"})]}),e.jsxs(ee,{as:"select",value:H,onChange:b=>K(b.target.value),className:"text-xs",children:[e.jsx("option",{value:"all",children:"Todos os Tipos"}),e.jsx("option",{value:"Passaporte",children:"Passaporte"}),e.jsx("option",{value:"RG",children:"RG"}),e.jsx("option",{value:"CPF",children:"CPF"}),e.jsx("option",{value:"CNH",children:"CNH"}),e.jsx("option",{value:"Visto",children:"Visto"}),e.jsx("option",{value:"ESTA",children:"ESTA/ETA"}),e.jsx("option",{value:"Outro",children:"Outros"})]}),e.jsx(ee,{placeholder:"Buscar...",value:ie,onChange:b=>de(b.target.value),className:"text-xs"})]})]}),X.length===0?e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 italic mb-3",children:"Nenhum documento encontrado"}),e.jsx(V,{variant:"outline",size:"sm",onClick:ue,children:"+ Adicionar primeiro documento"})]}):e.jsxs("div",{className:"space-y-4",children:[A.passports.length>0&&e.jsx(ji,{title:" Passaportes",count:A.passports.length,documents:A.passports,onEdit:b=>{k(b),w(!1)}}),A.identity.length>0&&e.jsx(ji,{title:" Identidade",count:A.identity.length,documents:A.identity,onEdit:b=>{k(b),w(!1)}}),A.entry.length>0&&e.jsx(ji,{title:" Entrada no Pas",count:A.entry.length,documents:A.entry,onEdit:b=>{k(b),w(!1)}}),A.others.length>0&&e.jsx(ji,{title:" Outros",count:A.others.length,documents:A.others,onEdit:b=>{k(b),w(!1)}})]})]})]}),e.jsx(Re,{isOpen:x,onClose:()=>y(!1),title:"Editar Perfil",size:"xl",children:e.jsx(Oi,{existingProfileId:o.id,onCancel:()=>y(!1),onDone:async b=>{y(!1),await xe(),l()}})}),e.jsx(Re,{isOpen:v,onClose:()=>j(!1),title:"Selecione o tipo de documento",size:"lg",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[{type:"Passaporte",icon:"",desc:"Documento internacional",color:"indigo"},{type:"RG",icon:"",desc:"Registro Geral",color:"blue"},{type:"CPF",icon:"",desc:"Cadastro de Pessoa Fsica",color:"green"},{type:"CNH",icon:"",desc:"Carteira de Habilitao",color:"purple"},{type:"Visto",icon:"",desc:"Autorizao de entrada",color:"yellow"},{type:"ESTA",icon:"",desc:"Autorizao eletrnica",color:"cyan"},{type:"Outro",icon:"",desc:"Documento customizado",color:"gray"}].map(({type:b,icon:B,desc:z,color:oe})=>e.jsxs("button",{onClick:()=>L(b),className:"group relative p-6 bg-gray-950 hover:bg-gray-900 border border-gray-800 hover:border-indigo-500 rounded-xl transition-all text-left overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600/0 via-indigo-600/0 to-indigo-600/0 group-hover:from-indigo-600/5 group-hover:via-indigo-600/10 group-hover:to-indigo-600/5 transition-all duration-300"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-4xl mb-3 transform group-hover:scale-110 transition-transform duration-200",children:B}),e.jsx("p",{className:"font-black text-white text-lg mb-1",children:b}),e.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:z})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-indigo-600 to-purple-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300"})]},b))})}),_&&e.jsx(Lf,{document:_,passports:u.filter(b=>b.docType==="Passaporte"),onClose:()=>{k(null),w(!1)},onSave:Y,onDelete:P,onUpdateNumber:ae,isNewDocument:S})]})},ji=({title:r,count:s,documents:l,onEdit:o})=>{const[c,u]=D.useState(!1),m=y=>{if(!y)return null;const _=new Date,k=new Date(y),S=Math.ceil((k.getTime()-_.getTime())/(1e3*60*60*24));return S<0?{color:"bg-red-600/20 text-red-400 border-red-600/30",textColor:"text-red-400",label:"Vencido"}:S<=30?{color:"bg-red-600/20 text-red-400 border-red-600/30",textColor:"text-red-400",label:`Vence em ${S}d`}:S<=90?{color:"bg-yellow-600/20 text-yellow-400 border-yellow-600/30",textColor:"text-yellow-400",label:`Vence em ${S}d`}:null},g=y=>y.issuerCountry||y.issuerState||y.regionOrCountry||"",f=y=>{if(y.docType==="Visto"&&y.visaCategory)return y.visaCategory;if(y.docType==="CNH"&&y.licenseCategory)return`Cat. ${y.licenseCategory}`;if(y.docType==="RG"&&(y.issuerAgency||y.issuerState)){const _=[];return y.issuerAgency&&_.push(y.issuerAgency),y.issuerState&&_.push(y.issuerState),_.join("/")}return y.docType==="Outro"&&y.customLabel?y.customLabel:y.docType==="Visto"&&y.entryType?y.entryType==="multiple"?"Mltiplas":"nica":null},x=l.filter(y=>m(y.expiryDate)!==null).length;return e.jsxs("div",{className:"border border-gray-800 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>u(!c),className:"w-full px-5 py-3 bg-gray-900/50 flex items-center justify-between hover:bg-gray-900 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm font-black text-gray-300 uppercase tracking-wide",children:r}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:[s," ",s===1?"item":"itens"]}),x>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{className:"text-amber-400 font-bold",children:[x," ",x===1?"alerta":"alertas"]})]})]})]}),e.jsx("svg",{className:`w-4 h-4 text-gray-600 transition-transform duration-200 ${c?"":"rotate-180"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!c&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900/30 border-b border-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Emissor"}),e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Nmero"}),e.jsx("th",{className:"px-5 py-2.5 text-left text-[10px] font-black text-gray-500 uppercase tracking-wider",children:"Validade"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:l.map(y=>{const _=m(y.expiryDate),k=g(y),S=f(y);return e.jsxs("tr",{onClick:()=>o(y),className:"hover:bg-gray-900/40 transition-colors cursor-pointer group",children:[e.jsx("td",{className:"px-5 py-3.5",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("span",{className:"text-xl",children:Rb[y.docType]||""}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white",children:y.docType}),S&&e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:S}),y.isPrimary&&e.jsx("span",{className:"inline-block mt-1 text-[8px] px-1.5 py-0.5 bg-emerald-600/20 text-emerald-400 rounded uppercase font-bold border border-emerald-600/30",children:"Principal"})]})]})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("p",{className:"text-sm text-gray-300",children:k})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("p",{className:"text-sm font-mono text-white",children:Lb(y.docNumber,y.docType)})}),e.jsx("td",{className:"px-5 py-3.5",children:y.expiryDate?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:`text-sm ${_?_.textColor:"text-gray-300"}`,children:Ai(y.expiryDate)}),_&&e.jsx("span",{className:`inline-block text-[10px] px-2 py-0.5 rounded uppercase font-bold border ${_.color}`,children:_.label})]}):e.jsx("p",{className:"text-sm text-gray-600 italic",children:"Sem validade"})})]},y.id)})})]})})]})},Mb=({onNavigateToDetail:r})=>{const[s,l]=D.useState([]),[o,c]=D.useState(!0),[u,m]=D.useState(""),[g,f]=D.useState(!1),[x,y]=D.useState(null),[_,k]=D.useState(null),[S,w]=D.useState({name:"",legalName:"",categories:[],rating:3,tags:[],riskFlags:[],contacts:[],websiteUrl:"",instagramUrl:"",youtubeUrl:"",paymentTermsDefault:"",cancellationPolicyNotes:""});D.useEffect(()=>{v()},[]);const v=async()=>{c(!0);try{const C=await he.getVendorProfiles();l(C)}catch(C){console.error("Erro ao carregar perfis:",C)}finally{c(!1)}},j=async()=>{try{await he.saveVendorProfile({id:x==null?void 0:x.id,...S}),f(!1),y(null),w({name:"",legalName:"",categories:[],rating:3,tags:[],riskFlags:[],contacts:[],websiteUrl:"",instagramUrl:"",youtubeUrl:"",paymentTermsDefault:"",cancellationPolicyNotes:""}),await v()}catch(C){console.error("Erro ao salvar perfil:",C)}},U=C=>{y(C),w({name:C.name,legalName:C.legal_name||"",categories:C.categories||[],rating:C.rating||3,tags:C.tags||[],riskFlags:C.risk_flags||[],contacts:C.contacts||[],websiteUrl:C.website_url||"",instagramUrl:C.instagram_url||"",youtubeUrl:C.youtube_url||"",paymentTermsDefault:C.payment_terms_default||"",cancellationPolicyNotes:C.cancellation_policy_notes||""}),f(!0)},q=async C=>{try{await he.deleteVendorProfile(C),k(null),await v()}catch(N){console.error("Erro ao deletar perfil:",N)}},Q=s.filter(C=>{var N,O;return((N=C.name)==null?void 0:N.toLowerCase().includes(u.toLowerCase()))||((O=C.legal_name)==null?void 0:O.toLowerCase().includes(u.toLowerCase()))});return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-6xl animate-pulse",children:""}),e.jsx("p",{className:"text-gray-500 animate-pulse",children:"Carregando fornecedores..."})]})}):e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600/20 via-purple-600/20 to-pink-600/20 border border-indigo-600/30 p-8",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djItaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6bTAtNHYyaDJ2LTJoLTJ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-30"}),e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-2xl shadow-lg",children:""}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:"Fornecedores"}),e.jsx("p",{className:"text-sm text-indigo-300 mt-1",children:"Sua rede de parceiros confiveis"})]})]})}),e.jsxs(V,{onClick:()=>f(!0),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold shadow-xl border-2 border-indigo-400/50",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Novo Fornecedor"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-indigo-600/20 to-indigo-600/5 !border-indigo-600/30 hover:!border-indigo-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:s.length}),e.jsx("div",{className:"text-xs text-indigo-400 mt-2 uppercase font-bold tracking-wider",children:"Total de Fornecedores"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-indigo-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-green-600/20 to-green-600/5 !border-green-600/30 hover:!border-green-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:s.filter(C=>C.rating>=4).length}),e.jsx("div",{className:"text-xs text-green-400 mt-2 uppercase font-bold tracking-wider",children:"Bem Avaliados"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-green-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-amber-600/20 to-amber-600/5 !border-amber-600/30 hover:!border-amber-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:s.filter(C=>C.website_url||C.instagram_url||C.youtube_url).length}),e.jsx("div",{className:"text-xs text-amber-400 mt-2 uppercase font-bold tracking-wider",children:"Com Presena Online"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-amber-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})}),e.jsx(me,{className:"!p-6 !bg-gradient-to-br from-red-600/20 to-red-600/5 !border-red-600/30 hover:!border-red-500 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-4xl font-black text-white group-hover:scale-110 transition-transform",children:s.filter(C=>{var N;return((N=C.risk_flags)==null?void 0:N.length)>0}).length}),e.jsx("div",{className:"text-xs text-red-400 mt-2 uppercase font-bold tracking-wider",children:"Com Alertas"})]}),e.jsx("div",{className:"w-14 h-14 rounded-xl bg-red-600/20 flex items-center justify-center text-3xl group-hover:scale-110 transition-transform",children:""})]})})]}),e.jsx(me,{className:"!p-6 bg-gradient-to-r from-gray-900/60 to-gray-900/40 border-gray-800 backdrop-blur-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:u,onChange:C=>m(C.target.value),placeholder:"Buscar fornecedor por nome, razo social, categoria...",className:"w-full pl-12 pr-4 py-4 bg-gray-950/50 border border-gray-800 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all"}),u&&e.jsx("button",{onClick:()=>m(""),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),Q.length===0?e.jsx(me,{className:"text-center py-16 bg-gray-900/40 border-gray-800",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-bold text-white",children:s.length===0?"Nenhum perfil cadastrado":"Nenhum resultado encontrado"}),e.jsx("p",{className:"text-gray-500 text-sm",children:s.length===0?"Crie perfis globais de fornecedores para reutilizar em todas as suas viagens":"Tente ajustar sua busca para encontrar o fornecedor desejado"}),s.length===0&&e.jsxs(V,{onClick:()=>f(!0),className:"mt-4 bg-indigo-600 hover:bg-indigo-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Criar primeiro perfil"]})]})}):e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:Q.map(C=>{var E,H;const N=C.rating>=4&&(((E=C.risk_flags)==null?void 0:E.length)||0)===0,O=(((H=C.risk_flags)==null?void 0:H.length)||0)>0,R=C.website_url||C.instagram_url||C.youtube_url;return e.jsxs(me,{className:"!p-0 hover:!border-indigo-500 hover:shadow-2xl hover:shadow-indigo-500/20 transition-all duration-300 cursor-pointer overflow-hidden group relative",onClick:()=>r(C.id),children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600/5 via-transparent to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"relative p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-600/20 to-purple-600/20 flex items-center justify-center text-3xl flex-shrink-0 group-hover:scale-110 transition-transform duration-300 border border-indigo-600/30",children:C.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-white text-xl group-hover:text-indigo-400 transition-colors leading-tight",children:C.name}),C.legal_name&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 truncate",children:C.legal_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[O?e.jsxs(ge,{color:"red",className:"text-[9px]",children:[" ",C.risk_flags.length," alertas"]}):N?e.jsx(ge,{color:"green",className:"text-[9px]",children:" Confivel"}):e.jsx(ge,{color:"gray",className:"text-[9px]",children:""}),R&&e.jsx(ge,{color:"indigo",className:"text-[9px]",children:" Online"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 py-3 px-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(K=>e.jsx("span",{className:`text-xl ${C.rating>=K?"text-amber-400":"text-gray-800"}`,children:""},K))}),e.jsxs("span",{className:"text-sm text-gray-500 font-bold",children:["(",C.rating,"/5)"]})]}),C.categories&&C.categories.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[C.categories.slice(0,4).map(K=>e.jsx("span",{className:"text-[10px] px-3 py-1.5 bg-gradient-to-r from-indigo-600/20 to-purple-600/20 text-indigo-300 rounded-lg font-bold uppercase border border-indigo-600/30",children:K},K)),C.categories.length>4&&e.jsxs("span",{className:"text-[10px] px-3 py-1.5 bg-gray-800 text-gray-500 rounded-lg font-bold border border-gray-700",children:["+",C.categories.length-4]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-gray-800",children:[C.website_url&&e.jsx("div",{className:"w-10 h-10 rounded-lg bg-indigo-600/20 flex items-center justify-center text-indigo-400 hover:bg-indigo-600/30 transition-colors",title:"Website",children:""}),C.instagram_url&&e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-600/20 to-pink-600/20 flex items-center justify-center text-pink-400 hover:from-purple-600/30 hover:to-pink-600/30 transition-colors",title:"Instagram",children:""}),C.youtube_url&&e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-600/20 flex items-center justify-center text-red-400 hover:bg-red-600/30 transition-colors",title:"YouTube",children:""}),C.contacts&&C.contacts.length>0&&e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-600/20 flex items-center justify-center text-green-400 hover:bg-green-600/30 transition-colors",title:`${C.contacts.length} contatos`,children:""}),e.jsx("div",{className:"flex-1"}),e.jsx("span",{className:"text-[9px] text-gray-600 font-bold uppercase tracking-wider opacity-0 group-hover:opacity-100 transition-opacity",children:"Ver detalhes "})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-gray-800",children:[e.jsxs(V,{onClick:K=>{K.stopPropagation(),U(C)},className:"flex-1 bg-gradient-to-r from-gray-800 to-gray-700 hover:from-gray-700 hover:to-gray-600 text-white text-sm py-2.5 font-bold",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Editar"]}),e.jsx(V,{onClick:K=>{K.stopPropagation(),k(C.id)},className:"bg-red-600/20 hover:bg-red-600/30 text-red-400 text-sm px-4 py-2.5 font-bold border border-red-600/30",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},C.id)})}),_&&e.jsx(Re,{isOpen:!0,onClose:()=>k(null),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-600/20 flex items-center justify-center text-2xl",children:""}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Confirmar Excluso"})]}),e.jsxs("p",{className:"text-gray-400 mb-6",children:["Tem certeza que deseja ",e.jsx("span",{className:"font-bold text-red-400",children:"excluir permanentemente"})," este perfil? Esta ao no pode ser desfeita e todos os dados sero perdidos."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(V,{onClick:()=>k(null),className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsxs(V,{onClick:()=>q(_),className:"bg-red-600 hover:bg-red-700",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Sim, Excluir Permanentemente"]})]})]})}),e.jsx(Re,{isOpen:g,onClose:()=>{f(!1),y(null)},children:e.jsxs("div",{className:"p-4 space-y-4 max-h-[85vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-gray-800",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-600/20 to-purple-600/20 flex items-center justify-center text-xl",children:""}),e.jsx("h3",{className:"text-lg font-bold text-white",children:x?"Editar Perfil":"Novo Perfil"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Nome Comercial *"}),e.jsx(ee,{value:S.name,onChange:C=>w({...S,name:C.target.value}),placeholder:"Nome",className:"!py-2 !text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Razo Social"}),e.jsx(ee,{value:S.legalName,onChange:C=>w({...S,legalName:C.target.value}),placeholder:"Opcional",className:"!py-2 !text-sm"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 py-2 px-3 bg-gray-900/50 rounded-lg border border-gray-800",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500",children:"Avaliao:"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(C=>e.jsx("button",{type:"button",onClick:()=>w({...S,rating:C}),className:`text-xl ${S.rating>=C?"text-amber-400":"text-gray-700"} hover:scale-110 transition-transform`,children:""},C))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" Website"}),e.jsx(ee,{value:S.websiteUrl,onChange:C=>w({...S,websiteUrl:C.target.value}),placeholder:"https://...",className:"!py-2 !text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" Instagram"}),e.jsx(ee,{value:S.instagramUrl,onChange:C=>w({...S,instagramUrl:C.target.value}),placeholder:"@usuario",className:"!py-2 !text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" YouTube"}),e.jsx(ee,{value:S.youtubeUrl,onChange:C=>w({...S,youtubeUrl:C.target.value}),placeholder:"URL",className:"!py-2 !text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-800",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-500 uppercase",children:["Contatos (",(S.contacts||[]).length,")"]}),e.jsx("button",{type:"button",onClick:()=>{const C={id:Math.random().toString(36).substr(2,9),name:"",role:"Comercial",phone:"",email:"",preferredMethod:"WhatsApp",isPrimary:(S.contacts||[]).length===0};w({...S,contacts:[...S.contacts||[],C]})},className:"text-[10px] px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded font-bold transition-colors",children:"+ Adicionar"})]}),(S.contacts||[]).length===0?e.jsx("div",{className:"text-center py-4 bg-gray-900/30 border border-gray-800 rounded-lg",children:e.jsx("p",{className:"text-xs text-gray-600 italic",children:"Nenhum contato"})}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:(S.contacts||[]).map((C,N)=>e.jsx("div",{className:"p-2 bg-gray-900/50 border border-gray-800 rounded-lg",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",value:C.name,onChange:O=>{const R=[...S.contacts||[]];R[N]={...C,name:O.target.value},w({...S,contacts:R})},placeholder:"Nome",className:"px-2 py-1.5 bg-gray-950 border border-gray-800 rounded text-white text-xs placeholder-gray-600 focus:outline-none focus:border-indigo-500"}),e.jsx("input",{type:"text",value:C.role,onChange:O=>{const R=[...S.contacts||[]];R[N]={...C,role:O.target.value},w({...S,contacts:R})},placeholder:"Cargo",className:"px-2 py-1.5 bg-gray-950 border border-gray-800 rounded text-white text-xs placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"tel",value:C.phone||"",onChange:O=>{const R=[...S.contacts||[]];R[N]={...C,phone:O.target.value},w({...S,contacts:R})},placeholder:"WhatsApp/Tel",className:"px-2 py-1.5 bg-gray-950 border border-gray-800 rounded text-white text-xs placeholder-gray-600 focus:outline-none focus:border-indigo-500"}),e.jsx("input",{type:"email",value:C.email||"",onChange:O=>{const R=[...S.contacts||[]];R[N]={...C,email:O.target.value},w({...S,contacts:R})},placeholder:"Email",className:"px-2 py-1.5 bg-gray-950 border border-gray-800 rounded text-white text-xs placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:C.isPrimary,onChange:O=>{const R=(S.contacts||[]).map((E,H)=>({...E,isPrimary:H===N?O.target.checked:!1}));w({...S,contacts:R})},className:"accent-indigo-500"}),e.jsx("span",{className:"text-gray-500",children:"Principal"})]}),e.jsx("span",{className:"text-gray-700",children:"|"}),["WhatsApp","Email"].map(O=>e.jsx("button",{type:"button",onClick:()=>{const R=[...S.contacts||[]];R[N]={...C,preferredMethod:O},w({...S,contacts:R})},className:`px-1.5 py-0.5 rounded font-bold transition-colors ${C.preferredMethod===O?"bg-indigo-600 text-white":"bg-gray-800 text-gray-600 hover:bg-gray-700"}`,children:O==="WhatsApp"?"WA":"EM"},O))]})]}),e.jsx("button",{type:"button",onClick:()=>{const O=(S.contacts||[]).filter((R,E)=>E!==N);w({...S,contacts:O})},className:"text-red-500/50 hover:text-red-500 px-1 text-sm",children:""})]})},C.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Condies de Pagamento"}),e.jsx(ee,{value:S.paymentTermsDefault,onChange:C=>w({...S,paymentTermsDefault:C.target.value}),placeholder:"Ex: 50% + 50% 30d",className:"!py-2 !text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Poltica de Cancelamento"}),e.jsx(ee,{value:S.cancellationPolicyNotes,onChange:C=>w({...S,cancellationPolicyNotes:C.target.value}),placeholder:"Resumo da poltica",className:"!py-2 !text-sm"})]})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-3 border-t border-gray-800",children:[e.jsx(V,{onClick:()=>{f(!1),y(null)},className:"bg-gray-800 hover:bg-gray-700 !py-2 !text-sm",children:"Cancelar"}),e.jsx(V,{onClick:j,className:"bg-indigo-600 hover:bg-indigo-700 !py-2 !text-sm",disabled:!S.name.trim(),children:x?"Salvar":"Criar"})]})]})})]})},zb=({profileId:r,onBack:s,onRefresh:l})=>{const[o,c]=D.useState(null),[u,m]=D.useState(!0),[g,f]=D.useState(!1),[x,y]=D.useState(!1),[_,k]=D.useState(null),[S,w]=D.useState(!1),[v,j]=D.useState({name:"",legalName:"",categories:[],rating:3,tags:[],riskFlags:[],contacts:[],websiteUrl:"",instagramUrl:"",youtubeUrl:"",paymentTermsDefault:"",cancellationPolicyNotes:""});D.useEffect(()=>{q(),U()},[r]);const U=async()=>{w(!0);try{const N=await he.getVendorProfileHistory(r);k(N)}catch(N){console.error("Erro ao carregar histrico:",N)}finally{w(!1)}},q=async()=>{m(!0);try{const N=await he.getVendorProfileById(r);c(N),j({name:N.name||"",legalName:N.legal_name||"",categories:N.categories||[],rating:N.rating||3,tags:N.tags||[],riskFlags:N.risk_flags||[],contacts:N.contacts||[],websiteUrl:N.website_url||"",instagramUrl:N.instagram_url||"",youtubeUrl:N.youtube_url||"",paymentTermsDefault:N.payment_terms_default||"",cancellationPolicyNotes:N.cancellation_policy_notes||""})}catch(N){console.error("Erro ao carregar perfil:",N)}finally{m(!1)}},Q=async()=>{try{await he.deleteVendorProfile(r),s()}catch(N){console.error("Erro ao arquivar perfil:",N)}},C=async()=>{try{await he.saveVendorProfile({id:r,...v}),y(!1),await q()}catch(N){console.error("Erro ao salvar perfil:",N)}};return u?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"text-gray-500",children:"Carregando perfil..."})}):o?e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-2 text-gray-400 hover:text-white group",children:[e.jsx("svg",{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Perfis de Fornecedores"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"outline",onClick:()=>y(!0),children:"Editar Perfil"}),e.jsx(V,{variant:"ghost",className:"text-red-400 hover:text-red-300",onClick:()=>f(!0),children:"Arquivar"})]})]}),e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 pb-6 border-b border-gray-800",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-4xl font-black text-white uppercase tracking-tighter leading-none",children:o.name}),o.legal_name&&e.jsx("p",{className:"text-sm text-gray-500",children:o.legal_name}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:(o.categories||[]).map(N=>e.jsx(ge,{color:"indigo",children:N},N))})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(N=>e.jsx("span",{className:`text-2xl ${o.rating>=N?"text-amber-400":"text-gray-800"}`,children:""},N))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Avaliao Global"})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Links e Redes Sociais"}),e.jsxs("div",{className:"space-y-3",children:[o.website_url&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:o.website_url.startsWith("http")?o.website_url:`https://${o.website_url}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center gap-3 p-3 bg-gray-900 hover:bg-gray-800 border border-gray-800 hover:border-indigo-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600/20 flex items-center justify-center text-indigo-400 group-hover:bg-indigo-600/30",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Website"}),e.jsx("p",{className:"text-sm text-white truncate group-hover:text-indigo-400 transition-colors",children:o.website_url})]})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(o.website_url);const N=document.activeElement;N.innerHTML='<svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>',setTimeout(()=>{N.innerHTML='<svg class="w-5 h-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>'},1500)},className:"p-3 hover:bg-gray-800 rounded-xl transition-colors border border-gray-800",title:"Copiar link",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),o.instagram_url&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:o.instagram_url.startsWith("@")?`https://instagram.com/${o.instagram_url.slice(1)}`:`https://instagram.com/${o.instagram_url}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center gap-3 p-3 bg-gray-900 hover:bg-gray-800 border border-gray-800 hover:border-pink-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-600/20 to-pink-600/20 flex items-center justify-center text-pink-400 group-hover:from-purple-600/30 group-hover:to-pink-600/30",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Instagram"}),e.jsx("p",{className:"text-sm text-white truncate group-hover:text-pink-400 transition-colors",children:o.instagram_url.startsWith("@")?o.instagram_url:`@${o.instagram_url}`})]})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(o.instagram_url);const N=document.activeElement;N.innerHTML='<svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>',setTimeout(()=>{N.innerHTML='<svg class="w-5 h-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>'},1500)},className:"p-3 hover:bg-gray-800 rounded-xl transition-colors border border-gray-800",title:"Copiar link",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),o.youtube_url&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:o.youtube_url.startsWith("http")?o.youtube_url:`https://youtube.com/${o.youtube_url}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center gap-3 p-3 bg-gray-900 hover:bg-gray-800 border border-gray-800 hover:border-red-600/50 rounded-xl transition-all group",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-600/20 flex items-center justify-center text-red-400 group-hover:bg-red-600/30",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"YouTube"}),e.jsx("p",{className:"text-sm text-white truncate group-hover:text-red-400 transition-colors",children:o.youtube_url})]})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(o.youtube_url);const N=document.activeElement;N.innerHTML='<svg class="w-5 h-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>',setTimeout(()=>{N.innerHTML='<svg class="w-5 h-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>'},1500)},className:"p-3 hover:bg-gray-800 rounded-xl transition-colors border border-gray-800",title:"Copiar link",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),!o.website_url&&!o.instagram_url&&!o.youtube_url&&e.jsx("div",{className:"text-center py-8 text-gray-600 italic text-sm",children:"Nenhum link cadastrado"})]})]}),o.tags&&o.tags.length>0&&e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-3",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map(N=>e.jsx("span",{className:"px-3 py-1.5 bg-gray-900 border border-gray-800 rounded-lg text-xs font-bold text-gray-400",children:N},N))})]}),o.risk_flags&&o.risk_flags.length>0&&e.jsxs(me,{className:"!bg-red-600/10 !border-red-600/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsx("h3",{className:"text-sm font-black text-red-400 uppercase",children:"Alertas de Risco"})]}),e.jsx("div",{className:"space-y-2",children:o.risk_flags.map(N=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400",children:[e.jsx("span",{children:""}),e.jsx("span",{children:N})]},N))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Equipe de Atendimento"}),o.contacts&&o.contacts.length>0?e.jsx("div",{className:"space-y-4",children:o.contacts.map(N=>e.jsxs("div",{className:"p-3 bg-gray-900 border border-gray-800 rounded-xl space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-bold text-white",children:N.name}),e.jsx("p",{className:"text-xs text-gray-500",children:N.role})]}),N.isPrimary&&e.jsx(ge,{color:"indigo",className:"text-[9px]",children:"Principal"})]}),e.jsxs("div",{className:"space-y-2",children:[N.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:`https://wa.me/${N.phone.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center gap-2 p-2 bg-green-600/10 hover:bg-green-600/20 border border-green-600/30 hover:border-green-600/50 rounded-lg transition-all group text-sm",children:[e.jsx("span",{className:"text-green-400",children:""}),e.jsx("span",{className:"text-white group-hover:text-green-400 transition-colors",children:N.phone})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(N.phone);const O=document.activeElement;O.innerHTML='<svg class="w-4 h-4 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>',setTimeout(()=>{O.innerHTML='<svg class="w-4 h-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>'},1500)},className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),N.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:`mailto:${N.email}`,className:"flex-1 flex items-center gap-2 p-2 bg-blue-600/10 hover:bg-blue-600/20 border border-blue-600/30 hover:border-blue-600/50 rounded-lg transition-all group text-sm",children:[e.jsx("span",{className:"text-blue-400",children:""}),e.jsx("span",{className:"text-white truncate group-hover:text-blue-400 transition-colors",children:N.email})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(N.email);const O=document.activeElement;O.innerHTML='<svg class="w-4 h-4 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>',setTimeout(()=>{O.innerHTML='<svg class="w-4 h-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>'},1500)},className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"Preferido:"}),e.jsx(ge,{color:"gray",className:"text-[9px]",children:N.preferredMethod})]})]})]},N.id))}):e.jsx("div",{className:"text-center py-8 text-gray-600 italic text-sm",children:"Nenhum contato cadastrado"})]}),e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Condies de Pagamento"}),o.payment_terms_default?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-4 bg-gray-900 border border-gray-800 rounded-xl",children:e.jsx("p",{className:"text-white",children:o.payment_terms_default})}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(o.payment_terms_default);const N=document.activeElement,O=N.textContent;N.textContent=" Copiado!",N.classList.add("!text-green-400"),setTimeout(()=>{N.textContent=O,N.classList.remove("!text-green-400")},1500)},className:"text-xs text-gray-500 hover:text-indigo-400 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar condies"]})]}):e.jsx("p",{className:"text-gray-600 italic text-sm",children:"No informado"})]}),e.jsxs(me,{children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase mb-4",children:"Poltica de Cancelamento"}),o.cancellation_policy_notes?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"p-4 bg-gray-900 border border-gray-800 rounded-xl",children:e.jsx("p",{className:"text-white whitespace-pre-wrap",children:o.cancellation_policy_notes})}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(o.cancellation_policy_notes);const N=document.activeElement,O=N.textContent;N.textContent=" Copiado!",N.classList.add("!text-green-400"),setTimeout(()=>{N.textContent=O,N.classList.remove("!text-green-400")},1500)},className:"text-xs text-gray-500 hover:text-indigo-400 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copiar poltica"]})]}):e.jsx("p",{className:"text-gray-600 italic text-sm",children:"No informado"})]})]})]}),e.jsxs(me,{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-black text-gray-400 uppercase",children:"Histrico de Uso"}),_&&e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:[_.totalTrips," viagens"]}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{className:"text-gray-500",children:[_.totalQuotes," oramentos"]}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsx("span",{className:"text-indigo-400 font-bold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(_.totalValue)})]})]}),S?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Carregando histrico..."}):!_||_.trips.length===0&&_.quotes.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-3",children:""}),e.jsx("p",{className:"text-gray-600 italic text-sm",children:"Este fornecedor ainda no foi usado em nenhuma viagem"})]}):e.jsxs("div",{className:"space-y-6",children:[_.trips.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-3",children:["Viagens (",_.trips.length,")"]}),e.jsx("div",{className:"space-y-2",children:_.trips.map(N=>{var O,R,E,H;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 border border-gray-800 rounded-lg hover:border-indigo-600/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white text-sm",children:((O=N.trip)==null?void 0:O.name)||"Viagem sem nome"}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:((R=N.trip)==null?void 0:R.start_date)&&((E=N.trip)==null?void 0:E.end_date)&&e.jsxs("span",{children:[new Date(N.trip.start_date).toLocaleDateString("pt-BR")," - ",new Date(N.trip.end_date).toLocaleDateString("pt-BR")]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[N.preferred&&e.jsx(ge,{color:"amber",className:"text-[9px]",children:" Favorito"}),e.jsx(ge,{color:"gray",className:"text-[9px]",children:((H=N.trip)==null?void 0:H.status)||"ativo"})]})]},N.id)})})]}),_.quotes.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-3",children:["Oramentos (",_.quotes.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[_.quotes.slice(0,5).map(N=>{var O;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900 border border-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold text-white text-sm",children:cleanText(N.title)}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[(O=N.trip)==null?void 0:O.name,"  ",N.category]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-white text-sm",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(N.amount_brl||0)}),e.jsx(ge,{color:N.status==="Fechada"?"green":"gray",className:"text-[9px] mt-1",children:N.status})]})]},N.id)}),_.quotes.length>5&&e.jsx("div",{className:"text-center py-2",children:e.jsxs("span",{className:"text-xs text-gray-600",children:["+ ",_.quotes.length-5," oramentos"]})})]})]})]})]}),g&&e.jsx(Re,{isOpen:!0,onClose:()=>f(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Confirmar Arquivamento"}),e.jsxs("p",{className:"text-gray-400 mb-6",children:["Tem certeza que deseja arquivar o perfil de ",e.jsx("span",{className:"font-bold text-white",children:o.name}),"? Ele no ser mais exibido na lista de fornecedores."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(V,{onClick:()=>f(!1),className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:Q,className:"bg-red-600 hover:bg-red-700",children:"Arquivar Perfil"})]})]})}),x&&e.jsx(Re,{isOpen:!0,onClose:()=>y(!1),children:e.jsxs("div",{className:"p-6 space-y-6 max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Editar Perfil"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase border-b border-gray-800 pb-2",children:"Identificao"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Nome Comercial *"}),e.jsx("input",{value:v.name,onChange:N=>j({...v,name:N.target.value}),placeholder:"Nome do fornecedor",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Razo Social"}),e.jsx("input",{value:v.legalName,onChange:N=>j({...v,legalName:N.target.value}),placeholder:"Razo social (opcional)",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Avaliao"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(N=>e.jsx("button",{type:"button",onClick:()=>j({...v,rating:N}),className:`text-2xl ${v.rating>=N?"text-amber-400":"text-gray-700"}`,children:""},N))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase border-b border-gray-800 pb-2",children:"Links e Redes Sociais"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:" Website"}),e.jsx("input",{value:v.websiteUrl,onChange:N=>j({...v,websiteUrl:N.target.value}),placeholder:"https://...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:" Instagram"}),e.jsx("input",{value:v.instagramUrl,onChange:N=>j({...v,instagramUrl:N.target.value}),placeholder:"@usuario",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:" YouTube"}),e.jsx("input",{value:v.youtubeUrl,onChange:N=>j({...v,youtubeUrl:N.target.value}),placeholder:"https://youtube.com/@canal ou link do vdeo",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-800 pb-2",children:[e.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase",children:"Contatos"}),e.jsx("button",{type:"button",onClick:()=>{const N={id:Math.random().toString(36).substr(2,9),name:"",role:"Comercial",phone:"",email:"",preferredMethod:"WhatsApp",isPrimary:(v.contacts||[]).length===0};j({...v,contacts:[...v.contacts||[],N]})},className:"text-xs px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:"+ Adicionar"})]}),(v.contacts||[]).length===0?e.jsxs("div",{className:"text-center py-6 bg-gray-900/50 border border-gray-800 rounded-xl",children:[e.jsx("p",{className:"text-sm text-gray-600 italic mb-2",children:"Nenhum contato cadastrado"}),e.jsx("button",{type:"button",onClick:()=>{const N={id:Math.random().toString(36).substr(2,9),name:"",role:"Comercial",phone:"",email:"",preferredMethod:"WhatsApp",isPrimary:!0};j({...v,contacts:[N]})},className:"text-xs text-indigo-400 hover:text-indigo-300",children:"Adicionar primeiro contato"})]}):e.jsx("div",{className:"space-y-3",children:(v.contacts||[]).map((N,O)=>e.jsx("div",{className:"p-3 bg-gray-900 border border-gray-800 rounded-xl space-y-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",value:N.name,onChange:R=>{const E=[...v.contacts||[]];E[O]={...N,name:R.target.value},j({...v,contacts:E})},placeholder:"Nome",className:"px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"}),e.jsx("input",{type:"text",value:N.role,onChange:R=>{const E=[...v.contacts||[]];E[O]={...N,role:R.target.value},j({...v,contacts:E})},placeholder:"Cargo",className:"px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"tel",value:N.phone||"",onChange:R=>{const E=[...v.contacts||[]];E[O]={...N,phone:R.target.value},j({...v,contacts:E})},placeholder:"WhatsApp/Telefone",className:"px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"}),e.jsx("input",{type:"email",value:N.email||"",onChange:R=>{const E=[...v.contacts||[]];E[O]={...N,email:R.target.value},j({...v,contacts:E})},placeholder:"Email",className:"px-3 py-2 bg-gray-950 border border-gray-800 rounded-lg text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:N.isPrimary,onChange:R=>{const E=(v.contacts||[]).map((H,K)=>({...H,isPrimary:K===O?R.target.checked:!1}));j({...v,contacts:E})},className:"accent-indigo-500"}),e.jsx("span",{className:"text-gray-500",children:"Principal"})]}),e.jsx("span",{className:"text-gray-600",children:"|"}),e.jsx("span",{className:"text-gray-600",children:"Preferido:"}),["WhatsApp","Email"].map(R=>e.jsx("button",{type:"button",onClick:()=>{const E=[...v.contacts||[]];E[O]={...N,preferredMethod:R},j({...v,contacts:E})},className:`px-2 py-0.5 rounded text-[10px] font-bold transition-colors ${N.preferredMethod===R?"bg-indigo-600 text-white":"bg-gray-800 text-gray-500 hover:bg-gray-700"}`,children:R},R))]})]}),e.jsx("button",{type:"button",onClick:()=>{const R=(v.contacts||[]).filter((E,H)=>H!==O);j({...v,contacts:R})},className:"ml-2 text-red-500/50 hover:text-red-500 p-1",children:""})]})},N.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-black text-gray-400 uppercase border-b border-gray-800 pb-2",children:"Condies"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Condies de Pagamento"}),e.jsx("input",{value:v.paymentTermsDefault,onChange:N=>j({...v,paymentTermsDefault:N.target.value}),placeholder:"Ex: 50% entrada + 50% 30 dias",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-1",children:"Poltica de Cancelamento"}),e.jsx("textarea",{value:v.cancellationPolicyNotes,onChange:N=>j({...v,cancellationPolicyNotes:N.target.value}),placeholder:"Descreva a poltica de cancelamento...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white text-sm placeholder-gray-600 focus:outline-none focus:border-indigo-500",rows:3})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-800",children:[e.jsx(V,{onClick:()=>y(!1),className:"bg-gray-800 hover:bg-gray-700",children:"Cancelar"}),e.jsx(V,{onClick:C,className:"bg-indigo-600 hover:bg-indigo-700",disabled:!v.name.trim(),children:"Salvar Alteraes"})]})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 space-y-4",children:[e.jsx("div",{className:"text-6xl",children:""}),e.jsx("div",{className:"text-gray-500",children:"Perfil no encontrado"}),e.jsx(V,{onClick:s,children:"Voltar"})]})},Bb=()=>{const[r,s]=D.useState(null),[l,o]=D.useState(!0),[c,u]=D.useState({type:"general-dashboard"}),[m,g]=D.useState(null),[f,x]=D.useState(null),[y,_]=D.useState(!1),[k,S]=D.useState(!1),[w,v]=D.useState(null),[j,U]=D.useState("login"),[q,Q]=D.useState([]),[C,N]=D.useState([]),[O,R]=D.useState([]),[E,H]=D.useState(!0);D.useEffect(()=>{re.auth.getSession().then(({data:{session:X}})=>{s((X==null?void 0:X.user)??null),o(!1)});const{data:{subscription:L}}=re.auth.onAuthStateChange((X,A)=>{s((A==null?void 0:A.user)??null)});return()=>L.unsubscribe()},[]);const K=async L=>{if(r){if(!L){x(null),g(null),Q([]),N([]),R([]);return}_(!0);try{x(L);const X=await he.getTripById(L),[A,M,b,B,z]=await Promise.all([Oe.getCouples(L),Oe.getSegments(L),Oe.getVendors(L),Oe.getQuotes(L),Oe.getExpenses(L)]),oe=await Oe.getTravelers(L),fe=A.map(Pe=>({id:Pe.id,name:Pe.name,members:oe.filter(Tt=>Tt.couple_id===Pe.id).map(Tt=>({id:Tt.id,name:Tt.full_name,isChild:Tt.type!=="Adulto"}))})),Ce=M.map(Pe=>({id:Pe.id,name:Pe.name,startDate:Pe.start_date,endDate:Pe.end_date})),Ne={id:X.id,name:X.name,startDate:X.start_date,endDate:X.end_date,consensusRule:X.consensus_rule,categories:X.categories,couples:fe,segments:Ce.length>0?Ce:[]};g(Ne),Q(b),N(B),R(z)}catch(X){console.error("Erro ao carregar dados:",X)}finally{_(!1)}}};if(D.useEffect(()=>{r&&(H(!1),x(null),g(null),Q([]),N([]),R([]),u({type:"general-dashboard"}))},[r]),l)return e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center text-gray-500 animate-pulse font-black uppercase tracking-widest italic",children:"Carregando..."});const ie=async()=>{if(!r){U("signup"),H(!1);return}H(!1)},de=async L=>{await K(L),u({type:"trip-dashboard",tripId:L})},xe=async()=>{x(null),g(null),Q([]),N([]),R([]);const{data:{user:L}}=await re.auth.getUser();L&&await re.from("td_user_active_trip").delete().eq("user_id",L.id),u({type:"general-dashboard"})},F=async(L,X=!1)=>{await K(L),X&&u({type:"trip-dashboard",tripId:L})},Y=()=>{v(null),S(!0)},P=async()=>{if(!f)return;const L=await he.getTripById(f),X=await he.getSegments(f);v({...L,segments:X.map(A=>({id:A.id,name:A.name,startDate:A.start_date||"",endDate:A.end_date||""}))}),S(!0)};if(!r)return E?e.jsx(e.Fragment,{children:e.jsxs("main",{className:"bg-[#02040a]",children:[e.jsx(of,{onCreateTrip:ie,hasTrip:!1,onEnter:()=>H(!1)}),e.jsx(cf,{})]})}):e.jsx(Kv,{onSuccess:()=>o(!1),initialMode:j});if(y)return e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center text-gray-500 animate-pulse font-black uppercase tracking-widest italic",children:"Iniciando TripDivide..."});if(E)return e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"bg-[#02040a]",children:[e.jsx(of,{onCreateTrip:ie,hasTrip:!!m,onEnter:()=>H(!1)}),e.jsx(cf,{})]}),k&&e.jsx(vd,{initialTrip:w,onClose:()=>{S(!1),v(null)},onSave:async L=>{console.log(" TripWizard onSave - tripData:",L);const X=await he.saveTrip(L);console.log(" Viagem salva:",X.id);let A=[];if(console.log(" Segmentos a criar:",L.segments),L.segments&&L.segments.length>0)for(const M of L.segments){console.log(" Salvando segmento:",M);const b=await he.saveSegment({tripId:X.id,name:M.name,startDate:M.startDate,endDate:M.endDate});console.log(" Segmento salvo:",b),A.push(b.id)}else{console.log(' Nenhum segmento encontrado, criando "Viagem Completa"');const M=await he.saveSegment({tripId:X.id,name:"Viagem Completa",startDate:L.startDate,endDate:L.endDate});A.push(M.id)}if(console.log(" Total de segmentos criados:",A.length),L.selectedTravelerIds&&L.selectedTravelerIds.length>0)for(const M of L.selectedTravelerIds)await he.linkTravelerToTrip({tripId:X.id,travelerProfileId:M,coupleId:null,goesToSegments:A,isPayer:!0,countInSplit:!0});S(!1),v(null),H(!1),await K(X.id),u({type:"trip-dashboard",tripId:X.id})}})]});const ae=L=>{u(f?{type:L,tripId:f}:{type:L})},ue=()=>{switch(c.type){case"general-dashboard":return e.jsx(df,{onNavigate:L=>u({type:L}),onOpenTrip:de});case"trips":return e.jsx(Eb,{onNavigateToTrip:L=>de(L),onRefresh:()=>{}});case"trip-dashboard":return m?e.jsx(Ab,{trip:m,quotes:C,expenses:O,onNavigate:ae,onRefresh:()=>K(c.tripId),onEditTrip:P}):null;case"travelers":return c.tripId&&m?e.jsx(pb,{trip:m,onRefresh:()=>K(c.tripId),onNavigateToDetail:L=>u({type:"traveler-profile-detail",profileId:L,returnTo:{type:"travelers",tripId:c.tripId}})}):e.jsx(Ob,{onNavigateToDetail:L=>u({type:"traveler-profile-detail",profileId:L,returnTo:{type:"travelers"}})});case"traveler-detail":return m?e.jsx(jb,{trip:m,travelerId:c.id,onBack:()=>u({type:"travelers",tripId:c.tripId}),onRefresh:()=>K(f)}):null;case"traveler-profile-detail":return e.jsx(Ub,{profileId:c.profileId,onBack:()=>u(c.returnTo||{type:"travelers"}),onRefresh:()=>{}});case"vendors":return c.tripId&&m?e.jsx(Zv,{trip:m,onRefresh:()=>K(c.tripId),onNavigateToVendor:L=>u({type:"vendor-detail",id:L,tripId:c.tripId}),onNavigateToWizard:()=>u({type:"vendor-edit",tripId:c.tripId})}):e.jsx(Mb,{onNavigateToDetail:L=>u({type:"vendor-profile-detail",profileId:L,returnTo:{type:"vendors"}})});case"vendor-detail":{if(!m)return null;const L=q.find(X=>X.id===c.id);return L?e.jsx(wb,{trip:m,vendor:L,onBack:()=>u({type:"vendors",tripId:c.tripId}),onEdit:()=>u({type:"vendor-edit",id:L.id,tripId:c.tripId}),onRefresh:()=>K(f),onNavigateToQuote:X=>u({type:"quote-detail",id:X,tripId:f}),onCreateQuote:()=>u({type:"quote-edit",tripId:f})}):null}case"vendor-profile-detail":return e.jsx(zb,{profileId:c.profileId,onBack:()=>u({type:"vendors"}),onRefresh:()=>{}});case"vendor-edit":{if(!m)return null;const L=q.find(X=>X.id===c.id);return e.jsx(Sb,{trip:m,initialData:L||{},onCancel:()=>u({type:"vendors",tripId:c.tripId}),onSave:async X=>{await Oe.saveVendor(X),K(f),u({type:"vendors",tripId:c.tripId})}})}case"quotes":return m?e.jsx(ib,{trip:m,vendors:q,quotes:C,onRefresh:()=>K(c.tripId),onNavigateToQuote:L=>u({type:"quote-detail",id:L,tripId:c.tripId}),onNavigateToWizard:L=>u({type:"quote-edit",initialData:L,tripId:c.tripId}),onNavigateToCompare:L=>u({type:"quote-compare",ids:L,tripId:c.tripId})}):null;case"quote-detail":{if(!m)return null;const L=C.find(X=>X.id===c.id);return L?e.jsx(Nb,{trip:m,quote:L,onBack:()=>u({type:"quotes",tripId:c.tripId}),onEdit:()=>u({type:"quote-edit",id:L.id,tripId:c.tripId}),onRefresh:()=>K(c.tripId),onNavigateToExpense:async()=>{const X=await Oe.closeQuoteToExpense(m.id,L.id);X&&(await K(c.tripId),u({type:"expense-detail",id:X.id,tripId:c.tripId}))},onNavigateToQuote:X=>u({type:"quote-detail",id:X,tripId:c.tripId})}):null}case"quote-compare":{if(!m)return null;const L=C.filter(X=>c.ids.includes(X.id));return e.jsx(Cb,{trip:m,quotes:L,onBack:()=>u({type:"quotes",tripId:c.tripId}),onRefresh:()=>K(c.tripId),onNavigateToQuote:X=>u({type:"quote-detail",id:X,tripId:c.tripId})})}case"quote-edit":{if(!m)return null;const L=C.find(A=>A.id===c.id),X=c.initialData||{};return e.jsx(_b,{trip:m,vendors:q,initialData:L||X,onCancel:()=>u({type:"quotes",tripId:c.tripId}),onSave:async A=>{await Oe.saveQuote(A),K(c.tripId),u({type:"quotes",tripId:c.tripId})}})}case"expenses":return m?e.jsx(ob,{trip:m,expenses:O,onRefresh:()=>K(c.tripId),onNavigateToExpense:L=>u({type:"expense-detail",id:L,tripId:c.tripId})}):null;case"expense-detail":{if(!m)return null;const L=O.find(X=>X.id===c.id);return L?e.jsx(mb,{trip:m,expense:L,onBack:()=>u({type:"expenses",tripId:c.tripId}),onRefresh:()=>K(c.tripId)}):null}case"payments":return m?e.jsx(fb,{trip:m}):null;case"settlement":return m?e.jsx(gb,{trip:m}):null;default:return e.jsx(df,{onNavigate:L=>u({type:L}),onOpenTrip:de})}};return e.jsxs(Fv,{activeTab:c.type.split("-")[0],setActiveTab:ae,tripId:f,tripName:(m==null?void 0:m.name)||"Sem viagem",userEmail:r==null?void 0:r.email,onTripChange:F,onCreateTrip:Y,onCloseTrip:xe,children:[ue(),k&&e.jsx(vd,{initialTrip:w,onClose:()=>{S(!1),v(null)},onSave:async L=>{if(L.id){console.log(" Editando viagem existente:",L.id),await he.saveTrip(L),console.log(" Viagem atualizada");const X=await he.getSegments(L.id),A=new Set(X.map(b=>b.id)),M=new Set((L.segments||[]).map(b=>b.id).filter(Boolean));for(const b of X)M.has(b.id)||(console.log(" Deletando segmento:",b.name),await re.from("td_segments").delete().eq("id",b.id));if(L.segments&&L.segments.length>0)for(const b of L.segments)b.id&&A.has(b.id)?(console.log(" Atualizando segmento:",b.name),await he.saveSegment({id:b.id,tripId:L.id,name:b.name,startDate:b.startDate,endDate:b.endDate})):(console.log(" Criando novo segmento:",b.name),await he.saveSegment({tripId:L.id,name:b.name,startDate:b.startDate,endDate:b.endDate}));console.log(" Segmentos atualizados"),await K(L.id),u({type:"trip-dashboard",tripId:L.id})}else{const X=await he.saveTrip(L);console.log(" Viagem criada:",X.id);let A=[];if(console.log(" Segmentos a criar:",L.segments),L.segments&&L.segments.length>0)for(const M of L.segments){console.log(" Salvando segmento:",M);const b=await he.saveSegment({tripId:X.id,name:M.name,startDate:M.startDate,endDate:M.endDate});console.log(" Segmento salvo:",b),A.push(b.id)}else{console.log(' Nenhum segmento encontrado, criando "Viagem Completa"');const M=await he.saveSegment({tripId:X.id,name:"Viagem Completa",startDate:L.startDate,endDate:L.endDate});A.push(M.id)}if(console.log(" Total de segmentos criados:",A.length),L.selectedTravelerIds&&L.selectedTravelerIds.length>0)for(const M of L.selectedTravelerIds)await he.linkTravelerToTrip({tripId:X.id,travelerProfileId:M,coupleId:null,goesToSegments:A,isPayer:!0,countInSplit:!0});if(L.selectedVendorIds&&L.selectedVendorIds.length>0)for(const M of L.selectedVendorIds)await he.linkVendorToTrip({tripId:X.id,vendorProfileId:M,isFavorite:L.markVendorsAsFavorite||!1});await K(X.id),u({type:"trip-dashboard",tripId:X.id})}S(!1),v(null),H(!1)}})]})},Uf=document.getElementById("root");if(!Uf)throw new Error("Could not find root element to mount to");const Ib=gp.createRoot(Uf);Ib.render(e.jsx(ip.StrictMode,{children:e.jsx(Bb,{})}));
